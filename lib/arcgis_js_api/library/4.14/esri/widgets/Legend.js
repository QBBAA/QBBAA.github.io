// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.15/esri/copyright.txt for details.
//>>built
/*

 Copyright 2000, Silicon Graphics, Inc. All Rights Reserved.
 Copyright 2015, Google Inc. All Rights Reserved.

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to
 deal in the Software without restriction, including without limitation the
 rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 sell copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:

 The above copyright notice including the dates of first publication and
 either this permission notice or a reference to http://oss.sgi.com/projects/FreeB/
 shall be included in all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL
 SILICON GRAPHICS, INC. BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR
 IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

 Original Code. The Original Code is: OpenGL Sample Implementation,
 Version 1.2.1, released January 26, 2000, developed by Silicon Graphics,
 Inc. The Original Code is Copyright (c) 1991-2000 Silicon Graphics, Inc.
 Copyright in any portions created by third parties is as indicated
 elsewhere herein. All Rights Reserved.
*/
require({cache:{"esri/widgets/Legend/LegendViewModel":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/Collection ../../core/Handles ../../core/watchUtils ../../core/accessorSupport/decorators ../../views/2d/layers/support/clusterUtils ./support/ActiveLayerInfo".split(" "),function(g,a,d,h,b,e,m,c,l,f,t){var x=e.ofType(t),n="esri.layers.CSVLayer esri.layers.FeatureLayer esri.layers.HeatmapLayer esri.layers.MapImageLayer esri.layers.PointCloudLayer esri.layers.TileLayer esri.layers.StreamLayer esri.layers.SceneLayer esri.layers.GeoRSSLayer esri.layers.GeoJSONLayer esri.layers.GroupLayer esri.layers.ImageryLayer esri.layers.WMSLayer esri.layers.WMTSLayer".split(" "),
p=["view.basemapView.baseLayerViews","view.groundView.layerViews","view.layerViews","view.basemapView.referenceLayerViews"];return function(a){function b(k){k=a.call(this,k)||this;k._handles=new m;k._layerViewByLayerId={};k._layerInfosByLayerViewId={};k._activeLayerInfosByLayerViewId={};k.activeLayerInfos=new x;k.basemapLegendVisible=!1;k.groundLegendVisible=!1;k.respectLayerVisibility=!0;k.layerInfos=[];k.view=null;return k}d(b,a);b.prototype.initialize=function(){this._handles.add(c.init(this,"view",
this._viewHandles),"view")};b.prototype.destroy=function(){this._destroyViewActiveLayerInfos();this._handles.destroy();this.view=this._handles=null};Object.defineProperty(b.prototype,"state",{get:function(){return this.get("view.ready")?"ready":"disabled"},enumerable:!0,configurable:!0});b.prototype._viewHandles=function(){this._handles.remove("state");this.view&&this._handles.add(c.init(this,"state",this._stateHandles),"state")};b.prototype._stateHandles=function(){this._resetAll();"ready"===this.state&&
this._watchPropertiesAndAllLayerViews()};b.prototype._resetAll=function(){this._handles.remove(["all-layer-views","legend-properties"]);this._destroyViewActiveLayerInfos();this.activeLayerInfos.removeAll()};b.prototype._destroyViewActiveLayerInfos=function(){Object.keys(this._activeLayerInfosByLayerViewId).forEach(this._destroyViewActiveLayerInfo,this)};b.prototype._destroyViewActiveLayerInfo=function(a){this._handles.remove(a);delete this._activeLayerInfosByLayerViewId[a]};b.prototype._watchPropertiesAndAllLayerViews=
function(){var a=this.view.allLayerViews;a.length&&this._refresh();this._handles.add(a.on("change",this._allLayerViewsChangeHandle.bind(this)),"all-layer-views");this._handles.add(c.watch(this,"layerInfos, basemapLegendVisible, groundLegendVisible",this._propertiesChangeHandle.bind(this)),"legend-properties")};b.prototype._allLayerViewsChangeHandle=function(a){var k=this;a.removed.forEach(function(a){return k._destroyViewActiveLayerInfo(a.uid)});this._refresh()};b.prototype._propertiesChangeHandle=
function(){this._destroyViewActiveLayerInfos();this._refresh()};b.prototype._refresh=function(){this._layerInfosByLayerViewId={};this.activeLayerInfos.removeAll();this._generateLayerViews().filter(this._filterLayerViewsByLayerInfos,this).filter(this._isLayerViewSupported,this).forEach(this._generateActiveLayerInfo,this);this._sortActiveLayerInfos(this.activeLayerInfos)};b.prototype._sortActiveLayerInfos=function(a){var k={};this.view.allLayerViews.forEach(function(a,c){return k[a.layer.uid]=c});a.sort(function(a,
c){return(k[c.layer.uid]||0)-(k[a.layer.uid]||0)})};b.prototype._generateLayerViews=function(){var a=[];p.filter(this._filterLayerViews,this).map(this.get,this).filter(function(a){return null!=a}).forEach(this._collectLayerViews("layerViews",a));return a};b.prototype._filterLayerViews=function(a){var k=!this.groundLegendVisible&&"view.groundView.layerViews"===a;return!(!this.basemapLegendVisible&&("view.basemapView.baseLayerViews"===a||"view.basemapView.referenceLayerViews"===a))&&!k};b.prototype._collectLayerViews=
function(a,c){var k=function(q){q&&q.forEach(function(q){c.push(q);k(q[a])});return c};return k};b.prototype._filterLayerViewsByLayerInfos=function(a){var k=this,c=this.layerInfos;return c&&c.length?c.some(function(c){return k._hasLayerInfo(c,a)}):!0};b.prototype._hasLayerInfo=function(a,c){var k=this._isLayerUIDMatching(a.layer,c.layer.uid);k&&(this._layerInfosByLayerViewId[c.uid]=a);return k};b.prototype._isLayerUIDMatching=function(a,c){return a&&(a.uid===c||this._hasLayerUID(a.layers,c))};b.prototype._hasLayerUID=
function(a,c){var k=this;return a&&a.some(function(a){return k._isLayerUIDMatching(a,c)})};b.prototype._isLayerViewSupported=function(a){return-1<n.indexOf(a.layer.declaredClass)?(this._layerViewByLayerId[a.layer.uid]=a,!0):!1};b.prototype._generateActiveLayerInfo=function(a){var k=this;this._isLayerActive(a)?this._buildActiveLayerInfo(a):(this._handles.remove(a.uid),this._handles.add(c.watch(a,"suspended, layer.legendEnabled",function(){return k._layerActiveHandle(a)}),a.uid))};b.prototype._layerActiveHandle=
function(a){this._isLayerActive(a)&&(this._handles.remove(a.uid),this._buildActiveLayerInfo(a))};b.prototype._isLayerActive=function(a){return this.respectLayerVisibility?!a.suspended&&a.get("layer.legendEnabled"):!0};b.prototype._buildActiveLayerInfo=function(a){var k=this,b=a.layer,q=a.uid,f=this._layerInfosByLayerViewId[q],l=this._activeLayerInfosByLayerViewId[q];l||(l=new t({layer:b,title:f&&void 0!==f.title?f.title:b.title,view:this.view}),this._activeLayerInfosByLayerViewId[q]=l);l.parent||
(f=(f=b.parent)&&this._layerViewByLayerId[f.uid],l.parent=f&&this._activeLayerInfosByLayerViewId[f.uid]);if(!this._handles.has(q)){var f=c.watch(b,"title",function(c){return k._titleHandle(c,l,a)}),e=c.watch(b,"renderer?, opacity",function(){return k._constructLegendElements(l,a)}),u=c.whenTrue(this.view,"stationary",function(){return k._scaleHandle(l,a)}),n=c.watch(a,"_effectiveRenderer",function(){return k._constructLegendElements(l,a)}),f=[f,e,u,n];this.respectLayerVisibility&&(e=c.watch(a,"suspended",
function(c){return k._suspendedHandle(c,l,a)}),b=c.watch(b,"legendEnabled",function(c){return k._legendEnabledHandle(c,l,a)}),f.push(e,b));this._handles.add(f,q);this._constructLegendElements(l,a)}this._addActiveLayerInfo(l,a)};b.prototype._titleHandle=function(a,c,b){c.title=a;this._constructLegendElements(c,b)};b.prototype._legendEnabledHandle=function(a,c,b){a?this._addActiveLayerInfo(c,b):this._removeActiveLayerInfo(c)};b.prototype._suspendedHandle=function(a,c,b){a?this._removeActiveLayerInfo(c):
this._addActiveLayerInfo(c,b)};b.prototype._scaleHandle=function(a,c){a.scale!==this.view.scale&&a.isScaleDriven&&this._constructLegendElements(a,c)};b.prototype._addActiveLayerInfo=function(a,c){this._isLayerActive(c)&&-1===this.activeLayerInfos.indexOf(a)&&((c=a.parent,c)?-1===c.children.indexOf(a)&&(c.children.push(a),this._sortActiveLayerInfos(c.children)):(this.activeLayerInfos.add(a),this._sortActiveLayerInfos(this.activeLayerInfos)))};b.prototype._removeActiveLayerInfo=function(a){var c=a.parent;
c?c.children.remove(a):this.activeLayerInfos.remove(a)};b.prototype._constructLegendElements=function(a,c){var k=c.layer;a.scale=this.view.scale;k.featureCollections?a.buildLegendElementsForFeatureCollections(k.featureCollections):k.renderer?a.buildLegendElementsForRenderer(k.renderer):k.url&&a.buildLegendElementsForTools();if(k.featureReduction&&"cluster"===k.featureReduction.type){c=c._effectiveRenderer;var q=(k=k.renderer.clone())&&"visualVariables"in k&&k.visualVariables||[];if(!(c&&"visualVariables"in
c&&c.visualVariables))return null;c=f.findSizeVV(c.visualVariables);f.getActiveSizeStops(this.view,c)&&(k.visualVariables=q.concat([c]),a.buildLegendElementsForRenderer(k))}};h([l.property({type:x})],b.prototype,"activeLayerInfos",void 0);h([l.property()],b.prototype,"basemapLegendVisible",void 0);h([l.property()],b.prototype,"groundLegendVisible",void 0);h([l.property()],b.prototype,"respectLayerVisibility",void 0);h([l.property()],b.prototype,"layerInfos",void 0);h([l.property({dependsOn:["view.ready"],
readOnly:!0})],b.prototype,"state",null);h([l.property()],b.prototype,"view",void 0);return b=h([l.subclass("esri.widgets.Legend.LegendViewModel")],b)}(l.declared(b))})},"esri/views/2d/layers/support/clusterUtils":function(){define("require exports ../../../../core/tsSupport/generatorHelper ../../../../core/tsSupport/awaiterHelper ../../../../core/tsSupport/assignHelper ../../../../core/Error ../../../../core/Logger ../../../../core/maybe ../../../../core/MD5 ../../../../renderers/visualVariables/SizeVariable ../../../../renderers/visualVariables/support/SizeStop ../../engine".split(" "),
function(g,a,d,h,b,e,m,c,l,f,t,x){function n(a,c,b){switch(a){case "avg":case "avg_angle":return"cluster_avg_"+c;case "mode":return"cluster_type_"+c;case "norm":return a=c.toLowerCase()+",norm:field,"+b.toLowerCase(),"cluster_avg_"+l.createMD5Hash(a)}}function p(a,c,b,q){var k=n(b,c,q);a.some(function(a){return a.name===k})||("norm"===b?a.push({name:k,outStatistic:{onStatisticField:c,onStatisticNormalizationField:q,statisticType:b}}):a.push({name:k,outStatistic:{onStatisticField:c,statisticType:b}}));
return k}var y=this;Object.defineProperty(a,"__esModule",{value:!0});var u=m.getLogger("esri.views.2d.layers.support.clusterUtils");a.createClusterRenderer=function(k,b,f,q,l){return h(y,void 0,void 0,function(){var b,r,e;return d(this,function(u){b=f.clone();if(!a.isClusterCompatibleRenderer(b))return[2,b];r="visualVariables"in b&&b.visualVariables||[];e=a.findSizeVV(r);r.forEach(function(a){"rotation"===a.type?a.field=p(k,a.field,"avg_angle"):a.normalizationField?(a.field=p(k,a.field,"norm",a.normalizationField),
a.normalizationField=null):a.field&&(a.field=p(k,a.field,"avg"))});c.isNone(e)&&r.push(a.createClusterCountSizeVariable(q,l));switch(b.type){case "unique-value":b.field&&(b.field=p(k,b.field,"mode"));break;case "class-breaks":b.normalizationField?(b.field=p(k,b.field,"norm",b.normalizationField),b.normalizationField=null):b.field=p(k,b.field,"avg")}b.visualVariables=r;return[2,b]})})};a.findSizeVV=function(a){for(var c=0;c<a.length;c++){var k=a[c];if("size"===k.type)return k}return null};a.getActiveSizeStops=
function(a,c){a=a.featuresTilingScheme.getClosestInfoForScale(a.scale).level;return c.levels?c.levels[a]:null};a.createClusterCountSizeVariable=function(a,l){var k=[new t({value:0,size:0}),new t({value:1})];if(c.isNone(l))return new f({field:"cluster_count",stops:k.concat([new t({value:2,size:0})])});a=Object.keys(l).reduce(function(a,c){var q;return b({},a,(q={},q[c]=k.concat([new t({value:Math.max(2,l[c].minValue),size:"12px"}),new t({value:Math.max(3,l[c].maxValue),size:"50px"})]),q))},{});return new x.LevelDependentSizeVariable({field:"cluster_count",
levels:a})};a.isClusterCompatibleRenderer=function(a){var c=function(c){return u.error(new e("Unsupported-renderer",c,{renderer:a}))};if("valueExpression"in a&&a.valueExpression)return c("FeatureReductionCluster does not currently support renderer.valueExpression. Support will be added in a future release"),!1;if("unique-value"===a.type){if(a.field2||a.field3)return c("FeatureReductionCluster does not support multi-field UniqueValueRenderers"),!1}else if("class-breaks"===a.type){if(a.normalizationField){var k=
a.normalizationType;if("field"!==k)return c("FeatureReductionCluster does not support a normalizationType of "+k),!1}}else if("simple"!==a.type)return c("FeatureReductionCluster does not support renderers of type "+a.type),!1;return("visualVariables"in a&&a.visualVariables||[]).some(function(a){return!!("valueExpression"in a&&a.valueExpression)})?(c("FeatureReductionCluster does not currently support visualVariables with a valueExpression. Support will be added in a future release"),!1):!0}})},"esri/core/MD5":function(){define(["require",
"exports"],function(g,a){function d(a,b){var c=(a&65535)+(b&65535);return(a>>16)+(b>>16)+(c>>16)<<16|c&65535}function h(a,b,f,e,m,n){a=d(d(b,a),d(e,n));return d(a<<m|a>>>32-m,f)}function b(a,b,f,e,m,n,p){return h(b&f|~b&e,a,b,m,n,p)}function e(a,b,f,e,m,n,p){return h(b&e|f&~e,a,b,m,n,p)}function m(a,b,f,e,m,n,p){return h(f^(b|~e),a,b,m,n,p)}Object.defineProperty(a,"__esModule",{value:!0});a.outputTypes={Base64:0,Hex:1,String:2,Raw:3};a.createMD5Hash=function(c,l){void 0===l&&(l=a.outputTypes.Hex);
l=l||a.outputTypes.Base64;for(var f=[],t=0,x=8*c.length;t<x;t+=8)f[t>>5]|=(c.charCodeAt(t/8)&255)<<t%32;c=8*c.length;f[c>>5]|=128<<c%32;f[(c+64>>>9<<4)+14]=c;c=1732584193;for(var t=-271733879,x=-1732584194,n=271733878,p=0;p<f.length;p+=16){var y=c,u=t,k=x,r=n;c=b(c,t,x,n,f[p+0],7,-680876936);n=b(n,c,t,x,f[p+1],12,-389564586);x=b(x,n,c,t,f[p+2],17,606105819);t=b(t,x,n,c,f[p+3],22,-1044525330);c=b(c,t,x,n,f[p+4],7,-176418897);n=b(n,c,t,x,f[p+5],12,1200080426);x=b(x,n,c,t,f[p+6],17,-1473231341);t=b(t,
x,n,c,f[p+7],22,-45705983);c=b(c,t,x,n,f[p+8],7,1770035416);n=b(n,c,t,x,f[p+9],12,-1958414417);x=b(x,n,c,t,f[p+10],17,-42063);t=b(t,x,n,c,f[p+11],22,-1990404162);c=b(c,t,x,n,f[p+12],7,1804603682);n=b(n,c,t,x,f[p+13],12,-40341101);x=b(x,n,c,t,f[p+14],17,-1502002290);t=b(t,x,n,c,f[p+15],22,1236535329);c=e(c,t,x,n,f[p+1],5,-165796510);n=e(n,c,t,x,f[p+6],9,-1069501632);x=e(x,n,c,t,f[p+11],14,643717713);t=e(t,x,n,c,f[p+0],20,-373897302);c=e(c,t,x,n,f[p+5],5,-701558691);n=e(n,c,t,x,f[p+10],9,38016083);
x=e(x,n,c,t,f[p+15],14,-660478335);t=e(t,x,n,c,f[p+4],20,-405537848);c=e(c,t,x,n,f[p+9],5,568446438);n=e(n,c,t,x,f[p+14],9,-1019803690);x=e(x,n,c,t,f[p+3],14,-187363961);t=e(t,x,n,c,f[p+8],20,1163531501);c=e(c,t,x,n,f[p+13],5,-1444681467);n=e(n,c,t,x,f[p+2],9,-51403784);x=e(x,n,c,t,f[p+7],14,1735328473);t=e(t,x,n,c,f[p+12],20,-1926607734);c=h(t^x^n,c,t,f[p+5],4,-378558);n=h(c^t^x,n,c,f[p+8],11,-2022574463);x=h(n^c^t,x,n,f[p+11],16,1839030562);t=h(x^n^c,t,x,f[p+14],23,-35309556);c=h(t^x^n,c,t,f[p+
1],4,-1530992060);n=h(c^t^x,n,c,f[p+4],11,1272893353);x=h(n^c^t,x,n,f[p+7],16,-155497632);t=h(x^n^c,t,x,f[p+10],23,-1094730640);c=h(t^x^n,c,t,f[p+13],4,681279174);n=h(c^t^x,n,c,f[p+0],11,-358537222);x=h(n^c^t,x,n,f[p+3],16,-722521979);t=h(x^n^c,t,x,f[p+6],23,76029189);c=h(t^x^n,c,t,f[p+9],4,-640364487);n=h(c^t^x,n,c,f[p+12],11,-421815835);x=h(n^c^t,x,n,f[p+15],16,530742520);t=h(x^n^c,t,x,f[p+2],23,-995338651);c=m(c,t,x,n,f[p+0],6,-198630844);n=m(n,c,t,x,f[p+7],10,1126891415);x=m(x,n,c,t,f[p+14],15,
-1416354905);t=m(t,x,n,c,f[p+5],21,-57434055);c=m(c,t,x,n,f[p+12],6,1700485571);n=m(n,c,t,x,f[p+3],10,-1894986606);x=m(x,n,c,t,f[p+10],15,-1051523);t=m(t,x,n,c,f[p+1],21,-2054922799);c=m(c,t,x,n,f[p+8],6,1873313359);n=m(n,c,t,x,f[p+15],10,-30611744);x=m(x,n,c,t,f[p+6],15,-1560198380);t=m(t,x,n,c,f[p+13],21,1309151649);c=m(c,t,x,n,f[p+4],6,-145523070);n=m(n,c,t,x,f[p+11],10,-1120210379);x=m(x,n,c,t,f[p+2],15,718787259);t=m(t,x,n,c,f[p+9],21,-343485551);c=d(c,y);t=d(t,u);x=d(x,k);n=d(n,r)}f=[c,t,x,
n];switch(l){case a.outputTypes.Raw:return f;case a.outputTypes.Hex:l=[];c=0;for(t=4*f.length;c<t;c++)l.push("0123456789abcdef".charAt(f[c>>2]>>c%4*8+4&15)+"0123456789abcdef".charAt(f[c>>2]>>c%4*8&15));return l.join("");case a.outputTypes.String:l=[];c=0;for(t=32*f.length;c<t;c+=8)l.push(String.fromCharCode(f[c>>5]>>>c%32&255));return l.join("");case a.outputTypes.Base64:l=[];c=0;for(t=4*f.length;c<t;c+=3)for(x=(f[c>>2]>>c%4*8&255)<<16|(f[c+1>>2]>>(c+1)%4*8&255)<<8|f[c+2>>2]>>(c+2)%4*8&255,n=0;4>
n;n++)8*c+6*n>32*f.length?l.push("\x3d"):l.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(x>>6*(3-n)&63));return l.join("")}}})},"esri/views/2d/engine":function(){define("require exports ./engine/Bitmap ./engine/BitmapContainer ./engine/BitmapTile ./engine/Container ./engine/webgl/TileContainer ./engine/DisplayObject ./engine/RasterTile ./engine/RasterTileContainer ./engine/Stage ./engine/webgl/AttributeStoreView ./engine/webgl/collisions/CollisionGrid ./engine/webgl/collisions/CollisionEngine ./engine/webgl/collisions/LayerViewSorter ./engine/webgl/Geometry ./engine/webgl/alignmentUtils ./engine/webgl/color ./engine/webgl/definitions ./engine/webgl/enums ./engine/webgl/fontUtils ./engine/webgl/Utils ./engine/webgl/brushes/BrushBitmap ./engine/webgl/brushes/BrushClip ./engine/webgl/brushes/BrushRasterBitmap ./engine/webgl/brushes/WGLBrushInfo ./engine/webgl/brushes/WGLBrushStencil ./engine/webgl/brushes/WGLBrushVTLBackground ./engine/webgl/brushes/WGLBrushVTLCircle ./engine/webgl/brushes/WGLBrushVTLFill ./engine/webgl/brushes/WGLBrushVTLLine ./engine/webgl/brushes/WGLBrushVTLSymbol ./engine/webgl/brushes/WGLGeometryBrush ./engine/webgl/brushes/WGLGeometryBrushFill ./engine/webgl/brushes/WGLGeometryBrushLabel ./engine/webgl/brushes/WGLGeometryBrushLine ./engine/webgl/brushes/WGLGeometryBrushMarker ./engine/webgl/brushes/WGLGeometryBrushText ./engine/webgl/util/debug ./engine/webgl/TileClipper ./engine/webgl/TurboLine ./engine/webgl/mesh/factories/matcherUtils ./engine/webgl/mesh/factories/WGLMeshFactory ./engine/webgl/mesh/MeshData ./engine/webgl/mesh/templates/WGLTemplateStore ./engine/webgl/Painter ./engine/webgl/TextShaping ./engine/webgl/TextShapingNew ./engine/webgl/TileData ./engine/webgl/util/BidiText ./engine/webgl/util/Matcher ./engine/webgl/util/vvFlagUtils ./engine/webgl/visualVariablesUtils ./engine/webgl/WGLRendererInfo ./engine/webgl/WGLTile ./engine/webgl/BitBlitRenderer ./engine/webgl/shaders/MagnifierPrograms ../../symbols/cim/CIMSymbolHelper ./engine/webgl/Rect ./engine/webgl/mesh/templates/util ./engine/webgl/painter/RenderPass ./engine/webgl/TiledDisplayObject ./engine/BitmapTileContainer ./engine/LevelDependentSizeVariable".split(" "),
function(g,a,d,h,b,e,m,c,l,f,t,x,n,p,y,u,k,r,z,q,E,A,B,C,D,I,L,H,G,M,O,K,Q,P,N,J,R,Y,W,X,Z,aa,V,ca,da,ba,S,ea,fa,ma,ja,na,ha,pa,ka,T,ga,v,la,oa,w,ia,U,F){Object.defineProperty(a,"__esModule",{value:!0});a.Bitmap=d.Bitmap;a.BitmapContainer=h.BitmapContainer;a.BitmapTile=b.BitmapTile;a.Container=e.Container;a.TileContainer=m.default;a.DisplayObject=c.DisplayObject;a.RasterTile=l.RasterTile;a.RasterTileContainer=f.RasterTileContainer;a.Stage=t.Stage;a.AttributeStoreView=x.AttributeStoreView;a.CollisionGrid=
n.CollisionGrid;a.CollisionEngine=p.CollisionEngine;a.LayerViewSorter=y.LayerViewSorter;a.Point=u.Point;a.alignmentUtils=k;a.color=r;a.definitions=z;a.enums=q;a.fontUtils=E;a.Utils=A;a.debug=W;a.TileClipper=X.TileClipper;a.SimpleBuilder=X.SimpleBuilder;a.tessellate=Z.tessellate;a.TessellationState=Z.TessellationState;a.splitVertex=Z.splitVertex;a.createMatcher=aa.createMatcher;a.WGLMeshFactory=V.WGLMeshFactory;a.MeshData=ca.MeshData;a.WGLTemplateStore=da.WGLTemplateStore;a.Painter=ba.default;a.PainterOptions=
ba.PainterOptions;a.TextShaping=S.TextShaping;a.TextShapingNew=ea.TextShaping;a.TileData=fa.TileData;a.bidiText=ma.bidiText;a.FeatureMatcher=ja.FeatureMatcher;a.getVVFlags=na.getVVFlags;a.getTypeOfSizeVisualVariable=ha.getTypeOfSizeVisualVariable;a.WGLRendererInfo=pa.WGLRendererInfo;a.WGLTile=ka.WGLTile;a.BitBlitRenderer=T.BitBlitRenderer;a.createMagnifierProgram=ga.createMagnifierProgram;a.magnifier=ga.magnifier;a.CIMSymbolHelper=v.CIMSymbolHelper;a.Rect=la.default;a.getLimitCosine=oa.getLimitCosine;
g=a.brushes||(a.brushes={});g.Geometry=Q.default;g.Marker=R.default;g.Line=J.default;g.Fill=P.default;g.Text=Y.default;g.Label=N.default;g.Clip=C.default;g.Stencil=L.default;g.Bitmap=B.default;g.Raster=D.default;g.TileInfo=I.default;g.VTLBackground=H.WGLBrushVTLBackground;g.VTLFill=M.WGLBrushVTLFill;g.VTLLine=O.WGLBrushVTLLine;g.VTLCircle=G.WGLBrushVTLCircle;g.VTLSymbol=K.WGLBrushVTLSymbol;a.RenderPass=w.default;a.TiledDisplayObject=ia.TiledDisplayObject;a.BitmapTileContainer=U.BitmapTileContainer;
a.LevelDependentSizeVariable=F.LevelDependentSizeVariable})},"esri/views/2d/engine/Bitmap":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/libs/gl-matrix-2/mat3 ../../../core/libs/gl-matrix-2/mat3f32 ../../../core/libs/gl-matrix-2/vec2f32 ../../webgl ./DisplayObject ./ImageryBitmapSource".split(" "),function(g,a,d,h,b,e,m,c,l){function f(a){var c=document.createElement("canvas");c.width=a.width;c.height=a.height;a.render(c.getContext("2d"));return c}function t(a,
c,k){var b={target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071};c&&k&&(b.width=c,b.height=k);return new m.Texture(a,b)}function x(a){p.has(a)&&(n.splice(n.indexOf(a),1),p.delete(a))}Object.defineProperty(a,"__esModule",{value:!0});var n=[],p=new Set;g=function(a){function c(c,f){void 0===c&&(c=null);void 0===f&&(f=function(){return null});var k=a.call(this)||this;k.stencilRef=0;k.coordScale=[1,1];k._height=void 0;k.pixelRatio=1;k.resolution=0;k.rotation=0;k._source=null;
k._width=void 0;k.x=0;k.y=0;k.transforms={dvs:b.mat3f32.create()};k.source=c;k.requestRender=f;return k}d(c,a);Object.defineProperty(c.prototype,"isSourceScaled",{get:function(){return this.width!==this.sourceWidth||this.height!==this.sourceHeight},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"height",{get:function(){return void 0!==this._height?this._height:this.sourceHeight},set:function(a){this._height=a},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"source",
{get:function(){return this._source},set:function(a){this._source=a;this.invalidateTexture()},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"sourceHeight",{get:function(){return this._source instanceof HTMLImageElement?this._source.naturalHeight:this._source.height},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"sourceWidth",{get:function(){return this._source instanceof HTMLImageElement?this._source.naturalWidth:this._source.width},enumerable:!0,configurable:!0});
Object.defineProperty(c.prototype,"width",{get:function(){return void 0!==this._width?this._width:this.sourceWidth},set:function(a){this._width=a},enumerable:!0,configurable:!0});c.prototype.attach=function(){this.updateTexture();return!0};c.prototype.detach=function(){this._texture.dispose();this._texture=null;x(this)};c.prototype.invalidateTexture=function(){this.attached?this.updateTexture():x(this)};c.prototype.setTransform=function(a){var c=h.mat3.identity(this.transforms.dvs),k=a.toScreenNoRotation([0,
0],this.x,this.y),b=this.resolution/this.pixelRatio/a.resolution,f=b*this.width,b=b*this.height,l=Math.PI*this.rotation/180;h.mat3.translate(c,c,e.vec2f32.fromValues(k[0],k[1]));h.mat3.translate(c,c,e.vec2f32.fromValues(f/2,b/2));h.mat3.rotate(c,c,-l);h.mat3.translate(c,c,e.vec2f32.fromValues(-f/2,-b/2));h.mat3.scaleByVec2(c,c,e.vec2f32.fromValues(f,b));h.mat3.multiply(this.transforms.dvs,a.displayViewMat3,c)};c.prototype.updateTexture=function(){this._texture||(this._texture=this.source?t(this.stage.context,
this.sourceWidth,this.sourceHeight):t(this.stage.context));var a=this.source;a?(this._texture.resize(this.sourceWidth,this.sourceHeight),a&&"render"in a?a instanceof l.default?(a=a.getRenderedRasterPixels(),this._texture.setData(a.renderedRasterPixels)):this._texture.setData(f(a)):!a||"render"in a||this._texture.setData(a),this.ready(),this.requestRender()):this._texture.setData(null)};c.prototype.setSamplingProfile=function(a){this._texture&&(a.mips&&!this._texture.descriptor.hasMipmap&&this._texture.generateMipmap(),
this._texture.setSamplingMode(a.samplingMode))};c.prototype.bind=function(a){this._texture&&this.stage.context.bindTexture(this._texture,a)};return c}(c.DisplayObject);a.Bitmap=g})},"esri/views/2d/engine/DisplayObject":function(){define(["require","exports","../../../core/tsSupport/extendsHelper","../../../core/Evented"],function(g,a,d,h){Object.defineProperty(a,"__esModule",{value:!0});g=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;b._renderRequestedCalled=!1;b._attached=
!1;b._isReady=!1;b._opacity=1;b.renderRequested=!1;b._visible=!0;return b}d(b,a);Object.defineProperty(b.prototype,"attached",{get:function(){return this._attached},set:function(a){this._attached!==a&&((this._attached=a)?this.hasEventListener("attach")&&this.emit("attach"):this.hasEventListener("detach")&&this.emit("detach"))},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"isReady",{get:function(){return this._attached&&this._isReady},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,
"opacity",{get:function(){return this._opacity},set:function(a){this._opacity!==a&&(this._opacity=a,this.requestRender())},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"visible",{get:function(){return this._visible},set:function(a){this._visible!==a&&(this._visible=a,this.requestRender())},enumerable:!0,configurable:!0});b.prototype.attach=function(){this.ready();return!0};b.prototype.setTransform=function(a){};b.prototype.detach=function(){};b.prototype.processRender=function(a){this.visible&&
this.attached&&(this._renderRequestedCalled=!1,this.doRender(a),this._renderRequestedCalled||(this.renderRequested=!1),this.hasEventListener("post-render")&&this.emit("post-render"))};b.prototype.requestRender=function(){var a=this.renderRequested;this.renderRequested=this._renderRequestedCalled=!0;this.parent&&this.parent.requestRender();a!==this.renderRequested&&this.hasEventListener("will-render")&&this.emit("will-render")};b.prototype.dispose=function(){};b.prototype.doRender=function(a){};b.prototype.ready=
function(){this._isReady=!0;this.emit("isReady")};return b}(h);a.DisplayObject=g})},"esri/views/2d/engine/ImageryBitmapSource":function(){define(["require","exports"],function(g,a){Object.defineProperty(a,"__esModule",{value:!0});g=function(){function a(a,b,e){this.pixelBlock=a;this.extent=b;this.originalPixelBlock=e}Object.defineProperty(a.prototype,"width",{get:function(){return this.pixelBlock?this.pixelBlock.width:0},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"height",{get:function(){return this.pixelBlock?
this.pixelBlock.height:0},enumerable:!0,configurable:!0});a.prototype.render=function(a){var b=this.pixelBlock;if(b){var e=this.filter({pixelBlock:b}),b=e.pixelBlock.getAsRGBA(),e=a.createImageData(e.pixelBlock.width,e.pixelBlock.height);e.data.set(b);a.putImageData(e,0,0)}};a.prototype.getRenderedRasterPixels=function(){var a=this.filter({pixelBlock:this.pixelBlock});return{width:a.pixelBlock.width,height:a.pixelBlock.height,renderedRasterPixels:new Uint8Array(a.pixelBlock.getAsRGBA().buffer)}};
return a}();a.default=g})},"esri/views/2d/engine/BitmapContainer":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/decorateHelper ../engine ./webgl/WGLContainer".split(" "),function(g,a,d,h,b,e){Object.defineProperty(a,"__esModule",{value:!0});g=function(a){function c(){return null!==a&&a.apply(this,arguments)||this}d(c,a);c.prototype.prepareRenderPasses=function(c){var f=this,l=c.registerRenderPass({name:"bitmap",brushes:[b.brushes.Bitmap],target:function(){return f.children}});
return a.prototype.prepareRenderPasses.call(this,c).concat([l])};return c}(e.default);a.BitmapContainer=g})},"esri/views/2d/engine/webgl/WGLContainer":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/tsSupport/assignHelper ../../../../core/maybe ../../engine ../Container ./ClippingInfo ./enums".split(" "),function(g,a,d,h,b,e,m,c,l){Object.defineProperty(a,"__esModule",{value:!0});g=function(a){function f(c){var b=a.call(this)||this;b.name=b.constructor.name;
b._lastTime=null;b.setClips(c);return b}d(f,a);f.prototype.setClips=function(a){var f=this;b.isSome(this._clippingInfos)&&(this._clippingInfos.forEach(function(a){return a.destroy()}),this._clippingInfos=null);b.isSome(a)&&a.length&&(this._clippingInfos=a.items.map(function(a){return c.default.fromClipArea(f,a)}));this.requestRender()};f.prototype.doRender=function(a){this.attachChildren();this.detachChildren();var c=this.createRenderParams(a),b=c.context,f=c.painter,e=c.globalOpacity,k=c.profiler,
e=c.drawPhase===l.WGLDrawPhase.LABEL?1:e*this.opacity;k.recordContainerStart(this.name);f.beforeRenderLayer(b,this._clippingInfos?255:0,e);this.updateTransforms(a.state);this.renderChildren(c);f.compositeLayer(b,e);k.recordContainerEnd()};f.prototype.renderChildren=function(a){b.isNone(this._renderPasses)&&(this._renderPasses=this.prepareRenderPasses(this.stage.painter));for(var c=0,f=this._renderPasses;c<f.length;c++)f[c].render(a)};f.prototype.createRenderParams=function(a){var c=Date.now(),f=(b.isSome(this._lastTime)?
c-this._lastTime:0)/1E3;this._lastTime=c;return h({},a,{context:this.stage.context,painter:this.stage.painter,profiler:this.stage.profiler,renderingOptions:this.stage.renderingOptions,driverTestResult:this.stage.driverTestResult,timeDelta:f,timeline:this.stage.timeline})};f.prototype.prepareRenderPasses=function(a){var c=this;return[a.registerRenderPass({name:"clip",brushes:[e.brushes.Clip],target:function(){return c._clippingInfos},drawPhase:l.WGLDrawPhase.MAP|l.WGLDrawPhase.LABEL|l.WGLDrawPhase.LABEL_ALPHA|
l.WGLDrawPhase.DEBUG})]};f.prototype.updateTransforms=function(a){for(var c=0,b=this.children;c<b.length;c++)b[c].setTransform(a)};return f}(m.Container);a.default=g})},"esri/views/2d/engine/Container":function(){define(["require","exports","../../../core/tsSupport/extendsHelper","./DisplayObject"],function(g,a,d,h){Object.defineProperty(a,"__esModule",{value:!0});g=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;b._childrenSet=new Set;b._childrenToAttach=[];b._childrenToDetach=
[];b.children=[];return b}d(b,a);Object.defineProperty(b.prototype,"numChildren",{get:function(){return this.children.length},enumerable:!0,configurable:!0});b.prototype.detach=function(){for(var a=0,c=this.children.concat(this._childrenToDetach);a<c.length;a++){var b=c[a];b.attached&&(this.detachChild(b),b.attached=!1,b.parent=null)}};b.prototype.doRender=function(a){var c=a.globalOpacity;a.globalOpacity*=this.opacity;this.attachChildren();this.detachChildren();this.renderChildren(a);a.globalOpacity=
c};b.prototype.addChild=function(a){return this.addChildAt(a,this.children.length)};b.prototype.addChildAt=function(a,c){void 0===c&&(c=this.numChildren);if(!a||this.contains(a))return a;var b=a.parent;b&&b!==this&&b.removeChild(a);c>=this.numChildren?this.children.push(a):this.children.splice(c,0,a);this._childrenSet.add(a);c=this._childrenToDetach.indexOf(a);-1<c&&this._childrenToDetach.splice(c,1);this._childrenToAttach.push(a);this.requestRender();return a};b.prototype.contains=function(a){return this._childrenSet.has(a)};
b.prototype.getChildIndex=function(a){return this.children.indexOf(a)};b.prototype.getChildAt=function(a){return 0>a||a>this.children.length?null:this.children[a]};b.prototype.removeAllChildren=function(){for(var a=this.numChildren;a--;)this.removeChildAt(0)};b.prototype.removeChild=function(a){return this.contains(a)?this.removeChildAt(this.getChildIndex(a)):a};b.prototype.removeChildAt=function(a){if(0>a||a>=this.children.length)return null;a=this.children.splice(a,1)[0];this._childrenSet["delete"](a);
if(a.attached)this._childrenToDetach.push(a);else{var c=this._childrenToAttach.indexOf(a);-1<c&&this._childrenToAttach.splice(c,1)}return a};b.prototype.setChildIndex=function(a,c){var b=this.getChildIndex(a);-1<b&&(this.children.splice(b,1),this.children.splice(c,0,a))};b.prototype.sortChildren=function(a){return this.children.sort(a)};b.prototype.attachChildren=function(){var a=this._childrenToAttach;if(0!==a.length)for(var c=0,b=!1;!b;)b=a[c],b.parent=this,b.stage=this.stage,this.attachChild(b)?
(b.attached=!0,a.splice(c,1)):++c,b=a.length===c};b.prototype.detachChildren=function(){for(var a=this._childrenToDetach;0<a.length;){var c=a.shift();this.detachChild(c);c.attached=!1;c.parent=null;c.stage=null}};b.prototype.renderChildren=function(a){for(var c=this.children,b=c.length,f=0;f<b;f++)c[f].processRender(a)};b.prototype.attachChild=function(a){return a.attach()};b.prototype.detachChild=function(a){a.detach()};return b}(h.DisplayObject);a.Container=g})},"esri/views/2d/engine/webgl/ClippingInfo":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/Error ../../../../core/Logger ../../../../core/maybe ../DisplayObject ./Mesh2D ../../../webgl/VertexArrayObject".split(" "),
function(g,a,d,h,b,e,m,c,l){Object.defineProperty(a,"__esModule",{value:!0});var f=b.getLogger("esri.views.2d.engine.webgl.ClippingInfo");g=function(a){function b(c,b){var f=a.call(this)||this;f._cache={};f.parent=c;f._handle=b.watch("version",function(){return f._invalidate()});f._clip=b;f.attach();f.attached=!0;return f}d(b,a);b.fromClipArea=function(a,c){return new b(a,c)};b.prototype._destroyGL=function(){e.isSome(this._cache.mesh)&&(this._cache.mesh.destroy(),this._cache.mesh=null);e.isSome(this._cache.vao)&&
(this._cache.vao.dispose(),this._cache.vao=null)};b.prototype.destroy=function(){this._destroyGL();this._handle.remove()};b.prototype.doRender=function(){};b.prototype.getVAO=function(a,c,b,f){var k=c.size,r=k[0],k=k[1];if("geometry"===this._clip.type||this._lastWidth!==r||this._lastHeight!==k)this._lastWidth=r,this._lastHeight=k,this._destroyGL();e.isNone(this._cache.vao)&&(c=this._createMesh(c,this._clip),r=c.getIndexBuffer(a),k=c.getVertexBuffers(a),this._cache.mesh=c,this._cache.vao=new l(a,b,
f,k,r));return this._cache.vao};b.prototype._invalidate=function(){this._destroyGL();this.requestRender()};b.prototype._createScreenRect=function(a,c){var b=a.size;a=b[0];var b=b[1],f="string"===typeof c.left?parseFloat(c.left)/100*a:c.left,k="string"===typeof c.right?parseFloat(c.right)/100*a:c.right,l="string"===typeof c.top?parseFloat(c.top)/100*b:c.top;c="string"===typeof c.bottom?parseFloat(c.bottom)/100*b:c.bottom;return{x:f,y:l,width:Math.max(a-k-f,0),height:Math.max(b-c-l,0)}};b.prototype._createMesh=
function(a,b){switch(b.type){case "rect":return c.default.fromRect(this._createScreenRect(a,b));case "path":return c.default.fromPath(b);case "geometry":return c.default.fromGeometry(a,b);default:return f.error(new h("mapview-bad-type","Unable to create ClippingInfo mesh from clip of type: ${clip.type}")),c.default.fromRect({x:0,y:0,width:1,height:1})}};return b}(m.DisplayObject);a.default=g})},"esri/views/2d/engine/webgl/Mesh2D":function(){define("require exports ../../../../core/tsSupport/assignHelper ../../../../core/Error ../../../../core/Logger ../../../../core/maybe ../../../../core/libs/earcut/earcut ../../../../core/libs/gl-matrix-2/vec2 ../../../../core/libs/gl-matrix-2/vec2f64 ../../../../layers/graphics/featureConversionUtils ../../../../layers/graphics/OptimizedGeometry ./number ../../../webgl/BufferObject".split(" "),
function(g,a,d,h,b,e,m,c,l,f,t,x,n){Object.defineProperty(a,"__esModule",{value:!0});var p=b.getLogger("esri.views.2d.engine.webgl.Mesh2D"),y=function(a,c){var b=a.coords;a=a.lengths;for(var k=[],q=0,f=0;q<a.length;f+=a[q],q+=1){for(var l=f,e=[];q<a.length-1;q+=1,f+=a[q]){for(var u=f+a[q],n=0,t=1;t<a[q+1];t++)n+=(b[2*(u+t)]-b[2*(u+t-1)])*(b[2*(u+t)+1]+b[2*(u+t-1)+1]);if(!(c?0<n:0>n))break;e.push(f+a[q]-l)}n=b.slice(2*l,2*(f+a[q]));u=0;for(e=m(n,e,2);u<e.length;u++)k.push(e[u]+l)}return k};g=function(){function a(a,
c,b,q){void 0===q&&(q=!1);this._cache={};this.vertices=a;this.indices=c;this.primitiveType=b;this.isMapSpace=q}a.fromRect=function(c){var b=c.x,k=c.y;return a.fromScreenExtent({xmin:b,ymin:k,xmax:b+c.width,ymax:k+c.height})};a.fromPath=function(c){var b=f.convertFromNestedArray(new t.default,c.path,!1,!1);c=b.coords;for(var b=new Uint32Array(y(b,!0)),k=new Uint32Array(c.length/2),q=0;q<k.length;q++)k[q]=x.i1616to32(Math.floor(c[2*q]),Math.floor(c[2*q+1]));return new a({geometry:k},b,4)};a.fromGeometry=
function(c,b){var k=b.geometry.type;switch(k){case "polygon":return a.fromPolygon(c,b.geometry);case "extent":return a.fromMapExtent(c,b.geometry);default:return p.error(new h("mapview-bad-type","Unable to create a mesh from type "+k,b)),a.fromRect({x:0,y:0,width:1,height:1})}};a.fromPolygon=function(b,e){var k=f.convertFromPolygon(new t.default,e,!1,!1);e=k.coords;for(var k=new Uint32Array(y(k,!1)),q=new Uint32Array(e.length/2),r=l.vec2f64.create(),u=l.vec2f64.create(),n=0;n<q.length;n++)c.vec2.set(r,
e[2*n],e[2*n+1]),b.toScreen(u,r),q[n]=x.i1616to32(Math.floor(u[0]),Math.floor(u[1]));return new a({geometry:q},k,4,!0)};a.fromScreenExtent=function(c){var b=c.xmin,k=c.xmax,q=c.ymin;c=c.ymax;b={geometry:new Uint32Array([x.i1616to32(b,q),x.i1616to32(k,q),x.i1616to32(b,c),x.i1616to32(b,c),x.i1616to32(k,q),x.i1616to32(k,c)])};k=new Uint32Array([0,1,2,3,4,5]);return new a(b,k,4)};a.fromMapExtent=function(c,b){var k=c.toScreen([0,0],[b.xmin,b.ymin]),q=k[0],k=k[1];b=c.toScreen([0,0],[b.xmax,b.ymax]);c=
b[0];b=b[1];q={geometry:new Uint32Array([x.i1616to32(q,k),x.i1616to32(c,k),x.i1616to32(q,b),x.i1616to32(q,b),x.i1616to32(c,k),x.i1616to32(c,b)])};k=new Uint32Array([0,1,2,3,4,5]);return new a(q,k,4)};a.prototype.destroy=function(){e.isSome(this._cache.indexBuffer)&&this._cache.indexBuffer.dispose();for(var a in this._cache.vertexBuffers)e.isSome(this._cache.vertexBuffers[a])&&this._cache.vertexBuffers[a].dispose()};Object.defineProperty(a.prototype,"elementType",{get:function(){var a;a:switch(this.indices.BYTES_PER_ELEMENT){case 1:a=
5121;break a;case 2:a=5123;break a;case 4:a=5125;break a;default:throw new h("Cannot get DataType of array");}return a},enumerable:!0,configurable:!0});a.prototype.getIndexBuffer=function(a,c){void 0===c&&(c=35044);this._cache.indexBuffer||(this._cache.indexBuffer=n.createIndex(a,c,this.indices));return this._cache.indexBuffer};a.prototype.getVertexBuffers=function(a,c){var b=this;void 0===c&&(c=35044);this._cache.vertexBuffers||(this._cache.vertexBuffers=Object.keys(this.vertices).reduce(function(k,
f){var q;return d({},k,(q={},q[f]=n.createVertex(a,c,b.vertices[f]),q))},{}));return this._cache.vertexBuffers};return a}();a.default=g})},"esri/core/libs/earcut/earcut":function(){define([],function(){function g(c,b,k){k=k||2;var q=b&&b.length,f=q?b[0]*k:c.length,r=a(c,0,f,k,!0),n=[];if(!r||r.next===r.prev)return n;var u,t,p,z;if(q){var A=k,q=[],x,E,g;z=0;for(x=b.length;z<x;z++)E=b[z]*A,g=z<x-1?b[z+1]*A:c.length,E=a(c,E,g,A,!1),E===E.next&&(E.steiner=!0),q.push(l(E));q.sort(e);for(z=0;z<q.length;z++){b=
q[z];A=r;if(A=m(b,A))b=y(A,b),d(b,b.next);r=d(r,r.next)}}if(c.length>80*k){u=p=c[0];t=q=c[1];for(A=k;A<f;A+=k)z=c[A],b=c[A+1],z<u&&(u=z),b<t&&(t=b),z>p&&(p=z),b>q&&(q=b);p=Math.max(p-u,q-t);p=0!==p?1/p:0}h(r,n,k,u,t,p);return n}function a(a,c,b,f,l){var q;if(l===0<z(a,c,b,f))for(l=c;l<b;l+=f)q=u(l,a[l],a[l+1],q);else for(l=b-f;l>=c;l-=f)q=u(l,a[l],a[l+1],q);q&&x(q,q.next)&&(k(q),q=q.next);return q}function d(a,c){if(!a)return a;c||(c=a);var b;do if(b=!1,a.steiner||!x(a,a.next)&&0!==t(a.prev,a,a.next))a=
a.next;else{k(a);a=c=a.prev;if(a===a.next)break;b=!0}while(b||a!==c);return c}function h(a,l,e,r,u,m,z){if(a){if(!z&&m){var q=a,A=q;do null===A.z&&(A.z=c(A.x,A.y,r,u,m)),A.prevZ=A.prev,A=A.nextZ=A.next;while(A!==q);A.prevZ.nextZ=null;A.prevZ=null;var q=A,E,B,g,C,D,I,N=1;do{A=q;g=q=null;for(C=0;A;){C++;B=A;for(E=D=0;E<N&&(D++,B=B.nextZ,B);E++);for(I=N;0<D||0<I&&B;)0!==D&&(0===I||!B||A.z<=B.z)?(E=A,A=A.nextZ,D--):(E=B,B=B.nextZ,I--),g?g.nextZ=E:q=E,E.prevZ=g,g=E;A=B}g.nextZ=null;N*=2}while(1<C)}for(q=
a;a.prev!==a.next;){A=a.prev;B=a.next;if(m)g=b(a,r,u,m);else a:if(g=a,C=g.prev,D=g,N=g.next,0<=t(C,D,N))g=!1;else{I=E=g.next.next;for(var J=0;E!==g.prev&&(0===J||E!==I);){J++;if(f(C.x,C.y,D.x,D.y,N.x,N.y,E.x,E.y)&&0<=t(E.prev,E,E.next)){g=!1;break a}E=E.next}g=!0}if(g)l.push(A.i/e),l.push(a.i/e),l.push(B.i/e),k(a),q=a=B.next;else if(a=B,a===q){if(!z)h(d(a),l,e,r,u,m,1);else if(1===z){z=l;q=e;A=a;do B=A.prev,g=A.next.next,!x(B,g)&&n(B,A,A.next,g)&&p(B,g)&&p(g,B)&&(z.push(B.i/q),z.push(A.i/q),z.push(g.i/
q),k(A),k(A.next),A=a=g),A=A.next;while(A!==a);a=A;h(a,l,e,r,u,m,2)}else if(2===z)a:{z=a;do{for(q=z.next.next;q!==z.prev;){if(A=z.i!==q.i){A=z;B=q;g=void 0;if(g=A.next.i!==B.i&&A.prev.i!==B.i){g=void 0;b:{g=A;do{if(g.i!==A.i&&g.next.i!==A.i&&g.i!==B.i&&g.next.i!==B.i&&n(g,g.next,A,B)){g=!0;break b}g=g.next}while(g!==A);g=!1}g=!g}C=void 0;if(C=g&&p(A,B)&&p(B,A)){g=A;C=!1;D=(A.x+B.x)/2;B=(A.y+B.y)/2;do g.y>B!==g.next.y>B&&g.next.y!==g.y&&D<(g.next.x-g.x)*(B-g.y)/(g.next.y-g.y)+g.x&&(C=!C),g=g.next;
while(g!==A)}A=C}if(A){a=y(z,q);z=d(z,z.next);a=d(a,a.next);h(z,l,e,r,u,m);h(a,l,e,r,u,m);break a}q=q.next}z=z.next}while(z!==a)}break}}}}function b(a,b,k,l){var q=a.prev,e=a.next;if(0<=t(q,a,e))return!1;var r=q.x>a.x?q.x>e.x?q.x:e.x:a.x>e.x?a.x:e.x,u=q.y>a.y?q.y>e.y?q.y:e.y:a.y>e.y?a.y:e.y,n=c(q.x<a.x?q.x<e.x?q.x:e.x:a.x<e.x?a.x:e.x,q.y<a.y?q.y<e.y?q.y:e.y:a.y<e.y?a.y:e.y,b,k,l);b=c(r,u,b,k,l);k=a.prevZ;for(l=a.nextZ;k&&k.z>=n&&l&&l.z<=b;){if(k!==a.prev&&k!==a.next&&f(q.x,q.y,a.x,a.y,e.x,e.y,k.x,
k.y)&&0<=t(k.prev,k,k.next))return!1;k=k.prevZ;if(l!==a.prev&&l!==a.next&&f(q.x,q.y,a.x,a.y,e.x,e.y,l.x,l.y)&&0<=t(l.prev,l,l.next))return!1;l=l.nextZ}for(;k&&k.z>=n;){if(k!==a.prev&&k!==a.next&&f(q.x,q.y,a.x,a.y,e.x,e.y,k.x,k.y)&&0<=t(k.prev,k,k.next))return!1;k=k.prevZ}for(;l&&l.z<=b;){if(l!==a.prev&&l!==a.next&&f(q.x,q.y,a.x,a.y,e.x,e.y,l.x,l.y)&&0<=t(l.prev,l,l.next))return!1;l=l.nextZ}return!0}function e(a,c){return a.x-c.x}function m(a,c){var b=c,k=a.x,q=a.y,l=-Infinity,e;do{if(q<=b.y&&q>=b.next.y&&
b.next.y!==b.y){var r=b.x+(q-b.y)*(b.next.x-b.x)/(b.next.y-b.y);if(r<=k&&r>l){l=r;if(r===k){if(q===b.y)return b;if(q===b.next.y)return b.next}e=b.x<b.next.x?b:b.next}}b=b.next}while(b!==c);if(!e)return null;if(k===l)return e.prev;c=e;for(var r=e.x,u=e.y,n=Infinity,t,b=e.next;b!==c;)k>=b.x&&b.x>=r&&k!==b.x&&f(q<u?k:l,q,r,u,q<u?l:k,q,b.x,b.y)&&(t=Math.abs(q-b.y)/(k-b.x),(t<n||t===n&&b.x>e.x)&&p(b,a)&&(e=b,n=t)),b=b.next;return e}function c(a,c,b,k,f){a=32767*(a-b)*f;c=32767*(c-k)*f;a=(a|a<<8)&16711935;
a=(a|a<<4)&252645135;a=(a|a<<2)&858993459;c=(c|c<<8)&16711935;c=(c|c<<4)&252645135;c=(c|c<<2)&858993459;return(a|a<<1)&1431655765|((c|c<<1)&1431655765)<<1}function l(a){var c=a,b=a;do{if(c.x<b.x||c.x===b.x&&c.y<b.y)b=c;c=c.next}while(c!==a);return b}function f(a,c,b,k,f,l,e,r){return 0<=(f-e)*(c-r)-(a-e)*(l-r)&&0<=(a-e)*(k-r)-(b-e)*(c-r)&&0<=(b-e)*(l-r)-(f-e)*(k-r)}function t(a,c,b){return(c.y-a.y)*(b.x-c.x)-(c.x-a.x)*(b.y-c.y)}function x(a,c){return a.x===c.x&&a.y===c.y}function n(a,c,b,k){return x(a,
c)&&x(b,k)||x(a,k)&&x(b,c)?!0:0<t(a,c,b)!==0<t(a,c,k)&&0<t(b,k,a)!==0<t(b,k,c)}function p(a,c){return 0>t(a.prev,a,a.next)?0<=t(a,c,a.next)&&0<=t(a,a.prev,c):0>t(a,c,a.prev)||0>t(a,a.next,c)}function y(a,c){var b=new r(a.i,a.x,a.y),k=new r(c.i,c.x,c.y),f=a.next,l=c.prev;a.next=c;c.prev=a;b.next=f;f.prev=b;k.next=b;b.prev=k;l.next=k;k.prev=l;return k}function u(a,c,b,k){a=new r(a,c,b);k?(a.next=k.next,a.prev=k,k.next.prev=a,k.next=a):(a.prev=a,a.next=a);return a}function k(a){a.next.prev=a.prev;a.prev.next=
a.next;a.prevZ&&(a.prevZ.nextZ=a.nextZ);a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function r(a,c,b){this.i=a;this.x=c;this.y=b;this.nextZ=this.prevZ=this.z=this.next=this.prev=null;this.steiner=!1}function z(a,c,b,k){for(var f=0,l=b-k;c<b;c+=k)f+=(a[l]-a[c])*(a[c+1]+a[l+1]),l=c;return f}g.deviation=function(a,c,b,k){var f=c&&c.length,l=Math.abs(z(a,0,f?c[0]*b:a.length,b));if(f)for(var f=0,e=c.length;f<e;f++)l-=Math.abs(z(a,c[f]*b,f<e-1?c[f+1]*b:a.length,b));for(f=c=0;f<k.length;f+=3){var e=k[f]*b,q=k[f+1]*
b,r=k[f+2]*b;c+=Math.abs((a[e]-a[r])*(a[q+1]-a[e+1])-(a[e]-a[q])*(a[r+1]-a[e+1]))}return 0===l&&0===c?0:Math.abs((c-l)/l)};g.flatten=function(a){for(var c=a[0][0].length,b={vertices:[],holes:[],dimensions:c},k=0,f=0;f<a.length;f++){for(var l=0;l<a[f].length;l++)for(var e=0;e<c;e++)b.vertices.push(a[f][l][e]);0<f&&(k+=a[f-1].length,b.holes.push(k))}return b};return g})},"esri/views/2d/engine/webgl/number":function(){define(["require","exports"],function(g,a){function d(a,b,c){return Math.round(Math.max(Math.min(a,
c),b))}Object.defineProperty(a,"__esModule",{value:!0});var h=new Float32Array(1),b=new Uint32Array(h.buffer);a.i8=function(a){return d(a,-128,127)};a.i16=function(a){return d(a,-32768,32767)};a.i32=function(a){return d(a,-2147483648,2147483647)};a.u8=function(a){return d(a,0,255)};a.u16=function(a){return d(a,0,65535)};a.u32=function(a){return d(a,0,4294967295)};a.toUint32=function(a){h[0]=a;return b[0]};a.toFloat32=function(a){b[0]=a;return h[0]};a.u32to4Xu8=function(a){return[a&255,(a&65280)>>>
8,(a&16711680)>>>16,(a&4278190080)>>>24]};a.i1616to32=function(a,b){return 65535&a|b<<16};a.i8888to32=function(a,b,c,l){return a&255|(b&255)<<8|(c&255)<<16|l<<24};a.i8816to32=function(a,b,c){return a&255|(b&255)<<8|c<<16};a.numTo32=function(a){return a|0}})},"esri/views/2d/engine/webgl/enums":function(){define(["require","exports"],function(g,a){Object.defineProperty(a,"__esModule",{value:!0});(function(a){a[a.FILL=0]="FILL";a[a.LINE=1]="LINE";a[a.MARKER=2]="MARKER";a[a.TEXT=3]="TEXT";a[a.LABEL=4]=
"LABEL"})(a.WGLGeometryType||(a.WGLGeometryType={}));(function(a){a[a.SUCCEEDED=0]="SUCCEEDED";a[a.FAILED_OUT_OF_MEMORY=1]="FAILED_OUT_OF_MEMORY"})(a.WGLGeometryTransactionStatus||(a.WGLGeometryTransactionStatus={}));(function(a){a[a.NONE=0]="NONE";a[a.MAP=1]="MAP";a[a.LABEL=2]="LABEL";a[a.LABEL_ALPHA=4]="LABEL_ALPHA";a[a.HITTEST=8]="HITTEST";a[a.HIGHLIGHT=16]="HIGHLIGHT";a[a.CLIP=32]="CLIP";a[a.DEBUG=64]="DEBUG";a[a.NUM_DRAW_PHASES=9]="NUM_DRAW_PHASES"})(a.WGLDrawPhase||(a.WGLDrawPhase={}));(function(a){a[a.SIZE=
0]="SIZE";a[a.COLOR=1]="COLOR";a[a.OPACITY=2]="OPACITY";a[a.ROTATION=3]="ROTATION"})(a.VVType||(a.VVType={}));(function(a){a[a.NONE=0]="NONE";a[a.OPACITY=1]="OPACITY";a[a.COLOR=2]="COLOR";a[a.ROTATION=4]="ROTATION";a[a.SIZE_MINMAX_VALUE=8]="SIZE_MINMAX_VALUE";a[a.SIZE_SCALE_STOPS=16]="SIZE_SCALE_STOPS";a[a.SIZE_FIELD_STOPS=32]="SIZE_FIELD_STOPS";a[a.SIZE_UNIT_VALUE=64]="SIZE_UNIT_VALUE"})(a.WGLVVFlag||(a.WGLVVFlag={}));(function(a){a[a.MINMAX_TARGETS_OUTLINE=128]="MINMAX_TARGETS_OUTLINE";a[a.SCALE_TARGETS_OUTLINE=
256]="SCALE_TARGETS_OUTLINE";a[a.FIELD_TARGETS_OUTLINE=512]="FIELD_TARGETS_OUTLINE";a[a.UNIT_TARGETS_OUTLINE=1024]="UNIT_TARGETS_OUTLINE"})(a.WGLVVTarget||(a.WGLVVTarget={}));(function(a){a[a.SPRITE=0]="SPRITE";a[a.GLYPH=1]="GLYPH"})(a.MosaicType||(a.MosaicType={}))})},"esri/views/2d/engine/BitmapTile":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/decorateHelper ./Bitmap ./webgl/TiledDisplayObject".split(" "),function(g,a,d,h,b,e){Object.defineProperty(a,
"__esModule",{value:!0});g=function(a){function c(c,f,e,m){void 0===m&&(m=null);var l=a.call(this,c,f,e,e)||this;c=l.requestRender.bind(l);l.bitmap=new b.Bitmap(m,c);l.bitmap.coordScale=e;l.bitmap.once("isReady",function(){return l.ready()});return l}d(c,a);Object.defineProperty(c.prototype,"stencilRef",{get:function(){return this.bitmap.stencilRef},set:function(a){this.bitmap.stencilRef=a},enumerable:!0,configurable:!0});c.prototype.setTransform=function(c,b){a.prototype.setTransform.call(this,c,
b);this.bitmap.transforms.dvs=this.transforms.dvs};c.prototype.attach=function(){this.bitmap.stage=this.stage;var a=this.bitmap.attach();a&&(this.bitmap.attached=!0);return a};c.prototype.detach=function(){this.bitmap.detach()};return c}(e.TiledDisplayObject);a.BitmapTile=g})},"esri/views/2d/engine/webgl/TiledDisplayObject":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/has ../../../../core/libs/gl-matrix-2/mat3 ../../../../core/libs/gl-matrix-2/mat3f32 ../DisplayObject ../../tiling/TileKey".split(" "),
function(g,a,d,h,b,e,m,c){Object.defineProperty(a,"__esModule",{value:!0});g=function(a){function f(b,f,l,p){void 0===p&&(p=l);var n=a.call(this)||this;n.transforms={dvs:e.mat3f32.create(),tileMat3:e.mat3f32.create()};n.triangleCount=0;n.key=c.pool.acquire(b);n.bounds=f;n.size=l;n.coordRange=p;return n}d(f,a);f.prototype.destroy=function(){c.pool.release(this.key);this.key=null;this.texture&&(this.texture.dispose(),this.texture=null)};Object.defineProperty(f.prototype,"coords",{get:function(){return this._coords},
enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"bounds",{get:function(){return this._bounds},set:function(a){this._coords=[a[0],a[3]];this._bounds=a},enumerable:!0,configurable:!0});f.prototype.setTransform=function(a,c){c/=a.resolution*a.pixelRatio;var f=this.transforms.tileMat3,l=a.toScreenNoRotation([0,0],this.coords);b.mat3.set(f,this.size[0]/this.coordRange[0]*c,0,0,0,this.size[1]/this.coordRange[1]*c,0,l[0],l[1],1);b.mat3.multiply(this.transforms.dvs,a.displayViewMat3,f)};
return f}(m.DisplayObject);a.TiledDisplayObject=g})},"esri/views/2d/engine/webgl/TileContainer":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/tsSupport/assignHelper ./enums ./WGLContainer ./brushes/WGLBrushInfo ./brushes/WGLBrushStencil".split(" "),function(g,a,d,h,b,e,m,c){Object.defineProperty(a,"__esModule",{value:!0});a.sortByLevel=function(a,c){return 0!==a.key.level-c.key.level?a.key.level-c.key.level:0!==a.key.row-c.key.row?a.key.row-c.key.row:
a.key.col-c.key.col};g=function(l){function f(a,c){c=l.call(this,c)||this;c._tileInfoView=a;return c}d(f,l);f.prototype.renderChildren=function(c){this.sortChildren(a.sortByLevel);this.setStencilReference();l.prototype.renderChildren.call(this,c)};f.prototype.createRenderParams=function(a){var c=a.state;return h({},l.prototype.createRenderParams.call(this,a),{requiredLevel:this._tileInfoView.getClosestInfoForScale(c.scale).level,displayLevel:this._tileInfoView.tileInfo.scaleToZoom(c.scale)})};f.prototype.prepareRenderPasses=
function(a){var f=this,e=a.registerRenderPass({name:"stencil",brushes:[c.default],drawPhase:b.WGLDrawPhase.DEBUG|b.WGLDrawPhase.MAP,target:function(){return f.children}}),p=a.registerRenderPass({name:"tileInfo",brushes:[m.default],drawPhase:b.WGLDrawPhase.DEBUG,target:function(){return f.children},has:"esri-tiles-debug"});return l.prototype.prepareRenderPasses.call(this,a).concat([e,p])};f.prototype.updateTransforms=function(a){for(var c=0,b=this.children;c<b.length;c++){var f=b[c],l=this._tileInfoView.getTileResolution(f.key);
f.setTransform(a,l)}};f.prototype.setStencilReference=function(){for(var a=1,c=0,b=this.children;c<b.length;c++)b[c].stencilRef=a++};return f}(e.default);a.default=g})},"esri/views/2d/engine/webgl/brushes/WGLBrushInfo":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/libs/gl-matrix-2/vec4f32 ../../../../webgl ./WGLBrush ../shaders/BackgroundPrograms ../shaders/TileInfoPrograms".split(" "),function(g,a,d,h,b,e,m,c){Object.defineProperty(a,"__esModule",
{value:!0});g=function(a){function f(){var c=null!==a&&a.apply(this,arguments)||this;c._color=h.vec4f32.fromValues(1,0,0,1);return c}d(f,a);f.prototype.dispose=function(){this._outlineProgram&&(this._outlineProgram.dispose(),this._outlineProgram=null);this._tileInfoProgram&&(this._tileInfoProgram.dispose(),this._tileInfoProgram=null);this._outlineVertexArrayObject&&(this._outlineVertexArrayObject.dispose(),this._outlineVertexArrayObject=null);this._tileInfoVertexArrayObject&&(this._tileInfoVertexArrayObject.dispose(),
this._tileInfoVertexArrayObject=null);this._canvas=null};f.prototype.prepareState=function(a){a=a.context;a.setBlendingEnabled(!0);a.setBlendFunctionSeparate(1,771,1,771);a.setColorMask(!0,!0,!0,!0);a.setStencilWriteMask(0);a.setStencilTestEnabled(!1)};f.prototype.draw=function(a,c){a=a.context;if(c.isReady){this._loadWGLResources(a);a.bindVAO(this._outlineVertexArrayObject);a.bindProgram(this._outlineProgram);this._outlineProgram.setUniformMatrix3fv("u_dvsMat3",c.transforms.dvs);this._outlineProgram.setUniform2f("u_coord_range",
c.coordRange[0],c.coordRange[1]);this._outlineProgram.setUniform1f("u_depth",0);this._outlineProgram.setUniform4fv("u_color",this._color);a.drawArrays(3,0,4);a.bindVAO();var b=this._getTexture(a,c);b&&(a.bindVAO(this._tileInfoVertexArrayObject),a.bindProgram(this._tileInfoProgram),a.bindTexture(b,0),this._tileInfoProgram.setUniformMatrix3fv("u_dvsMat3",c.transforms.dvs),this._tileInfoProgram.setUniform1f("u_depth",0),this._tileInfoProgram.setUniform2f("u_coord_ratio",c.coordRange[0]/c.size[0],c.coordRange[1]/
c.size[1]),this._tileInfoProgram.setUniform2f("u_delta",8,8),this._tileInfoProgram.setUniform2f("u_dimensions",b.descriptor.width,b.descriptor.height),a.drawArrays(5,0,4),a.bindVAO())}};f.prototype._loadWGLResources=function(a){if(!this._outlineProgram||!this._tileInfoProgram){var f=b.createProgram(a,m.background),l=b.createProgram(a,c.tileInfo),e={geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}]},t=new Int8Array([0,0,1,0,1,1,0,1]),t=b.BufferObject.createVertex(a,
35044,t),t=new b.VertexArrayObject(a,m.background.attributes,e,{geometry:t}),u=new Int8Array([0,0,1,0,0,1,1,1]),u=b.BufferObject.createVertex(a,35044,u);a=new b.VertexArrayObject(a,c.tileInfo.attributes,e,{geometry:u});this._outlineProgram=f;this._tileInfoProgram=l;this._outlineVertexArrayObject=t;this._tileInfoVertexArrayObject=a}};f.prototype._getTexture=function(a,c){if(c.texture)return c.texture;this._canvas||(this._canvas=document.createElement("canvas"),this._canvas.setAttribute("id","canvas2d"),
this._canvas.setAttribute("width","300"),this._canvas.setAttribute("height","32"),this._canvas.setAttribute("style","display:none"));var f=c.triangleCount,l=c.key.id;0<c.triangleCount&&(l+=", "+f);var e=this._canvas,u=e.getContext("2d");u.font="24px sans-serif";u.textAlign="left";u.textBaseline="top";u.clearRect(0,0,300,32);1E5<f?(u.fillStyle="red",u.fillRect(0,0,300,32),u.fillStyle="black"):(u.clearRect(0,0,300,32),u.fillStyle="blue");u.fillText(l,0,0);c.texture=new b.Texture(a,{target:3553,pixelFormat:6408,
dataType:5121,samplingMode:9728,wrapMode:33071},e);return c.texture};return f}(e.default);a.default=g})},"esri/views/2d/engine/webgl/brushes/WGLBrush":function(){define(["require","exports"],function(g,a){Object.defineProperty(a,"__esModule",{value:!0});g=function(){function a(){this.name=this.constructor.name||"UnnamedBrush"}a.prototype.prepareState=function(a,b,e){};a.prototype.draw=function(a,b,e){};a.prototype.drawMany=function(a,b,e){for(var m=0;m<b.length;m++)this.draw(a,b[m],e)};return a}();
a.default=g})},"esri/views/2d/engine/webgl/shaders/BackgroundPrograms":function(){define(["require","exports","./sources/resolver"],function(g,a,d){Object.defineProperty(a,"__esModule",{value:!0});a.background={name:"background",shaders:{vertexShader:d.resolveIncludes("background/background.vert"),fragmentShader:d.resolveIncludes("background/background.frag")},attributes:{a_pos:0}}})},"esri/views/2d/engine/webgl/shaders/sources/resolver":function(){define(["require","exports","../../../../../webgl",
"./shaderRepository"],function(g,a,d,h){Object.defineProperty(a,"__esModule",{value:!0});var b=new d.ShaderCompiler(function(a){var b=h;a.split("/").forEach(function(a){b&&(b=b[a])});return b});a.resolveIncludes=function(a){return b.resolveIncludes(a)}})},"esri/views/2d/engine/webgl/shaders/sources/shaderRepository":function(){define(["require","exports"],function(g,a){return{background:{"background.frag":"uniform lowp vec4 u_color;\nvoid main() {\n  gl_FragColor \x3d u_color;\n}","background.vert":"attribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform mediump vec2 u_coord_range;\nuniform mediump float u_depth;\nvoid main() {\n  vec3 v_pos \x3d u_dvsMat3 * vec3(u_coord_range * a_pos, 1.0);\n  gl_Position \x3d vec4(v_pos.xy, 0.0, 1.0);\n}"},
bitBlit:{"bitBlit.frag":"uniform lowp sampler2D u_tex;\nuniform lowp float u_opacity;\nvarying mediump vec2 v_uv;\nvoid main() {\n  lowp vec4 color \x3d texture2D(u_tex, v_uv);\n  gl_FragColor \x3d color *  u_opacity;\n}","bitBlit.vert":"attribute vec2 a_pos;\nattribute vec2 a_tex;\nvarying mediump vec2 v_uv;\nvoid main(void) {\n  gl_Position \x3d vec4(a_pos, 0.0, 1.0);\n  v_uv \x3d a_tex;\n}"},filtering:{"bicubic.glsl":"vec4 computeWeights(float v) {\n  float b \x3d 1.0 / 6.0;\n  float v2 \x3d v * v;\n  float v3 \x3d v2 * v;\n  float w0 \x3d b * (-v3 + 3.0 * v2 - 3.0 * v + 1.0);\n  float w1 \x3d b * (3.0 * v3  - 6.0 * v2 + 4.0);\n  float w2 \x3d b * (-3.0 * v3 + 3.0 * v2 + 3.0 * v + 1.0);\n  float w3 \x3d b * v3;\n  return vec4(w0, w1, w2, w3);\n}\nvec4 bicubicOffsetsAndWeights(float v) {\n  vec4 w \x3d computeWeights(v);\n  float g0 \x3d w.x + w.y;\n  float g1 \x3d w.z + w.w;\n  float h0 \x3d 1.0 - (w.y / g0) + v;\n  float h1 \x3d 1.0 + (w.w / g1) - v;\n  return vec4(h0, h1, g0, g1);\n}\nvec4 sampleBicubicBSpline(sampler2D sampler, vec2 coords, vec2 texSize) {\n  vec2 eX \x3d vec2(1.0 / texSize.x, 0.0);\n  vec2 eY \x3d vec2(0.0, 1.0 / texSize.y);\n  vec2 texel \x3d coords * texSize - 0.5;\n  vec3 hgX \x3d bicubicOffsetsAndWeights(fract(texel).x).xyz;\n  vec3 hgY \x3d bicubicOffsetsAndWeights(fract(texel).y).xyz;\n  vec2 coords10 \x3d coords + hgX.x * eX;\n  vec2 coords00 \x3d coords - hgX.y * eX;\n  vec2 coords11 \x3d coords10 + hgY.x * eY;\n  vec2 coords01 \x3d coords00 + hgY.x * eY;\n  coords10 \x3d coords10 - hgY.y * eY;\n  coords00 \x3d coords00 - hgY.y * eY;\n  vec4 color00 \x3d texture2D(sampler, coords00);\n  vec4 color10 \x3d texture2D(sampler, coords10);\n  vec4 color01 \x3d texture2D(sampler, coords01);\n  vec4 color11 \x3d texture2D(sampler, coords11);\n  color00 \x3d mix(color00, color01, hgY.z);\n  color10 \x3d mix(color10, color11, hgY.z);\n  color00 \x3d mix(color00, color10, hgX.z);\n  return color00;\n}",
"bilinear.glsl":"vec4 sampleBilinear(sampler2D sampler, vec2 coords, vec2 texSize) {\n  vec2 texelStart \x3d floor(coords * texSize);\n  vec2 coord0 \x3d texelStart / texSize;\n  vec2 coord1 \x3d (texelStart +  vec2(1.0, 0.0)) / texSize;\n  vec2 coord2 \x3d (texelStart +  vec2(0.0, 1.0)) / texSize;\n  vec2 coord3 \x3d (texelStart +  vec2(1.0, 1.0)) / texSize;\n  vec4 color0 \x3d texture2D(sampler, coord0);\n  vec4 color1 \x3d texture2D(sampler, coord1);\n  vec4 color2 \x3d texture2D(sampler, coord2);\n  vec4 color3 \x3d texture2D(sampler, coord3);\n  vec2 blend \x3d fract(coords * texSize);\n  vec4 color01 \x3d mix(color0, color1, blend.x);\n  vec4 color23 \x3d mix(color2, color3, blend.x);\n  return mix(color01, color23, blend.y);\n}",
"epx.glsl":"vec4 sampleEPX(sampler2D sampler, float size, vec2 coords, vec2 texSize) {\n  vec2 invSize \x3d 1.0 / texSize;\n  vec2 texel \x3d coords * texSize;\n  vec2 texel_i \x3d floor(texel);\n  vec2 texel_frac \x3d fract(texel);\n  vec4 colorP \x3d texture2D(sampler, texel_i * invSize);\n  vec4 colorP1 \x3d vec4(colorP);\n  vec4 colorP2 \x3d vec4(colorP);\n  vec4 colorP3 \x3d vec4(colorP);\n  vec4 colorP4 \x3d vec4(colorP);\n  vec4 colorA \x3d texture2D(sampler, (texel_i - vec2(0.0, 1.0)) * invSize);\n  vec4 colorB \x3d texture2D(sampler, (texel_i + vec2(1.0, 0.0)) * invSize);\n  vec4 colorC \x3d texture2D(sampler, (texel_i - vec2(1.0, 0.0)) * invSize);\n  vec4 colorD \x3d texture2D(sampler, (texel_i + vec2(0.0, 1.0)) * invSize);\n  if (colorC \x3d\x3d colorA \x26\x26 colorC !\x3d colorD \x26\x26 colorA !\x3d colorB) {\n    colorP1 \x3d colorA;\n  }\n  if (colorA \x3d\x3d colorB \x26\x26 colorA !\x3d colorC \x26\x26 colorB !\x3d colorD) {\n    colorP2 \x3d colorB;\n  }\n  if (colorD \x3d\x3d colorC \x26\x26 colorD !\x3d colorB \x26\x26 colorC !\x3d colorA) {\n    colorP3 \x3d colorC;\n  }\n  if (colorB \x3d\x3d colorD \x26\x26 colorB !\x3d colorA \x26\x26 colorD !\x3d colorC) {\n    colorP4 \x3d colorD;\n  }\n  vec4 colorP12 \x3d mix(colorP1, colorP2, texel_frac.x);\n  vec4 colorP34 \x3d mix(colorP1, colorP2, texel_frac.x);\n  return mix(colorP12, colorP34, texel_frac.y);\n}"},
fx:{integrate:{"integrate.frag":"precision mediump float;\nuniform lowp sampler2D u_sourceTexture;\nuniform lowp sampler2D u_maskTexture;\nuniform mediump float u_zoomLevel;\nuniform highp float u_timeDelta;\nuniform highp float u_animationTime;\nvarying highp vec2 v_texcoord;\n#include \x3cmaterials/utils.glsl\x3e\nvoid main()\n{\n#ifdef DELTA\n  vec4 texel \x3d texture2D(u_sourceTexture, v_texcoord);\n  vec4 data0 \x3d texture2D(u_maskTexture, v_texcoord);\n  float flags \x3d data0.r * 255.0;\n  float groupMinZoom \x3d data0.g * 255.0;\n  float isVisible \x3d getFilterBit(flags, 0);\n  float wouldClip \x3d step(groupMinZoom, u_zoomLevel);\n  float direction \x3d wouldClip * 1.0 + (1.0 - wouldClip) * -1.0;\n  float dt \x3d u_timeDelta / max(u_animationTime, 0.0001);\n  vec4 nextState \x3d vec4(texel + direction * dt);\n  gl_FragColor \x3d  vec4(nextState);\n#elif defined(UPDATE)\n  vec4 texel \x3d texture2D(u_sourceTexture, v_texcoord);\n  gl_FragColor \x3d texel;\n#endif\n}",
"integrate.vert":"precision mediump float;\nattribute vec2 a_pos;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\n  v_texcoord \x3d a_pos;\n  gl_Position \x3d vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\n}"}},highlight:{"blur.frag":"varying mediump vec2 v_texcoord;\nuniform mediump vec4 u_direction;\nuniform mediump mat4 u_channelSelector;\nuniform mediump vec4 u_sigmas;\nuniform sampler2D u_texture;\nmediump vec4 gauss4(mediump vec2 dir) {\n  return exp(-dot(dir, dir) / (2.0 * u_sigmas * u_sigmas));\n}\nmediump float gauss1(mediump vec2 dir) {\n  return exp(-dot(dir, dir) / (2.0 * u_sigmas[3] * u_sigmas[3]));\n}\nmediump vec4 selectChannel(mediump vec4 sample) {\n  return u_channelSelector * sample;\n}\nvoid accumGauss4(mediump float i, inout mediump vec4 tot, inout mediump vec4 weight) {\n  mediump vec4 w \x3d gauss4(i * u_direction.xy);\n  tot +\x3d selectChannel(texture2D(u_texture, v_texcoord + i * u_direction.zw)) * w;\n  weight +\x3d w;\n}\nvoid accumGauss1(mediump float i, inout mediump float tot, inout mediump float weight) {\n  mediump float w \x3d gauss1(i * u_direction.xy);\n  tot +\x3d selectChannel(texture2D(u_texture, v_texcoord + i * u_direction.zw))[3] * w;\n  weight +\x3d w;\n}\nvoid main(void) {\n  mediump float tot \x3d 0.0;\n  mediump float weight \x3d 0.0;\n  accumGauss1(-4.0, tot, weight);\n  accumGauss1(-3.0, tot, weight);\n  accumGauss1(-2.0, tot, weight);\n  accumGauss1(-1.0, tot, weight);\n  accumGauss1(0.0, tot, weight);\n  accumGauss1(1.0, tot, weight);\n  accumGauss1(2.0, tot, weight);\n  accumGauss1(3.0, tot, weight);\n  accumGauss1(4.0, tot, weight);\n  gl_FragColor \x3d vec4(0.0, 0.0, 0.0, tot / weight);\n}",
"highlight.frag":"varying mediump vec2 v_texcoord;\nuniform sampler2D u_texture;\nuniform mediump vec4 u_sigmas;\nuniform sampler2D u_shade;\nuniform mediump vec2 u_minMaxDistance;\nmediump float estimateDistance() {\n  mediump float sigma \x3d u_sigmas[3];\n  mediump float y \x3d texture2D(u_texture, v_texcoord)[3];\n  const mediump float y0 \x3d 0.5;\n  mediump float m0 \x3d 1.0 / (sqrt(2.0 * 3.1415) * sigma);\n  mediump float d \x3d (y - y0) / m0;\n  return d;\n}\nmediump vec4 shade(mediump float d) {\n  mediump float mappedDistance \x3d (d - u_minMaxDistance.x) / (u_minMaxDistance.y - u_minMaxDistance.x);\n  mappedDistance \x3d clamp(mappedDistance, 0.0, 1.0);\n  return texture2D(u_shade, vec2(mappedDistance, 0.5));\n}\nvoid main(void) {\n  mediump float d \x3d estimateDistance();\n  gl_FragColor \x3d shade(d);\n}",
"textured.vert":"attribute mediump vec2 a_position;\nattribute mediump vec2 a_texcoord;\nvarying mediump vec2 v_texcoord;\nvoid main(void) {\n  gl_Position \x3d vec4(a_position, 0.0, 1.0);\n  v_texcoord \x3d a_texcoord;\n}"},magnifier:{"magnifier.frag":"uniform lowp vec4 u_background;\nuniform mediump sampler2D u_readbackTexture;\nuniform mediump sampler2D u_maskTexture;\nuniform mediump sampler2D u_overlyTexture;\nvarying mediump vec2 v_texCoord;\nvoid main(void)\n{\n  lowp vec4 color \x3d texture2D(u_readbackTexture, v_texCoord);\n  color \x3d color + (1.0 - color.a) * u_background;\n  lowp vec4 mask_color \x3d texture2D(u_maskTexture, v_texCoord);\n  lowp float gray \x3d 1.0 - dot(mask_color, vec4(0.3, 0.59, 0.11, 0));\n  color *\x3d gray;\n  lowp vec4 overley_color \x3d texture2D(u_overlyTexture, v_texCoord);\n  overley_color.rgb *\x3d overley_color.a;\n  gl_FragColor \x3d overley_color + (1.0 - overley_color.a) * color;\n}",
"magnifier.vert":"precision mediump float;\nattribute mediump vec2 a_pos;\nuniform mediump vec2 u_drawPos;\nuniform mediump float u_width;\nuniform mediump float u_height;\nvarying mediump vec2 v_texCoord;\nvoid main(void)\n{\n  v_texCoord \x3d a_pos;\n  vec2 coord \x3d u_drawPos + vec2(a_pos - 0.5) * vec2(u_width, u_height);\n  gl_Position \x3d vec4(coord, 0.0, 1.0);\n}"},materials:{"attributeData.glsl":"uniform highp sampler2D u_attributeData0;\nuniform highp sampler2D u_attributeData1;\nuniform highp sampler2D u_attributeData2;\nuniform highp sampler2D u_attributeData3;\nuniform highp int u_attributeTextureSize;\nhighp vec2 getAttributeDataCoords(in highp vec4 id) {\n  highp vec4 texel \x3d unpackLocalIdTexel(id);\n  highp float size \x3d float(u_attributeTextureSize);\n  highp float u32 \x3d float(int(texel.r) + int(texel.g) * 256 + int(texel.b) * 256 * 256 + int(texel.a) * 256 * 256 * 256);\n  highp float col \x3d mod(u32, size);\n  highp float row \x3d (u32 - col) / size;\n  highp float u \x3d col / size;\n  highp float v \x3d row / size;\n  return vec2(u, v);\n}\nhighp vec4 getAttributeData0(in highp vec4 id) {\n  vec2 coords \x3d getAttributeDataCoords(id);\n  return texture2D(u_attributeData0, coords);\n}\nhighp vec4 getAttributeData1(in highp vec4 id) {\n  highp vec2 coords \x3d getAttributeDataCoords(id);\n  return texture2D(u_attributeData1, coords);\n}\nhighp vec4 getAttributeData2(in highp vec4 id) {\n  highp vec2 coords \x3d getAttributeDataCoords(id);\n  return texture2D(u_attributeData2, coords);\n}\nhighp vec4 getAttributeData3(in highp vec4 id) {\n  highp vec2 coords \x3d getAttributeDataCoords(id);\n  return texture2D(u_attributeData3, coords);\n}\nfloat u88VVToFloat(in vec2 v) {\n  bool isMagic \x3d v.x \x3d\x3d 255.0 \x26\x26 v.y \x3d\x3d 255.0;\n  if (isMagic) {\n    return NAN_MAGIC_NUMBER;\n  }\n  return (v.x + v.y * float(0x100)) - 32768.0;\n}",
"constants.glsl":"const float C_DEG_TO_RAD \x3d 3.14159265359 / 180.0;\nconst float SIGNED_BYTE_TO_UNSIGNED \x3d 128.0;\nconst float SOFT_EDGE_RATIO \x3d 1.0;\nconst float THIN_LINE_WIDTH_FACTOR \x3d 1.1;\nconst float THIN_LINE_HALF_WIDTH \x3d 1.0;\nconst float OFFSET_PRECISION \x3d 1.0 / 8.0;\nconst float OUTLINE_SCALE \x3d 1.0 / 5.0;\nconst float SDF_FONT_SIZE \x3d 24.0;\nconst float MAX_SDF_DISTANCE \x3d 8.0;\nconst float PLACEMENT_PADDING \x3d 8.0;\nconst float EPSILON \x3d 0.0000001;\nconst int MAX_FILTER_COUNT \x3d 2;\nconst int ATTR_VV_SIZE \x3d 0;\nconst int ATTR_VV_COLOR \x3d 1;\nconst int ATTR_VV_OPACITY \x3d 2;\nconst int ATTR_VV_ROTATION \x3d 3;\nconst highp float NAN_MAGIC_NUMBER \x3d 1e-30;",
"effects.glsl":"uniform highp mat4 u_insideEffectMat4[ MAX_FILTER_COUNT ];\nuniform highp mat4 u_outsideEffectMat4[ MAX_FILTER_COUNT ];\nuniform highp float u_insideOpacities[ MAX_FILTER_COUNT ];\nuniform highp float u_outsideOpacities[ MAX_FILTER_COUNT ];\nvec4 getEffectColor(in vec4 color, in float filterFlags) {\n  vec4 rgbw \x3d vec4(color.a \x3e 0.0 ? color.rgb / color.a : vec3(0.0), 1.0);\n  float a \x3d color.a;\n  for (int i \x3d 1; i \x3c EFFECT_COUNT + 1; i++) {\n    float bit \x3d getFilterBit(filterFlags, i);\n    rgbw \x3d u_insideEffectMat4[ i ] * (bit  * rgbw) + u_outsideEffectMat4[ i ] * ((1.0 - bit) * rgbw);\n    a    \x3d u_insideOpacities[ i ]  * (bit  * a)    + u_outsideOpacities[ i ]  * ((1.0 - bit) * a);\n  }\n  return vec4(rgbw.rgb * a, a);\n}\nvec3 applyFilter(inout vec4 color, inout vec3 pos, in float filterFlags) {\n  vec4 rgbw \x3d vec4(color.a \x3e 0.0 ? color.rgb / color.a : vec3(0.0), 1.0);\n  float a \x3d color.a;\n  for (int i \x3d 0; i \x3c EFFECT_COUNT + 1; i++) {\n    float bit \x3d getFilterBit(filterFlags, i);\n    rgbw \x3d u_insideEffectMat4[ i ] * (bit  * rgbw) + u_outsideEffectMat4[ i ] * ((1.0 - bit) * rgbw);\n    a    \x3d u_insideOpacities[ i ]  * (bit  * a)    + u_outsideOpacities[ i ]  * ((1.0 - bit) * a);\n  }\n  color.rgb \x3d rgbw.rgb * a;\n  color.a \x3d a;\n  pos.z +\x3d 2.0 * (1.0 - getFilterBit(filterFlags, 0));\n#ifdef HIGHLIGHT\n  pos.z +\x3d 2.0 * (1.0 - getHighlightBit(filterFlags));\n#endif\n  return pos;\n}\nvec3 applyFilterLabels(inout vec4 color, inout vec3 pos, in float filterFlags) {\n  float bit \x3d getFilterBit(filterFlags, 0);\n  pos.z +\x3d 2.0 * (1.0 - bit);\n#ifndef OUTSIDE_LABELS_VISIBLE\n  for (int i \x3d 1; i \x3c EFFECT_COUNT + 1; i++) {\n    float bit \x3d getFilterBit(filterFlags, i);\n    pos.z +\x3d 2.0 * (1.0 - bit);\n  }\n#endif\n  return pos;\n}",
fill:{"common.glsl":"#ifdef PATTERN\nuniform mediump vec2 u_mosaicSize;\n#endif\n#ifdef DOT_DENSITY\nuniform lowp vec4 u_isActive[ 2 ];\nuniform highp float u_dotValue;\nuniform highp float u_tileDotsOverArea;\nuniform highp float u_dotTextureDotCount;\nuniform mediump float u_tileZoomFactor;\n#endif\nvarying vec3 v_pos;\nvarying lowp float v_opacity;\nvarying lowp vec4 v_color;\nvarying highp vec4 v_id;\nvarying highp float v_flags;\n#ifdef PATTERN\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_tileTextureCoord;\n#endif\n#ifdef DOT_DENSITY\nvarying vec2 v_dotTextureCoords;\nvarying vec4 v_dotThresholds[ 2 ];\n#endif",
"fill.frag":"precision highp float;\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cmaterials/fill/common.glsl\x3e\n#ifdef DOT_DENSITY\n#include \x3cmaterials/effects.glsl\x3e\n#endif\n#ifdef PATTERN\nuniform lowp sampler2D u_texture;\n#endif\n#ifdef DOT_DENSITY\nuniform mediump mat4 u_dotColors[ 2 ];\nuniform sampler2D u_dotTextures[ 2 ];\nuniform vec4 u_dotBackgroundColor;\n#endif\nvoid main() {\n#ifdef ID\n  gl_FragColor \x3d v_id;\n#elif defined(PATTERN)\n  mediump vec2 normalizedTextureCoord \x3d mod(v_tileTextureCoord, 1.0);\n  mediump vec2 samplePos \x3d mix(v_tlbr.xy, v_tlbr.zw, normalizedTextureCoord);\n  lowp vec4 color \x3d texture2D(u_texture, samplePos);\n  gl_FragColor \x3d v_opacity * v_color * color;\n#elif defined(DOT_DENSITY) \x26\x26 !defined(HIGHLIGHT)\n  vec4 textureThresholds0 \x3d texture2D(u_dotTextures[0], v_dotTextureCoords);\n  vec4 textureThresholds1 \x3d texture2D(u_dotTextures[1], v_dotTextureCoords);\n  vec4 difference0 \x3d v_dotThresholds[0] - textureThresholds0;\n  vec4 difference1 \x3d v_dotThresholds[1] - textureThresholds1;\n#ifdef DD_DOT_BLENDING\n  vec4 isPositive0 \x3d step(0.0, difference0);\n  vec4 isPositive1 \x3d step(0.0, difference1);\n  float weightSum \x3d dot(isPositive0, difference0) + dot(isPositive1, difference1);\n  float lessThanEqZero \x3d step(weightSum, 0.0);\n  float greaterThanZero \x3d 1.0 - lessThanEqZero ;\n  float divisor \x3d (weightSum + lessThanEqZero);\n  vec4 weights0 \x3d difference0 * isPositive0 / divisor;\n  vec4 weights1 \x3d difference1 * isPositive1 / divisor;\n  vec4 dotColor \x3d u_dotColors[0] * weights0 + u_dotColors[1] * weights1;\n  vec4 preEffectColor \x3d greaterThanZero * dotColor + lessThanEqZero * u_dotBackgroundColor;\n#else\n  float diffMax \x3d max(max4(difference0), max4(difference1));\n  float lessThanZero \x3d step(diffMax, 0.0);\n  float greaterOrEqZero \x3d 1.0 - lessThanZero;\n  vec4 isMax0 \x3d step(diffMax, difference0);\n  vec4 isMax1 \x3d step(diffMax, difference1);\n  vec4 dotColor \x3d u_dotColors[0] * isMax0 + u_dotColors[1] * isMax1;\n  vec4 preEffectColor \x3d greaterOrEqZero * dotColor + lessThanZero * u_dotBackgroundColor;\n#endif\n  gl_FragColor \x3d getEffectColor(preEffectColor, v_flags);\n#else\n  gl_FragColor \x3d v_opacity * v_color;\n#endif\n#ifdef HIGHLIGHT\n  gl_FragColor.a \x3d 1.0;\n#endif\n}",
"fill.vert":"precision mediump float;\n#ifdef DOT_DENSITY\nattribute float a_inverseArea;\nvec4 a_color \x3d vec4(0.0, 0.0, 0.0, 1.0);\nvec4 a_aux3 \x3d vec4(0.0);\n#else\nattribute vec4 a_color;\nattribute vec4 a_tlbr;\nattribute vec4 a_aux1;\nattribute vec2 a_aux2;\nattribute vec4 a_aux3;\n#endif\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/fill/common.glsl\x3e\n#ifdef DOT_DENSITY\nvec4 dotThreshold(vec4 featureAttrOverFeatureArea, float dotValue, float tileDotsOverArea) {\n  return featureAttrOverFeatureArea * (1.0 / dotValue)  * (1.0 / tileDotsOverArea);\n}\n#endif\n#ifdef PATTERN\nmat3 getPatternMatrix() {\n  mat3 patternMatrix \x3d mat3(1.0);\n  vec2 aux2 \x3d (1.0 / SIGNED_BYTE_TO_UNSIGNED) * a_aux2;\n  patternMatrix[0][0] \x3d 1.0 / (u_zoomFactor * a_aux1.x * aux2.x);\n  patternMatrix[1][1] \x3d 1.0 / (u_zoomFactor * a_aux1.y * aux2.y);\n  return patternMatrix;\n}\n#endif\nvoid main()\n{\n  INIT;\n  float a_bitSet \x3d a_aux3.a;\n  v_color     \x3d getColor(a_color, a_bitSet, 0);\n  v_opacity   \x3d getOpacity(a_bitSet, 1);\n  v_id        \x3d norm(a_id);\n  v_pos       \x3d u_dvsMat3 * vec3(a_pos, 1.);\n  v_flags     \x3d getFilterFlags();\n#ifdef PATTERN\n  vec2 symbolOffset \x3d u_zoomFactor * (a_aux1.zw - SIGNED_BYTE_TO_UNSIGNED);\n  v_tileTextureCoord \x3d (getPatternMatrix() * vec3(a_pos + symbolOffset, 1.0)).xy;\n  v_tlbr \x3d a_tlbr / u_mosaicSize.xyxy;\n#elif defined(DOT_DENSITY)\n  vec4 ddAttributeData0 \x3d getAttributeData2(a_id) * u_isActive[0] * a_inverseArea;\n  vec4 ddAttributeData1 \x3d getAttributeData3(a_id) * u_isActive[1] * a_inverseArea;\n  float size \x3d u_tileZoomFactor * 512.0 * 1.0 / u_pixelRatio;\n  v_dotThresholds[0] \x3d dotThreshold(ddAttributeData0, u_dotValue, u_tileDotsOverArea);\n  v_dotThresholds[1] \x3d dotThreshold(ddAttributeData1, u_dotValue, u_tileDotsOverArea);\n  v_dotTextureCoords \x3d (a_pos + 0.5) / size;\n#endif\n  gl_Position \x3d vec4(applyFilter(v_color, v_pos, v_flags), 1.0);\n}"},
icon:{"common.glsl":"uniform lowp vec2 u_mosaicSize;\nvarying lowp vec4 v_color;\nvarying highp vec4 v_id;\nvarying vec4 v_sizeTex;\nvarying vec3 v_pos;\nvarying float v_filters;\nvarying lowp float v_opacity;\n#ifdef SDF\nvarying lowp vec4 v_outlineColor;\nvarying mediump float v_outlineWidth;\nvarying mediump float v_distRatio;\nvarying float v_overridingOutlineColor;\nvarying float v_isThin;\n#endif","icon.frag":"precision mediump float;\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cutil/encoding.glsl\x3e\n#include \x3cmaterials/effects.glsl\x3e\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/icon/common.glsl\x3e\nuniform lowp sampler2D u_texture;\nvoid main()\n{\n  vec2 v_size \x3d v_sizeTex.xy;\n  vec2 v_tex  \x3d v_sizeTex.zw;\n#ifdef SDF\n  lowp vec4 fillPixelColor \x3d v_color;\n  float d \x3d 0.5 - rgba2float(texture2D(u_texture, v_tex));\n  float size \x3d max(v_size.x, v_size.y);\n  float dist \x3d d * size * SOFT_EDGE_RATIO * v_distRatio;\n  fillPixelColor *\x3d clamp(0.5 - dist, 0.0, 1.0);\n  float outlineWidth \x3d v_outlineWidth;\n  #ifdef HIGHLIGHT\n    outlineWidth \x3d max(outlineWidth, 4.0 * v_isThin);\n  #endif\n  if (outlineWidth \x3e 0.25) {\n    lowp vec4 outlinePixelColor \x3d v_overridingOutlineColor * v_color + (1.0 - v_overridingOutlineColor) * v_outlineColor;\n    float clampedOutlineSize \x3d min(outlineWidth, size);\n    outlinePixelColor *\x3d clamp(0.5 - abs(dist) + clampedOutlineSize * 0.5, 0.0, 1.0);\n    gl_FragColor \x3d v_opacity * ((1.0 - outlinePixelColor.a) * fillPixelColor + outlinePixelColor);\n  }\n  else {\n    gl_FragColor \x3d v_opacity * fillPixelColor;\n  }\n#else\n   lowp vec4 texColor \x3d texture2D(u_texture, v_tex);\n   gl_FragColor \x3d v_opacity * getEffectColor(texColor, v_filters);\n#endif\n#ifdef HIGHLIGHT\n  gl_FragColor.a \x3d step(1.0 / 255.0, gl_FragColor.a);\n#endif\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"icon.vert":"precision mediump float;\nattribute vec4 a_color;\nattribute vec4 a_outlineColor;\nattribute vec4 a_sizeAndOutlineWidth;\nattribute vec2 a_vertexOffset;\nattribute vec2 a_texCoords;\nattribute vec4 a_bitSetAndDistRatio;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/icon/common.glsl\x3e\nvec2 getMarkerSize(inout vec2 offset, inout vec2 baseSize, inout float outlineSize, in float referenceSize, in float bitSet) {\n#ifdef VV_SIZE\n  float r \x3d getSize(baseSize.y) / referenceSize;\n  baseSize.xy *\x3d r;\n  offset.xy *\x3d r;\n  float scaleSymbolProportionally \x3d getBit(bitSet, 3);\n  outlineSize *\x3d scaleSymbolProportionally * (r - 1.0) + 1.0;\n#endif\n  return baseSize;\n}\nvec3 getOffset(in vec2 in_offset, float a_bitSet) {\n  float isMapAligned \x3d getBit(a_bitSet, 0);\n  vec3  offset       \x3d getRotation() * vec3(in_offset, 0.0);\n  return getMatrix(isMapAligned) * offset;\n}\nvoid main()\n{\n  INIT;\n  vec2  a_size   \x3d a_sizeAndOutlineWidth.xy * a_sizeAndOutlineWidth.xy / 256.0;\n  vec2  a_offset \x3d a_vertexOffset / 16.0;\n  float a_outlineSize \x3d a_sizeAndOutlineWidth.z * a_sizeAndOutlineWidth.z / 256.0;\n  float a_bitSet \x3d a_bitSetAndDistRatio.z;\n  vec2 v_size \x3d getMarkerSize(a_offset, a_size, a_outlineSize, a_sizeAndOutlineWidth.w * a_sizeAndOutlineWidth.w / 256.0, a_bitSet);\n  vec2 v_tex      \x3d a_texCoords / u_mosaicSize;\n  v_color    \x3d getColor(a_color, a_bitSet, 1);\n  v_opacity  \x3d getOpacity(a_bitSet, 1);\n  v_id       \x3d norm(a_id);\n  v_filters  \x3d getFilterFlags();\n  v_pos      \x3d u_dvsMat3 * vec3(a_pos, 1.0) + getOffset(a_offset, a_bitSet);\n  v_sizeTex  \x3d vec4(v_size.xy, v_tex.xy);\n#ifdef SDF\n  v_isThin   \x3d getBit(a_bitSet, 2);\n  #ifdef VV_COLOR\n    v_overridingOutlineColor \x3d v_isThin;\n  #else\n    v_overridingOutlineColor \x3d 0.0;\n  #endif\n  v_outlineWidth \x3d min(a_outlineSize, max(max(v_size.x, v_size.y) - 0.99, 0.0));\n  v_outlineColor \x3d getEffectColor(a_outlineColor, v_filters);\n  v_distRatio \x3d a_bitSetAndDistRatio.w / 126.0;\n#endif\n  gl_Position \x3d vec4(applyFilter(v_color, v_pos, v_filters), 1.0);\n}"},
label:{"common.glsl":"uniform mediump float u_zoomLevel;\nuniform float u_mapRotation;\nuniform float u_mapAligned;\nuniform vec2 u_mosaicSize;\nvarying mediump float v_antialiasingWidth;\nvarying mediump float v_edgeDistanceOffset;\nvarying mediump vec2 v_tex;\nvarying mediump vec4 v_color;\nvarying lowp vec4 v_animation;","label.frag":"precision mediump float;\n#include \x3cmaterials/label/common.glsl\x3e\nuniform mediump vec2 u_screenSize;\nuniform highp float u_pixelRatio;\nuniform lowp sampler2D u_texture;\nvoid main()\n{\n  mediump vec2 refTextPos \x3d gl_FragCoord.xy / (u_pixelRatio * u_screenSize.xy);\n  lowp float dist \x3d texture2D(u_texture, v_tex).a;\n  float glyphEdgeDistance \x3d max(0.75 - v_edgeDistanceOffset, 0.25);\n  lowp float sdfAlpha \x3d smoothstep(glyphEdgeDistance - v_antialiasingWidth, glyphEdgeDistance + v_antialiasingWidth, dist);\n  gl_FragColor \x3d v_animation.r * sdfAlpha * v_color;\n}",
"label.vert":"precision mediump float;\nattribute vec4 a_color;\nattribute vec2 a_vertexOffset;\nattribute vec4 a_texAndSize;\nattribute vec4 a_refSymbolAndPlacementOffset;\nattribute vec4 a_zoomRangeAndEmpty;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/label/common.glsl\x3e\nfloat getZ(in float minZoom, in float maxZoom, in float angle) {\n  float glyphAngle \x3d angle * 360.0 / 254.0;\n  float mapAngle \x3d u_mapRotation * 360.0 / 254.0;\n  float diffAngle \x3d min(360.0 - abs(mapAngle - glyphAngle), abs(mapAngle - glyphAngle));\n  float z \x3d 0.0;\n  z +\x3d u_mapAligned * (2.0 * (1.0 - step(minZoom, u_zoomLevel)));\n  z +\x3d u_mapAligned * 2.0 * step(90.0, diffAngle);\n  z +\x3d 2.0 * (1.0 - step(u_zoomLevel, maxZoom));\n  return z;\n}\nvoid main()\n{\n  INIT;\n  float groupMinZoom    \x3d getMinZoom();\n  float glyphMinZoom    \x3d a_zoomRangeAndEmpty.x;\n  float a_minZoom       \x3d max(groupMinZoom, glyphMinZoom);\n  float a_maxZoom       \x3d a_zoomRangeAndEmpty.y;\n  vec2  a_placementDir  \x3d a_refSymbolAndPlacementOffset.zw - 1.0;\n  float a_refSymbolSize \x3d a_refSymbolAndPlacementOffset.y;\n  float fontSize        \x3d a_texAndSize.z;\n  float isHalo          \x3d mod(a_pos, 2.0).x;\n  vec2  vertexOffset \x3d a_vertexOffset * OFFSET_PRECISION;\n  vec3  pos          \x3d vec3(floor(a_pos * 0.5), 1.0);\n  float z            \x3d getZ(a_minZoom, a_maxZoom, a_refSymbolAndPlacementOffset.x);\n  float fontScale    \x3d fontSize / SDF_FONT_SIZE;\n  float halfSize     \x3d getSize(a_refSymbolSize) / 2.0;\n  v_color     \x3d a_color;\n  v_tex       \x3d a_texAndSize.xy / u_mosaicSize;\n  v_animation \x3d pow(getAnimationState(), vec4(2.0));\n  v_edgeDistanceOffset \x3d isHalo * OUTLINE_SCALE * a_texAndSize.w / fontScale / MAX_SDF_DISTANCE;\n  v_antialiasingWidth  \x3d 0.106 * SDF_FONT_SIZE / fontSize / u_pixelRatio;\n  vec2 placementOffset \x3d a_placementDir * (halfSize + PLACEMENT_PADDING);\n  vec3 glyphOffset     \x3d u_displayMat3 * vec3(vertexOffset + placementOffset, 0.0);\n  vec3 v_pos           \x3d vec3((u_dvsMat3 * pos + glyphOffset).xy, z);\n  gl_Position \x3d vec4(applyFilterLabels(v_color, v_pos, getFilterFlags()), 1.0);\n#ifdef DEBUG\n  v_color \x3d vec4(a_color.rgb, z \x3d\x3d 0.0 ? 1.0 : 0.645);\n#endif\n}"},
line:{"common.glsl":"varying lowp vec4 v_color;\nvarying highp vec4 v_id;\nvarying mediump vec2 v_normal;\nvarying mediump float v_lineHalfWidth;\nvarying lowp float v_opacity;\nvarying vec3 v_pos;\n#ifdef PATTERN\nuniform mediump vec2 u_mosaicSize;\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_patternSize;\n#endif\n#if defined(PATTERN) || defined(SDF)\nvarying highp float v_accumulatedDistance;\n#endif","line.frag":"precision lowp float;\n#include \x3cutil/encoding.glsl\x3e\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/line/common.glsl\x3e\nuniform lowp float u_blur;\nuniform mediump float u_zoomFactor;\n#if defined(PATTERN) || defined(SDF)\nuniform sampler2D u_texture;\n#endif\n#ifdef SDF\nconst float sdfPatternHalfWidth \x3d 15.5;\nconst float widthFactor \x3d 2.0;\n#endif\nvoid main()\n{\n  mediump float thinLineFactor \x3d max(THIN_LINE_WIDTH_FACTOR * step(v_lineHalfWidth, THIN_LINE_HALF_WIDTH), 1.0);\n  mediump float fragDist \x3d length(v_normal) * v_lineHalfWidth;\n  lowp float alpha \x3d clamp(thinLineFactor * (v_lineHalfWidth - fragDist) / (u_blur + thinLineFactor - 1.0), 0.0, 1.0);\n#if defined(SDF) \x26\x26 !defined(HIGHLIGHT)\n  mediump float lineHalfWidth \x3d widthFactor * v_lineHalfWidth;\n  mediump float lineWidthRatio \x3d lineHalfWidth / sdfPatternHalfWidth;\n  mediump float relativeTexX \x3d mod((u_zoomFactor * v_accumulatedDistance + v_normal.x * lineHalfWidth) / (lineWidthRatio * v_patternSize.x), 1.0);\n  mediump float relativeTexY \x3d 0.5 + 0.5 * v_normal.y;\n  mediump vec2 texCoord \x3d mix(v_tlbr.xy, v_tlbr.zw, vec2(relativeTexX, relativeTexY));\n  mediump float d \x3d rgba2float(texture2D(u_texture, texCoord)) - 0.5;\n  float dist \x3d d * lineHalfWidth;\n  lowp vec4 fillPixelColor \x3d v_opacity * alpha * clamp(0.5 - dist, 0.0, 1.0) * v_color;\n  gl_FragColor \x3d fillPixelColor;\n#elif defined(PATTERN) \x26\x26 !defined(HIGHLIGHT)\n  mediump float relativeTexX \x3d mod((u_zoomFactor * v_accumulatedDistance + v_normal.x * v_lineHalfWidth) / v_patternSize.x, 1.0);\n  mediump float relativeTexY \x3d 0.5 + (v_normal.y * v_lineHalfWidth / v_patternSize.y);\n  mediump vec2 texCoord \x3d mix(v_tlbr.xy, v_tlbr.zw, vec2(relativeTexX, relativeTexY));\n  lowp vec4 color \x3d texture2D(u_texture, texCoord);\n  gl_FragColor \x3d v_opacity * alpha * v_color * color;\n#else\n  gl_FragColor \x3d v_opacity * alpha * v_color;\n#endif\n#ifdef HIGHLIGHT\n  gl_FragColor.a \x3d step(1.0 / 255.0, gl_FragColor.a);\n#endif\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"line.vert":"precision mediump float;\nattribute vec4 a_color;\nattribute vec4 a_offsetAndNormal;\nattribute vec2 a_accumulatedDistanceAndHalfWidth;\nattribute vec4 a_tlbr;\nattribute vec4 a_segmentDirection;\nattribute vec2 a_aux;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/line/common.glsl\x3e\nconst float SCALE \x3d 1.0 / 31.0;\nfloat getBaseLineHalfWidth(in float in_lineHalfWidth) {\n#ifdef VV_SIZE\n  float referenceHalfWidth \x3d a_aux.x * SCALE;\n  float lineWidth \x3d 2.0 * in_lineHalfWidth;\n  return 0.5 * (in_lineHalfWidth / referenceHalfWidth) * getSize(lineWidth);\n#else\n  return in_lineHalfWidth;\n#endif\n}\nfloat getLineHalfWidth(in float baseWidth, in float aa) {\n  float halfWidth \x3d max(baseWidth + aa, 0.45) + 0.1 * aa;\n#ifdef HIGHLIGHT\n  halfWidth \x3d max(halfWidth, 2.0);\n#endif\n  return halfWidth;\n}\nvec2 getDist(in vec2 offset, in float halfWidth) {\n  float thinLineFactor \x3d max(THIN_LINE_WIDTH_FACTOR * step(halfWidth, THIN_LINE_HALF_WIDTH), 1.0);\n#if defined(SDF) \x26\x26 !defined(HIGHLIGHT)\n  thinLineFactor *\x3d 2.0;\n#endif\n  return thinLineFactor * halfWidth * offset * SCALE;\n}\nvoid main()\n{\n  INIT;\n  float a_bitSet          \x3d a_segmentDirection.w;\n  float a_accumulatedDist \x3d a_accumulatedDistanceAndHalfWidth.x;\n  float a_lineHalfWidth   \x3d a_accumulatedDistanceAndHalfWidth.y * SCALE;\n  float aa                \x3d 0.5 * u_antialiasing;\n  vec2  a_offset          \x3d a_offsetAndNormal.xy;\n  float baseWidth \x3d getBaseLineHalfWidth(a_lineHalfWidth);\n  float halfWidth \x3d getLineHalfWidth(baseWidth, aa);\n  float z         \x3d 2.0 * step(baseWidth, 0.0);\n  vec2  dist      \x3d getDist(a_offset, halfWidth);\n  vec3  offset    \x3d u_displayViewMat3 * vec3(dist, 0.0);\n  vec3  pos       \x3d u_dvsMat3 * vec3(a_pos.xy, 1.0) + offset;\n  v_color         \x3d getColor(a_color, a_bitSet, 0);\n  v_opacity       \x3d getOpacity(a_bitSet, 0);\n  v_lineHalfWidth \x3d halfWidth;\n  v_id            \x3d norm(a_id);\n  v_normal        \x3d a_offsetAndNormal.zw * SCALE;\n  v_pos           \x3d vec3(pos.xy, z);\n#ifdef PATTERN\n  v_tlbr          \x3d a_tlbr / u_mosaicSize.xyxy;\n  v_patternSize   \x3d vec2(a_tlbr.z - a_tlbr.x, a_tlbr.w - a_tlbr.y);\n#endif\n#if defined(PATTERN) || defined(SDF)\n  v_accumulatedDistance \x3d a_accumulatedDist + dot(SCALE * a_segmentDirection.xy, dist / u_zoomFactor);\n#endif\n  gl_Position \x3d vec4(applyFilter(v_color, v_pos, getFilterFlags()), 1.0);\n}"},
text:{"common.glsl":"uniform vec2 u_mosaicSize;\nvarying highp vec4 v_id;\nvarying vec3 v_pos;\nvarying float v_opacity;\nvarying vec4 v_color;\nvarying vec2 v_tex;\nvarying float v_antialiasingWidth;\nvarying float v_edgeDistanceOffset;\nvarying lowp float v_transparency;","text.frag":"precision mediump float;\n#include \x3cmaterials/text/common.glsl\x3e\nuniform lowp sampler2D u_texture;\nvoid main()\n{\n  lowp float dist \x3d texture2D(u_texture, v_tex).a;\n  float glyphEdgeDistance \x3d max(0.75 - v_edgeDistanceOffset, 0.25);\n  #ifdef HIGHLIGHT\n    glyphEdgeDistance /\x3d 2.0;\n  #endif\n  lowp float alpha \x3d smoothstep(glyphEdgeDistance - v_antialiasingWidth, glyphEdgeDistance + v_antialiasingWidth, dist) * v_opacity;\n  gl_FragColor \x3d alpha * v_color;\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"text.vert":"precision mediump float;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/text/common.glsl\x3e\nattribute vec4 a_color;\nattribute vec2 a_vertexOffset;\nattribute vec4 a_texFontSize;\nattribute vec4 a_aux;\nfloat getTextSize(inout vec2 offset, in float baseSize, in float referenceSize) {\n#ifdef VV_SIZE\n   float ratio \x3d baseSize / referenceSize;\n   baseSize \x3d ratio * getSize(baseSize);\n#endif\n  return baseSize;\n}\nvoid main()\n{\n  INIT;\n  float a_bitSet    \x3d a_aux.w;\n  float a_fontSize  \x3d a_texFontSize.z;\n  vec2  a_offset    \x3d a_vertexOffset * OFFSET_PRECISION;\n  float a_isHalo    \x3d getBit(a_pos.x, 0);\n  vec3  in_pos      \x3d vec3(floor(a_pos * 0.5), 1.0);\n  float fontSize    \x3d getTextSize(a_offset, a_fontSize, a_aux.z * a_aux.z / 256.0);\n  float scaleFactor \x3d fontSize / a_fontSize;\n  float fontScale   \x3d fontSize / SDF_FONT_SIZE;\n  vec3  offset      \x3d getRotation() * vec3(scaleFactor * a_offset, 0.0);\n  v_color   \x3d a_isHalo * a_color + (1.0 - a_isHalo) * getColor(a_color, a_bitSet, 0);\n  v_opacity \x3d getOpacity(a_bitSet, 0);\n  v_id      \x3d norm(a_id);\n  v_tex     \x3d a_texFontSize.xy / u_mosaicSize;\n  v_pos     \x3d u_dvsMat3 * in_pos + u_displayMat3 * offset;\n  v_edgeDistanceOffset \x3d a_isHalo * OUTLINE_SCALE * a_texFontSize.w / fontScale / MAX_SDF_DISTANCE;\n  v_antialiasingWidth  \x3d 0.105 * SDF_FONT_SIZE / fontSize / u_pixelRatio;\n  gl_Position \x3d  vec4(applyFilter(v_color, v_pos, getFilterFlags()), 1.0);\n}"},
"utils.glsl":"float rshift(in float u32, in int amount) {\n  return floor(u32 / pow(2.0, float(amount)));\n}\nfloat getBit(in float bitset, in int bitIndex) {\n  float offset \x3d pow(2.0, float(bitIndex));\n  return mod(floor(bitset / offset), 2.0);\n}\nfloat getFilterBit(in float bitset, in int bitIndex) {\n  return getBit(bitset, bitIndex + 1);\n}\nfloat getHighlightBit(in float bitset) {\n  return getBit(bitset, 0);\n}\nhighp vec4 unpackLocalIdTexel(in highp vec4 bitset) {\n  float isAggregate \x3d getBit(bitset.a, 7);\n  return (1.0 - isAggregate) * bitset + isAggregate * (vec4(bitset.rgba) - vec4(0.0, 0.0, 0.0, float(0x80)));\n}\nvec4 unpack(in float u32) {\n  float r \x3d mod(rshift(u32, 0), 255.0);\n  float g \x3d mod(rshift(u32, 8), 255.0);\n  float b \x3d mod(rshift(u32, 16), 255.0);\n  float a \x3d mod(rshift(u32, 24), 255.0);\n  return vec4(r, g, b, a);\n}\nvec4 norm(in vec4 v) {\n  return v /\x3d 255.0;\n}\nfloat max4(vec4 target) {\n  return max(max(max(target.x, target.y), target.z), target.w);\n}",
"vcommon.glsl":"#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cmaterials/attributeData.glsl\x3e\n#include \x3cmaterials/vv.glsl\x3e\n#include \x3cmaterials/effects.glsl\x3e\nattribute vec2 a_pos;\nattribute highp vec4 a_id;\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform highp float u_pixelRatio;\nuniform mediump float u_zoomFactor;\nuniform mediump float u_antialiasing;\nvec4 VV_ADATA \x3d vec4(0.0);\nvoid loadVisualVariableData(inout vec4 target) {\n#ifdef OES_TEXTURE_FLOAT\n  target.rgba \x3d getAttributeData2(a_id);\n#else\n  vec4 data0 \x3d getAttributeData2(a_id);\n  vec4 data1 \x3d getAttributeData3(a_id);\n  target.r \x3d u88VVToFloat(data0.rg * 255.0);\n  target.g \x3d u88VVToFloat(data0.ba * 255.0);\n  target.b \x3d u88VVToFloat(data1.rg * 255.0);\n  target.a \x3d u88VVToFloat(data1.ba * 255.0);\n#endif\n}\n#ifdef VV\n  #define INIT loadVisualVariableData(VV_ADATA)\n#else\n  #define INIT\n#endif\nvec4 getColor(in vec4 a_color, in float a_bitSet, int index) {\n#ifdef VV_COLOR\n  float isColorLocked   \x3d getBit(a_bitSet, index);\n  return getVVColor(VV_ADATA[ATTR_VV_COLOR], a_color, isColorLocked);\n#else\n  return a_color;\n#endif\n}\nfloat getOpacity(in float a_bitSet, in int index) {\n#ifdef VV_OPACITY\n  float isOpacityLocked \x3d getBit(a_bitSet, index);\n  return getVVOpacity(VV_ADATA[ATTR_VV_OPACITY], isOpacityLocked);\n#else\n  return 1.0;\n#endif\n}\nfloat getSize(in float in_size) {\n#ifdef VV_SIZE\n  return getVVSize(in_size, VV_ADATA[ATTR_VV_SIZE]);\n#else\n  return in_size;\n#endif\n}\nmat3 getRotation() {\n#ifdef VV_ROTATION\n  return getVVRotationMat3(VV_ADATA[ATTR_VV_ROTATION]);\n#else\n  return mat3(1.0);\n#endif\n}\nfloat getFilterFlags() {\n#ifdef IGNORES_SAMPLER_PRECISION\n  return ceil(getAttributeData0(a_id).x * 255.0);\n#else\n  return getAttributeData0(a_id).x * 255.0;\n#endif\n}\nvec4 getAnimationState() {\n  return getAttributeData1(a_id);\n}\nfloat getMinZoom() {\n  vec4 data0 \x3d getAttributeData0(a_id) * 255.0;\n  return data0.g;\n}\nmat3 getMatrix(float isMapAligned) {\n  return isMapAligned * u_displayViewMat3 + (1.0 - isMapAligned) * u_displayMat3;\n}",
"vv.glsl":"#if defined(VV_SIZE_MIN_MAX_VALUE) || defined(VV_SIZE_SCALE_STOPS) || defined(VV_SIZE_FIELD_STOPS) || defined(VV_SIZE_UNIT_VALUE)\n  #define VV_SIZE\n#endif\n#if defined(VV_COLOR) || defined(VV_SIZE) || defined(VV_OPACITY) || defined(VV_ROTATION)\n  #define VV\n#endif\n#ifdef VV_COLOR\nuniform highp float u_vvColorValues[8];\nuniform vec4 u_vvColors[8];\n#endif\n#ifdef VV_SIZE_MIN_MAX_VALUE\nuniform highp vec4 u_vvSizeMinMaxValue;\n#endif\n#ifdef VV_SIZE_SCALE_STOPS\nuniform highp float u_vvSizeScaleStopsValue;\n#endif\n#ifdef VV_SIZE_FIELD_STOPS\nuniform highp float u_vvSizeFieldStopsValues[6];\nuniform float u_vvSizeFieldStopsSizes[6];\n#endif\n#ifdef VV_SIZE_UNIT_VALUE\nuniform highp float u_vvSizeUnitValueWorldToPixelsRatio;\n#endif\n#ifdef VV_OPACITY\nuniform highp float u_vvOpacityValues[8];\nuniform float u_vvOpacities[8];\n#endif\n#ifdef VV_ROTATION\nuniform lowp float u_vvRotationType;\n#endif\nbool isNan(float val) {\n  return (val \x3d\x3d NAN_MAGIC_NUMBER);\n}\n#ifdef VV_SIZE_MIN_MAX_VALUE\nfloat getVVMinMaxSize(float sizeValue, float fallback) {\n  if (isNan(sizeValue)) {\n    return fallback;\n  }\n  float interpolationRatio \x3d (sizeValue  - u_vvSizeMinMaxValue.x) / (u_vvSizeMinMaxValue.y - u_vvSizeMinMaxValue.x);\n  interpolationRatio \x3d clamp(interpolationRatio, 0.0, 1.0);\n  return u_vvSizeMinMaxValue.z + interpolationRatio * (u_vvSizeMinMaxValue.w - u_vvSizeMinMaxValue.z);\n}\n#endif\n#ifdef VV_SIZE_FIELD_STOPS\nconst int VV_SIZE_N \x3d 6;\nfloat getVVStopsSize(float sizeValue, float fallback) {\n  if (isNan(sizeValue)) {\n    return fallback;\n  }\n  if (sizeValue \x3c\x3d u_vvSizeFieldStopsValues[0]) {\n    return u_vvSizeFieldStopsSizes[0];\n  }\n  for (int i \x3d 1; i \x3c VV_SIZE_N; ++i) {\n    if (u_vvSizeFieldStopsValues[i] \x3e\x3d sizeValue) {\n      float f \x3d (sizeValue - u_vvSizeFieldStopsValues[i-1]) / (u_vvSizeFieldStopsValues[i] - u_vvSizeFieldStopsValues[i-1]);\n      return mix(u_vvSizeFieldStopsSizes[i-1], u_vvSizeFieldStopsSizes[i], f);\n    }\n  }\n  return u_vvSizeFieldStopsSizes[VV_SIZE_N - 1];\n}\n#endif\n#ifdef VV_SIZE_UNIT_VALUE\nfloat getVVUnitValue(float sizeValue, float fallback) {\n  if (isNan(sizeValue)) {\n    return fallback;\n  }\n  return u_vvSizeUnitValueWorldToPixelsRatio * sizeValue;\n}\n#endif\n#ifdef VV_OPACITY\nconst int VV_OPACITY_N \x3d 8;\nfloat getVVOpacity(float opacityValue, float isOpacityLocked) {\n  if (isNan(opacityValue) || isOpacityLocked \x3d\x3d 1.0) {\n    return 1.0;\n  }\n  if (opacityValue \x3c\x3d u_vvOpacityValues[0]) {\n    return u_vvOpacities[0];\n  }\n  for (int i \x3d 1; i \x3c VV_OPACITY_N; ++i) {\n    if (u_vvOpacityValues[i] \x3e\x3d opacityValue) {\n      float f \x3d (opacityValue - u_vvOpacityValues[i-1]) / (u_vvOpacityValues[i] - u_vvOpacityValues[i-1]);\n      return mix(u_vvOpacities[i-1], u_vvOpacities[i], f);\n    }\n  }\n  return u_vvOpacities[VV_OPACITY_N - 1];\n}\n#endif\n#ifdef VV_ROTATION\nmat4 getVVRotation(float rotationValue) {\n  if (isNan(rotationValue)) {\n    return mat4(1, 0, 0, 0,\n                0, 1, 0, 0,\n                0, 0, 1, 0,\n                0, 0, 0, 1);\n  }\n  float rotation \x3d rotationValue;\n  if (u_vvRotationType \x3d\x3d 1.0) {\n    rotation \x3d 90.0 - rotation;\n  }\n  float angle \x3d C_DEG_TO_RAD * rotation;\n  float sinA \x3d sin(angle);\n  float cosA \x3d cos(angle);\n  return mat4(cosA, sinA, 0, 0,\n              -sinA,  cosA, 0, 0,\n              0,     0, 1, 0,\n              0,     0, 0, 1);\n}\nmat3 getVVRotationMat3(float rotationValue) {\n  if (isNan(rotationValue)) {\n    return mat3(1, 0, 0,\n                0, 1, 0,\n                0, 0, 1);\n  }\n  float rotation \x3d rotationValue;\n  if (u_vvRotationType \x3d\x3d 1.0) {\n    rotation \x3d 90.0 - rotation;\n  }\n  float angle \x3d C_DEG_TO_RAD * -rotation;\n  float sinA \x3d sin(angle);\n  float cosA \x3d cos(angle);\n  return mat3(cosA, -sinA, 0,\n             sinA, cosA, 0,\n              0,    0,    1);\n}\n#endif\n#ifdef VV_COLOR\nconst int VV_COLOR_N \x3d 8;\nvec4 getVVColor(float colorValue, vec4 fallback, float isColorLocked) {\n  if (isNan(colorValue) || isColorLocked \x3d\x3d 1.0) {\n    return fallback;\n  }\n  if (colorValue \x3c\x3d u_vvColorValues[0]) {\n    return u_vvColors[0];\n  }\n  for (int i \x3d 1; i \x3c VV_COLOR_N; ++i) {\n    if (u_vvColorValues[i] \x3e\x3d colorValue) {\n      float f \x3d (colorValue - u_vvColorValues[i-1]) / (u_vvColorValues[i] - u_vvColorValues[i-1]);\n      return mix(u_vvColors[i-1], u_vvColors[i], f);\n    }\n  }\n  return u_vvColors[VV_COLOR_N - 1];\n}\n#endif\nfloat getVVSize(in float size, in float vvSize)  {\n#ifdef VV_SIZE_MIN_MAX_VALUE\n  return getVVMinMaxSize(vvSize, size);\n#elif defined(VV_SIZE_SCALE_STOPS)\n  return u_vvSizeScaleStopsValue;\n#elif defined(VV_SIZE_FIELD_STOPS)\n  float outSize \x3d getVVStopsSize(vvSize, size);\n  return isNan(outSize) ? size : outSize;\n#elif defined(VV_SIZE_UNIT_VALUE)\n  return getVVUnitValue(vvSize, size);\n#else\n  return size;\n#endif\n}"},
raster:{bitmap:{"bitmap.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\nuniform sampler2D u_texture;\nuniform highp vec2 u_coordScale;\n#include \x3cfiltering/bicubic.glsl\x3e\nvoid main() {\n#ifdef BICUBIC\n  vec4 color \x3d sampleBicubicBSpline(u_texture, v_texcoord, u_coordScale);\n#else\n  vec4 color \x3d texture2D(u_texture, v_texcoord);\n#endif\n  gl_FragColor \x3d vec4(color.rgb * color.a, color.a);\n}","bitmap.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\n  v_texcoord \x3d a_pos;\n  gl_Position \x3d vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"},
common:{"common.glsl":"uniform sampler2D u_image;\nuniform int u_bandCount;\nuniform bool u_isFloatTexture;\nuniform bool u_flipY;\nuniform bool u_applyTransform;\nuniform float u_opacity;\nuniform int u_resampling;\n#include \x3craster/common/projection.glsl\x3e\nvec2 getPixelLocation(vec2 coords) {\n  vec2 targetLocation \x3d u_flipY ? vec2(coords.s, 1.0 - coords.t) : coords;\n  if (!u_applyTransform) {\n    return targetLocation;\n  }\n  return projectPixelLocation(targetLocation);\n}\nbool isOutside(vec2 coords){\n   if (coords.t\x3e1.00001 ||coords.t\x3c-0.00001 || coords.s\x3e1.00001 ||coords.s\x3c-0.00001) {\n     return true;\n   } else {\n     return false;\n   }\n}\nvec4 getPixel(vec2 pixelLocation) {\n  return texture2D(u_image, pixelLocation);\n}",
"contrastBrightness.glsl":"uniform float u_contrastOffset;\nuniform float u_brightnessOffset;\nvec4 adjustContrastBrightness(vec4 currentPixel, bool isFloat) {\n  vec4 pixelValue \x3d isFloat ? currentPixel * 255.0 : currentPixel;\n  float maxI \x3d 255.0;\n  float mid \x3d 128.0;\n  float c \x3d u_contrastOffset;\n  float b \x3d u_brightnessOffset;\n  vec4 v;\n  if (c \x3e 0.0 \x26\x26 c \x3c 100.0) {\n    v \x3d (200.0 * pixelValue - 100.0 * maxI + 2.0 * maxI * b) / (2.0 * (100.0 - c)) + mid;\n  } else if (c \x3c\x3d 0.0 \x26\x26 c \x3e -100.0) {\n    v \x3d (200.0 * pixelValue - 100.0 * maxI + 2.0 * maxI * b) * (100.0 + c) / 20000.0 + mid;\n  } else if (c \x3d\x3d 100.0) {\n    v \x3d (200.0 * pixelValue - 100.0 * maxI + (maxI + 1.0) * (100.0 - c) + 2.0 * maxI * b);\n    v \x3d (sign(v) + 1.0) / 2.0;\n  } else if (c \x3d\x3d -100.0) {\n    v \x3d vec4(mid, mid, mid, currentPixel.a);\n  }\n  return vec4(v.r / 255.0, v.g / 255.0, v.b / 255.0, currentPixel.a);\n}",
"projection.glsl":"uniform sampler2D u_transformGrid;\nuniform vec2 u_transformSpacing;\nuniform vec2 u_transformGridSize;\nuniform vec2 u_targetImageSize;\nuniform vec2 u_srcImageSize;\nvec2 projectPixelLocation(vec2 coords) {\n  vec2 index_image \x3d floor(coords * u_targetImageSize);\n  vec2 oneTransformPixel \x3d vec2(0.25 / u_transformGridSize.s, 1.0 / u_transformGridSize.t);\n  vec2 index_transform \x3d floor(index_image / u_transformSpacing) / u_transformGridSize;\n  vec2 pos \x3d fract((index_image + vec2(0.5, 0.5)) / u_transformSpacing);\n  vec2 srcLocation;\n  vec2 transform_location \x3d index_transform + oneTransformPixel * 0.5;\n  if (pos.s \x3c\x3d pos.t) {\n    vec4 ll_abc \x3d texture2D(u_transformGrid, vec2(transform_location.s, transform_location.t));\n    vec4 ll_def \x3d texture2D(u_transformGrid, vec2(transform_location.s + oneTransformPixel.s, transform_location.t));\n    srcLocation.s \x3d dot(ll_abc.rgb, vec3(pos, 1.0));\n    srcLocation.t \x3d dot(ll_def.rgb, vec3(pos, 1.0));\n  } else {\n    vec4 ur_abc \x3d texture2D(u_transformGrid, vec2(transform_location.s + 2.0 * oneTransformPixel.s, transform_location.t));\n    vec4 ur_def \x3d texture2D(u_transformGrid, vec2(transform_location.s + 3.0 * oneTransformPixel.s, transform_location.t));\n    srcLocation.s \x3d dot(ur_abc.rgb, vec3(pos, 1.0));\n    srcLocation.t \x3d dot(ur_def.rgb, vec3(pos, 1.0));\n  }\n  return srcLocation;\n}"},
lut:{"colorize.glsl":"uniform sampler2D u_colormap;\nuniform float u_colormapOffset;\nuniform float u_colormapMaxIndex;\nvec4 colorize(vec4 currentPixel, bool isFloat) {\n  float clrIndex \x3d isFloat ? currentPixel.r - u_colormapOffset : currentPixel.r * 255.0 - u_colormapOffset;\n  vec4 result;\n  if (currentPixel.a \x3d\x3d 0.0 || clrIndex \x3e u_colormapMaxIndex) {\n    result \x3d vec4(0.0, 0.0, 0.0, 0.0);\n  } else {\n    vec2 clrPosition \x3d vec2((clrIndex + 0.5) / (u_colormapMaxIndex + 1.0), 0.0);\n    vec4 color \x3d texture2D(u_colormap, clrPosition);\n    result \x3d vec4(color.rgb, color.a * u_opacity);\n  }\n  return result;\n}",
"lut.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\n#include \x3craster/common/common.glsl\x3e\n#include \x3craster/lut/colorize.glsl\x3e\nvoid main() {\n  vec2 pixelLocation \x3d getPixelLocation(v_texcoord);\n  if (isOutside(pixelLocation)) {\n     gl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\n     return;\n  }\n  vec4 currentPixel \x3d getPixel(pixelLocation);\n  gl_FragColor \x3d colorize(currentPixel, true);\n}","lut.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\n  v_texcoord \x3d a_pos;\n  gl_Position \x3d vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"},
stretch:{"stretch.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\n#include \x3craster/common/common.glsl\x3e\nuniform float u_minCutOff[3];\nuniform float u_maxCutOff[3];\nuniform float u_minOutput;\nuniform float u_maxOutput;\nuniform float u_factor[3];\nuniform bool u_useGamma;\nuniform float u_gamma[3];\nuniform float u_gammaCorrection[3];\nuniform bool u_applyColormap;\n#include \x3craster/lut/colorize.glsl\x3e\nfloat stretchOneValue(float val, float minCutOff, float maxCutOff, float minOutput, float maxOutput, float factor, bool useGamma, float gamma, float gammaCorrection) {\n  if (val \x3e\x3d maxCutOff) {\n    return maxOutput;\n  } else if (val \x3c\x3d minCutOff) {\n    return minOutput;\n  }\n  float stretchedVal;\n  if (useGamma) {\n  \tfloat tempf \x3d 1.0;\n\t  float outRange \x3d maxOutput - minOutput;\n\t  float relativeVal \x3d (val - minCutOff) / (maxCutOff - minCutOff);\n\t  if (gamma \x3e 1.0) {\n      tempf -\x3d pow(1.0 / outRange, relativeVal * gammaCorrection);\n    }\n    stretchedVal \x3d floor(tempf * outRange * pow(relativeVal, 1.0 / gamma)) + minOutput;\n  } else {\n    stretchedVal \x3d minOutput + (val - minCutOff) * factor;\n  }\n  return stretchedVal;\n}\nvoid main() {\n  vec2 pixelLocation \x3d getPixelLocation(v_texcoord);\n  if (isOutside(pixelLocation)) {\n     gl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\n     return;\n  }\n  vec4 currentPixel \x3d getPixel(pixelLocation);\n  if (currentPixel.a \x3d\x3d 0.0) {\n    gl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\n    return;\n  }\n  if (u_bandCount \x3d\x3d 1) {\n    float grayVal \x3d stretchOneValue(currentPixel.r, u_minCutOff[0], u_maxCutOff[0], u_minOutput, u_maxOutput, u_factor[0], u_useGamma, u_gamma[0], u_gammaCorrection[0]);\n    if (u_applyColormap) {\n      gl_FragColor \x3d colorize(vec4(grayVal, grayVal, grayVal, currentPixel.a), true);\n    } else {\n      gl_FragColor \x3d vec4(grayVal, grayVal, grayVal, currentPixel.a);\n    }\n  } else {\n    float redVal \x3d stretchOneValue(currentPixel.r, u_minCutOff[0], u_maxCutOff[0], u_minOutput, u_maxOutput, u_factor[0], u_useGamma, u_gamma[0], u_gammaCorrection[0]);\n    float greenVal \x3d stretchOneValue(currentPixel.g, u_minCutOff[1], u_maxCutOff[1], u_minOutput, u_maxOutput, u_factor[1], u_useGamma, u_gamma[1], u_gammaCorrection[1]);\n    float blueVal \x3d stretchOneValue(currentPixel.b, u_minCutOff[2], u_maxCutOff[2], u_minOutput, u_maxOutput, u_factor[2], u_useGamma, u_gamma[2], u_gammaCorrection[2]);\n    gl_FragColor \x3d vec4(redVal, greenVal, blueVal, currentPixel.a);\n  }\n}",
"stretch.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\n  v_texcoord \x3d a_pos;\n  gl_Position \x3d vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"}},stencil:{"stencil.frag":"void main() {\n  gl_FragColor \x3d vec4(1.0, 1.0, 1.0, 1.0);\n}","stencil.vert":"attribute vec2 a_pos;\nvoid main() {\n  gl_Position \x3d vec4(a_pos, 0.0, 1.0);\n}"},tileInfo:{"tileInfo.frag":"uniform mediump sampler2D u_texture;\nvarying mediump vec2 v_tex;\nvoid main(void) {\n  lowp vec4 color \x3d texture2D(u_texture, v_tex);\n  gl_FragColor \x3d 0.75 * color;\n}",
"tileInfo.vert":"attribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform mediump float u_depth;\nuniform mediump vec2 u_coord_ratio;\nuniform mediump vec2 u_delta;\nuniform mediump vec2 u_dimensions;\nvarying mediump vec2 v_tex;\nvoid main() {\n  mediump vec2 offset \x3d u_coord_ratio * vec2(u_delta + a_pos * u_dimensions);\n  vec3 v_pos \x3d u_dvsMat3 * vec3(offset, 1.0);\n  gl_Position \x3d vec4(v_pos.xy, 0.0, 1.0);\n  v_tex \x3d a_pos;\n}"},util:{"encoding.glsl":"const vec4 rgba2float_factors \x3d vec4(\n    255.0 / (256.0),\n    255.0 / (256.0 * 256.0),\n    255.0 / (256.0 * 256.0 * 256.0),\n    255.0 / (256.0 * 256.0 * 256.0 * 256.0)\n  );\nfloat rgba2float(vec4 rgba) {\n  return dot(rgba, rgba2float_factors);\n}"}}})},
"esri/views/2d/engine/webgl/shaders/TileInfoPrograms":function(){define(["require","exports","./sources/resolver"],function(g,a,d){Object.defineProperty(a,"__esModule",{value:!0});a.tileInfo={name:"tileInfo",shaders:{vertexShader:d.resolveIncludes("tileInfo/tileInfo.vert"),fragmentShader:d.resolveIncludes("tileInfo/tileInfo.frag")},attributes:{a_pos:0}}})},"esri/views/2d/engine/webgl/brushes/WGLBrushStencil":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/libs/gl-matrix-2/vec4f32 ../../../../webgl ./WGLBrush ../shaders/BackgroundPrograms".split(" "),
function(g,a,d,h,b,e,m){Object.defineProperty(a,"__esModule",{value:!0});g=function(a){function c(){var c=null!==a&&a.apply(this,arguments)||this;c._color=h.vec4f32.fromValues(1,0,0,1);c._initialized=!1;return c}d(c,a);c.prototype.dispose=function(){this._solidProgram&&(this._solidProgram.dispose(),this._solidProgram=null);this._solidVertexArrayObject&&(this._solidVertexArrayObject.dispose(),this._solidVertexArrayObject=null)};c.prototype.prepareState=function(a,c){a=a.context;a.setDepthWriteEnabled(!1);
a.setDepthTestEnabled(!1);a.setStencilTestEnabled(!0);a.setBlendingEnabled(!1);a.setColorMask(!1,!1,!1,!1);a.setStencilOp(7680,7680,7681);a.setStencilWriteMask(255);a.setStencilFunctionSeparate(1032,516,c.stencilRef,255)};c.prototype.draw=function(a,c){a=a.context;this._initialized||this._initialize(a);a.bindVAO(this._solidVertexArrayObject);a.bindProgram(this._solidProgram);this._solidProgram.setUniformMatrix3fv("u_dvsMat3",c.transforms.dvs);this._solidProgram.setUniform2fv("u_coord_range",c.coordRange);
this._solidProgram.setUniform1f("u_depth",0);this._solidProgram.setUniform4fv("u_color",this._color);a.drawArrays(5,0,4);a.bindVAO()};c.prototype._initialize=function(a){if(this._initialized)return!0;var c=b.createProgram(a,m.background);if(!c)return!1;var f=new Int8Array([0,0,1,0,0,1,1,1]),f=b.BufferObject.createVertex(a,35044,f);a=new b.VertexArrayObject(a,m.background.attributes,{geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}]},{geometry:f});this._solidProgram=
c;this._solidVertexArrayObject=a;return this._initialized=!0};return c}(e.default);a.default=g})},"esri/views/2d/engine/RasterTile":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/decorateHelper ./RasterBitmap ./webgl/TiledDisplayObject".split(" "),function(g,a,d,h,b,e){Object.defineProperty(a,"__esModule",{value:!0});g=function(a){function c(c,f,e,m){void 0===m&&(m=null);var l=a.call(this,c,f,e)||this;c=l.requestRender.bind(l);l.bitmap=new b.RasterBitmap(m,
null,null,c);l.bitmap.coordScale=e;l.bitmap.once("isReady",function(){return l.ready()});return l}d(c,a);Object.defineProperty(c.prototype,"stencilRef",{get:function(){return this.bitmap.stencilRef},set:function(a){this.bitmap.stencilRef=a},enumerable:!0,configurable:!0});c.prototype.setTransform=function(c,b){a.prototype.setTransform.call(this,c,b);this.bitmap.transforms.dvs=this.transforms.dvs};c.prototype.attach=function(){this.bitmap.stage=this.stage;var a=this.bitmap.attach();a&&(this.bitmap.attached=
!0);return a};c.prototype.detach=function(){this.bitmap.detach()};return c}(e.TiledDisplayObject);a.RasterTile=g})},"esri/views/2d/engine/RasterBitmap":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/assignHelper ../../../core/libs/gl-matrix-2/mat3 ../../../core/libs/gl-matrix-2/mat3f32 ../../../core/libs/gl-matrix-2/vec2f32 ../../../layers/support/rasterFunctions/pixelUtils ./DisplayObject ./webgl/WGLRasterUtils".split(" "),function(g,a,d,h,b,e,m,
c,l,f){function t(a){n.has(a)&&(x.splice(x.indexOf(a),1),n.delete(a))}Object.defineProperty(a,"__esModule",{value:!0});var x=[],n=new Set;g=function(a){function l(c,b,f,l){void 0===c&&(c=null);void 0===b&&(b=null);void 0===f&&(f=null);void 0===l&&(l=function(){return null});var k=a.call(this)||this;k.stencilRef=0;k.coordScale=[1,1];k.height=null;k.pixelRatio=1;k.resolution=0;k.rotation=0;k._source=null;k._bandIds=null;k._interpolation=null;k._transformGrid=null;k.width=null;k.x=0;k.y=0;k.transforms=
{dvs:e.mat3f32.create()};k.source=c;k.transformGrid=b;k.interpolation=f;k.requestRender=l;return k}d(l,a);Object.defineProperty(l.prototype,"source",{get:function(){return this._source},set:function(a){this._source=a;this._rasterTexture&&(this._rasterTexture.dispose(),this._rasterTexture=null)},enumerable:!0,configurable:!0});Object.defineProperty(l.prototype,"bandIds",{get:function(){return this._bandIds},set:function(a){this.attached&&this._updateRasterTexture(a);this._bandIds=a},enumerable:!0,
configurable:!0});Object.defineProperty(l.prototype,"interpolation",{get:function(){return this._interpolation},set:function(a){this._interpolation=a;this._rasterTexture&&this._rasterTexture.setSamplingMode("bilinear"===a?9729:9728)},enumerable:!0,configurable:!0});Object.defineProperty(l.prototype,"transformGrid",{get:function(){return this._transformGrid},set:function(a){this._transformGrid=a;this._transformGridTexture&&(this._transformGridTexture.dispose(),this._transformGridTexture=null)},enumerable:!0,
configurable:!0});l.prototype.attach=function(){this.updateTexture();return!0};l.prototype.detach=function(){this._rasterTexture&&(this._rasterTexture.dispose(),this._rasterTexture=null);this._transformGridTexture&&(this._transformGridTexture.dispose(),this._transformGridTexture=null);this._colormapTexture&&(this._colormapTexture.dispose(),this._colormapTexture=null);t(this)};l.prototype.invalidateTexture=function(){this.attached?this.updateTexture():t(this)};l.prototype.setTransform=function(a){var c=
b.mat3.identity(this.transforms.dvs),f=a.toScreenNoRotation([0,0],this.x,this.y),l=this.resolution/this.pixelRatio/a.resolution,e=l*this.width,l=l*this.height,u=Math.PI*this.rotation/180;b.mat3.translate(c,c,m.vec2f32.fromValues(f[0],f[1]));b.mat3.translate(c,c,m.vec2f32.fromValues(e/2,l/2));b.mat3.rotate(c,c,-u);b.mat3.translate(c,c,m.vec2f32.fromValues(-e/2,-l/2));b.mat3.scaleByVec2(c,c,m.vec2f32.fromValues(e,l));b.mat3.multiply(this.transforms.dvs,a.displayViewMat3,c)};l.prototype.updateTexture=
function(){var a=this.stage.context,c=this.source,c=c&&c.pixels&&0<c.pixels.length;!this._rasterTexture&&c&&this._updateRasterTexture(this.bandIds);this._rasterTexture&&c&&(this._updateColormapTexture(),this.transformGrid&&!this._transformGridTexture&&(this._transformGridTexture=f.createTransformTexture(a,this.transformGrid)));this._rasterTexture&&!c&&this._rasterTexture.setData(null);this.ready();this.requestRender()};l.prototype.getUniforms=function(){var a=this.source,c=this.transformGrid,b;switch(this.symbolizerParameters.type){case "lut":b=
this._getColormapUniforms();break;case "stretch":b=this._getStretchUniforms()}a=h({},b,{u_srcImageSize:[a.width,a.height],u_resampling:"nearest",u_flipY:!0,u_applyTransform:c?!0:!1,u_dvsMat3:this.transforms.dvs});this.transformGrid&&(a.u_transformSpacing=c.spacing,a.u_transformGridSize=c.size,a.u_targetImageSize=new Float32Array([this.width,this.height]));return a};l.prototype.getTextures=function(){if(!this._rasterTexture)return null;var a=[],c=[];this._transformGridTexture&&(c.push(this._transformGridTexture),
a.push("u_transformGrid"));this._rasterTexture&&(c.push(this._rasterTexture),a.push("u_image"));this._colormapTexture&&(c.push(this._colormapTexture),a.push("u_colormap"));return{names:a,textures:c}};l.prototype._getColormapUniforms=function(){var a=this.symbolizerParameters;return{u_colormapOffset:a.colormapOffset||0,u_colormapMaxIndex:a.colormap.length/4-1,u_isFloatTexture:!1}};l.prototype._getStretchUniforms=function(){var a=this.symbolizerParameters;return{u_bandCount:a.bandCount,u_minOutput:a.outMin,
u_maxOutput:a.outMax,u_minCutOff:a.minCutOff,u_maxCutOff:a.maxCutOff,u_factor:a.factor,u_useGamma:a.useGamma,u_gamma:a.gamma,u_gammaCorrection:a.gammaCorrection,u_contrast:a.contrast,u_brightness:a.brightness}};l.prototype._updateRasterTexture=function(a){var b=this.source?c.extractBands(this.source,a):null;if(b&&b.pixels&&0<b.pixels.length){a=null==a&&null==this.bandIds||a&&this.bandIds&&a.join("")===this.bandIds.join("");if(this._rasterTexture){if(a)return;this._rasterTexture.dispose();this._rasterTexture=
null}this._rasterTexture=f.createRasterTexture(this.stage.context,b,this.interpolation||"nearest")}else this._rasterTexture&&(this._rasterTexture.dispose(),this._rasterTexture=null)};l.prototype._updateColormapTexture=function(){var a=this._colormap,c=this.symbolizerParameters.colormap;if(c){var b=this.stage.context;if(!a)this._colormapTexture=f.createColormapTexture(b,c),this._colormap=c;else if(c.length!==a.length||c.some(function(c,b){return c!==a[b]}))this._colormapTexture&&(this._colormapTexture.dispose(),
this._colormapTexture=null),this._colormapTexture=f.createColormapTexture(b,c),this._colormap=c}else this._colormapTexture&&(this._colormapTexture.dispose(),this._colormapTexture=null),this._colormap=null};return l}(l.DisplayObject);a.RasterBitmap=g})},"esri/layers/support/rasterFunctions/pixelUtils":function(){define(["require","exports","../PixelBlock"],function(g,a,d){function h(a,b){a=Math.min(Math.max(a,-100),100);b=Math.min(Math.max(b,-100),100);var c,l,e=new Uint8Array(256);for(c=0;256>c;c++)0<
a&&100>a?l=(200*c-25500+510*b)/(2*(100-a))+128:0>=a&&-100<a?l=(200*c-25500+510*b)*(100+a)/2E4+128:100===a?(l=200*c-25500+256*(100-a)+510*b,l=0<l?255:0):-100===a&&(l=128),e[c]=255<l?255:0>l?0:l;return e}function b(a,b,f,e,m,n,p,y){return{xmin:m<=f*a?0:m<f*a+a?m-f*a:a,ymin:n<=e*b?0:n<e*b+b?n-e*b:b,xmax:m+p<=f*a?0:m+p<f*a+a?m+p-f*a:a,ymax:n+y<=e*b?0:n+y<e*b+b?n+y-e*b:b}}function e(a,l,f,e){var c=a.filter(function(a){return m(a)})[0];if(null==c)return null;var n=e?e.width:l.width;e=e?e.height:l.height;
var p=c.width,t=c.height,u=l.width/p;l=l.height/t;var k=f?f.x:0;f=f?f.y:0;var r=c.pixelType,z=d.getPixelArrayConstructor(r),q=c.pixels.length,c=[],h,A,g,C,D,I,L,H,G,M;for(D=0;D<q;D++){A=new z(n*e);for(I=0;I<l;I++)for(L=0;L<u;L++)if(g=a[I*u+L])for(h=g.pixels[D],M=b(p,t,L,I,k,f,n,e),H=M.ymin;H<M.ymax;H++)for(g=(I*t+H-f)*n+(L*p-k),C=H*p,G=M.xmin;G<M.xmax;G++)A[g+G]=h[C+G];c.push(A)}var O;if(a.some(function(a){return null==a||a.mask&&0<a.mask.length}))for(O=new Uint8Array(n*e),I=0;I<l;I++)for(L=0;L<u;L++)if(z=
(g=a[I*u+L])?g.mask:null,M=b(p,t,L,I,k,f,n,e),z)for(H=M.ymin;H<M.ymax;H++)for(g=(I*t+H-f)*n+(L*p-k),C=H*p,G=M.xmin;G<M.xmax;G++)O[g+G]=z[C+G];else if(g)for(H=M.ymin;H<M.ymax;H++)for(g=(I*t+H-f)*n+(L*p-k),C=H*p,G=M.xmin;G<M.xmax;G++)O[g+G]=1;else for(H=M.ymin;H<M.ymax;H++)for(g=(I*t+H-f)*n+(L*p-k),C=H*p,G=M.xmin;G<M.xmax;G++)O[g+G]=0;a=new d({width:n,height:e,pixels:c,pixelType:r,mask:O});a.updateStatistics();return a}Object.defineProperty(a,"__esModule",{value:!0});var m=function(a){return a&&"esri.layers.support.PixelBlock"===
a.declaredClass&&a.pixels&&0<a.pixels.length};a.extractBands=function(a,b){if(!b||!m(a))return a;var c=a.pixels.length;return b&&b.some(function(a){return a>=c})||1===c&&1===b.length&&0===b[0]||c===b.length&&!b.some(function(a,c){return a!==c})?a:new d({pixelType:a.pixelType,width:a.width,height:a.height,mask:a.mask,validPixelCount:a.validPixelCount,maskIsAlpha:a.maskIsAlpha,pixels:b.map(function(c){return a.pixels[c]}),statistics:a.statistics&&b.map(function(c){return a.statistics[c]})})};a.createColormapLUT=
function(a){if(a){var c=a.colormap;if(c&&0!==c.length){var c=c.sort(function(a,c){return a[0]-c[0]}),b=0;0>c[0][0]&&(b=c[0][0]);var e=Math.max(256,c[c.length-1][0]-b+1),m=new Uint8Array(4*e),n=[],p=0,d=0,u=5===c[0].length;if(65536<e)return c.forEach(function(a){n[a[0]-b]=u?a.slice(1):a.slice(1).concat([255])}),{indexed2DColormap:n,offset:b,alphaSpecified:u};if(a.fillUnspecified)for(a=c[d],p=a[0]-b;p<e;p++)m[4*p]=a[1],m[4*p+1]=a[2],m[4*p+2]=a[3],m[4*p+3]=u?a[4]:255,p===a[0]-b&&(a=d===c.length-1?a:
c[++d]);else for(p=0;p<c.length;p++)a=c[p],d=4*(a[0]-b),m[d]=a[1],m[d+1]=a[2],m[d+2]=a[3],m[d+3]=u?a[4]:255;return{indexedColormap:m,offset:b,alphaSpecified:u}}}};a.colorize=function(a,b){if(!m(a)||!b&&(b.indexedColormap||b.indexed2DColormap))return a;var c=a.clone(),e=c.pixels,l=c.mask,n=c.width*c.height;if(1!==e.length)return a;var p=b.indexedColormap;a=b.indexed2DColormap;var d=b.offset;b=b.alphaSpecified;var u=p.length-1,k=0,e=e[0],r=new Uint8Array(e.length),z=new Uint8Array(e.length),q=new Uint8Array(e.length),
h=0;if(p)if(l)for(k=0;k<n;k++)l[k]&&(h=4*(e[k]-d),h<d||h>u?l[k]=0:(r[k]=p[h],z[k]=p[h+1],q[k]=p[h+2],l[k]=p[h+3]));else{l=new Uint8Array(n);for(k=0;k<n;k++)h=4*(e[k]-d),h<d||h>u?l[k]=0:(r[k]=p[h],z[k]=p[h+1],q[k]=p[h+2],l[k]=p[h+3]);c.mask=l}else if(l)for(k=0;k<n;k++)l[k]&&(p=a[e[k]],r[k]=p[0],z[k]=p[1],q[k]=p[2],l[k]=p[3]);else{l=new Uint8Array(n);for(k=0;k<n;k++)p=a[e[k]],r[k]=p[0],z[k]=p[1],q[k]=p[2],l[k]=p[3];c.mask=l}c.pixels=[r,z,q];c.statistics=null;c.pixelType="u8";c.maskIsAlpha=b;return c};
a.estimateStatisticsHistograms=function(a){if(!m(a))return null;var c=a.pixels,b=a.mask,e=a.pixelType,d=a.statistics;a=a.width*a.height;var n=c.length,p,y,u,k,r,z=[],q=[],h,A,g;for(k=0;k<n;k++){h=new Uint32Array(256);g=c[k];if("u8"===e)if(p=-.5,y=255.5,b)for(r=0;r<a;r++)b[r]&&h[g[r]]++;else for(r=0;r<a;r++)h[g[r]]++;else{p=d[k].minValue;y=d[k].maxValue;u=(y-p)/256;A=new Uint32Array(257);if(b)for(r=0;r<a;r++)b[r]&&A[Math.floor((g[r]-p)/u)]++;else for(r=0;r<a;r++)A[Math.floor((g[r]-p)/u)]++;for(r=0;255>
r;r++)h[r]=A[r];h[255]=A[255]+A[256]}z.push({min:p,max:y,size:256,counts:h});for(r=g=A=u=0;256>r;r++)u+=h[r],A+=r*h[r];A/=u;for(r=0;256>r;r++)g+=h[r]*Math.pow(r-A,2);h=Math.sqrt(g/(u-1));u=(y-p)/256;r=(A+.5)*u+p;h*=u;q.push({min:p,max:y,avg:r,stddev:h})}return{statistics:q,histograms:z}};a.createStretchLUT=function(a){var c=a.minCutOff,b=a.maxCutOff,e=a.gamma,m=a.pixelType,n=a.outMin||0,p=a.outMax||255;if(-1===["u8","u16","s8","s16"].indexOf(m))return null;var d=c.length,u,k=0;"s8"===m?k=-127:"s16"===
m&&(k=-32767);var r=256;-1<["u16","s16"].indexOf(m)&&(r=65536);for(var z=[],q=p-n,m=0;m<d;m++)z[m]=b[m]-c[m];u=e&&e.length>=d;var g=[];if(u)for(m=0;m<d;m++)g[m]=1<e[m]?2<e[m]?6.5+Math.pow(e[m]-2,2.5):6.5+100*Math.pow(2-e[m],4):1;var A,B=[],C,D,I;if(u)for(m=0;m<d;m++){I=[];for(u=0;u<r;u++)C=u+k,A=(C-c[m])/z[m],D=1,1<e[m]&&(D-=Math.pow(1/q,A*g[m])),I[u]=C<b[m]&&C>c[m]?Math.floor(D*q*Math.pow(A,1/e[m]))+n:C>=b[m]?p:n;B[m]=I}else for(m=0;m<d;m++){I=[];for(u=0;u<r;u++)C=u+k,I[u]=C<=c[m]?n:C>=b[m]?p:Math.floor((C-
c[m])/z[m]*q)+n;B[m]=I}if(null!=a.contrastOffset)for(a=h(a.contrastOffset,a.brightnessOffset),m=0;m<d;m++)for(I=B[m],u=0;u<r;u++)I[u]=a[I[u]];return{lut:B,offset:k}};a.createContrastBrightnessLUT=h;a.stretch=function(a,b){if(!m(a))return null;a=a.clone();var c=a.pixels,e=a.mask,l=b.minCutOff,n=b.maxCutOff,p=b.gamma,d=b.outMin||0;b=b.outMax||255;var u=a.width*a.height,k=c.length,r,z,q,h,A,g=b-d,C=[];for(r=0;r<k;r++)C[r]=n[r]-l[r];z=p&&p.length>=k;var D=[];if(z)for(r=0;r<k;r++)D[r]=1<p[r]?2<p[r]?6.5+
Math.pow(p[r]-2,2.5):6.5+100*Math.pow(2-p[r],4):1;if(z)if(null!=e)for(z=0;z<u;z++){if(e[z])for(r=0;r<k;r++)q=c[r][z],A=(q-l[r])/C[r],h=1,1<p[r]&&(h-=Math.pow(1/g,A*D[r])),c[r][z]=q<n[r]&&q>l[r]?Math.floor(h*g*Math.pow(A,1/p[r]))+d:q>=n[r]?b:d}else for(z=0;z<u;z++)for(r=0;r<k;r++)q=c[r][z],A=(q-l[r])/C[r],h=1,1<p[r]&&(h-=Math.pow(1/g,A*D[r])),c[r][z]=q<n[r]&&q>l[r]?Math.floor(h*g*Math.pow(A,1/p[r]))+d:q>=n[r]?b:d;else if(null!=e)for(z=0;z<u;z++){if(e[z])for(r=0;r<k;r++)q=c[r][z],c[r][z]=q<n[r]&&q>
l[r]?Math.floor((q-l[r])/C[r]*g)+d:q>=n[r]?b:d}else for(z=0;z<u;z++)for(r=0;r<k;r++)q=c[r][z],c[r][z]=q<n[r]&&q>l[r]?Math.floor((q-l[r])/C[r]*g)+d:q>=n[r]?b:d;a.pixelType="u8";a.updateStatistics();return a};a.lookupPixels=function(a,b){if(!m(a))return null;var c=a.pixels,e=a.mask,l=a.width*a.height,n=c.length,p=b.lut;b=b.offset;var y,u;p&&1===p[0].length&&(p=c.map(function(){return p}));var k=[],r,z,q;if(b)if(null==e)for(y=0;y<n;y++){r=c[y];z=p[y];q=new Uint8Array(l);for(u=0;u<l;u++)q[u]=z[r[u]-b];
k.push(q)}else for(y=0;y<n;y++){r=c[y];z=p[y];q=new Uint8Array(l);for(u=0;u<l;u++)e[u]&&(q[u]=z[r[u]-b]);k.push(q)}else if(null==e)for(y=0;y<n;y++){r=c[y];z=p[y];q=new Uint8Array(l);for(u=0;u<l;u++)q[u]=z[r[u]];k.push(q)}else for(y=0;y<n;y++){r=c[y];z=p[y];q=new Uint8Array(l);for(u=0;u<l;u++)e[u]&&(q[u]=z[r[u]]);k.push(q)}a=new d({width:a.width,height:a.height,pixels:k,mask:e,pixelType:"u8"});a.updateStatistics();return a};a.remapColor=function(a,b){if(!m(a))return null;a=a.clone();var c=a.width*
a.height,e=b.length,l=Math.floor(e/2),n=b[Math.floor(l)],p=a.pixels[0],d,u,k,r,z,q,h=!1,A=new Uint8Array(c),g=new Uint8Array(c),C=new Uint8Array(c),D=a.mask,I=4===b[0].mappedColor.length;D||(D=new Uint8Array(c),D.fill(I?255:1),a.mask=D);for(z=0;z<c;z++)if(D[z]){d=p[z];h=!1;q=l;u=n;k=0;for(r=e-1;1<r-k;){if(d===u.value){h=!0;break}d>u.value?k=q:r=q;q=Math.floor((k+r)/2);u=b[Math.floor(q)]}h||(d===b[k].value?(u=b[k],h=!0):d===b[r].value?(u=b[r],h=!0):d<b[k].value?(h=!1,u=null):d>b[k].value&&(d<b[r].value?
(u=b[k],h=!0):r===e-1?(h=!1,u=null):(u=b[r],h=!0)));h?(A[z]=u.mappedColor[0],g[z]=u.mappedColor[1],C[z]=u.mappedColor[2],D[z]=u.mappedColor[3]):A[z]=g[z]=C[z]=D[z]=0}a.pixels=[A,g,C];a.mask=D;a.pixelType="u8";a.maskIsAlpha=I;return a};a.getClipBounds=b;a.mosaicPixelData=function(a,b){if(!a||0===a.length)return null;var c=a.filter(function(a){return a.pixelBlock})[0];if(!c)return null;var l=(c.extent.xmax-c.extent.xmin)/c.pixelBlock.width,m=(c.extent.ymax-c.extent.ymin)/c.pixelBlock.height,n=.01*Math.min(l,
m),p=a.sort(function(a,b){return Math.abs(a.extent.ymax-b.extent.ymax)>n?b.extent.ymax-a.extent.ymax:Math.abs(a.extent.xmin-b.extent.xmin)>n?a.extent.xmin-b.extent.xmin:0}),d=Math.min.apply(null,p.map(function(a){return a.extent.xmin})),u=Math.min.apply(null,p.map(function(a){return a.extent.ymin})),k=Math.max.apply(null,p.map(function(a){return a.extent.xmax})),r=Math.max.apply(null,p.map(function(a){return a.extent.ymax}));a={x:Math.round((b.xmin-d)/l),y:Math.round((r-b.ymax)/m)};d={width:Math.round((k-
d)/l),height:Math.round((r-u)/m)};l={width:Math.round((b.xmax-b.xmin)/l),height:Math.round((b.ymax-b.ymin)/m)};if(Math.round(d.width/c.pixelBlock.width)*Math.round(d.height/c.pixelBlock.height)!==p.length||0>a.x||0>a.y||d.width<l.width||d.height<l.height)return null;c=p.map(function(a){return a.pixelBlock});c=e(c,d,a,l);return{extent:b,pixelBlock:c}};a.mosaic=e;a.setValidBoundary=function(a,b,e){if(!m(a))return null;var c=a.width,l=a.height,f=b.x;b=b.y;var p=e.width+f;e=e.height+b;if(0>f||0>b||p>
c||e>l||0===f&&0===b&&p===c&&e===l)return a;a.mask||(a.mask=new Uint8Array(c*l));for(var d=a.mask,u=0;u<l;u++)for(var k=u*c,r=0;r<c;r++)d[k+r]=u<b||u>=e||r<f||r>=p?0:1;a.updateStatistics();return a};a.clip=function(a,b,e){if(!m(a))return null;var c=b.x,l=b.y,f=b.x+e.width;b=b.x+e.height;if(b===a.height&&f===a.width)return a;for(var p=a.pixels,y=a.mask,u=a.width,k=u*a.height,r=p.length,z=[],q=0;q<r;q++){for(var h=p[q],A=d.createEmptyBand(a.pixelType,k),g=0,C=l;C<=b;C++)for(var D=C*u,I=c;I<=f;I++)A[g++]=
h[D+I];z.push(A)}var L;if(y)for(L=new Uint8Array(e.width*e.height),g=0,C=l;C<=b;C++)for(D=C*u,I=c;I<=f;I++)L[g++]=y[D+I];a=new d({width:e.width,height:e.height,pixels:z,mask:L});a.updateStatistics();return a};a.approximateTransform=function(a,b,e,t){if(!m(a))return null;var c=a.pixels,l=a.mask,f=a.pixelType,y=a.width,u=a.height;a=d.getPixelArrayConstructor(f);var k=c.length,r=b.width,z=b.height;b=t.cols;t=t.rows;for(var q=Math.ceil(r/b),h=Math.ceil(z/t),A,g,C,D,I,L,H,G=new Uint16Array(r*z),M=new Uint16Array(r*
z),O=0,K,Q,P=0;P<h;P++)for(var N=0;N<q;N++){A=12*(P*q+N);g=e[A];C=e[A+1];D=e[A+2];I=e[A+3];L=e[A+4];H=e[A+5];for(var J=0;J<t;J++){O=(P*t+J)*r+N*b;Q=(J+.5)/t;for(var R=0;R<J;R++)K=(R+.5)/b,G[O+R]=Math.round((g*K+C*Q+D)*y-.5),M[O+R]=Math.round((I*K+L*Q+H)*u-.5)}A+=6;g=e[A];C=e[A+1];D=e[A+2];I=e[A+3];L=e[A+4];H=e[A+5];for(J=0;J<t;J++)for(O=(P*t+J)*r+N*b,Q=(J+.5)/t,R=J;R<b;R++)K=(R+.5)/b,G[O+R]=Math.round((g*K+C*Q+D)*y-.5),M[O+R]=Math.round((I*K+L*Q+H)*u-.5)}e=function(a,b){for(var c=0;c<z;c++){A=c*r;
for(var k=0;k<r;k++)a[A]=b[G[A]+M[A]*y],A++}};u=[];for(t=0;t<k;t++)b=new a(r*z),e(b,c[t]),u.push(b);c=new d({width:r,height:z,pixelType:f,pixels:u});l&&(c.mask=new Uint8Array(r*z),e(c.mask,l));c.updateStatistics();return c}})},"esri/layers/support/PixelBlock":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/compilerUtils ../../core/Error ../../core/JSONSupport ../../core/lang ../../core/Logger ../../core/accessorSupport/decorators".split(" "),
function(g,a,d,h,b,e,m,c,l,f){var t=l.getLogger("esri.layers.support.PixelBlock");return function(a){function l(b){b=a.call(this,b)||this;b.width=null;b.height=null;b.pixelType="f32";b.validPixelCount=null;b.mask=null;b.maskIsAlpha=!1;b.pixels=null;b.statistics=null;return b}d(l,a);p=l;l.createEmptyBand=function(a,b){return new (p.getPixelArrayConstructor(a))(b)};l.getPixelArrayConstructor=function(a){var c;switch(a){case "u1":case "u2":case "u4":case "u8":c=Uint8Array;break;case "u16":c=Uint16Array;
break;case "u32":c=Uint32Array;break;case "s8":c=Int8Array;break;case "s16":c=Int16Array;break;case "s32":c=Int32Array;break;case "u32":c=Uint32Array;break;case "f32":c=Float32Array;break;case "f64":c=Float64Array;break;case "c64":case "c128":case "unknown":c=Float32Array;break;default:b.neverReached(a)}return c};l.prototype.castPixelType=function(a){if(!a)return"f32";a=a.toLowerCase();-1<["u1","u2","u4"].indexOf(a)?a="u8":-1==="unknown u8 s8 u16 s16 u32 s32 f32 f64".split(" ").indexOf(a)&&(a="f32");
return a};l.prototype.getPlaneCount=function(){return this.pixels&&this.pixels.length};l.prototype.addData=function(a){if(!a.pixels||a.pixels.length!==this.width*this.height)throw new e("pixelblock:invalid-or-missing-pixels","add data requires valid pixels array that has same length defined by pixel block width * height");this.pixels||(this.pixels=[]);this.statistics||(this.statistics=[]);this.pixels.push(a.pixels);this.statistics.push(a.statistics||{minValue:null,maxValue:null})};l.prototype.getAsRGBA=
function(){var a=new ArrayBuffer(this.width*this.height*4);switch(this.pixelType){case "s8":case "s16":case "u16":case "s32":case "u32":case "f32":case "f64":this._fillFromNon8Bit(a);break;default:this._fillFrom8Bit(a)}return new Uint8ClampedArray(a)};l.prototype.getAsRGBAFloat=function(){var a=new Float32Array(this.width*this.height*4);this._fillFrom32Bit(a);return a};l.prototype.updateStatistics=function(){var a=this;this.statistics=this.pixels.map(function(b){return a._calculateBandStatistics(b,
a.mask)});var b=this.mask,c=0;if(b)for(var e=0;e<b.length;e++)b[e]&&c++;else c=this.width*this.height;this.validPixelCount=c};l.prototype.clamp=function(a){if(a&&"f64"!==a&&"f32"!==a){var b;switch(a){case "u8":b=[0,255];break;case "u16":b=[0,65535];break;case "u32":b=[0,4294967295];break;case "s8":b=[-128,127];break;case "s16":b=[-32768,32767];break;case "s32":b=[-2147483648,2147483647];break;default:b=[-3.4*1E39,3.4*1E39]}var c=b[0];b=b[1];for(var e=this.pixels,l=this.width*this.height,f=e.length,
m,n,d,t=[],y=0;y<f;y++){d=p.createEmptyBand(a,l);m=e[y];for(var h=0;h<l;h++)n=m[h],d[h]=n>b?b:n<c?c:n;t.push(d)}this.pixels=t;this.pixelType=a}};l.prototype.clone=function(){var a=new p({width:this.width,height:this.height,pixelType:this.pixelType,maskIsAlpha:this.maskIsAlpha,validPixelCount:this.validPixelCount});this.mask&&(a.mask=this.mask instanceof Uint8Array?new Uint8Array(this.mask):this.mask.slice(0));var b,k=p.getPixelArrayConstructor(this.pixelType);if(this.pixels&&0<this.pixels.length){a.pixels=
[];var e=this.pixels[0].slice;for(b=0;b<this.pixels.length;b++)a.pixels[b]=e?this.pixels[b].slice(0,this.pixels[b].length):new k(this.pixels[b])}if(this.statistics)for(a.statistics=[],b=0;b<this.statistics.length;b++)a.statistics[b]=c.clone(this.statistics[b]);return a};l.prototype._fillFrom8Bit=function(a){var b=this.mask,c=this.maskIsAlpha,e=this.pixels;if(a&&e&&e.length){var l,f,p;l=f=p=e[0];3<=e.length?(f=e[1],p=e[2]):2===e.length&&(f=e[1]);a=new Uint32Array(a);e=this.width*this.height;if(l.length!==
e)t.error("getAsRGBA()","Unable to convert to RGBA. The pixelblock is invalid.");else if(b&&b.length===e)if(c)for(c=0;c<e;c++)b[c]&&(a[c]=b[c]<<24|p[c]<<16|f[c]<<8|l[c]);else for(c=0;c<e;c++)b[c]&&(a[c]=-16777216|p[c]<<16|f[c]<<8|l[c]);else for(c=0;c<e;c++)a[c]=-16777216|p[c]<<16|f[c]<<8|l[c]}else t.error("getAsRGBA()","Unable to convert to RGBA. The input pixel block is empty.")};l.prototype._fillFromNon8Bit=function(a){var b=this.pixels,c=this.mask,e=this.statistics;if(a&&b&&b.length){var l=this.pixelType,
f=1,p=0,f=1;e&&0<e.length?(p=e.map(function(a){return a.minValue}).reduce(function(a,b){return Math.min(a,b)}),f=e.map(function(a){return a.maxValue-a.minValue}).reduce(function(a,b){return Math.max(a,b)}),f=255/f):(f=255,"s8"===l?(p=-128,f=127):"u16"===l?f=65535:"s16"===l?(p=-32768,f=32767):"u32"===l?f=4294967295:"s32"===l?(p=-2147483648,f=2147483647):"f32"===l?(p=-3.4*1E39,f=3.4*1E39):"f64"===l&&(p=-Number.MAX_VALUE,f=Number.MAX_VALUE),f=255/(f-p));a=new Uint32Array(a);var l=this.width*this.height,
n,m,e=n=m=b[0];if(e.length!==l)return t.error("getAsRGBA()","Unable to convert to RGBA. The pixelblock is invalid.");if(2<=b.length)if(n=b[1],3<=b.length&&(m=b[2]),c&&c.length===l)for(b=0;b<l;b++)c[b]&&(a[b]=-16777216|(m[b]-p)*f<<16|(n[b]-p)*f<<8|(e[b]-p)*f);else for(b=0;b<l;b++)a[b]=-16777216|(m[b]-p)*f<<16|(n[b]-p)*f<<8|(e[b]-p)*f;else if(c&&c.length===l)for(b=0;b<l;b++)n=(e[b]-p)*f,c[b]&&(a[b]=-16777216|n<<16|n<<8|n);else for(b=0;b<l;b++)n=(e[b]-p)*f,a[b]=-16777216|n<<16|n<<8|n}else t.error("getAsRGBA()",
"Unable to convert to RGBA. The input pixel block is empty.")};l.prototype._fillFrom32Bit=function(a){var b=this.pixels,c=this.mask;if(!a||!b||!b.length)return t.error("getAsRGBAFloat()","Unable to convert to RGBA. The input pixel block is empty.");var e,l,f;e=l=f=b[0];3<=b.length?(l=b[1],f=b[2]):2===b.length&&(l=b[1]);var p=this.width*this.height;if(e.length!==p)return t.error("getAsRGBAFloat()","Unable to convert to RGBA. The pixelblock is invalid.");var n=0;if(c&&c.length===p)for(b=0;b<p;b++)a[n++]=
e[b],a[n++]=l[b],a[n++]=f[b],a[n++]=c[b]&1;else for(b=0;b<p;b++)a[n++]=e[b],a[n++]=l[b],a[n++]=f[b],a[n++]=1};l.prototype._calculateBandStatistics=function(a,b){var c=Infinity,e=-Infinity,l=a.length,f,p=0;if(b)for(f=0;f<l;f++)b[f]&&(p=a[f],c=p<c?p:c,e=p>e?p:e);else for(f=0;f<l;f++)p=a[f],c=p<c?p:c,e=p>e?p:e;return{minValue:c,maxValue:e}};var p;h([f.property({json:{write:!0}})],l.prototype,"width",void 0);h([f.property({json:{write:!0}})],l.prototype,"height",void 0);h([f.property({json:{write:!0}})],
l.prototype,"pixelType",void 0);h([f.cast("pixelType")],l.prototype,"castPixelType",null);h([f.property({json:{write:!0}})],l.prototype,"validPixelCount",void 0);h([f.property({json:{write:!0}})],l.prototype,"mask",void 0);h([f.property({json:{write:!0}})],l.prototype,"maskIsAlpha",void 0);h([f.property({json:{write:!0}})],l.prototype,"pixels",void 0);h([f.property({json:{write:!0}})],l.prototype,"statistics",void 0);return l=p=h([f.subclass("esri.layers.support.PixelBlock")],l)}(f.declared(m.JSONSupport))})},
"esri/views/2d/engine/webgl/WGLRasterUtils":function(){define(["require","exports","../../../webgl"],function(g,a,d){Object.defineProperty(a,"__esModule",{value:!0});a.createRasterTexture=function(a,b,e,m){void 0===e&&(e="nearest");void 0===m&&(m=!1);var c=!(m&&"u8"===b.pixelType);m=c?5126:5121;c=null==b.pixels||0===b.pixels.length?null:c?b.getAsRGBAFloat():b.getAsRGBA();return new d.Texture(a,{width:b.width,height:b.height,target:3553,pixelFormat:6408,internalFormat:6408,samplingMode:"bilinear"===
e?9729:9728,dataType:m,wrapMode:33071,flipped:!1},c)};a.createFrameBuffer=function(a,b,e,m){m=new d.Texture(a,{width:b,height:e,target:3553,pixelFormat:6408,internalFormat:6408,samplingMode:9728,dataType:m?5121:5126,wrapMode:33071,flipped:!1});return new d.FramebufferObject(a,{colorTarget:0,depthStencilTarget:3,width:b,height:e},m)};a.createTransformTexture=function(a,b){for(var e=4*b.size[0],m=b.size[1],c={width:e,height:m,target:3553,pixelFormat:6408,internalFormat:6408,dataType:5126,samplingMode:9728,
wrapMode:33071,flipped:!1},e=new Float32Array(e*m*4),l=m=0;l<b.coefficients.length;l++)e[m++]=b.coefficients[l],2===l%3&&(e[m++]=1);return new d.Texture(a,c,e)};a.createColormapTexture=function(a,b){return new d.Texture(a,{width:b.length/4,height:1,target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071,flipped:!1},b)};a.getUniformInfos=function(a,b){a=a.gl;b=b.glName;for(var e=a.getProgramParameter(b,a.ACTIVE_UNIFORMS),m=new Map,c,l=0;l<e;l++)(c=a.getActiveUniform(b,
l))&&m.set(c.name,{location:a.getUniformLocation(b,c.name),info:c});return m};a.setUniforms=function(a,b,e,m){Object.keys(m).forEach(function(c){var l=e.get(c)||e.get(c+"[0]");if(l){var f=m[c];if(null!==l&&null!=f){var d=a.gl,l=l.info;switch(l.type){case d.FLOAT:1<l.size?b.setUniform1fv(c,f):b.setUniform1f(c,f);break;case d.FLOAT_VEC2:b.setUniform2fv(c,f);break;case d.FLOAT_VEC3:b.setUniform3fv(c,f);break;case d.FLOAT_VEC4:b.setUniform4fv(c,f);break;case d.FLOAT_MAT3:b.setUniformMatrix3fv(c,f);break;
case d.FLOAT_MAT4:b.setUniformMatrix4fv(c,f);break;case d.INT:case d.BOOL:1<l.size?b.setUniform1iv(c,f):b.setUniform1i(c,f);break;case d.INT_VEC2:case d.BOOL_VEC2:b.setUniform2iv(c,f);break;case d.INT_VEC3:case d.BOOL_VEC3:b.setUniform3iv(c,f);break;case d.INT_VEC4:case d.BOOL_VEC4:b.setUniform4iv(c,f)}}}})};a.setTextures=function(a,b,e,m){e.length===m.length&&(m.some(function(a){return null==a})||e.some(function(a){return null==a})||e.forEach(function(c,e){b.setUniform1i(c,e);a.bindTexture(m[e],
e)}))}})},"esri/views/2d/engine/RasterTileContainer":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/decorateHelper ../../../geometry/support/aaBoundingRect ../engine ./RasterTile ./webgl/enums ./webgl/TileContainer".split(" "),function(g,a,d,h,b,e,m,c,l){Object.defineProperty(a,"__esModule",{value:!0});g=function(a){function l(){return null!==a&&a.apply(this,arguments)||this}d(l,a);l.prototype.createTile=function(a){var c=this._tileInfoView.getTileBounds(b.create(),
a);return new m.RasterTile(a,c,this._tileInfoView.tileInfo.size)};l.prototype.destroyTile=function(){};l.prototype.prepareRenderPasses=function(b){var l=this,f=b.registerRenderPass({name:"bitmap (tile)",brushes:[e.brushes.Raster],target:function(){return l.children.map(function(a){return a.bitmap})},drawPhase:c.WGLDrawPhase.MAP});return a.prototype.prepareRenderPasses.call(this,b).concat([f])};l.prototype.doRender=function(b){this.visible&&b.drawPhase===c.WGLDrawPhase.MAP&&a.prototype.doRender.call(this,
b)};return l}(l.default);a.RasterTileContainer=g})},"esri/views/2d/engine/Stage":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/assignHelper ../../../core/Error ../../../core/events ../../../core/has ../../../core/promiseUtils ../../../core/scheduling ../../../core/watchUtils ../../../core/libs/gl-matrix-2/common ../../../core/libs/gl-matrix-2/mat2d ../../../core/libs/gl-matrix-2/mat2df64 ../../../core/libs/gl-matrix-2/vec2 ../../../core/libs/gl-matrix-2/vec2f64 ../../webgl ./Container ./webgl/BitBlitRenderer ./webgl/definitions ./webgl/enums ./webgl/Painter ./webgl/Profiler ./webgl/WebGLDriverTest ./webgl/shaders/StencilPrograms ../support/Timeline ../../support/screenshotUtils".split(" "),
function(g,a,d,h,b,e,m,c,l,f,t,x,n,p,y,u,k,r,z,q,E,A,B,C,D,I){Object.defineProperty(a,"__esModule",{value:!0});g=function(a){function k(c,k){var f=a.call(this)||this;f._renderParameters={drawPhase:0,state:f.state,pixelRatio:window.devicePixelRatio,stationary:!1,globalOpacity:1};f._clipData=new Float32Array(8);f._upperLeft=y.vec2f64.create();f._upperRight=y.vec2f64.create();f._lowerLeft=y.vec2f64.create();f._lowerRight=y.vec2f64.create();f._mat2=n.mat2df64.create();f._clipRendererInitialized=!1;f._supersampleScreenshots=
!0;f.dataUploadCounter=0;f.stage=f;f._stationary=!0;f.attached=!0;var r=k.canvas,r=void 0===r?document.createElement("canvas"):r,p=k.alpha,q=k.stencil,d=k.renderContext,z=k.supersampleScreenshots,z=void 0===z?!0:z,t=k.contextOptions,t=void 0===t?{}:t;f._canvas=r;p=u.createContextOrErrorHTML(r,{alpha:void 0===p?!0:p,antialias:!1,depth:!0,stencil:void 0===q?!0:q},void 0===d?"webgl":d);f.context=new u.RenderingContext(p,t);f.painter=new E.default(f.context);f._taskHandle=l.addFrameTask({render:function(){return f.renderFrame()}});
f._taskHandle.pause();f._supersampleScreenshots=z;f._lostWebGLContextHandle=e.on(r,"webglcontextlost",function(){f.emit("webgl-error",{error:new b("webgl-context-lost")})});m("esri-2d-profiler")&&(f._debugOutput=document.createElement("div"),f._debugOutput.setAttribute("style","margin: 24px 64px; position: absolute; color: red;"),c.appendChild(f._debugOutput));r.setAttribute("style","width: 100%; height:100%; display:block;");f.profiler=new A.Profiler(f.context,f._debugOutput);f.renderingOptions=
k.renderingOptions;f.timeline=k.timeline||new D.Timeline;f.driverTestResult=B.testWebGLDriver(f.context);c.appendChild(r);return f}d(k,a);k.prototype.destroy=function(){this.removeAllChildren();this.renderFrame();this._taskHandle.remove();this._boundFBO=this._taskHandle=null;this._clipFBO&&(this._clipFBO.dispose(),this._clipFBO=null);this._blitRenderer&&(this._blitRenderer.dispose(),this._blitRenderer=null);this._clipVAO&&(this._clipVAO.dispose(),this._clipVBO=this._clipVAO=null);this._clipStencilProgram&&
(this._clipStencilProgram.dispose(),this._clipStencilProgram=null);this._lostWebGLContextHandle&&(this._lostWebGLContextHandle.remove(),this._lostWebGLContextHandle=null);this._canvas.parentNode&&this._canvas.parentNode.removeChild(this._canvas);this._debugOutput&&this._debugOutput.parentNode&&this._debugOutput.parentNode.removeChild(this._debugOutput);this.painter.dispose();this.context.dispose();this._canvas=null};Object.defineProperty(k.prototype,"background",{get:function(){return this._background},
set:function(a){this._background=a;this.requestRender()},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"highlightOptions",{get:function(){return this._highlightOptions},set:function(a){var b=this;this._highlightOptionsHandle&&(this._highlightOptionsHandle.remove(),this._highlightOptionsHandle=null);if(this._highlightOptions=a)this._highlightOptionsHandle=f.init(this._highlightOptions,"version",function(){b.painter.setHighlightOptions(a);b.requestRender()})},enumerable:!0,configurable:!0});
Object.defineProperty(k.prototype,"renderingOptions",{get:function(){return this._renderingOptions},set:function(a){this._renderingOptions=a;this.requestRender()},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"state",{get:function(){return this._state},set:function(a){this._state=a;this.requestRender()},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"stationary",{get:function(){return this._stationary},set:function(a){this._stationary!==a&&(this._stationary=
a,this.requestRender())},enumerable:!0,configurable:!0});k.prototype.requestRender=function(){this._lastRenderRequestTime=Date.now();this._taskHandle&&this._taskHandle.resume()};k.prototype.renderFrame=function(){var a=Date.now()-this._lastRenderRequestTime;this._renderParameters.state=this._state;this._renderParameters.stationary=this.stationary;this._renderParameters.pixelRatio=window.devicePixelRatio;this._renderParameters.globalOpacity=1;this.processRender(this._renderParameters);a>=z.MAX_ANIMATION_TIME_MS&&
this._taskHandle.pause()};k.prototype.renderChildren=function(a){var b=this.context,c=this.children,c=a.children?a.children:c;this.profiler.recordStart("drawLayers");this.dataUploadCounter=0;this.beforeRenderChildren(a);a.drawPhase=q.WGLDrawPhase.MAP;this.painter.beforeRenderLayers(b);for(var e=0;e<c.length;e++){var k=c[e];k.attached&&k.processRender(a)}this.painter.renderLayers(b);a.drawPhase=q.WGLDrawPhase.LABEL;this.painter.beforeRenderLayers(b);for(e=0;e<c.length;e++)k=c[e],k.attached&&k.processRender(a);
this.painter.renderLayers(b);if(m("esri-tiles-debug")){a.drawPhase=q.WGLDrawPhase.DEBUG;this.painter.beforeRenderLayers(b);for(e=0;e<c.length;e++)k=c[e],k.attached&&k.processRender(a);this.painter.renderLayers(b)}this.profiler.recordEnd("drawLayers");this.afterRenderChildren()};k.prototype.beforeRenderChildren=function(a){var b=this.context,c=a.state,e=a.pixelRatio;if(this.painter){b.enforceState();var k=c.size;a=c.rotation;var f=Math.round(k[0]*e),k=Math.round(k[1]*e);this._boundFBO=b.getBoundFramebufferObject();
if(c.spatialReference&&(c.spatialReference._isWrappable?c.spatialReference._isWrappable():c.spatialReference.isWrappable)){var l=t.common.toRadian(a),r=Math.abs(Math.cos(l)),q=Math.abs(Math.sin(l)),n=Math.round(c.worldScreenWidth);if(Math.round(f*r+k*q)<=n)this._clipFrame=!1;else{this._clipFBO&&this._clipFBO.width===f&&this._clipFBO.height===k||(this._clipFBO=new u.FramebufferObject(b,{colorTarget:0,depthStencilTarget:3,width:f,height:k}));var m=(this.state.padding.left-this.state.padding.right)/
2,d=(this.state.padding.bottom-this.state.padding.top)/2,z=.5*f,A=.5*k,c=1/f,y=1/k,e=.5*n*e,h=.5*(f*q+k*r),f=this._upperLeft,r=this._upperRight,q=this._lowerLeft,n=this._lowerRight;p.vec2.set(f,-e,-h);p.vec2.set(r,e,-h);p.vec2.set(q,-e,h);p.vec2.set(n,e,h);x.mat2d.identity(this._mat2);x.mat2d.translate(this._mat2,this._mat2,[z+m,A+d]);0!==a&&x.mat2d.rotate(this._mat2,this._mat2,l);p.vec2.transformMat2d(f,f,this._mat2);p.vec2.transformMat2d(r,r,this._mat2);p.vec2.transformMat2d(q,q,this._mat2);p.vec2.transformMat2d(n,
n,this._mat2);a=this._clipData;a.set([2*q[0]*c-1,2*(k-q[1])*y-1,2*n[0]*c-1,2*(k-n[1])*y-1,2*f[0]*c-1,2*(k-f[1])*y-1,2*r[0]*c-1,2*(k-r[1])*y-1]);this._clipRendererInitialized||this._initializeClipRenderer(b);this._clipVBO.setData(a);this._boundFBO=b.getBoundFramebufferObject();b.bindFramebuffer(this._clipFBO);b.setDepthWriteEnabled(!0);b.setStencilWriteMask(255);b.setClearColor(0,0,0,0);b.setClearDepth(1);b.setClearStencil(0);b.clear(b.gl.COLOR_BUFFER_BIT|b.gl.DEPTH_BUFFER_BIT|b.gl.STENCIL_BUFFER_BIT);
b.setDepthWriteEnabled(!1);this._clipFrame=!0}}else this._clipFrame=!1}};k.prototype.afterRenderChildren=function(){var a=this.context;a.logIno();this._clipFrame&&this._clipRendererInitialized&&(a.bindFramebuffer(this._boundFBO),this._boundFBO=null,a.bindVAO(this._clipVAO),a.bindProgram(this._clipStencilProgram),a.setDepthWriteEnabled(!1),a.setDepthTestEnabled(!1),a.setStencilTestEnabled(!0),a.setBlendingEnabled(!1),a.setColorMask(!1,!1,!1,!1),a.setStencilOp(7680,7680,7681),a.setStencilWriteMask(255),
a.setStencilFunction(519,1,255),a.drawElements(4,6,5123,0),a.bindVAO(),a.setColorMask(!0,!0,!0,!0),a.setBlendingEnabled(!0),a.setStencilFunction(514,1,255),this._blitRenderer.render(a,this._clipFBO.colorTexture,9728,1),a.setStencilTestEnabled(!1))};k.prototype.doRender=function(b){var c=this.context,e=b.state,k=b.pixelRatio;this._resizeCanvas(b);this.context.enforceState();c.setViewport(0,0,k*e.size[0],k*e.size[1]);c.setDepthWriteEnabled(!0);c.setStencilWriteMask(255);this.background&&this.background.color?
(e=this.background.color,c.setClearColor(e.r/255,e.g/255,e.b/255,e.a)):c.setClearColor(0,0,0,0);c.setClearDepth(1);c.setClearStencil(0);c.clear(c.gl.COLOR_BUFFER_BIT|c.gl.DEPTH_BUFFER_BIT|c.gl.STENCIL_BUFFER_BIT);c.setDepthWriteEnabled(!1);a.prototype.doRender.call(this,b)};k.prototype.takeScreenshot=function(a,b){var e=I.screenshotSuperSampleSettings(a,this._supersampleScreenshots,this._state.padding),k=e.framebufferWidth,f=e.framebufferHeight,l=this.context,r=a.layers,q={drawPhase:null,globalOpacity:1,
stationary:!0,state:this._renderParameters.state.clone(),pixelRatio:e.pixelRatio};if(null!=a.rotation){var p=q.state.viewpoint;p.rotation=a.rotation;q.state.viewpoint=p}0<r.length&&(q.children=[],r.forEach(function(a){var c=b.find(function(b){return b.layer.id===a.id});c&&"container"in c&&c.container&&c.attached&&q.children.push(c.container)}));var n=new u.FramebufferObject(l,{colorTarget:0,depthStencilTarget:3,width:k,height:f}),r=l.getBoundFramebufferObject(),p=l.getViewport();l.bindFramebuffer(n);
l.setViewport(0,0,k,f);k=l.gl;!a.ignoreBackground&&this.background&&this.background.color?(f=this.background.color,l.setClearColor(f.r/255,f.g/255,f.b/255,f.a)):l.setClearColor(0,0,0,0);l.setClearDepth(1);l.setClearStencil(0);l.clear(k.COLOR_BUFFER_BIT|k.DEPTH_BUFFER_BIT|k.STENCIL_BUFFER_BIT);this.renderChildren(q);e=this._readbackScreenshot(e);l.bindFramebuffer(r);l.setViewport(p.x,p.y,p.width,p.height);this.requestRender();l=this._ensureScreenshotEncodeCanvas();a=I.encodeResult(e,a,l,{flipY:!0,
premultipliedAlpha:!0});return c.resolve(a)};k.prototype._ensureScreenshotEncodeCanvas=function(){this._screenshotEncodeCanvas||(this._screenshotEncodeCanvas=document.createElement("canvas"));return this._screenshotEncodeCanvas};k.prototype._readbackScreenshot=function(a){var b=a.framebufferWidth,c=a.framebufferHeight,e=a.region;a=a.resample;var k=this.context.gl;if(a){var f=I.createEmptyImageData(b,c,this._ensureScreenshotEncodeCanvas());k.readPixels(0,0,b,c,6408,5121,new Uint8Array(f.data.buffer));
b=I.createEmptyImageData(e.width,e.height,this._ensureScreenshotEncodeCanvas());return I.resampleHermite(f,b,!0,a.region.x,c-(a.region.y+a.region.height),a.region.width,a.region.height)}f=I.createEmptyImageData(e.width,e.height,this._ensureScreenshotEncodeCanvas());k.readPixels(e.x,c-(e.y+e.height),e.width,e.height,6408,5121,new Uint8Array(f.data.buffer));return f};k.prototype._resizeCanvas=function(a){var b=this._canvas,c=b.style,e=a.state.size,k=a.pixelRatio;a=e[0];var e=e[1],f=Math.round(a*k),
k=Math.round(e*k);if(b.width!==f||b.height!==k)b.width=f,b.height=k;c.width=a+"px";c.height=e+"px"};k.prototype._initializeClipRenderer=function(a){if(this._clipRendererInitialized)return!0;this._blitRenderer=new r.BitBlitRenderer;var b=C.stencil.attributes,c=u.createProgram(a,C.stencil);if(!c)return!1;var e=u.BufferObject.createVertex(a,35040,32),k=new Uint16Array([0,1,2,2,1,3]),k=u.BufferObject.createIndex(a,35044,k);a=new u.VertexArrayObject(a,b,{geometry:[{name:"a_pos",count:2,type:5126,offset:0,
stride:8,normalized:!1,divisor:0}]},{geometry:e},k);this._clipStencilProgram=c;this._clipVBO=e;this._clipVAO=a;return this._clipRendererInitialized=!0};return k}(k.Container);a.Stage=g})},"esri/views/2d/engine/webgl/BitBlitRenderer":function(){define(["require","exports","../../../webgl","./shaders/BitBlitPrograms"],function(g,a,d,h){Object.defineProperty(a,"__esModule",{value:!0});g=function(){function a(){this._initialized=!1}a.prototype.dispose=function(){this._program&&(this._program.dispose(),
this._program=null);this._vertexArrayObject&&(this._vertexArrayObject.dispose(),this._vertexArrayObject=null)};a.prototype.render=function(a,b,c,l){a&&(this._initialized||this._initialize(a),a.setBlendFunctionSeparate(1,771,1,771),a.bindVAO(this._vertexArrayObject),a.bindProgram(this._program),b.setSamplingMode(c),a.bindTexture(b,0),this._program.setUniform1i("u_tex",0),this._program.setUniform1f("u_opacity",l),a.drawArrays(5,0,4),a.bindVAO())};a.prototype._initialize=function(a){if(this._initialized)return!0;
var b=h.bitBlit.attributes,c=d.createProgram(a,h.bitBlit);if(!c)return!1;var e=new Int8Array(16);e[0]=-1;e[1]=-1;e[2]=0;e[3]=0;e[4]=1;e[5]=-1;e[6]=1;e[7]=0;e[8]=-1;e[9]=1;e[10]=0;e[11]=1;e[12]=1;e[13]=1;e[14]=1;e[15]=1;a=new d.VertexArrayObject(a,b,{geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:4,normalized:!1,divisor:0},{name:"a_tex",count:2,type:5120,offset:2,stride:4,normalized:!1,divisor:0}]},{geometry:d.BufferObject.createVertex(a,35044,e)});this._program=c;this._vertexArrayObject=
a;return this._initialized=!0};return a}();a.BitBlitRenderer=g})},"esri/views/2d/engine/webgl/shaders/BitBlitPrograms":function(){define(["require","exports","./sources/resolver"],function(g,a,d){Object.defineProperty(a,"__esModule",{value:!0});a.bitBlit={name:"bitBlit",shaders:{vertexShader:d.resolveIncludes("bitBlit/bitBlit.vert"),fragmentShader:d.resolveIncludes("bitBlit/bitBlit.frag")},attributes:{a_pos:0,a_tex:1}}})},"esri/views/2d/engine/webgl/definitions":function(){define(["require","exports"],
function(g,a){Object.defineProperty(a,"__esModule",{value:!0});a.WEBGL_MAX_STOPS=8;a.WEBGL_MAX_INNER_STOPS=a.WEBGL_MAX_STOPS-2;a.NAN_MAGIC_NUMBER=1E-30;a.EXTRUDE_SCALE=64;a.PICTURE_FILL_COLOR=4294967295;a.TILE_SIZE=512;a.RASTER_TILE_SIZE=256;a.ANGLE_FACTOR_256=256/360;a.DEBUG_LABELS=!1;a.COLLISION_BUCKET_SIZE=128;a.DOT_DENSITY_MAX_FIELDS=8;a.COLLISION_MAX_ZOOM_DELTA=3;a.COLLISION_EARLY_REJECT_BUCKET_SIZE=16;a.COLLISION_BOX_PADDING=16;a.COLLISION_TILE_BOX_SIZE=a.TILE_SIZE/a.COLLISION_BUCKET_SIZE;a.COLLISION_PLACEMENT_PADDING=
8;a.HEURISTIC_GLYPHS_PER_LINE=50;a.HEURISTIC_GLYPHS_PER_FEATURE=10;a.GLYPH_SIZE=24;a.TEXT_LINE_HEIGHT=1.2*a.GLYPH_SIZE;a.TEXT_MAX_WIDTH=10*a.GLYPH_SIZE;a.TEXT_SPACING=0;a.AVERAGE_GLYPH_MOSAIC_ITEM={metrics:{width:15,height:17,left:0,top:-7,advance:14}};a.ATTRIBUTE_STORE_TEXTURE_SIZE=1024;a.TEXTURE_BINDING_SPRITE_ATLAS=0;a.TEXTURE_BINDING_GLYPH_ATLAS=0;a.TEXTURE_BINDING_BITMAP=0;a.TEXTURE_BINDING_ATTRIBUTE_DATA_0=1;a.TEXTURE_BINDING_ATTRIBUTE_DATA_1=2;a.TEXTURE_BINDING_ATTRIBUTE_DATA_2=3;a.TEXTURE_BINDING_ATTRIBUTE_DATA_3=
4;a.TEXTURE_BINDING_HIGHLIGHT_0=5;a.TEXTURE_BINDING_HIGHLIGHT_1=6;a.TEXTURE_BINDING_RENDERER_0=5;a.TEXTURE_BINDING_RENDERER_1=6;a.ATTRIBUTE_DATA_FILTER_FLAGS=0;a.ATTRIBUTE_DATA_ANIMATION=1;a.ATTRIBUTE_DATA_VV=2;a.ATTRIBUTE_DATA_DD0=3;a.ATTRIBUTE_DATA_DD1=3;a.MAX_FILTERS=2;a.HIGHLIGHT_FLAG=1;a.FILTER_FLAG_0=2;a.EFFECT_FLAG_0=4;a.THIN_LINE_THRESHOLD=2.5;a.HITTEST_SEARCH_SIZE=24;a.MAX_ANIMATION_TIME_MS=2E3;a.VTL_TEXTURE_BINDING_UNIT_SPRITES=5;a.VTL_TEXTURE_BINDING_UNIT_GLYPHS=6;a.VTL_HIGH_RES_CUTOFF=
1.15;a.MAX_GPU_UPLOADS_PER_FRAME=2})},"esri/views/2d/engine/webgl/Painter":function(){define("require exports ../../../../core/tsSupport/assignHelper ../../../webgl ../../engine ../vectorTiles/shaders/ProgramCache ./BitBlitRenderer ./enums ./MaterialManager ./TextureManager ./effects/AnimationEffect ./effects/HighlightEffect ./effects/HittestEffect ./painter/RenderPass".split(" "),function(g,a,d,h,b,e,m,c,l,f,t,x,n,p){Object.defineProperty(a,"__esModule",{value:!0});g=function(){return function(){}}();
a.PainterOptions=g;g=function(){function a(a){this.context=a;this._blitRenderer=new m.BitBlitRenderer;this._brushCache=new Map;this._vtlProgramCache=null;this.brushNameToCtor={marker:b.brushes.Marker,line:b.brushes.Line,fill:b.brushes.Fill,text:b.brushes.Text,label:b.brushes.Label,clip:b.brushes.Clip,stencil:b.brushes.Stencil,bitmap:b.brushes.Bitmap,tileInfo:b.brushes.TileInfo,vtlBackground:b.brushes.VTLBackground,vtlFill:b.brushes.VTLFill,vtlLine:b.brushes.VTLLine,vtlCircle:b.brushes.VTLCircle,vtlSymbol:b.brushes.VTLSymbol};
this.textureManager=new f;this.effects={highlight:new x.default,hittest:new n.HittestEffect,integrate:new t.AnimationEffect};this.materialManager=new l(a);this._vtlProgramCache=new e.default(a)}a.prototype.getFbos=function(a,b){if(a!==this._lastWidth||b!==this._lastHeight){this._lastWidth=a;this._lastHeight=b;if(this._fbos)for(var c in this._fbos)this._fbos[c].dispose();c={target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071,width:a,height:b};var e={colorTarget:0,depthStencilTarget:3};
a=new h.Renderbuffer(this.context,{width:a,height:b,internalFormat:34041});this._fbos={output:new h.FramebufferObject(this.context,e,c,a),alpha:new h.FramebufferObject(this.context,e,c,a),effect0:new h.FramebufferObject(this.context,e,c,a)}}return this._fbos};a.prototype.beforeRenderLayers=function(a){var b=a.getViewport(),b=this.getFbos(b.width,b.height);this._prevFBO=a.getBoundFramebufferObject();a.bindFramebuffer(b.output);a.setDepthWriteEnabled(!0);a.setClearColor(0,0,0,0);a.setClearDepth(1);
a.clear(a.gl.COLOR_BUFFER_BIT|a.gl.DEPTH_BUFFER_BIT);a.setDepthWriteEnabled(!1)};a.prototype.beforeRenderLayer=function(a,b,c){1!==c?(a.bindFramebuffer(this._fbos.alpha),a.setClearColor(0,0,0,0),a.clear(a.gl.COLOR_BUFFER_BIT)):a.bindFramebuffer(this._fbos.output);a.setDepthWriteEnabled(!1);a.setDepthTestEnabled(!1);a.setStencilTestEnabled(!0);a.setClearStencil(b);a.setStencilWriteMask(255);a.clear(a.gl.STENCIL_BUFFER_BIT)};a.prototype.compositeLayer=function(a,b){1!==b&&(a.bindFramebuffer(this._fbos.output),
a.setStencilTestEnabled(!1),a.setStencilWriteMask(0),a.setBlendingEnabled(!0),a.setBlendFunctionSeparate(1,771,1,771),a.setColorMask(!0,!0,!0,!0),this._blitRenderer.render(a,this._fbos.alpha.colorTexture,9728,b))};a.prototype.renderLayers=function(a){a.bindFramebuffer(this._prevFBO);this._fbos&&(a.setStencilTestEnabled(!1),a.setStencilWriteMask(0),a.setBlendingEnabled(!0),a.setBlendFunctionSeparate(1,771,1,771),a.setColorMask(!0,!0,!0,!0),this._blitRenderer.render(a,this._fbos.output.colorTexture,
9728,1))};a.prototype.dispose=function(){this.materialManager.dispose();this.textureManager.dispose();this._blitRenderer&&(this._blitRenderer.dispose(),this._blitRenderer=null);this._vtlProgramCache&&(this._vtlProgramCache.dispose(),this._vtlProgramCache=null);this._brushCache&&(this._brushCache.forEach(function(a){return a.dispose()}),this._brushCache.clear(),this._brushCache=null);if(this._fbos)for(var a in this._fbos)this._fbos[a]&&this._fbos[a].dispose();if(this.effects)for(var b in this.effects)this.effects[b]&&
this.effects[b].dispose();this._prevFBO=null};a.prototype.getGeometryBrush=function(a){var e;a=(e={},e[c.WGLGeometryType.FILL]=b.brushes.Fill,e[c.WGLGeometryType.LINE]=b.brushes.Line,e[c.WGLGeometryType.MARKER]=b.brushes.Marker,e[c.WGLGeometryType.TEXT]=b.brushes.Text,e)[a];e=this._brushCache.get(a);void 0===e&&(e=new a,this._brushCache.set(a,e));return this._brushCache.get(a)};a.prototype.renderObject=function(a,b,c,e){c=this.brushNameToCtor[c];if(!c)return null;var k=this._brushCache.get(c);void 0===
k&&(k=new c,this._brushCache.set(c,k));k.prepareState(a,b,e);k.draw(a,b,e)};a.prototype.renderObjects=function(a,b,c,e){c=this.brushNameToCtor[c];if(!c)return null;var k=this._brushCache.get(c);void 0===k&&(k=new c,this._brushCache.set(c,k));k.drawMany(a,b,e)};a.prototype.getVectorTileProgramCach=function(){return this._vtlProgramCache};a.prototype.registerRenderPass=function(a){var b=this,c=a.brushes.map(function(a){b._brushCache.has(a)||b._brushCache.set(a,new a);return b._brushCache.get(a)});return new p.default(c,
a)};a.prototype.setHighlightOptions=function(a){this.effects.highlight.setHighlightOptions(a)};return a}();a.default=g})},"esri/views/2d/engine/vectorTiles/shaders/ProgramCache":function(){define(["require","exports","../../../../webgl","./Programs"],function(g,a,d,h){Object.defineProperty(a,"__esModule",{value:!0});g=function(){function a(a){this._cache=Array(8);for(var b=0;8>b;b++)this._cache[b]={};this._programRepo=new d.ProgramCache(a)}a.prototype.dispose=function(){this._programRepo&&(this._programRepo.dispose(),
this._programRepo=null)};a.prototype.getProgram=function(a,b,c){var e=this._cache[a];e[b]||(a=this._programRepo.getProgram(this._getProgramTemplate(a),c),e[b]=a);return e[b]};a.prototype.getProgramAttributes=function(a){switch(a){case 0:return h.background.attributes;case 5:return h.circle.attributes;case 1:return h.fill.attributes;case 4:return h.icon.attributes;case 3:return h.line.attributes;case 2:return h.outline.attributes;case 6:return h.text.attributes;default:return null}};a.prototype._getProgramTemplate=
function(a){switch(a){case 0:return h.background;case 5:return h.circle;case 1:return h.fill;case 4:return h.icon;case 3:return h.line;case 2:return h.outline;case 6:return h.text;default:return null}};return a}();a.default=g})},"esri/views/2d/engine/vectorTiles/shaders/Programs":function(){define(["require","exports","../../../../webgl","./sources/resolver"],function(g,a,d,h){Object.defineProperty(a,"__esModule",{value:!0});a.background={name:"background",shaders:function(a){return{vertexShader:d.glslifyDefineMap({ID:a.id,
PATTERN:a.pattern})+h.resolveIncludes("background/background.vert"),fragmentShader:d.glslifyDefineMap({ID:a.id,PATTERN:a.pattern})+h.resolveIncludes("background/background.frag")}},attributes:{a_pos:0}};a.circle={name:"circle",shaders:function(a){return{vertexShader:d.glslifyDefineMap({ID:a.id})+h.resolveIncludes("circle/circle.vert"),fragmentShader:d.glslifyDefineMap({ID:a.id})+h.resolveIncludes("circle/circle.frag")}},attributes:{a_pos:0,a_color:1,a_stroke_color:2,a_data:3}};var b=function(a){return d.glslifyDefineMap({ID:a.id,
DD:a.dd,PATTERN:a.pattern})};a.fill={name:"fill",shaders:function(a){return{vertexShader:b(a)+h.resolveIncludes("fill/fill.vert"),fragmentShader:b(a)+h.resolveIncludes("fill/fill.frag")}},attributes:{a_pos:0,a_color:1}};a.outline={name:"outline",shaders:function(a){return{vertexShader:d.glslifyDefineMap({ID:a.id,DD:a.dd})+h.resolveIncludes("outline/outline.vert"),fragmentShader:d.glslifyDefineMap({ID:a.id,DD:a.dd})+h.resolveIncludes("outline/outline.frag")}},attributes:{a_pos:0,a_offset:1,a_xnormal:2,
a_color:3}};a.icon={name:"icon",shaders:function(a){return{vertexShader:d.glslifyDefineMap({ID:a.id,DD:a.dd,SDF:a.sdf})+h.resolveIncludes("icon/icon.vert"),fragmentShader:d.glslifyDefineMap({ID:a.id,DD:a.dd,SDF:a.sdf})+h.resolveIncludes("icon/icon.frag")}},attributes:{a_pos:0,a_vertexOffset:1,a_tex:2,a_levelInfo:3,a_color:4,a_size:5}};var e=function(a){return d.glslifyDefineMap({ID:a.id,DD:a.dd,PATTERN:a.pattern})};a.line={name:"line",shaders:function(a){return{vertexShader:e(a)+h.resolveIncludes("line/line.vert"),
fragmentShader:e(a)+h.resolveIncludes("line/line.frag")}},attributes:{a_pos:0,a_offsetAndNormal:1,a_accumulatedDistance:2,a_color:3,a_width:4}};a.text={name:"text",shaders:function(a){return{vertexShader:d.glslifyDefineMap({ID:a.id,DD:a.dd})+h.resolveIncludes("text/text.vert"),fragmentShader:d.glslifyDefineMap({ID:a.id,DD:a.dd})+h.resolveIncludes("text/text.frag")}},attributes:{a_pos:0,a_vertexOffset:1,a_tex:2,a_levelInfo:3,a_color:4,a_size:5}}})},"esri/views/2d/engine/vectorTiles/shaders/sources/resolver":function(){define(["require",
"exports","../../../../../webgl","./shaderRepository"],function(g,a,d,h){Object.defineProperty(a,"__esModule",{value:!0});var b=new d.ShaderCompiler(function(a){var b=h;a.split("/").forEach(function(a){b&&(b=b[a])});return b});a.resolveIncludes=function(a){return b.resolveIncludes(a)}})},"esri/views/2d/engine/vectorTiles/shaders/sources/shaderRepository":function(){define(["require","exports"],function(g,a){return{background:{"background.frag":"#ifdef PATTERN\nuniform lowp float u_opacity;\nuniform mediump vec2 u_pattern_tl;\nuniform mediump vec2 u_pattern_br;\nuniform sampler2D u_texture;\nvarying mediump vec2 v_tileTextureCoord;\n#else\nuniform lowp vec4 u_color;\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main() {\n#ifdef PATTERN\n  mediump vec2 normalizedTextureCoord \x3d mod(v_tileTextureCoord, 1.0);\n  mediump vec2 samplePos \x3d mix(u_pattern_tl, u_pattern_br, normalizedTextureCoord);\n  lowp vec4 color \x3d texture2D(u_texture, samplePos);\n  gl_FragColor \x3d u_opacity * color;\n#else\n  gl_FragColor \x3d u_color;\n#endif\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"background.vert":"precision mediump float;\nattribute vec2 a_pos;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform mediump float u_coord_range;\nuniform mediump float u_depth;\n#ifdef PATTERN\nuniform mediump mat3 u_pattern_matrix;\nvarying mediump vec2 v_tileTextureCoord;\n#endif\nvoid main() {\n  gl_Position \x3d vec4((u_dvsMat3 * vec3(u_coord_range * a_pos, 1.0)).xy, u_depth, 1.0);\n#ifdef PATTERN\n  v_tileTextureCoord \x3d (u_pattern_matrix * vec3(a_pos, 1.0)).xy;\n#endif\n#ifdef ID\n  v_id \x3d u_id / 255.0;\n#endif\n}"},
circle:{"circle.frag":"precision lowp float;\nvarying lowp vec4 v_color;\nvarying lowp vec4 v_stroke_color;\nvarying mediump float v_blur;\nvarying mediump float v_stroke_width;\nvarying mediump float v_radius;\nvarying mediump vec2 v_offset;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\n  mediump float dist \x3d length(v_offset);\n  mediump float alpha \x3d smoothstep(0.0, -v_blur, dist - 1.0);\n  lowp float color_mix_ratio \x3d v_stroke_width \x3c 0.01 ? 0.0 : smoothstep(-v_blur, 0.0, dist - v_radius / (v_radius + v_stroke_width));\n  gl_FragColor \x3d alpha * mix(v_color, v_stroke_color, color_mix_ratio);\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"circle.vert":"precision mediump float;\nattribute vec2 a_pos;\nattribute vec4 a_color;\nattribute vec4 a_stroke_color;\nattribute vec4 a_data;\nconst float sizePrecision \x3d 0.25;\nconst float blurPrecision \x3d 0.03125;\nvarying lowp vec4 v_color;\nvarying lowp vec4 v_stroke_color;\nvarying mediump float v_blur;\nvarying mediump float v_stroke_width;\nvarying mediump float v_radius;\nvarying mediump vec2 v_offset;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform mediump vec2 u_circleTranslation;\nuniform mediump float u_depth;\nuniform mediump float u_radius;\nuniform lowp vec4 u_color;\nuniform mediump float u_blur;\nuniform mediump float u_stroke_width;\nuniform lowp vec4 u_stroke_color;\nuniform mediump float u_antialiasingWidth;\nvoid main()\n{\n  v_color \x3d a_color * u_color;\n  v_stroke_color \x3d a_stroke_color * u_stroke_color;\n  v_stroke_width \x3d a_data[1] * sizePrecision * u_stroke_width;\n  v_radius \x3d a_data[2] * u_radius;\n  v_blur \x3d max(a_data[0] * blurPrecision + u_blur, u_antialiasingWidth / (v_radius + v_stroke_width));\n  mediump vec2 offset \x3d vec2(mod(a_pos, 2.0) * 2.0 - 1.0);\n  v_offset \x3d offset;\n#ifdef ID\n  v_id \x3d u_id / 255.0;\n#endif\n  mediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos * 0.5, 1.0) + u_displayMat3 * vec3((v_radius + v_stroke_width) * offset + u_circleTranslation, 0.0);\n  gl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n}"},
fill:{"fill.frag":"precision lowp float;\n#ifdef PATTERN\nuniform mediump vec2 u_pattern_tl;\nuniform mediump vec2 u_pattern_br;\nuniform lowp sampler2D u_texture;\nvarying mediump vec2 v_tileTextureCoord;\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\nvec4 mixColors(vec4 color1, vec4 color2) {\n  float compositeAlpha \x3d color2.a + color1.a * (1.0 - color2.a);\n  vec3 compositeColor \x3d color2.rgb + color1.rgb * (1.0 - color2.a);\n  return vec4(compositeColor, compositeAlpha);\n}\nvoid main()\n{\n#ifdef PATTERN\n  mediump vec2 normalizedTextureCoord \x3d fract(v_tileTextureCoord);\n  mediump vec2 samplePos \x3d mix(u_pattern_tl, u_pattern_br, normalizedTextureCoord);\n  lowp vec4 color \x3d texture2D(u_texture, samplePos);\n  gl_FragColor \x3d v_color[3] * color;\n#else\n  gl_FragColor \x3d v_color;\n#endif\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"fill.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform mediump float u_depth;\nuniform mediump vec2 u_fillTranslation;\n#ifdef PATTERN\nuniform mediump mat3 u_pattern_matrix;\nvarying mediump vec2 v_tileTextureCoord;\n#endif\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\n#ifdef DD\nattribute vec4 a_color;\n#endif\nuniform lowp vec4 u_color;\nvarying lowp vec4 v_color;\nvoid main()\n{\n#ifdef DD\n  v_color \x3d a_color * u_color;\n#else\n  v_color \x3d u_color;\n#endif\n#ifdef ID\n  v_id \x3d u_id / 255.0;\n#endif\n#ifdef PATTERN\n  v_tileTextureCoord \x3d (u_pattern_matrix * vec3(a_pos, 1.0)).xy;\n#endif\n  vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + u_displayMat3 * vec3(u_fillTranslation, 0.0);\n  gl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n}"},
icon:{"icon.frag":"precision mediump float;\nuniform lowp sampler2D u_texture;\n#ifdef SDF\nuniform lowp vec4 u_color;\nuniform lowp vec4 u_outlineColor;\nuniform mediump float u_outlineSize;\n#endif\nvarying mediump vec2 v_tex;\nvarying lowp float v_transparency;\nvarying mediump vec2 v_size;\nvarying lowp vec4 v_color;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\n#include \x3cutil/encoding.glsl\x3e\nvec4 mixColors(vec4 color1, vec4 color2) {\n  float compositeAlpha \x3d color2.a + color1.a * (1.0 - color2.a);\n  vec3 compositeColor \x3d color2.rgb + color1.rgb * (1.0 - color2.a);\n  return vec4(compositeColor, compositeAlpha);\n}\nvoid main()\n{\n#ifdef SDF\n  lowp vec4 fillPixelColor \x3d v_color;\n  float d \x3d rgba2float(texture2D(u_texture, v_tex)) - 0.5;\n  const float sofetEdgeRatio \x3d 0.248062016;\n  float size \x3d max(v_size.x, v_size.y);\n  float dist \x3d d * sofetEdgeRatio * size;\n  fillPixelColor *\x3d clamp(0.5 - dist, 0.0, 1.0);\n  if (u_outlineSize \x3e 0.25) {\n    lowp vec4 outlinePixelColor \x3d u_outlineColor;\n    const float outlineLimitRatio \x3d (16.0 / 86.0);\n    float clampedOutlineSize \x3d sofetEdgeRatio * min(u_outlineSize, outlineLimitRatio * max(v_size.x, v_size.y));\n    outlinePixelColor *\x3d clamp(0.5 - (abs(dist) - clampedOutlineSize), 0.0, 1.0);\n    gl_FragColor \x3d v_transparency * mixColors(fillPixelColor, outlinePixelColor);\n  }\n  else {\n    gl_FragColor \x3d v_transparency * fillPixelColor;\n  }\n#else\n  lowp vec4 texColor \x3d texture2D(u_texture, v_tex);\n  gl_FragColor \x3d v_transparency * texColor;\n#endif\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"icon.vert":"attribute vec2 a_pos;\nattribute vec2 a_vertexOffset;\nattribute vec4 a_tex;\nattribute vec4 a_levelInfo;\n#ifdef DD\nattribute vec4 a_color;\nattribute mediump float a_size;\n#endif\nuniform lowp vec4 u_color;\nuniform mediump float u_size;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform mediump vec2 u_iconTranslation;\nuniform vec2 u_mosaicSize;\nuniform mediump float u_depth;\nuniform mediump float u_mapRotation;\nuniform mediump float u_level;\nuniform lowp float u_keepUpright;\nuniform mediump float u_fadeSpeed;\nuniform mediump float u_minfadeLevel;\nuniform mediump float u_maxfadeLevel;\nuniform mediump float u_fadeChange;\nuniform mediump float u_opacity;\nvarying mediump vec2 v_tex;\nvarying lowp float v_transparency;\nvarying mediump vec2 v_size;\nconst float C_OFFSET_PRECISION \x3d 1.0 / 8.0;\nconst float C_256_TO_RAD \x3d 3.14159265359 / 128.0;\nconst float C_DEG_TO_RAD \x3d 3.14159265359 / 180.0;\nconst float tileCoordRatio \x3d 1.0 / 8.0;\nvoid main()\n{\n  mediump float a_labelMinLevel \x3d a_levelInfo[0];\n  mediump float a_angle         \x3d a_levelInfo[1];\n  mediump float a_minLevel      \x3d a_levelInfo[2];\n  mediump float a_maxLevel      \x3d a_levelInfo[3];\n  mediump float delta_z \x3d 0.0;\n  mediump float rotated \x3d mod(a_angle + u_mapRotation, 256.0);\n  delta_z +\x3d (1.0 - step(u_keepUpright, 0.0)) * step(64.0, rotated) * (1.0 - step(192.0, rotated));\n  delta_z +\x3d 1.0 - step(a_minLevel, u_level);\n  delta_z +\x3d step(a_maxLevel, u_level);\n  mediump float alpha \x3d u_fadeSpeed !\x3d 0.0 ? clamp((u_fadeChange - a_labelMinLevel) / u_fadeSpeed, 0.0, 1.0) : 1.0;\n  v_transparency \x3d (u_fadeSpeed \x3e\x3d 0.0 ? alpha : 1.0 - alpha);\n  if (u_maxfadeLevel \x3c a_labelMinLevel)\n  {\n    v_transparency \x3d 0.0;\n  }\n  if (u_minfadeLevel \x3e\x3d a_labelMinLevel)\n  {\n    v_transparency \x3d 1.0;\n  }\n  delta_z +\x3d step(v_transparency, 0.0);\n  vec2 offset \x3d C_OFFSET_PRECISION * a_vertexOffset;\n  v_size \x3d abs(offset);\n#ifdef SDF\n  offset \x3d (120.0 / 86.0) * offset;\n#endif\n#ifdef DD\n  mediump float icon_size \x3d a_size * u_size;\n#else\n  mediump float icon_size \x3d u_size;\n#endif\n  mediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + u_displayViewMat3 * vec3(icon_size * offset, 0.0) + u_displayMat3 * vec3(u_iconTranslation, 0.0);\n  gl_Position \x3d vec4(pos.xy, u_depth + delta_z, 1.0);\n#ifdef DD\n  v_color \x3d a_color * u_color;\n#else\n  v_color \x3d u_color;\n#endif\n#ifdef ID\n  v_id \x3d u_id / 255.0;\n#endif\n  v_tex \x3d a_tex.xy / u_mosaicSize;\n  v_transparency *\x3d v_color.w;\n}"},
line:{"line.frag":"varying mediump vec2 v_normal;\nvarying highp float v_accumulatedDistance;\nvarying mediump float v_lineHalfWidth;\nvarying lowp vec4 v_color;\nvarying mediump float v_blur;\n#ifdef PATTERN\nuniform mediump vec2 u_pattern_tl;\nuniform mediump vec2 u_pattern_br;\nuniform mediump vec2 u_spriteSize;\nuniform sampler2D u_texture;\nconst mediump float tileCoordRatio \x3d 8.0;\n#else\nvarying mediump vec2 v_dasharray;\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\n  mediump float fragDist \x3d length(v_normal) * v_lineHalfWidth;\n  lowp float alpha \x3d clamp((v_lineHalfWidth - fragDist) / v_blur, 0.0, 1.0);\n#ifdef PATTERN\n  mediump float relativeTexX \x3d mod((v_accumulatedDistance + v_normal.x * v_lineHalfWidth * tileCoordRatio) / u_spriteSize.x, 1.0);\n  mediump float relativeTexY \x3d 0.5 + (v_normal.y * v_lineHalfWidth / u_spriteSize.y);\n  mediump vec2 texCoord \x3d mix(u_pattern_tl, u_pattern_br, vec2(relativeTexX, relativeTexY));\n  lowp vec4 color \x3d texture2D(u_texture, texCoord);\n  gl_FragColor \x3d alpha * v_color[3] * color;\n#else\n  lowp float dashPos \x3d  mod(v_accumulatedDistance, v_dasharray.x + v_dasharray.y);\n  lowp float dashAlpha \x3d clamp(min(dashPos, v_dasharray.x - dashPos) + 0.5, 0.0, 1.0);\n  dashAlpha \x3d max(sign(-v_dasharray.y), dashAlpha);\n  alpha *\x3d dashAlpha;\n  gl_FragColor \x3d alpha * v_color;\n#endif\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"line.vert":"attribute vec2 a_pos;\nattribute vec4 a_offsetAndNormal;\nattribute vec2 a_accumulatedDistance;\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform mediump vec2 u_lineTranslation;\nuniform mediump float u_blur;\nuniform mediump float u_antialiasing;\nuniform mediump float u_depth;\nvarying mediump vec2 v_normal;\nvarying highp float v_accumulatedDistance;\nconst float scale \x3d 1.0 / 31.0;\n#ifdef DD\nattribute vec4 a_color;\nattribute mediump float a_width;\n#endif\nuniform lowp vec4 u_color;\nuniform mediump float u_width;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\nvarying mediump float v_lineHalfWidth;\nvarying mediump float v_blur;\n#ifndef PATTERN\nuniform mediump vec2 u_dasharray;\nvarying mediump vec2 v_dasharray;\n#endif\nvoid main()\n{\n  v_normal \x3d a_offsetAndNormal.zw * scale;\n#ifdef DD\n  v_lineHalfWidth \x3d a_width * u_width;\n#else\n  v_lineHalfWidth \x3d u_width;\n#endif\n  v_lineHalfWidth +\x3d u_antialiasing;\n  v_lineHalfWidth *\x3d 0.5;\n#ifndef PATTERN\n#ifdef DD\n  v_dasharray \x3d u_dasharray * a_width;\n#else\n  v_dasharray \x3d u_dasharray * u_width;\n#endif\n#endif\n  mediump vec2 dist \x3d v_lineHalfWidth * scale * a_offsetAndNormal.xy;\n  mediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) +  u_displayViewMat3 * vec3(dist, 0.0) + u_displayMat3 * vec3(u_lineTranslation, 0.0);\n  gl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n  v_accumulatedDistance \x3d a_accumulatedDistance.x;\n  v_blur \x3d u_blur + u_antialiasing;\n  #ifdef DD\n    v_color \x3d a_color * u_color;\n  #else\n    v_color \x3d u_color;\n  #endif\n  #ifdef ID\n    v_id \x3d u_id / 255.0;\n  #endif\n}"},
outline:{"outline.frag":"varying lowp vec4 v_color;\nvarying mediump vec2 v_normal;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\n  lowp float dist \x3d abs(v_normal.y);\n  lowp float alpha \x3d smoothstep(1.0, 0.0, dist);\n  gl_FragColor \x3d alpha * v_color;\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}","outline.vert":"attribute vec2 a_pos;\nattribute vec2 a_offset;\nattribute vec2 a_xnormal;\n#ifdef DD\nattribute vec4 a_color;\n#endif\nuniform lowp vec4 u_color;\nvarying lowp vec4 v_color;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform mediump vec2 u_fillTranslation;\nuniform mediump float u_depth;\nuniform mediump float u_outline_width;\nvarying lowp vec2 v_normal;\nconst float scale \x3d 1.0 / 15.0;\nvoid main()\n{\n#ifdef DD\n  v_color \x3d a_color * u_color;\n#else\n  v_color \x3d u_color;\n#endif\n#ifdef ID\n  v_id \x3d u_id / 255.0;\n#endif\n  v_normal \x3d a_xnormal;\n  mediump vec2 dist \x3d u_outline_width * scale * a_offset;\n  mediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + u_displayMat3 * vec3(dist + u_fillTranslation, 0.0);\n  gl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n}"},
text:{"text.frag":"uniform lowp sampler2D u_texture;\nuniform mediump float u_edgeDistance;\nvarying lowp vec2 v_tex;\nvarying lowp float v_transparency;\nvarying lowp vec4 v_color;\nvarying mediump float v_edgeWidth;\nvarying mediump float v_edgeDistance;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\n  lowp float dist \x3d texture2D(u_texture, v_tex).a;\n  mediump float alpha \x3d smoothstep(v_edgeDistance - v_edgeWidth, v_edgeDistance + v_edgeWidth, dist) * v_transparency;\n  gl_FragColor \x3d alpha * v_color;\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"text.vert":"attribute vec2 a_pos;\nattribute vec2 a_vertexOffset;\nattribute vec4 a_tex;\nattribute vec4 a_levelInfo;\nuniform lowp vec4 u_color;\n#ifdef DD\nattribute vec4 a_color;\n#endif\nvarying lowp vec4 v_color;\nuniform mediump float u_size;\n#ifdef DD\nattribute mediump float a_size;\n#endif\nvarying mediump float v_size;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform mediump vec2 u_textTranslation;\nuniform vec2 u_mosaicSize;\nuniform mediump float u_depth;\nuniform mediump float u_mapRotation;\nuniform mediump float u_level;\nuniform lowp float u_keepUpright;\nuniform mediump float u_fadeSpeed;\nuniform mediump float u_minfadeLevel;\nuniform mediump float u_maxfadeLevel;\nuniform mediump float u_fadeChange;\nuniform mediump float u_opacity;\nvarying lowp vec2 v_tex;\nvarying lowp float v_transparency;\nconst float offsetPrecision \x3d 1.0 / 8.0;\nconst mediump float edgePos \x3d 0.75;\nuniform mediump float u_edgeDistance;\nuniform mediump float u_edgeBlur;\nuniform mediump float u_antialiasingWidth;\nvarying mediump float v_edgeDistance;\nvarying mediump float v_edgeWidth;\nuniform lowp float u_halo;\nconst float sdfFontScale \x3d 1.0 / 24.0;\nvoid main()\n{\n  mediump float a_labelMinLevel \x3d a_levelInfo[0];\n  mediump float a_angle        \x3d a_levelInfo[1];\n  mediump float a_minLevel    \x3d a_levelInfo[2];\n  mediump float a_maxLevel    \x3d a_levelInfo[3];\n  mediump float delta_z \x3d 0.0;\n  mediump float rotated \x3d mod(a_angle + u_mapRotation, 256.0);\n  delta_z +\x3d (1.0 - step(u_keepUpright, 0.0)) * step(64.0, rotated) * (1.0 - step(192.0, rotated));\n  delta_z +\x3d 1.0 - step(a_minLevel, u_level);\n  delta_z +\x3d step(a_maxLevel, u_level);\n  mediump float alpha \x3d u_fadeSpeed !\x3d 0.0 ? clamp((u_fadeChange - a_labelMinLevel) / u_fadeSpeed, 0.0, 1.0) : 1.0;\n  v_transparency \x3d (u_fadeSpeed \x3e\x3d 0.0 ? alpha : 1.0 - alpha);\n  if (u_maxfadeLevel \x3c a_labelMinLevel)\n  {\n    v_transparency \x3d 0.0;\n  }\n  if (u_minfadeLevel \x3e\x3d a_labelMinLevel)\n  {\n    v_transparency \x3d 1.0;\n  }\n  delta_z +\x3d step(v_transparency, 0.0);\n  v_tex \x3d a_tex.xy / u_mosaicSize;\n#ifdef DD\n  if (u_halo \x3e 0.5)\n  {\n    v_color \x3d u_color;\n  }\n  else\n  {\n    v_color \x3d a_color * u_color;\n  }\n#else\n  v_color \x3d u_color;\n#endif\n#ifdef DD\n  v_size \x3d a_size * u_size;\n#else\n  v_size \x3d u_size;\n#endif\n#ifdef ID\n  v_id \x3d u_id / 255.0;\n#endif\n  v_edgeDistance \x3d edgePos - u_edgeDistance / v_size;\n  v_edgeWidth \x3d (u_antialiasingWidth + u_edgeBlur) / v_size;\n  mediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + sdfFontScale * u_displayViewMat3 * vec3(offsetPrecision * v_size * a_vertexOffset, 0.0) + u_displayMat3 * vec3(u_textTranslation, 0.0);\n  gl_Position \x3d vec4(pos.xy, u_depth + delta_z, 1.0);\n}"},
util:{"encoding.glsl":"const vec4 rgba2float_factors \x3d vec4(\n    255.0 / (256.0),\n    255.0 / (256.0 * 256.0),\n    255.0 / (256.0 * 256.0 * 256.0),\n    255.0 / (256.0 * 256.0 * 256.0 * 256.0)\n  );\nfloat rgba2float(vec4 rgba) {\n  return dot(rgba, rgba2float_factors);\n}"}}})},"esri/views/2d/engine/webgl/MaterialManager":function(){define("require exports ../../../../core/tsSupport/assignHelper ../../../../core/maybe ../../../webgl ./enums ./shaders/MaterialPrograms".split(" "),function(g,
a,d,h,b,e,m){var c=function(a){return a===e.WGLDrawPhase.HITTEST||a===e.WGLDrawPhase.LABEL_ALPHA},l=function(a,b,l,n){n=n.reduce(function(b,c){var e;return d({},b,(e={},e[c]=a.driverTestResult[c],e))},{});b=d({},b.getVariation(),a.rendererInfo.getVariation(),{highlight:a.drawPhase===e.WGLDrawPhase.HIGHLIGHT,id:c(a.drawPhase)},n);if(h.isSome(l))for(n=0;n<l.length;n++)b[l[n]]=!0;return b};return function(){function a(a){this._programByKey=new Map;this._programCache=new b.ProgramCache(a)}a.prototype.dispose=
function(){this._programCache&&this._programCache.dispose()};a.prototype.getProgram=function(a,b,c,e){void 0===c&&(c=[]);void 0===e&&(e=[]);var f=b.path+c.join(".")+e.join(".");if(this._programByKey.has(f))return this._programByKey.get(f);e=e.reduce(function(b,c){var e;return d({},b,(e={},e[c]=a.driverTestResult[c],e))},{});c=d({},c.reduce(function(a,b){var c;return d({},a,(c={},c[b]=!0,c))},{}),e);b=this._programCache.getProgram(m.createProgramTemplate(b.path,b.attributes),c);if(!b)throw Error("Unable to get program for key: ${key}");
this._programByKey.set(f,b);return b};a.prototype.getMaterialProgram=function(a,b,f,p,d,u){void 0===u&&(u=["ignoresSamplerPrecision"]);var k,r=u;k=a.rendererInfo;var n=a.drawPhase,r=b.getVariationHash()+"-"+r.join(".")+"-",n=(c(n)?1:0)|(n===e.WGLDrawPhase.HIGHLIGHT?2:0);k=r+n+"-"+k.getVariationHash()+"-"+(h.isSome(d)&&d.join("."));if(this._programByKey.has(k))return this._programByKey.get(k);a=l(a,b,d,u);f=this._programCache.getProgram(m.createProgramTemplate(f,p),a);if(!f)throw Error("Unable to get program for key: ${key}");
this._programByKey.set(k,f);return f};return a}()})},"esri/views/2d/engine/webgl/shaders/MaterialPrograms":function(){define(["require","exports","../../../../webgl","./sources/resolver"],function(g,a,d,h){Object.defineProperty(a,"__esModule",{value:!0});var b=function(a){var b={},c;for(c in a){for(var e=c,f=void 0,f=""+e[0].toUpperCase(),t=1;t<e.length;t++){var h=e[t];h===h.toUpperCase()?(f+="_",f+=h):f+=h.toUpperCase()}b[f]=a[c]}return d.glslifyDefineMap(b)};a.createProgramTemplate=function(a,d){var c=
a+a.substring(a.lastIndexOf("/"));return{name:name,attributes:d,shaders:function(a){return{vertexShader:b(a)+h.resolveIncludes(c+".vert"),fragmentShader:b(a)+h.resolveIncludes(c+".frag")}}}}})},"esri/views/2d/engine/webgl/TextureManager":function(){define("require exports ../../../../core/tsSupport/assignHelper ../../../../core/tsSupport/awaiterHelper ../../../../core/tsSupport/generatorHelper ../../../../config ../../../../request ../../../../core/Error ../../../../core/Logger ../../../../core/promiseUtils ../../../../core/libs/gl-matrix-2/vec2 ../../../../core/libs/gl-matrix-2/vec2f32 ../../../../symbols/cim/Rasterizer ./definitions ./enums ./fontUtils ./GlyphMosaic ./GlyphSource ./SDFConverter ./SpriteMosaic ./util/Result ./util/symbolUtils".split(" "),
function(g,a,d,h,b,e,m,c,l,f,t,x,n,p,y,u,k,r,z,q,E,A){var B=x.vec2f32.create(),C=l.getLogger("esri.views.2d.engine.webgl.TextureManager"),D=function(){function a(a,b,c){this.mosaicType=a;this.page=b;this.sdf=c}a.fromMosaic=function(b,c){return new a(b,c.page,c.sdf)};return a}();return function(){function a(){this._invalidFontsMap=new Map;this._sdfConverter=new z.default(126);this._bindingInfos=[];this._hashToBindingIndex=new Map;this._rasterizer=new n.default;this._spriteMosaic=new q(2048,2048,500);
this._glyphSource=new r(e.fontsUrl+"/{fontstack}/{range}.pbf");this._glyphMosaic=new k(1024,1024,this._glyphSource)}Object.defineProperty(a.prototype,"sprites",{get:function(){return this._spriteMosaic},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"glyphs",{get:function(){return this._glyphMosaic},enumerable:!0,configurable:!0});a.prototype.dispose=function(){this._spriteMosaic.dispose();this._glyphMosaic.dispose();this._rasterizer.dispose();this._rasterizer=this._glyphMosaic=
this._spriteMosaic=null};a.prototype._hashMosaic=function(a,b){return 1|a<<1|(b.sdf?1:0)<<2|b.page<<3};a.prototype._setTextureBinding=function(a,b){var c=this._hashMosaic(a,b);this._hashToBindingIndex.has(c)||(a=D.fromMosaic(a,b),this._hashToBindingIndex.set(c,this._bindingInfos.length+1),this._bindingInfos.push(a));b.textureBinding=this._hashToBindingIndex.get(c)};a.prototype.rasterizeItem=function(a,b,e){var k=this;void 0===b&&(b=null);return a?a.type&&-1!==a.type.toLowerCase().indexOf("3d")?(C.error(new c("mapview-invalid-type",
"MapView does not support 3d symbol type: "+a.type,a)),f.resolve({glyphMosaicItems:[],spriteMosaicItem:null})):!a.type||"text"!==a.type&&"esriTS"!==a.type&&"CIMTextSymbol"!==a.type?this._rasterizeSpriteSymbol(a,e).then(function(a){E.ok(a)&&a&&k._setTextureBinding(y.MosaicType.SPRITE,a);return{spriteMosaicItem:a}}):this._rasterizeTextSymbol(a,b,e).then(function(a){a.forEach(function(a){return k._setTextureBinding(y.MosaicType.GLYPH,a)});return{glyphMosaicItems:a}}):(C.error(new c("mapview-null-resource",
"Unable to rasterize null resource")),f.resolve(null))};a.prototype.bindTextures=function(a,b,c,e){void 0===e&&(e=1);if(0!==c.textureBinding){var k=this._bindingInfos[c.textureBinding-1];c=k.page;switch(k.mosaicType){case y.MosaicType.SPRITE:k=this.sprites.getWidth(c)/e;e=this.sprites.getHeight(c)/e;e=t.vec2.set(B,k,e);this._bindSpritePage(a,c,p.TEXTURE_BINDING_SPRITE_ATLAS,9729);b.setUniform1i("u_texture",p.TEXTURE_BINDING_SPRITE_ATLAS);b.setUniform2fv("u_mosaicSize",e);break;case y.MosaicType.GLYPH:k=
this.glyphs.width/e;e=this.glyphs.height/e;e=t.vec2.set(B,k,e);this._bindGlyphsPage(a,c,p.TEXTURE_BINDING_GLYPH_ATLAS);b.setUniform1i("u_texture",p.TEXTURE_BINDING_GLYPH_ATLAS);b.setUniform2fv("u_mosaicSize",e);break;default:C.error("mapview-texture-manager","Cannot handle unknown type "+k.mosaicType)}}};a.prototype._bindSpritePage=function(a,b,c,e){e||(e=9729);this._spriteMosaic.bind(a,e,b,c)};a.prototype._bindGlyphsPage=function(a,b,c){this._glyphMosaic.bind(a,9729,b,c)};a.prototype._rasterizeTextSymbol=
function(a,b,e){var k=this,f=u.getFullyQualifiedFontName(a.font);a=this._invalidFontsMap.has(f);return this._glyphMosaic.getGlyphItems(a?"arial-unicode-ms-regular":f,b,e).catch(function(){C.error(new c("mapview-invalid-resource","Couldn't find font "+f+". Falling back to Arial Unicode MS Regular"));k._invalidFontsMap.set(f,!0);return k._glyphMosaic.getGlyphItems("arial-unicode-ms-regular",b,e)})};a.prototype._rasterizeSpriteSymbol=function(a,e){return h(this,void 0,void 0,function(){var k,f,l,p,q,
r;return b(this,function(b){b="CIMSolidStroke"===a.type||"CIMSolidFill"===a.type?!0:a&&(A.isFillSymbol(a)||A.isLineSymbol(a))&&"style"in a&&("solid"===a.style||"esriSFSSolid"===a.style||"esriSLSSolid"===a.style||"none"===a.style||"esriSFSNull"===a.style||"esriSLSNull"===a.style);if(b)return[2,null];k=A.keyFromSymbol(a);return this._spriteMosaic.has(k)?[2,this._spriteMosaic.getSpriteItem(k)]:"simple-marker"!==a.type&&"esriSMS"!==a.type||!a.path?a.url||a.imageData?[2,this._handleImage(a,k,e)]:(f=this._rasterizer.rasterizeJSONResource(a))?
(l=f.size,p=f.image,q=f.sdf,r=f.simplePattern,[2,this._addItemToMosaic(k,l,p,!A.isMarkerSymbol(a),q,r)]):[2,new c("TextureManager","unrecognized or null rasterized image")]:[2,this._handleSVG(a,k,e)]})})};a.prototype._handleSVG=function(a,c,e){return h(this,void 0,void 0,function(){var k,f;return b(this,function(b){switch(b.label){case 0:return k=[126,126],[4,this._sdfConverter.draw(a.path,e)];case 1:return f=b.sent(),[2,this._addItemToMosaic(c,k,new Uint32Array(f.buffer),!1,!0,!0)]}})})};a.prototype._handleImage=
function(a,e,k){return h(this,void 0,void 0,function(){var l,p,q,r,n,z,t;return b(this,function(b){switch(b.label){case 0:l=a.imageData?"data:"+a.contentType+";base64,"+a.imageData:a.url,b.label=1;case 1:return b.trys.push([1,3,,4]),[4,m(l,d({responseType:"image"},k))];case 2:return p=b.sent().data,q=this._rasterizer.rasterizeImageResource(p,a.colorSubstitutions),r=q.size,n=q.sdf,z=q.image,[2,this._addItemToMosaic(e,r,z,!A.isMarkerSymbol(a),n,!1)];case 3:return t=b.sent(),f.isAbortError(t)?[3,4]:
[2,new c("mapview-invalid-resource","Could not fetch requested resource at "+l)];case 4:return[2,void 0]}})})};a.prototype._addItemToMosaic=function(a,b,c,e,k,f){return this._spriteMosaic.addSpriteItem(a,b,c,e,k,f)};return a}()})},"esri/symbols/cim/Rasterizer":function(){define(["require","exports","./CIMSymbolHelper","./SDFHelper","./utils"],function(g,a,d,h,b){Object.defineProperty(a,"__esModule",{value:!0});g=function(){function a(){}a.prototype.dispose=function(){this._rasterizationCanvas=null};
a.prototype.rasterizeJSONResource=function(a,b){this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));if("simple-fill"===a.type||"esriSFS"===a.type)return b=d.SymbolHelper.rasterizeSimpleFill(this._rasterizationCanvas,a.style),{size:[b[1],b[2]],image:new Uint32Array(b[0].buffer),sdf:!1,simplePattern:!0,anchorX:0,anchorY:0};if("simple-line"===a.type||"esriSLS"===a.type)return b=d.SymbolHelper.rasterizeSimpleLine(a.style,a.cap),{size:[b[1],b[2]],image:new Uint32Array(b[0].buffer),
sdf:!0,simplePattern:!0,anchorX:0,anchorY:0};var c;a="simple-marker"===a.type||"esriSMS"===a.type?d.CIMSymbolHelper.fromSimpleMarker(a):a;if((c=h.getSDFInfo(a))&&!b)return b=h.buildSDF(c),(a=b[0])?{size:[b[1],b[2]],image:new Uint32Array(a.buffer),sdf:!0,simplePattern:!0,anchorX:0,anchorY:0}:null;b=d.CIMSymbolHelper.rasterize(this._rasterizationCanvas,a,!b);a=b[0];c=b[3];var e=b[4];return a?{size:[b[1],b[2]],image:new Uint32Array(a.buffer),sdf:!1,simplePattern:!1,anchorX:c,anchorY:e}:null};a.prototype.rasterizeImageResource=
function(a,c){this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));this._rasterizationCanvas.width=a.width;this._rasterizationCanvas.height=a.height;var e=this._rasterizationCanvas.getContext("2d");e.drawImage(a,0,0,a.width,a.height);e=e.getImageData(0,0,a.width,a.height);e=new Uint8Array(e.data);if(c)for(var f=0;f<c.length;f++){var d=c[f];if(d&&d.oldColor&&4===d.oldColor.length&&d.newColor&&4===d.newColor.length){var m=d.oldColor,n=m[0],p=m[1],h=m[2],m=m[3],u=d.newColor,
d=u[0],k=u[1],r=u[2],z=u[3];if(n!==d||p!==k||h!==r||m!==z)for(u=0;u<e.length;u+=4)n===e[u]&&p===e[u+1]&&h===e[u+2]&&m===e[u+3]&&(e[u]=d,e[u+1]=k,e[u+2]=r,e[u+3]=z)}}for(u=0;u<e.length;u+=4)c=e[u+3]/255,e[u]*=c,e[u+1]*=c,e[u+2]*=c;c=a.width;f=a.height;n=e;if(512<=c||512<=f)n=a.width/a.height,1<n?(c=512,f=Math.round(512/n)):(f=512,c=Math.round(512*n)),n=new Uint8Array(4*c*f),b.resampleHermite(e,a.width,a.height,new Uint8ClampedArray(n.buffer),c,f,!1);return{size:[c,f],image:new Uint32Array(n.buffer),
sdf:!1,simplePattern:!1,anchorX:0,anchorY:0}};return a}();a.default=g})},"esri/symbols/cim/CIMSymbolHelper":function(){define("require exports ../../Color ../../core/Logger ../../geometry/support/jsonUtils ../cim/CIMCursor ../cim/CIMEffects ../cim/CIMOperators ../cim/CIMPlacements ./CIMSymbolDrawHelper ./packingUtils".split(" "),function(g,a,d,h,b,e,m,c,l,f,t){function x(a,b){switch(b.type){case "CIMSymbolReference":var c={type:"point",x:0,y:0};a.drawSymbol(b.symbol,c);break;case "CIMPointSymbol":c=
{type:"point",x:0,y:0};a.drawSymbol(b,c);break;case "CIMVectorMarker":c=new l.Placement,a.drawMarker(b,c)}return a.envelope()}Object.defineProperty(a,"__esModule",{value:!0});var n=Math.PI,p=n/2,y=h.getLogger("esri.symbols.cim.CIMSymbolHelper");g=function(){function a(){}a.getEnvelope=function(a){var b=new f.EnvDrawHelper;if(Array.isArray(a)){for(var c=void 0,e=0;e<a.length;e++){var k=a[e];c?c.union(x(b,k)):c=x(b,k)}return c}return x(b,a)};a.getTextureAnchor=function(a){a=this.getEnvelope(a);if(!a||
0>=a.width||0>=a.height)return[0,0];var b=96/72;return[(a.x+.5*a.width)*b/(a.width*b+2),-(a.y+.5*a.height)*b/(a.height*b+2)]};a.rasterize=function(a,b,c){void 0===c&&(c=!0);var e=this.getEnvelope(b);if(!e||0>=e.width||0>=e.height)return[null,0,0,0,0];var k=96/72,p=(e.x+.5*e.width)*k,n=(e.y+.5*e.height)*k;a.width=e.width*k+2;a.height=e.height*k+2;e=a.getContext("2d");k=f.Transformation.createScale(k,-k);k.translate(.5*a.width-p,.5*a.height+n);k=new f.CanvasDrawHelper(e,k);switch(b.type){case "CIMPointSymbol":k.drawSymbol(b,
{type:"point",x:0,y:0});break;case "CIMVectorMarker":var d=new l.Placement;k.drawMarker(b,d)}b=e.getImageData(0,0,a.width,a.height);b=new Uint8Array(b.data);if(c)for(c=void 0,e=0;e<b.length;e+=4)c=b[e+3]/255,b[e]*=c,b[e+1]*=c,b[e+2]*=c;return[b,a.width,a.height,-p/a.width,-n/a.height]};a.fromSimpleMarker=function(a){var b,c,e=a.style;if("circle"===e||"esriSMSCircle"===e){b=Math.acos(.995);c=Math.ceil(n/b/4);0===c&&(c=1);b=p/c;c*=4;e=[];e.push([50,0]);for(var k=1;k<c;k++)e.push([50*Math.cos(k*b),-50*
Math.sin(k*b)]);e.push([50,0]);b={rings:[e]};c={xmin:-50,ymin:-50,xmax:50,ymax:50}}else if("cross"===e||"esriSMSCross"===e)b=0,b={rings:[[[b,50],[b,b],[50,b],[50,-b],[b,-b],[b,-50],[-b,-50],[-b,-b],[-50,-b],[-50,b],[-b,b],[-b,50],[b,50]]]},c={xmin:-50,ymin:-50,xmax:50,ymax:50};else if("diamond"===e||"esriSMSDiamond"===e)b={rings:[[[-50,0],[0,50],[50,0],[0,-50],[-50,0]]]},c={xmin:-50,ymin:-50,xmax:50,ymax:50};else if("square"===e||"esriSMSSquare"===e)b={rings:[[[-50,-50],[-50,50],[50,50],[50,-50],
[-50,-50]]]},c={xmin:-50,ymin:-50,xmax:50,ymax:50};else if("x"===e||"esriSMSX"===e)b=0,b={rings:[[[0,b],[50-b,50],[50,50-b],[b,0],[50,b-50],[50-b,-50],[0,-b],[b-50,-50],[-50,b-50],[-b,0],[-50,50-b],[b-50,50],[0,b]]]},c={xmin:-50,ymin:-50,xmax:50,ymax:50};else if("triangle"===e||"esriSMSTriangle"===e)c=2/3*100,e=c-100,b={rings:[[[-57.735026918962575,e],[0,c],[57.735026918962575,e],[-57.735026918962575,e]]]},c={xmin:-57.735026918962575,ymin:e,xmax:57.735026918962575,ymax:c};var f;b&&c&&(f=[{type:"CIMSolidFill",
enable:!0,color:a.color}],a.outline&&f.push({type:"CIMSolidStroke",enable:!0,width:a.outline.width,color:a.outline.color}),f={type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,rotation:a.angle,size:a.size,offsetX:a.xoffset,offsetY:a.yoffset,frame:c,markerGraphics:[{type:"CIMMarkerGraphic",geometry:b,symbol:{type:"CIMPolygonSymbol",symbolLayers:f}}]}]});return f};a.getFillColor=function(b){if(!b)return null;switch(b.type){case "CIMPolygonSymbol":if(b.symbolLayers){var c=0;for(b=
b.symbolLayers;c<b.length;c++){var e=a.getFillColor(b[c]);if(null!=e)return e}}break;case "CIMTextSymbol":return a.getFillColor(b.symbol);case "CIMSolidFill":return b.color}};a.getStrokeColor=function(b){if(b)switch(b.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(b.symbolLayers){var c=0;for(b=b.symbolLayers;c<b.length;c++){var e=a.getStrokeColor(b[c]);if(void 0!==e)return e}}break;case "CIMTextSymbol":return a.getStrokeColor(b.symbol);case "CIMSolidStroke":return b.color}};a.getStrokeWidth=
function(b){if(b)switch(b.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(b.symbolLayers){var c=0;for(b=b.symbolLayers;c<b.length;c++){var e=a.getStrokeWidth(b[c]);if(void 0!==e)return e}}break;case "CIMTextSymbol":return a.getStrokeWidth(b.symbol);case "CIMSolidStroke":case "CIMGradientStroke":case "CIMPictureStroke":return b.width}};a.getSize=function(b){if(b)switch(b.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":var c=0;if(b.symbolLayers){var e=0;for(b=b.symbolLayers;e<
b.length;e++){var f=a.getSize(b[e]);f>c&&(c=f)}}return c;case "CIMSolidStroke":case "CIMPictureStroke":case "CIMGradientStroke":return b.width;case "CIMCharacterMarker":case "CIMPictureMarker":case "CIMVectorMarker":return b.size}};a.getMarkerScaleRatio=function(a){if(a)switch(a.type){case "CIMVectorMarker":if(!1!==a.scaleSymbolsProportionally&&a.frame)return a.size/(a.frame.ymax-a.frame.ymin)}return 1};a.executeEffects=function(a,b,e){void 0===e&&(e=!1);var f=96/72,k=a?a.length:0;k&&e&&--k;for(e=
0;e<k;++e){var l=a[e];if(l){var p=c.getEffectOperator(l);p&&(b=p.execute(b,l,f))}}return b};a.processEffects=function(c,f,l){var k;c.effects&&0<c.effects.length&&(k=e.deltaEncodeGeometry(l),k=new m.SimpleGeometryCursor(k),k=a.executeEffects(c.effects,k));c=c.symbolLayers[f];c.effects&&0<c.effects.length&&(f=!1,"CIMGeometricEffectDashes"===c.effects[c.effects.length-1].type&&(f=!0),k||(k=e.deltaEncodeGeometry(l),k=new m.SimpleGeometryCursor(k)),k=a.executeEffects(c.effects,k,f));if(!k)return l;l=[];
for(c=k.next();c;)l.push(c),c=k.next();k=l.length;switch(k){case 0:return null;case 1:return e.deltaEncodeGeometry(l[0]);default:c=l[0];for(f=1;f<k;++f){var p=l[f];b.isPolygon(c)&&b.isPolygon(p)&&Array.prototype.push.apply(c.rings,p.rings);b.isPolyline(c)&&b.isPolyline(p)&&Array.prototype.push.apply(c.paths,p.paths)}return e.deltaEncodeGeometry(c)}};return a}();a.CIMSymbolHelper=g;g=function(){function a(){}a.rasterizeSimpleFill=function(a,b){"solid"!==b&&"none"!==b&&"esriSFSSolid"!==b&&"esriSFSNull"!==
b||console.error("Unexpected: style does not require rasterization");a.width=8;a.height=8;var c=a.getContext("2d");c.strokeStyle="#FFFFFF";c.lineWidth=1;c.beginPath();if("vertical"===b||"cross"===b||"esriSFSCross"===b||"esriSFSVertical"===b)c.moveTo(0,0),c.lineTo(0,8);if("horizontal"===b||"cross"===b||"esriSFSCross"===b||"esriSFSHorizontal"===b)c.moveTo(0,0),c.lineTo(8,0);if("forward-diagonal"===b||"diagonal-cross"===b||"esriSFSDiagonalCross"===b||"esriSFSForwardDiagonal"===b)c.moveTo(0,0),c.lineTo(8,
8);if("backward-diagonal"===b||"diagonal-cross"===b||"esriSFSBackwardDiagonal"===b||"esriSFSDiagonalCross"===b)c.moveTo(8,0),c.lineTo(0,8);c.stroke();b=c.getImageData(0,0,a.width,a.height);b=new Uint8Array(b.data);for(var e=0;e<b.length;e+=4)c=b[e+3]/255,b[e]*=c,b[e+1]*=c,b[e+2]*=c;return[b,a.width,a.height]};a.rasterizeSimpleLine=function(a,b){switch(b){case "butt":b="Butt";break;case "square":b="Square";break;default:b="Round"}var c="Butt"===b;switch(a){case "dash":case "esriSLSDash":a=c?[4,3]:
[3,4];break;case "dash-dot":case "esriSLSDashDot":a=c?[4,3,1,3]:[3,4,0,4];break;case "dot":case "esriSLSDot":a=c?[1,3]:[0,4];break;case "long-dash":case "esriSLSLongDash":a=c?[8,3]:[7,4];break;case "long-dash-dot":case "esriSLSLongDashDot":a=c?[8,3,1,3]:[7,4,0,4];break;case "long-dash-dot-dot":case "esriSLSDashDotDot":a=c?[8,3,1,3,1,3]:[7,4,0,4,0,4];break;case "short-dash":case "esriSLSShortDash":a=c?[4,1]:[3,2];break;case "short-dash-dot":case "esriSLSShortDashDot":a=c?[4,1,1,1]:[3,2,0,2];break;
case "short-dash-dot-dot":case "esriSLSShortDashDotDot":a=c?[4,1,1,1,1,1]:[3,2,0,2,0,2];break;case "short-dot":case "esriSLSShortDot":a=c?[1,1]:[0,2];break;case "solid":case "esriSLSSolid":case "none":y.error("Unexpected: style does not require rasterization");a=[0,0];break;default:y.error("Tried to rasterize SLS, but found an unexpected style: "+a+"!"),a=[0,0]}return this.rasterizeDash(a,b)};a.rasterizeDash=function(a,b){var c="Butt"===b,e="Square"===b;b=!c&&!e;for(var f=0,k=0;k<a.length;k++)var l=
a[k],f=f+l;for(var f=15*f,p=31*f,k=new Float32Array(p),n=b?225:15,l=0;l<p;++l)k[l]=n;for(var n=p=0,d=!0,m=0;m<a.length;m++){for(var l=a[m],p=n,n=n+15*l,r=p;r<n;){for(var u=0;31>u;){var l=u*f+r,h=b?(u-15)*(u-15):Math.abs(u-15);k[l]=d?c?Math.max(Math.max(p+7.5-r,h),Math.max(r-n+7.5,h)):h:b?Math.min((r-p)*(r-p)+h,(r-n)*(r-n)+h):e?Math.min(Math.max(r-p,h),Math.max(n-r,h)):Math.min(Math.max(r-p+7.5,h),Math.max(n+7.5-r,h));u++}r++}d=!d}a=k.length;c=new Uint8Array(4*a);for(l=0;l<a;++l)t.packFloatRGBA((b?
Math.sqrt(k[l]):k[l])/15,c,4*l);return[c,f,31]};return a}();a.SymbolHelper=g;g=function(){function a(){}a.findApplicableOverrides=function(b,c,e){if(c){if(b.primitiveName){for(var f=!1,l=0;l<e.length;l++){var k=e[l];if(k.primitiveName===b.primitiveName){f=!0;break}}if(!f)for(f=0;f<c.length;f++)k=c[f],k.primitiveName===b.primitiveName&&e.push(k)}switch(b.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":if(b.effects)for(f=0,l=b.effects;f<l.length;f++)k=l[f],a.findApplicableOverrides(k,
c,e);if(b.symbolLayers)for(k=0,b=b.symbolLayers;k<b.length;k++)a.findApplicableOverrides(b[k],c,e);break;case "CIMSolidStroke":case "CIMPictureStroke":case "CIMGradientStroke":case "CIMSolidFill":case "CIMPictureFill":case "CIMHatchFill":case "CIMGradientFill":case "CIMVectorMarker":case "CIMCharacterMarker":case "CIMPictureMarker":if(b.effects)for(f=0,l=b.effects;f<l.length;f++)k=l[f],a.findApplicableOverrides(k,c,e);b.markerPlacement&&a.findApplicableOverrides(b.markerPlacement,c,e);if("CIMVectorMarker"===
b.type){if(b.markerGraphics)for(k=0,b=b.markerGraphics;k<b.length;k++)f=b[k],a.findApplicableOverrides(f,c,e),a.findApplicableOverrides(f.symbol,c,e)}else"CIMCharacterMarker"===b.type?a.findApplicableOverrides(b.symbol,c,e):"CIMHatchFill"===b.type&&a.findApplicableOverrides(b.lineSymbol,c,e)}}};a.applyOverrides=function(b,c,e,f){if(c){if(b.primitiveName)for(var l=0;l<c.length;l++){var k=c[l];if(k.primitiveName===b.primitiveName){var p;p=(p=k.propertyName)?p.charAt(0).toLowerCase()+p.substr(1):p;f&&
f.push({cim:b,nocapPropertyName:p,value:b[p]});k.expression&&(k.value=a.toValue(k.propertyName,k.expression));if(e){for(var n=!1,d=0,q=e;d<q.length;d++)q[d].primitiveName===b.primitiveName&&(n=!0);n||e.push(k)}b[p]=k.value}}switch(b.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":if(b.effects)for(k=0,p=b.effects;k<p.length;k++)l=p[k],a.applyOverrides(l,c,e,f);if(b.symbolLayers)for(l=0,b=b.symbolLayers;l<b.length;l++)a.applyOverrides(b[l],c,e,f);break;case "CIMSolidStroke":case "CIMSolidFill":case "CIMVectorMarker":if(b.effects)for(k=
0,p=b.effects;k<p.length;k++)l=p[k],a.applyOverrides(l,c,e,f);if("CIMVectorMarker"===b.type&&b.markerGraphics)for(l=0,b=b.markerGraphics;l<b.length;l++)k=b[l],a.applyOverrides(k,c,e,f),a.applyOverrides(k.symbol,c,e,f)}}};a.restoreOverrides=function(a){for(var b=0;b<a.length;b++){var c=a[b];c.cim[c.nocapPropertyName]=c.value}};a.buildOverrideKey=function(a){for(var b="",c=0;c<a.length;c++){var e=a[c];void 0!==e.value&&(b+=""+e.primitiveName+e.propertyName+JSON.stringify(e.value))}return b};a.toValue=
function(a,b){return"DashTemplate"===a?b.split(" ").map(function(a){return Number(a)}):"Color"===a?(a=(new d(b)).toRgba(),a[3]*=255,a):b};return a}();a.OverrideHelper=g})},"esri/symbols/cim/CIMCursor":function(){define(["require","exports","../../geometry/support/jsonUtils","./CIMPlacements"],function(g,a,d,h){function b(a){if(a)for(var b=a.length-1;0<b;--b)a[b][0]-=a[b-1][0],a[b][1]-=a[b-1][1]}function e(a){if(a)for(var c=0;c<a.length;c++)b(a[c])}function m(a){if(a)for(var b=a.length,c=1;c<b;++c)a[c][0]+=
a[c-1][0],a[c][1]+=a[c-1][1]}function c(a){if(a)for(var b=0;b<a.length;b++)m(a[b])}function l(a){a&&a.reverse()}function f(a){return{rings:[[[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]]]}}Object.defineProperty(a,"__esModule",{value:!0});a.deltaEncodePath=b;a.deltaEncodeMultipath=e;a.deltaDecodeGeometry=function(a){d.isPolygon(a)?c(a.rings):d.isPolyline(a)?c(a.paths):d.isMultipoint(a)&&m(a.points);return a};a.deltaEncodeGeometry=function(a){d.isPolygon(a)?e(a.rings):
d.isPolyline(a)?e(a.paths):d.isMultipoint(a)&&b(a.points);return a};a.reverseMultipath=function(a){if(a)for(var b=0;b<a.length;b++)l(a[b])};a.reversePath=l;a.getCoord2D=function(a,b,c){return[a[0]+(b[0]-a[0])*c,a[1]+(b[1]-a[1])*c]};a.isClosedPath=function(a){return a&&0!==a.length?a[0][0]===a[a.length-1][0]&&a[0][1]===a[a.length-1][1]:!1};a.getId=function(a){return a[4]};a.setId=function(a,b){a[4]=b};g=function(){function a(a,b,c,e){this.acceptPolygon=b;this.acceptPolyline=c;this.geomUnitsPerPoint=
e;this.pathIndex=this.pathCount=-1;this.iteratePath=!1;a&&(d.isPolygon(a)?b&&(this.multiPath=a.rings,this.isClosed=!0):d.isPolyline(a)?c&&(this.multiPath=a.paths,this.isClosed=!1):d.isExtent(a)&&b&&(this.multiPath=f(a).rings,this.isClosed=!0),this.multiPath&&(this.pathCount=this.multiPath.length));this.internalPlacement=new h.Placement}a.prototype.next=function(){if(!this.multiPath)return null;for(;this.iteratePath||this.pathIndex<this.pathCount-1;){this.iteratePath||this.pathIndex++;var a=this.processPath(this.multiPath[this.pathIndex]);
if(a)return a}this.pathIndex=this.pathCount=-1;return this.multiPath=null};return a}();a.PathTransformationCursor=g;g=function(){function a(a,b,c,e){this.inputGeometries=a;this.acceptPolygon=b;this.acceptPolyline=c;this.geomUnitsPerPoint=e;this.pathIndex=this.pathCount=-1;this.iteratePath=!1}a.prototype.next=function(){for(;;){if(!this.multiPath){for(var a=this.inputGeometries.next();a;)if(d.isPolygon(a)?this.acceptPolygon&&(this.multiPath=a.rings,this.isClosed=!0):d.isPolyline(a)?this.acceptPolyline&&
(this.multiPath=a.paths,this.isClosed=!1):d.isExtent(a)&&this.acceptPolygon&&(this.multiPath=f(a).rings,this.isClosed=!0),this.multiPath){this.pathCount=this.multiPath.length;this.pathIndex=-1;break}else a=this.inputGeometries.next();if(!this.multiPath)return null}for(;this.iteratePath||this.pathIndex<this.pathCount-1;)if(this.iteratePath||this.pathIndex++,a=this.processPath(this.multiPath[this.pathIndex]))return a;this.pathIndex=this.pathCount=-1;this.multiPath=null}};return a}();a.PathGeometryCursor=
g})},"esri/symbols/cim/CIMPlacements":function(){define(["require","exports"],function(g,a){Object.defineProperty(a,"__esModule",{value:!0});g=function(){function a(){this.setIdentity()}a.prototype.setIdentity=function(){this.tz=this.ty=this.tx=0;this.s=1;this.rz=this.ry=this.rx=0;this.rz_c=1;this.rz_s=0};a.prototype.setTranslate=function(a,b){this.tx=a;this.ty=b};a.prototype.setTranslateZ=function(a){this.tz=a};a.prototype.setRotateCS=function(a,b){this.rz=void 0;this.rz_c=a;this.rz_s=b};a.prototype.setRotate=
function(a){this.rz=a;this.rz_s=this.rz_c=void 0};a.prototype.setRotateY=function(a){this.ry=a};a.prototype.setScale=function(a){this.s=a};a.prototype.setMeasure=function(a){this.m=a};return a}();a.Placement=g;g=function(){function a(){}a.prototype.next=function(){return null};return a}();a.EmptyPlacementCursor=g})},"esri/symbols/cim/CIMEffects":function(){define(["require","exports","../../core/lang"],function(g,a,d){Object.defineProperty(a,"__esModule",{value:!0});g=function(){function a(a){this._geometry=
a}a.prototype.next=function(){var a=this._geometry;this._geometry=null;return a};return a}();a.SimpleGeometryCursor=g;a.clone=function(a){return d.clone(a)}})},"esri/symbols/cim/CIMOperators":function(){define(["require","exports"],function(g,a){Object.defineProperty(a,"__esModule",{value:!0});a.getEffectOperator=function(a){return null};a.getPlacementOperator=function(a){return null}})},"esri/symbols/cim/CIMSymbolDrawHelper":function(){define("require exports ../../core/tsSupport/extendsHelper ../../core/tsSupport/decorateHelper ../../core/Logger ../../geometry/support/jsonUtils ../cim/CIMEffects ../cim/CIMOperators ../cim/CIMPlacements ./Rect".split(" "),
function(g,a,d,h,b,e,m,c,l,f){Object.defineProperty(a,"__esModule",{value:!0});a.C_DEG_TO_RAD=Math.PI/180;var t=b.getLogger("esri.symbols.cim.CIMSymbolDrawHelper"),x=function(){function a(a){this._t=a}a.createIdentity=function(){return new a([1,0,0,0,1,0])};a.prototype.clone=function(){return new a(this._t.slice())};a.prototype.transform=function(a){var b=this._t;return[b[0]*a[0]+b[1]*a[1]+b[2],b[3]*a[0]+b[4]*a[1]+b[5]]};a.createScale=function(b,c){return new a([b,0,0,0,c,0])};a.prototype.scale=function(a,
b){var c=this._t;c[0]*=a;c[1]*=a;c[2]*=a;c[3]*=b;c[4]*=b;c[5]*=b;return this};a.prototype.scaleRatio=function(){return Math.sqrt(this._t[0]*this._t[0]+this._t[1]*this._t[1])};a.createTranslate=function(b,c){return new a([0,0,b,0,0,c])};a.prototype.translate=function(a,b){var c=this._t;c[2]+=a;c[5]+=b;return this};a.createRotate=function(b){var c=Math.cos(b);b=Math.sin(b);return new a([c,-b,0,b,c,0])};a.prototype.rotate=function(b){return this.multiply(a.createRotate(b))};a.prototype.multiply=function(a){var b=
this._t;a=a._t;var c=b[1]*a[0]+b[4]*a[1],e=b[2]*a[0]+b[5]*a[1]+a[2],f=b[0]*a[3]+b[3]*a[4],l=b[1]*a[3]+b[4]*a[4],p=b[2]*a[3]+b[5]*a[4]+a[5];b[0]=b[0]*a[0]+b[3]*a[1];b[1]=c;b[2]=e;b[3]=f;b[4]=l;b[5]=p;return this};return a}();a.Transformation=x;g=function(){function b(a){this._transfos=[];this._sizeTransfos=[];this._transfos.push(a||x.createIdentity());this._sizeTransfos.push(a?a.scaleRatio():1)}b.prototype.transformPt=function(a){return this._transfos[this._transfos.length-1].transform(a)};b.prototype.transformSize=
function(a){return a*this._sizeTransfos[this._sizeTransfos.length-1]};b.prototype.back=function(){return this._transfos[this._transfos.length-1]};b.prototype.push=function(a){var b=a.scaleRatio();a.multiply(this.back());this._transfos.push(a);this._sizeTransfos.push(this._sizeTransfos[this._sizeTransfos.length-1]*b)};b.prototype.pop=function(){this._transfos.splice(-1,1);this._sizeTransfos.splice(-1,1)};b.prototype.drawSymbol=function(a,b){if(a)switch(a.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":this.drawMultiLayerSymbol(a,
b)}};b.prototype.drawMultiLayerSymbol=function(a,b){if(a){var c=a.symbolLayers;if(c)if(a=a.effects){if(b=this.executeEffects(a,b))for(a=b.next();a;)this.drawSymbolLayers(c,a),a=b.next()}else this.drawSymbolLayers(c,b)}};b.prototype.executeEffects=function(a,b){var e=96/72;b=new m.SimpleGeometryCursor(b);for(var f=a?a.length:0,l=0;l<f;++l){var d=a[l];if(d){var p=c.getEffectOperator(d);p&&(b=p.execute(b,d,e))}}return b};b.prototype.drawSymbolLayers=function(a,b){for(var c=a.length;c--;){var e=a[c];
if(e&&!1!==e.enable){var f=e.effects;if(f){if(f=this.executeEffects(f,b))for(var l=f.next();l;)this.drawSymbolLayer(e,l),l=f.next()}else this.drawSymbolLayer(e,b)}}};b.prototype.drawSymbolLayer=function(a,b){switch(a.type){case "CIMSolidFill":this.drawSolidFill(b,a.color);break;case "CIMSolidStroke":this.drawSolidStroke(b,a.color,a.width);break;case "CIMCharacterMarker":case "CIMPictureMarker":case "CIMVectorMarker":this.drawMarkerLayer(a,b)}};b.prototype.drawMarkerLayer=function(a,b){var e=a.markerPlacement;
if(e){var f=96/72,d=c.getPlacementOperator(e);if(d&&(b=d.execute(b,e,f)))for(e=b.next();e;)this.drawMarker(a,e),e=b.next()}else e=new l.Placement,e.tx=b.x,e.ty=b.y,this.drawMarker(a,e)};b.prototype.drawMarker=function(a,b){switch(a.type){case "CIMCharacterMarker":case "CIMPictureMarker":this.drawPictureMarker(a,b);break;case "CIMVectorMarker":this.drawVectorMarker(a,b)}};b.prototype.drawPictureMarker=function(a,b){};b.prototype.drawVectorMarker=function(b,c){if(b){var e=b.markerGraphics;if(e){var f=
b.size,l=b.frame,d=l?l.ymax-l.ymin:0,f=f&&d?f/d:1,d=x.createIdentity();l&&d.translate(.5*-(l.xmax+l.xmin),.5*-(l.ymax+l.ymin));var n=b.anchorPoint;if(n){var p=n.x,n=n.y;"Absolute"!==b.anchorPointUnits&&l&&(p*=l.xmax-l.xmin,n*=l.ymax-l.ymin);d.translate(-p,-n)}1!==f&&d.scale(f,f);b.rotation&&d.rotate(b.rotation*a.C_DEG_TO_RAD);d.translate(b.offsetX||0,b.offsetY||0);d.translate(c.tx,c.ty);this.push(d);for(b=0;b<e.length;b++)(c=e[b])&&c.symbol&&c.geometry||t.error("Invalid marker graphic",c),this.drawSymbol(c.symbol,
c.geometry);this.pop()}}};return b}();a.CIMSymbolDrawHelper=g;h=function(a){function b(){var b=a.call(this)||this;b.reset();return b}d(b,a);b.prototype.reset=function(){this._xmin=this._ymin=Infinity;this._xmax=this._ymax=-Infinity};b.prototype.envelope=function(){return new f.default(this._xmin,this._ymin,this._xmax-this._xmin,this._ymax-this._ymin)};b.prototype._merge=function(a,b){a[0]-b<this._xmin&&(this._xmin=a[0]-b);a[0]+b>this._xmax&&(this._xmax=a[0]+b);a[1]-b<this._ymin&&(this._ymin=a[1]-
b);a[1]+b>this._ymax&&(this._ymax=a[1]+b)};b.prototype.drawSolidFill=function(a){if(a&&a.rings){var b=0;for(a=a.rings;b<a.length;b++){var c=a[b],e=c?c.length:0;if(2<e){this._merge(this.transformPt(c[0]),0);for(var f=1;f<e;++f)this._merge(this.transformPt(c[f]),0)}}}};b.prototype.drawSolidStroke=function(a,b,c){b=.5*this.transformSize(c);if(a=e.isPolygon(a)?a.rings:a.paths)for(c=0;c<a.length;c++){var f=a[c],l=f?f.length:0;if(1<l){this._merge(this.transformPt(f[0]),b);for(var k=1;k<l;++k)this._merge(this.transformPt(f[k]),
b)}}};return b}(g);a.EnvDrawHelper=h;g=function(a){function b(b,c){c=a.call(this,c)||this;c._ctx=b;return c}d(b,a);b.prototype.drawSolidFill=function(a,b){if(a&&a.rings){var c=this._ctx;c.fillStyle="string"===typeof b?b:"rgba("+Math.round(b[0])+","+Math.round(b[1])+","+Math.round(b[2])+","+b[3]/255+")";c.beginPath();b=0;for(a=a.rings;b<a.length;b++){var e=a[b],f=e?e.length:0;if(2<f){var l=this.transformPt(e[0]);c.moveTo(l[0],l[1]);for(var d=1;d<f;++d)l=this.transformPt(e[d]),c.lineTo(l[0],l[1]);c.closePath()}}c.fill("evenodd")}};
b.prototype.drawSolidStroke=function(a,b,c){var f=this._ctx;f.strokeStyle="string"===typeof b?b:"rgba("+Math.round(b[0])+","+Math.round(b[1])+","+Math.round(b[2])+","+b[3]/255+")";f.lineWidth=this.transformSize(c)+.5;f.beginPath();b=!1;e.isPolygon(a)?(c=a.rings,b=!0):c=a.paths;for(a=0;a<c.length;a++){var l=c[a],k=l?l.length:0;if(1<k){var d=this.transformPt(l[0]);f.moveTo(d[0],d[1]);for(var n=1;n<k;++n)d=this.transformPt(l[n]),f.lineTo(d[0],d[1]);b&&f.closePath()}}f.stroke()};return b}(g);a.CanvasDrawHelper=
g})},"esri/symbols/cim/Rect":function(){define(["require","exports"],function(g,a){Object.defineProperty(a,"__esModule",{value:!0});g=function(){function a(a,b,e,d){void 0===a&&(a=0);void 0===b&&(b=0);void 0===e&&(e=0);void 0===d&&(d=0);this.x=a;this.y=b;this.width=e;this.height=d}Object.defineProperty(a.prototype,"isEmpty",{get:function(){return 0>=this.width||0>=this.height},enumerable:!0,configurable:!0});a.prototype.union=function(a){this.x=Math.min(this.x,a.x);this.y=Math.min(this.y,a.y);this.width=
Math.max(this.width,a.width);this.height=Math.max(this.height,a.height)};return a}();a.default=g})},"esri/symbols/cim/packingUtils":function(){define(["require","exports"],function(g,a){function d(a){return a-Math.floor(a)}Object.defineProperty(a,"__esModule",{value:!0});var h=[1,256,65536,16777216],b=[1/256,1/65536,1/16777216,1/4294967296],e=function(a,c){void 0===c&&(c=0);for(var e=0,f=0;4>f;f++)e+=a[c+f]*b[f];return e}(new Uint8ClampedArray([255,255,255,255]));a.packFloatRGBA=function(a,b,l){void 0===
l&&(l=0);a=0>a?0:a>e?e:a;for(var c=0;4>c;c++)b[l+c]=Math.floor(256*d(a*h[c]))}})},"esri/symbols/cim/SDFHelper":function(){define(["require","exports","../../geometry/support/jsonUtils","./packingUtils","./Rect"],function(g,a,d,h,b){function e(a){if(!a)return null;switch(a.type){case "CIMPointSymbol":a=a.symbolLayers;if(!a||1!==a.length)break;return e(a[0]);case "CIMVectorMarker":a=a.markerGraphics;if(!a||1!==a.length)break;var b=a[0];if(!b)break;a=b.geometry;if(!a)break;b=b.symbol;if(!b||"CIMPolygonSymbol"!==
b.type&&"CIMLineSymbol"!==b.type)break;return{geom:a,asFill:"CIMPolygonSymbol"===b.type};case "sdf":return{geom:a.geom,asFill:a.asFill}}return null}function m(a){for(var b=Infinity,c=-Infinity,e=Infinity,d=-Infinity,n=0;n<a.length;n++)for(var p=0,m=a[n];p<m.length;p++){var h=m[p];h[0]<b&&(b=h[0]);h[0]>c&&(c=h[0]);h[1]<e&&(e=h[1]);h[1]>d&&(d=h[1])}return[b,e,c,d]}Object.defineProperty(a,"__esModule",{value:!0});a.getSDFInfo=e;a.getSDFSymbol=function(a){a=a.markerGraphics;if(!a||1!==a.length)return null;
a=a[0];if(!a)return null;a=a.symbol;return!a||"CIMPolygonSymbol"!==a.type&&"CIMLineSymbol"!==a.type?null:a};a.getExtent=function(a){return a?a.rings?m(a.rings):a.paths?m(a.paths):d.isExtent(a)?[a.xmin,a.ymin,a.xmax,a.ymax]:null:null};a.getSDFMetrics=function(a,b,e,d,m){var c=a[0],f=a[1],l=a[2];a=a[3];if(l<c||a<f)return[0,0,0];var h=l-c,k=a-f,l=Math.floor(31.5);a=(128-2*(l+1))/Math.max(h,k);var h=Math.round(h*a),k=Math.round(k*a)+2*l,r=1;b&&(r=k/a/(b.ymax-b.ymin));var t=0,q=0;d&&(m?b&&e&&0<b.ymax-
b.ymin&&(t=d.x/((b.xmax-b.xmin)/(b.ymax-b.ymin)*e),q=d.y/e):(t=d.x,q=d.y));t=.5*(b.xmax+b.xmin)+t*(b.xmax-b.xmin);q=.5*(b.ymax+b.ymin)+q*(b.ymax-b.ymin);t=(t-c)*a+l;q=(q-f)*a+l;return[r,t/(h+2*l)-.5,-(q/k-.5)]};a.buildSDF=function(a){var c,e=a.geom;c=e?e.rings?e.rings:e.paths?e.paths:void 0!==e.xmin&&void 0!==e.ymin&&void 0!==e.xmax&&void 0!==e.ymax?[[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]]:null:null;var d,e=Infinity,m=-Infinity,n=Infinity,p=-Infinity;for(d=
0;d<c.length;d++)for(var y=0,u=c[d];y<u.length;y++){var k=u[y];k[0]<e&&(e=k[0]);k[0]>m&&(m=k[0]);k[1]<n&&(n=k[1]);k[1]>p&&(p=k[1])}d=new b.default(e,n,m-e,p-n);n=Math.floor(31.5);y=(128-2*(n+1))/Math.max(d.width,d.height);e=Math.round(d.width*y)+2*n;m=Math.round(d.height*y)+2*n;p=[];for(u=0;u<c.length;u++){var r=c[u];if(r&&1<r.length){for(var k=[],z=0;z<r.length;z++){var q=r[z],g=q[0],q=q[1],g=g-d.x,q=q-d.y,g=g*y,q=q*y,g=g+(n-.5),q=q+(n-.5);k.push([g,q])}a.asFill&&(z=k.length-1,k[0][0]===k[z][0]&&
k[0][1]===k[z][1]||k.push(k[0]));p.push(k)}}d=e*m;c=Array(d);u=n*n+1;for(y=0;y<d;++y)c[y]=u;for(u=0;u<p.length;u++)for(k=p[u],z=k.length,y=1;y<z;++y){var r=k[y-1],g=k[y],A=void 0,q=void 0;r[0]<g[0]?(A=r[0],q=g[0]):(A=g[0],q=r[0]);var B=void 0,C=void 0;r[1]<g[1]?(B=r[1],C=g[1]):(B=g[1],C=r[1]);var D=Math.floor(A)-n,q=Math.floor(q)+n,B=Math.floor(B)-n,C=Math.floor(C)+n;0>D&&(D=0);q>e&&(q=e);0>B&&(B=0);C>m&&(C=m);for(var A=g[0]-r[0],I=g[1]-r[1],L=A*A+I*I;D<q;D++)for(var H=B;H<C;H++){var G=(D-r[0])*A+
(H-r[1])*I,M=void 0,O=void 0;0>G?(M=r[0],O=r[1]):G>L?(M=g[0],O=g[1]):(G/=L,M=r[0]+G*A,O=r[1]+G*I);G=(D-M)*(D-M)+(H-O)*(H-O);M=(m-H-1)*e+D;G<c[M]&&(c[M]=G)}}for(y=0;y<d;++y)c[y]=Math.sqrt(c[y]);if(a.asFill)for(a=0;a<p.length;a++)for(d=p[a],y=d.length,u=1;u<y;++u)for(k=d[u-1],z=d[u],g=r=void 0,k[0]<z[0]?(r=k[0],g=z[0]):(r=z[0],g=k[0]),q=B=void 0,k[1]<z[1]?(B=k[1],q=z[1]):(B=z[1],q=k[1]),r=Math.floor(r),g=Math.floor(g)+1,B=Math.floor(B),q=Math.floor(q)+1,r<n&&(r=n),g>e-n&&(g=e-n),B<n&&(B=n),q>m-n&&(q=
m-n);B<q;++B)if(k[1]>B!==z[1]>B){C=(m-B-1)*e;for(A=r;A<g;++A)A<(z[0]-k[0])*(B-k[1])/(z[1]-k[1])+k[0]&&(c[C+A]=-c[C+A]);for(A=n;A<r;++A)c[C+A]=-c[C+A]}n*=2;p=c.length;a=new Uint8Array(4*p);for(d=0;d<p;++d)h.packFloatRGBA(.5-c[d]/n,a,4*d);return[a,e,m]}})},"esri/symbols/cim/utils":function(){define(["require","exports"],function(g,a){Object.defineProperty(a,"__esModule",{value:!0});a.evaluateValueOrFunction=function(a,h,b,e){return"function"===typeof a?a(h,b,e):a};a.colorToArray=function(a){return[a.r,
a.g,a.b,a.a]};a.resampleHermite=function(a,h,b,e,m,c,l){void 0===l&&(l=!0);var f=h/m;b/=c;for(var d=Math.ceil(f/2),g=Math.ceil(b/2),n=0;n<c;n++)for(var p=0;p<m;p++){for(var y=4*(p+(l?c-n-1:n)*m),u=0,k=0,r=0,z=0,q=0,E=0,A=0,B=(n+.5)*b,C=Math.floor(n*b);C<(n+1)*b;C++)for(var D=Math.abs(B-(C+.5))/g,I=(p+.5)*f,D=D*D,L=Math.floor(p*f);L<(p+1)*f;L++){var H=Math.abs(I-(L+.5))/d,u=Math.sqrt(D+H*H);-1<=u&&1>=u&&(u=2*u*u*u-3*u*u+1,0<u&&(H=4*(L+C*h),A+=u*a[H+3],r+=u,255>a[H+3]&&(u=u*a[H+3]/250),z+=u*a[H],q+=
u*a[H+1],E+=u*a[H+2],k+=u))}e[y]=z/k;e[y+1]=q/k;e[y+2]=E/k;e[y+3]=A/r}}})},"esri/views/2d/engine/webgl/fontUtils":function(){define(["require","exports"],function(g,a){function d(a){a=a.toLowerCase().split(" ").join("-");switch(a){case "serif":return"noto-serif";case "sans-serif":return"arial-unicode-ms";case "monospace":return"ubuntu-mono";case "fantasy":return"cabin-sketch";case "cursive":return"redressed";default:return a}}Object.defineProperty(a,"__esModule",{value:!0});a.getFullyQualifiedFontName=
function(a){var b;a:{if(a.weight)switch(a.weight.toLowerCase()){case "bold":case "bolder":b="-bold";break a}b=""}var e;a:{if(a.style)switch(a.style.toLowerCase()){case "italic":case "oblic":e="-italic";break a}e=""}b+=e;return d(a.family)+(0<b.length?b:"-regular")};a.getFontDecorationTop=function(a){switch(a){case "underline":return-26;case "line-through":return-18}return NaN}})},"esri/views/2d/engine/webgl/GlyphMosaic":function(){define("require exports ../../../../core/has ../../../../core/promiseUtils ../../../webgl ./Rect ./RectangleBinPack".split(" "),
function(g,a,d,h,b,e,m){return function(){function a(a,b,c){this.height=this.width=0;this._dirties=[];this._glyphData=[];this._currentPage=0;this._glyphIndex={};this._textures=[];this._rangePromises=new Map;this.width=a;this.height=b;this._glyphSource=c;this._binPack=new m(a-4,b-4);this._glyphData.push(new Uint8Array(a*b));this._dirties.push(!0);this._textures.push(void 0);this._addDecorationGlyph()}a.prototype.getGlyphItems=function(a,b,c){for(var e=this,f=[],l=this._glyphSource,d=new Set,m=1/256,
k=0;k<b.length;k++)d.add(Math.floor(b[k]*m));var r=[];d.forEach(function(b){if(256>=b){var f=a+b;e._rangePromises.has(f)?r.push(e._rangePromises.get(f)):(b=l.getRange(a,b,c).then(function(){e._rangePromises["delete"](f)}).catch(function(a){e._rangePromises["delete"](f);if(!h.isAbortError(a))throw Error("Unable to query resource");}),e._rangePromises.set(f,b),r.push(b))}});return h.all(r).then(function(){var c,k=e._glyphIndex[a];k||(k={},e._glyphIndex[a]=k);for(var d=0;d<b.length;d++){c=b[d];var n=
k[c];if(n)f[c]={sdf:!0,rect:n.rect,metrics:n.metrics,page:n.page};else if((n=l.getGlyph(a,c))&&n.metrics){var p=e._recordGlyph(n);k[c]={rect:p,metrics:n.metrics,tileIDs:null,page:e._currentPage};f[c]={sdf:!0,rect:p,metrics:n.metrics,page:e._currentPage};e._dirties[e._currentPage]=!0}}return f})};a.prototype._recordGlyph=function(a){var b=a.metrics;if(0===b.width)b=new e.default(0,0,0,0);else{var c=b.width+6,l=b.height+6,d=c%4?4-c%4:4,p=l%4?4-l%4:4;1===d&&(d=5);1===p&&(p=5);b=this._binPack.allocate(c+
d,l+p);b.isEmpty&&(this._dirties[this._currentPage]||(this._glyphData[this._currentPage]=null),this._currentPage=this._glyphData.length,this._glyphData.push(new Uint8Array(this.width*this.height)),this._dirties.push(!0),this._textures.push(void 0),this._binPack=new m(this.width-4,this.height-4),b=this._binPack.allocate(c+d,l+p));d=this._glyphData[this._currentPage];a=a.bitmap;var h=p=void 0;if(a)for(var u=0;u<l;u++)for(var p=c*u,h=this.width*(b.y+u+1)+b.x,k=0;k<c;k++)d[h+k+1]=a[p+k]}return b};a.prototype._addDecorationGlyph=
function(){for(var a=[117,149,181,207,207,181,149,117],b=[],c=0;c<a.length;c++)for(var e=a[c],d=0;11>d;d++)b.push(e);a={metrics:{width:5,height:2,left:0,top:0,advance:0},bitmap:new Uint8Array(b)};this._recordGlyph(a)};a.prototype.bind=function(a,c,e,d){this._textures[e]||(this._textures[e]=new b.Texture(a,{pixelFormat:6406,dataType:5121,width:this.width,height:this.height},new Uint8Array(this.width*this.height)));var f=this._textures[e];f.setSamplingMode(c);this._dirties[e]&&f.setData(this._glyphData[e]);
a.bindTexture(f,d);this._dirties[e]=!1};a.prototype.dispose=function(){this._binPack=null;for(var a=0,b=this._textures;a<b.length;a++){var c=b[a];c&&c.dispose()}this._textures.length=0;this._glyphData.length=0};return a}()})},"esri/views/2d/engine/webgl/Rect":function(){define(["require","exports"],function(g,a){Object.defineProperty(a,"__esModule",{value:!0});g=function(){function a(a,b,e,d){void 0===a&&(a=0);void 0===b&&(b=0);void 0===e&&(e=0);void 0===d&&(d=0);this.x=a;this.y=b;this.width=e;this.height=
d}Object.defineProperty(a.prototype,"isEmpty",{get:function(){return 0>=this.width||0>=this.height},enumerable:!0,configurable:!0});a.prototype.union=function(a){this.x=Math.min(this.x,a.x);this.y=Math.min(this.y,a.y);this.width=Math.max(this.width,a.width);this.height=Math.max(this.height,a.height)};return a}();a.default=g})},"esri/views/2d/engine/webgl/RectangleBinPack":function(){define(["require","exports","./Rect"],function(g,a,d){return function(){function a(a,e){this._height=this._width=0;
this._free=[];this._width=a;this._height=e;this._free.push(new d.default(0,0,a,e))}Object.defineProperty(a.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0});a.prototype.allocate=function(a,e){if(a>this._width||e>this._height)return new d.default;for(var b=null,c=-1,l=0;l<this._free.length;++l){var f=this._free[l];a<=f.width&&e<=f.height&&(null===b||f.y<=
b.y&&f.x<=b.x)&&(b=f,c=l)}if(null===b)return new d.default;this._free.splice(c,1);b.width<b.height?(b.width>a&&this._free.push(new d.default(b.x+a,b.y,b.width-a,e)),b.height>e&&this._free.push(new d.default(b.x,b.y+e,b.width,b.height-e))):(b.width>a&&this._free.push(new d.default(b.x+a,b.y,b.width-a,b.height)),b.height>e&&this._free.push(new d.default(b.x,b.y+e,a,b.height-e)));return new d.default(b.x,b.y,a,e)};a.prototype.release=function(a){for(var b=0;b<this._free.length;++b){var d=this._free[b];
if(d.y===a.y&&d.height===a.height&&d.x+d.width===a.x)d.width+=a.width;else if(d.x===a.x&&d.width===a.width&&d.y+d.height===a.y)d.height+=a.height;else if(a.y===d.y&&a.height===d.height&&a.x+a.width===d.x)d.x=a.x,d.width+=a.width;else if(a.x===d.x&&a.width===d.width&&a.y+a.height===d.y)d.y=a.y,d.height+=a.height;else continue;this._free.splice(b,1);this.release(a)}this._free.push(a)};return a}()})},"esri/views/2d/engine/webgl/GlyphSource":function(){define("require exports ../../../../core/tsSupport/assignHelper ../../../../request ../../../../core/pbf ../../../../core/promiseUtils".split(" "),
function(g,a,d,h,b,e){var m=function(){function a(a){this._metrics=[];for(this._bitmaps=[];a.next();)switch(a.tag()){case 1:for(var b=a.getMessage();b.next();)switch(b.tag()){case 3:for(var c=b.getMessage(),e=void 0,f=void 0,l=void 0,d=void 0,k=void 0,m=void 0,h=void 0;c.next();)switch(c.tag()){case 1:e=c.getUInt32();break;case 2:f=c.getBytes();break;case 3:l=c.getUInt32();break;case 4:d=c.getUInt32();break;case 5:k=c.getSInt32();break;case 6:m=c.getSInt32();break;case 7:h=c.getUInt32();break;default:c.skip()}c.release();
e&&(this._metrics[e]={width:l,height:d,left:k,top:m,advance:h},this._bitmaps[e]=f);break;default:b.skip()}b.release();break;default:a.skip()}}a.prototype.getMetrics=function(a){return this._metrics[a]};a.prototype.getBitmap=function(a){return this._bitmaps[a]};return a}(),c=function(){function a(){this._ranges=[]}a.prototype.getRange=function(a){return this._ranges[a]};a.prototype.addRange=function(a,b){this._ranges[a]=b};return a}();return function(){function a(a){this._glyphInfo={};this._baseURL=
a}a.prototype.getRange=function(a,c,l){var f=this._getFontStack(a);if(f.getRange(c))return e.resolve();var p=256*c,t=p+255;a=this._baseURL.replace("{fontstack}",a).replace("{range}",p+"-"+t);return h(a,d({responseType:"array-buffer"},l)).then(function(a){f.addRange(c,new m(new b(new Uint8Array(a.data),new DataView(a.data))))})};a.prototype.getGlyph=function(a,b){if(a=this._getFontStack(a)){var c=Math.floor(b/256);if(!(256<c)&&(a=a.getRange(c)))return{metrics:a.getMetrics(b),bitmap:a.getBitmap(b)}}};
a.prototype._getFontStack=function(a){var b=this._glyphInfo[a];b||(b=this._glyphInfo[a]=new c);return b};return a}()})},"esri/views/2d/engine/webgl/SDFConverter":function(){define(["require","exports","../../../../core/promiseUtils","../../../../core/promiseUtils","./packingUtils"],function(g,a,d,h,b){Object.defineProperty(a,"__esModule",{value:!0});g=function(){function a(a){this.size=a;this.canvas=document.createElement("canvas");this.canvas.width=this.canvas.height=a;this.context=this.canvas.getContext("2d");
this._gridOuter=new Float64Array(a*a);this._gridInner=new Float64Array(a*a);this._f=new Float64Array(a);this._d=new Float64Array(a);this._z=new Float64Array(a+1);this._v=new Int16Array(a)}a.prototype.draw=function(a,c,e){var f=this;void 0===e&&(e=31);this._initSVG();var l=this._createSVGString(a);return d.create(function(a,d){var n=new Image;n.src="data:image/svg+xml; charset\x3dutf8, "+encodeURIComponent(l);n.onload=function(){f.context.clearRect(0,0,f.size,f.size);f.context.drawImage(n,0,0,f.size,
f.size);for(var c=f.context.getImageData(0,0,f.size,f.size),l=new Uint8Array(f.size*f.size*4),d=0;d<f.size*f.size;d++){var p=c.data[4*d+3]/255;f._gridOuter[d]=1===p?0:0===p?1E20:Math.pow(Math.max(0,.5-p),2);f._gridInner[d]=1===p?1E20:0===p?0:Math.pow(Math.max(0,p-.5),2)}f._edt(f._gridOuter,f.size,f.size);f._edt(f._gridInner,f.size,f.size);for(d=0;d<f.size*f.size;d++)b.packFloatRGBA(.5-(f._gridOuter[d]-f._gridInner[d])/(2*e),l,4*d);a(l)};var m=c&&c.signal;if(m)h.onAbort(m,function(){return d(h.createAbortError())})})};
a.prototype._initSVG=function(){if(!this._svg){var a=document.createElementNS("http://www.w3.org/2000/svg","svg");a.setAttribute("style","position: absolute;");a.setAttribute("width","0");a.setAttribute("height","0");a.setAttribute("aria-hidden","true");a.setAttribute("role","presentation");document.body.appendChild(a);this._svg=a}};a.prototype._createSVGString=function(a){var b=document.createElementNS("http://www.w3.org/2000/svg","path");b.setAttribute("d",a);this._svg.appendChild(b);a=b.getBBox();
var e=a.width/a.height,f=this.size/2,d,m,n;1<e?(m=d=f/a.width,n=this.size/4,e=f-1/e*f/2):(d=m=f/a.height,n=f-f*e/2,e=this.size/4);b.setAttribute("style","transform: matrix("+d+", 0, 0, "+m+", "+(-a.x*d+n)+", "+(-a.y*m+e)+")");a='\x3csvg style\x3d"fill:red;" height\x3d"'+this.size+'" width\x3d"'+this.size+'" xmlns\x3d"http://www.w3.org/2000/svg"\x3e'+this._svg.innerHTML+"\x3c/svg\x3e";this._svg.removeChild(b);return a};a.prototype._edt=function(a,b,e){for(var c=this._f,l=this._d,d=this._v,n=this._z,
p=0;p<b;p++){for(var m=0;m<e;m++)c[m]=a[m*b+p];this._edt1d(c,l,d,n,e);for(m=0;m<e;m++)a[m*b+p]=l[m]}for(m=0;m<e;m++){for(p=0;p<b;p++)c[p]=a[m*b+p];this._edt1d(c,l,d,n,b);for(p=0;p<b;p++)a[m*b+p]=Math.sqrt(l[p])}};a.prototype._edt1d=function(a,b,e,f,d){e[0]=0;f[0]=-1E20;f[1]=1E20;for(var c=1,l=0;c<d;c++){for(var p=(a[c]+c*c-(a[e[l]]+e[l]*e[l]))/(2*c-2*e[l]);p<=f[l];)l--,p=(a[c]+c*c-(a[e[l]]+e[l]*e[l]))/(2*c-2*e[l]);l++;e[l]=c;f[l]=p;f[l+1]=1E20}for(l=c=0;c<d;c++){for(;f[l+1]<c;)l++;b[c]=(c-e[l])*(c-
e[l])+a[e[l]]}};return a}();a.default=g})},"esri/views/2d/engine/webgl/packingUtils":function(){define(["require","exports"],function(g,a){function d(a){return a-Math.floor(a)}Object.defineProperty(a,"__esModule",{value:!0});var h=[1,256,65536,16777216],b=[1/256,1/65536,1/16777216,1/4294967296],e=function(a,c){void 0===c&&(c=0);for(var e=0,f=0;4>f;f++)e+=a[c+f]*b[f];return e}(new Uint8ClampedArray([255,255,255,255]));a.packFloatRGBA=function(a,b,l){void 0===l&&(l=0);a=0>a?0:a>e?e:a;for(var c=0;4>
c;c++)b[l+c]=Math.floor(256*d(a*h[c]))}})},"esri/views/2d/engine/webgl/SpriteMosaic":function(){define("require exports ../../../../core/has ../../../webgl ./GeometryUtils ./Rect ./RectangleBinPack".split(" "),function(g,a,d,h,b,e,m){return function(){function a(a,b,c){void 0===c&&(c=0);this._size=[];this._mosaicsData=[];this._textures=[];this._dirties=[];this._currentPage=this._maxItemSize=0;this._fixSpriteLocationsTable=d("fix-sprite-locations");this._testId=d("test-id");this._pageHeight=this._pageWidth=
0;this._mosaicRects=new Map;this._spriteCopyQueue=[];this.pixelRatio=1;(0>=a||0>=b)&&console.error("Sprites mosaic defaultWidth and defaultHeight must be greater than zero!");this._pageWidth=a;this._pageHeight=b;0<c&&(this._maxItemSize=c);this.pixelRatio=window.devicePixelRatio||1;if(this._fixSpriteLocationsTable){a=[];for(var e in this._fixSpriteLocationsTable[this._testId])b=this._fixSpriteLocationsTable[this._testId][e],a[b.page]=b.pageSize;for(e=0;e<a.length;e++)b=a[e],this._mosaicsData.push(new Uint32Array(b[0]*
b[1])),this._dirties.push(!0),this._size.push([b[0],b[1]]),this._textures.push(void 0)}this._binPack=new m(this._pageWidth,this._pageHeight);this._mosaicsData.push(new Uint32Array(Math.floor(this._pageWidth)*Math.floor(this._pageHeight)));this._dirties.push(!0);this._size.push([this._pageWidth,this._pageHeight]);this._textures.push(void 0)}a.prototype.getWidth=function(a){return a>=this._size.length?-1:this._size[a][0]};a.prototype.getHeight=function(a){return a>=this._size.length?-1:this._size[a][1]};
a.prototype.getPage=function(a){return a<this._textures.length?this._textures[a]:null};a.prototype.has=function(a){return this._mosaicRects.has(a)};Object.defineProperty(a.prototype,"itemCount",{get:function(){return this._mosaicRects.size},enumerable:!0,configurable:!0});a.prototype.getSpriteItem=function(a){return this._mosaicRects.get(a)};a.prototype.addSpriteItem=function(a,b,c,e,d,p){var f;if(this._mosaicRects.has(a))return this._mosaicRects.get(a);var l,k;this._fixSpriteLocationsTable&&this._fixSpriteLocationsTable[this._testId]&&
this._fixSpriteLocationsTable[this._testId][a]?(f=this._fixSpriteLocationsTable[this._testId][a],l=f.rect,k=f.page,f=f.pageSize):(f=this._allocateImage(b[0],b[1]),l=f[0],k=f[1],f=f[2]);if(0>=l.width||0>=l.height)return null;p={rect:l,width:b[0],height:b[1],sdf:d,simplePattern:p,pixelRatio:1,page:k};this._mosaicRects.set(a,p);this._copy({rect:l,spriteSize:b,spriteData:c,page:k,pageSize:f,repeat:e,sdf:d});return p};a.prototype.hasItemsToProcess=function(){return 0!==this._spriteCopyQueue.length};a.prototype.processNextItem=
function(){var a=this._spriteCopyQueue.pop();a&&this._copy(a)};a.prototype.getSpriteItems=function(a){for(var b={},c=0;c<a.length;c++){var e=a[c];b[e]=this.getSpriteItem(e)}return b};a.prototype.getMosaicItemPosition=function(a){var b=(a=this.getSpriteItem(a))&&a.rect;if(!b)return null;b.width=a.width;b.height=a.height;return{size:[a.width,a.height],tl:[(b.x+1)/this._size[a.page][0],(b.y+1)/this._size[a.page][1]],br:[(b.x+1+a.width)/this._size[a.page][0],(b.y+1+a.height)/this._size[a.page][1]],page:a.page}};
a.prototype.bind=function(a,b,c,e){void 0===c&&(c=0);void 0===e&&(e=0);this._textures[c]||(this._textures[c]=new h.Texture(a,{pixelFormat:6408,dataType:5121,width:this._size[c][0],height:this._size[c][1]},new Uint8Array(this._mosaicsData[c].buffer)));var f=this._textures[c];f.setSamplingMode(b);this._dirties[c]&&(f.setData(new Uint8Array(this._mosaicsData[c].buffer)),f.generateMipmap());a.bindTexture(f,e);this._dirties[c]=!1};a._copyBits=function(a,b,c,e,d,p,m,h,k,r,z){var f=e*b+c;m=h*p+m;if(z)for(m-=
p,z=-1;z<=r;z++,f=((z+r)%r+e)*b+c,m+=p)for(h=-1;h<=k;h++)d[m+h]=a[f+(h+k)%k];else for(z=0;z<r;z++){for(h=0;h<k;h++)d[m+h]=a[f+h];f+=b;m+=p}};a.prototype._copy=function(b){if(!(b.page>=this._mosaicsData.length)){var c=b.spriteData,e=this._mosaicsData[b.page];e&&c||console.error("Source or target images are uninitialized!");a._copyBits(c,b.spriteSize[0],0,0,e,b.pageSize[0],b.rect.x+1,b.rect.y+1,b.spriteSize[0],b.spriteSize[1],b.repeat);this._dirties[b.page]=!0}};a.prototype._allocateImage=function(a,
c){a+=2;c+=2;var f=Math.max(a,c);if(this._maxItemSize&&this._maxItemSize<f){var f=Math.pow(2,Math.ceil(b.log2(a))),l=Math.pow(2,Math.ceil(b.log2(c)));a=new e.default(0,0,a,c);this._mosaicsData.push(new Uint32Array(f*l));this._dirties.push(!0);this._size.push([f,l]);this._textures.push(void 0);return[a,this._mosaicsData.length-1,[f,l]]}f=this._binPack.allocate(a,c);return 0>=f.width?(this._dirties[this._currentPage]||(this._mosaicsData[this._currentPage]=null),this._currentPage=this._mosaicsData.length,
this._mosaicsData.push(new Uint32Array(this._pageWidth*this._pageHeight)),this._dirties.push(!0),this._size.push([this._pageWidth,this._pageHeight]),this._textures.push(void 0),this._binPack=new m(this._pageWidth,this._pageHeight),this._allocateImage(a,c)):[f,this._currentPage,[this._pageWidth,this._pageHeight]]};a.prototype.dispose=function(){this._binPack=null;for(var a=0,b=this._textures;a<b.length;a++){var c=b[a];c&&c.dispose()}this._textures.length=0;this._mosaicsData.length=0;this._mosaicRects.clear()};
return a}()})},"esri/views/2d/engine/webgl/GeometryUtils":function(){define(["require","exports"],function(g,a){function d(a,e){a%=e;return 0<=a?a:a+e}Object.defineProperty(a,"__esModule",{value:!0});a.C_INFINITY=Number.POSITIVE_INFINITY;a.C_PI=Math.PI;a.C_2PI=2*a.C_PI;a.C_PI_BY_2=a.C_PI/2;a.C_RAD_TO_256=128/a.C_PI;a.C_256_TO_RAD=a.C_PI/128;a.C_DEG_TO_256=256/360;a.C_DEG_TO_RAD=a.C_PI/180;a.C_SQRT2=1.414213562;a.C_SQRT2_INV=1/a.C_SQRT2;var h=1/Math.LN2;a.positiveMod=d;a.radToByte=function(b){return d(b*
a.C_RAD_TO_256,256)};a.degToByte=function(b){return d(b*a.C_DEG_TO_256,256)};a.log2=function(a){return Math.log(a)*h};a.sqr=function(a){return a*a};a.interpolate=function(a,e,d){return a*(1-d)+e*d};a.between=function(a,e,d){return a>=e&&a<=d||a>=d&&a<=e}})},"esri/views/2d/engine/webgl/util/Result":function(){define(["require","exports","../../../../../core/Error"],function(g,a,d){Object.defineProperty(a,"__esModule",{value:!0});a.ok=function(a,b){return a&&"name"in a?(b&&b.error(new d(a.name,a.message,
a.details)),!1):!0}})},"esri/views/2d/engine/webgl/util/symbolUtils":function(){define(["require","exports"],function(g,a){function d(a){switch(a){case "esriSMS":return"simple-marker";case "esriPMS":return"picture-marker";case "esriSLS":return"simple-line";case "esriPLS":return"picture-line";case "esriSFS":return"simple-fill";case "esriPFS":return"picture-fill";case "esriTS":return"text"}return a}function h(a){if(a=d(a.type))switch(a){case "picture-marker":case "picture-line":case "picture-fill":return!0;
case "CIMPictureMarker":return!0}return!1}Object.defineProperty(a,"__esModule",{value:!0});a.keyFromSymbol=function(a){if(a.type){switch(d(a.type)){case "simple-marker":return a.path?"simple-marker"+a.style+a.path:"simple-marker"+a.style;case "simple-line":return"simple-line"+a.style+a.cap;case "simple-fill":return"simple-fill"+a.style}if(a.mosaicHash)return a.mosaicHash;if(h(a))return a.imageData?a.imageData:a.url+(""+a.width+a.height)}return JSON.stringify(a)};a.normalizeSymbolType=d;a.isMarkerSymbol=
function(a){if(a=d(a.type)){switch(a){case "simple-marker":case "picture-marker":return!0;case "CIMPointSymbol":return!0;case "CIMVectorMarker":case "CIMPictureMarker":case "CIMCharacterMarker":return!0}return!1}};a.isFillSymbol=function(a){if(a=d(a.type)){switch(a){case "simple-fill":case "picture-fill":return!0;case "CIMPolygonSymbol":return!0}return!1}};a.isLineSymbol=function(a){if(a=d(a.type)){switch(a){case "simple-line":case "picture-line":return!0;case "CIMLineSymbol":return!0}return!1}};
a.isPictureSymbol=h;a.isTextSymbol=function(a){if(a=d(a.type)){switch(a){case "text":return!0;case "CIMTextSymbol":return!0}return!1}}})},"esri/views/2d/engine/webgl/effects/AnimationEffect":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/maybe ../definitions ../VertexStream ./Effect".split(" "),function(g,a,d,h,b,e,m){Object.defineProperty(a,"__esModule",{value:!0});g=function(a){function c(){var b=null!==a&&a.apply(this,arguments)||this;b.defines=
[];b._desc={path:"fx/integrate",attributes:{a_position:0}};return b}d(c,a);c.prototype.dispose=function(){this._quad&&this._quad.dispose()};c.prototype.bind=function(){};c.prototype.unbind=function(){};c.prototype.draw=function(a,c){if(c.size){var f=a.context,d=a.renderingOptions;this._quad||(this._quad=new e(f,[0,0,1,0,0,1,1,1]));var l=f.getBoundFramebufferObject(),m=f.getViewport(),u=m.x,k=m.y,r=m.width,m=m.height;c.bindTextures(f);var z=c.getBlock(b.ATTRIBUTE_DATA_ANIMATION);if(!h.isNone(z)){var q=
z.getFBO(f),z=z.getFBO(f,1);f.setViewport(0,0,c.size,c.size);this._computeDelta(a,z,d.labelsAnimationTime);this._updateAnimationState(a,z,q);f.bindFramebuffer(l);f.setViewport(u,k,r,m)}}};c.prototype._computeDelta=function(a,c,e){var f=a.context,d=a.displayLevel,l=a.painter.materialManager.getProgram(a,this._desc,["delta"]);f.bindFramebuffer(c);f.setClearColor(0,0,0,0);f.clear(f.gl.COLOR_BUFFER_BIT);f.bindProgram(l);l.setUniform1i("u_maskTexture",b.TEXTURE_BINDING_ATTRIBUTE_DATA_0);l.setUniform1i("u_sourceTexture",
b.TEXTURE_BINDING_ATTRIBUTE_DATA_1);l.setUniform1f("u_timeDelta",a.timeDelta);l.setUniform1f("u_animationTime",e/1E3);l.setUniform1f("u_zoomLevel",Math.round(10*d));this._quad.draw()};c.prototype._updateAnimationState=function(a,b,c){var e=a.context;a=a.painter.materialManager.getProgram(a,this._desc,["update"]);e.bindTexture(b.colorTexture,1);e.bindProgram(a);a.setUniform1i("u_sourceTexture",1);e.bindFramebuffer(c);e.setClearColor(0,0,0,0);e.clear(e.gl.COLOR_BUFFER_BIT);this._quad.draw()};return c}(m.Effect);
a.AnimationEffect=g})},"esri/views/2d/engine/webgl/VertexStream":function(){define(["require","exports","../../../../core/tsSupport/declareExtendsHelper","../../../webgl"],function(g,a,d,h){return function(){function a(a,b){this.rctx=a;this._vertexBuffer=h.BufferObject.createVertex(a,35044,new Uint16Array(b));this._vao=new h.VertexArrayObject(a,{a_position:0},{geometry:[{name:"a_position",count:2,type:5123,offset:0,stride:4,normalized:!1}]},{geometry:this._vertexBuffer})}a.prototype.bind=function(){this._vao.bind()};
a.prototype.unbind=function(){this._vao.unbind()};a.prototype.dispose=function(){this._vao.dispose(!1);this._vertexBuffer.dispose()};a.prototype.draw=function(){this.rctx.bindVAO(this._vao);this.rctx.drawArrays(5,0,4)};return a}()})},"esri/views/2d/engine/webgl/effects/Effect":function(){define(["require","exports"],function(g,a){Object.defineProperty(a,"__esModule",{value:!0});g=function(){return function(){this.name=this.constructor.name}}();a.Effect=g})},"esri/views/2d/engine/webgl/effects/HighlightEffect":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/has ../BitBlitRenderer ../effects/Effect ./highlight/HighlightGradient ./highlight/HighlightRenderer ./highlight/HighlightSurfaces".split(" "),
function(g,a,d,h,b,e,m,c,l){Object.defineProperty(a,"__esModule",{value:!0});g=function(a){function e(){var e=null!==a&&a.apply(this,arguments)||this;e.defines=["highlight"];e._hlRenderer=new c.default;e._hlGradient=new m.default;e._width=void 0;e._height=void 0;e._hlSurfaces=new l.default;e._adjustedWidth=void 0;e._adjustedHeight=void 0;e._blitRenderer=new b.BitBlitRenderer;return e}d(e,a);e.prototype.dispose=function(){this._hlSurfaces&&this._hlSurfaces.dispose();this._hlRenderer&&this._hlRenderer.dispose();
this._hlGradient&&this._hlGradient.destroy();this._boundFBO=null};e.prototype.bind=function(a){var b=a.context,c=a.painter,e=b.getViewport(),f=e.width,e=e.height,c=c.getFbos(f,e).effect0;this.setup(a,f,e);b.bindFramebuffer(c);b.setClearColor(0,0,0,0);b.clear(b.gl.COLOR_BUFFER_BIT)};e.prototype.unbind=function(){};e.prototype.setup=function(a,b,c){a=a.context;this._width=b;this._height=c;var e=b%4,f=c%4;b+=2>e?-e:4-e;c+=2>f?-f:4-f;this._adjustedWidth=b;this._adjustedHeight=c;this._boundFBO=a.getBoundFramebufferObject();
b=Math.round(.75*b);c=Math.round(.75*c);this._hlRenderer.setup(a,b,c);this._hlSurfaces.setup(a,b,c)};e.prototype.draw=function(a){a=a.context;var b=a.getBoundFramebufferObject();a.setViewport(0,0,.75*this._adjustedWidth,.75*this._adjustedHeight);a.bindFramebuffer(this._hlSurfaces.sharedBlur1Fbo);a.setStencilTestEnabled(!1);a.setClearColor(0,0,0,0);a.clear(a.gl.COLOR_BUFFER_BIT);this._blitRenderer.render(a,b.colorTexture,9728,1);a.setStencilTestEnabled(!1);a.setBlendingEnabled(!1);a.bindFramebuffer(this._hlSurfaces.sharedBlur2Fbo);
a.setClearColor(0,0,0,0);a.clear(a.gl.COLOR_BUFFER_BIT);this._hlRenderer.preBlur(a,this._hlSurfaces.sharedBlur1Tex);a.bindFramebuffer(this._hlSurfaces.sharedBlur1Fbo);a.setClearColor(0,0,0,0);a.clear(a.gl.COLOR_BUFFER_BIT);this._hlRenderer.finalBlur(a,this._hlSurfaces.sharedBlur2Tex);a.bindFramebuffer(this._boundFBO);a.setBlendingEnabled(!0);a.setViewport(0,0,this._width,this._height);this._hlRenderer.renderHighlight(a,this._hlSurfaces.sharedBlur1Tex,this._hlGradient);this._boundFBO=null};e.prototype.setHighlightOptions=
function(a){this._hlGradient.setHighlightOptions(a)};return e}(e.Effect);a.default=g})},"esri/views/2d/engine/webgl/effects/highlight/HighlightGradient":function(){define("require exports ../../../../../../core/Logger ../../../../../webgl ../../definitions ./parameters".split(" "),function(g,a,d,h,b,e){function m(a,b){b.fillColor[0]=a.color.r/255;b.fillColor[1]=a.color.g/255;b.fillColor[2]=a.color.b/255;b.fillColor[3]=a.color.a;a.haloColor?(b.outlineColor[0]=a.haloColor.r/255,b.outlineColor[1]=a.haloColor.g/
255,b.outlineColor[2]=a.haloColor.b/255,b.outlineColor[3]=a.haloColor.a):(b.outlineColor[0]=b.fillColor[0],b.outlineColor[1]=b.fillColor[1],b.outlineColor[2]=b.fillColor[2],b.outlineColor[3]=b.fillColor[3]);b.fillColor[3]*=a.fillOpacity;b.outlineColor[3]*=a.haloOpacity;b.fillColor[0]*=b.fillColor[3];b.fillColor[1]*=b.fillColor[3];b.fillColor[2]*=b.fillColor[3];b.outlineColor[0]*=b.outlineColor[3];b.outlineColor[1]*=b.outlineColor[3];b.outlineColor[2]*=b.outlineColor[3];b.outlineWidth=e.HIGHLIGHT_SIZING.outlineWidth;
b.outerHaloWidth=e.HIGHLIGHT_SIZING.outerHaloWidth;b.innerHaloWidth=e.HIGHLIGHT_SIZING.innerHaloWidth;b.outlinePosition=e.HIGHLIGHT_SIZING.outlinePosition}Object.defineProperty(a,"__esModule",{value:!0});var c=d.getLogger("esri.views.2d.engine.webgl.painter.highlight.HighlightGradient"),l=[0,0,0,0];g=function(){function a(){this._convertedHighlightOptions={fillColor:[.2*.75,.6*.75,.675,.75],outlineColor:[.2*.9,.54,.81,.9],outlinePosition:e.HIGHLIGHT_SIZING.outlinePosition,outlineWidth:e.HIGHLIGHT_SIZING.outlineWidth,
innerHaloWidth:e.HIGHLIGHT_SIZING.innerHaloWidth,outerHaloWidth:e.HIGHLIGHT_SIZING.outerHaloWidth};this.shadeTexChanged=!0;this.texelData=new Uint8Array(4*e.SHADE_TEXTURE_SIZE);this.minMaxDistance=[0,0]}a.prototype.setHighlightOptions=function(a){function b(a,b,c){q[0]=(1-c)*a[0]+c*b[0];q[1]=(1-c)*a[1]+c*b[1];q[2]=(1-c)*a[2]+c*b[2];q[3]=(1-c)*a[3]+c*b[3]}var f,d=this._convertedHighlightOptions;m(a,d);a=d.outlinePosition-d.outlineWidth/2-d.outerHaloWidth;var h=d.outlinePosition-d.outlineWidth/2,u=
d.outlinePosition+d.outlineWidth/2,k=d.outlinePosition+d.outlineWidth/2+d.innerHaloWidth,r=Math.sqrt(Math.PI/2)*e.SIGMAS[3],z=Math.abs(a)>r?Math.round(10*(Math.abs(a)-r))/10:0,r=Math.abs(k)>r?Math.round(10*(Math.abs(k)-r))/10:0;z&&!r?c.error("The outer rim of the highlight is "+z+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards positive values (inwards)."):!z&&r?c.error("The inner rim of the highlight is "+r+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards negative values (outwards)."):
z&&r&&c.error("The highlight is "+Math.max(z,r)+"px away from the edge of the feature; consider reducing some width values.");for(var q=[void 0,void 0,void 0,void 0],z=this.texelData,r=0;r<e.SHADE_TEXTURE_SIZE;++r)f=a+r/(e.SHADE_TEXTURE_SIZE-1)*(k-a),f<a?(q[4*r+0]=0,q[4*r+1]=0,q[4*r+2]=0,q[4*r+3]=0):f<h?b(l,d.outlineColor,(f-a)/(h-a)):f<u?(f=d.outlineColor,q[0]=f[0],q[1]=f[1],q[2]=f[2],q[3]=f[3]):f<k?b(d.outlineColor,d.fillColor,(f-u)/(k-u)):(f=d.fillColor,q[4*r+0]=f[0],q[4*r+1]=f[1],q[4*r+2]=f[2],
q[4*r+3]=f[3]),z[4*r+0]=255*q[0],z[4*r+1]=255*q[1],z[4*r+2]=255*q[2],z[4*r+3]=255*q[3];this.minMaxDistance[0]=a;this.minMaxDistance[1]=k;this.shadeTexChanged=!0};a.prototype.applyHighlightOptions=function(a,c){this.shadeTex||(this.shadeTex=new h.Texture(a,{target:3553,pixelFormat:6408,dataType:5121,wrapMode:33071,width:e.SHADE_TEXTURE_SIZE,height:1,samplingMode:9729}));this.shadeTexChanged&&(this.shadeTex.updateData(0,0,0,e.SHADE_TEXTURE_SIZE,1,this.texelData),this.shadeTexChanged=!1);a.bindTexture(this.shadeTex,
b.TEXTURE_BINDING_HIGHLIGHT_1);c.setUniform2fv("u_minMaxDistance",this.minMaxDistance)};a.prototype.destroy=function(){this.shadeTex&&(this.shadeTex.dispose(),this.shadeTex=null)};return a}();a.default=g})},"esri/views/2d/engine/webgl/effects/highlight/parameters":function(){define(["require","exports"],function(g,a){Object.defineProperty(a,"__esModule",{value:!0});a.SIGMAS=[void 0,void 0,void 0,1];a.ALPHA_TO_RGBA_CHANNEL_SELECTOR_MATRIX=[0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1];a.RGBA_TO_RGBA_CHANNEL_SELECTOR_MATRIX=
[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];a.SHADE_TEXTURE_SIZE=256;a.HIGHLIGHT_SIZING={outlineWidth:.7,outerHaloWidth:.7,innerHaloWidth:.7,outlinePosition:0}})},"esri/views/2d/engine/webgl/effects/highlight/HighlightRenderer":function(){define("require exports ../../../../../webgl ../../definitions ./parameters ../../shaders/HighlightPrograms".split(" "),function(g,a,d,h,b,e){Object.defineProperty(a,"__esModule",{value:!0});g=function(){function a(){this._height=this._width=void 0;this._resources=null}a.prototype.dispose=
function(){this._resources&&(this._resources.quadGeometry.dispose(),this._resources.quadVAO.dispose(),this._resources.highlightProgram.dispose(),this._resources.blurProgram.dispose(),this._resources=null)};a.prototype.preBlur=function(a,e){a.bindTexture(e,h.TEXTURE_BINDING_HIGHLIGHT_0);a.bindProgram(this._resources.blurProgram);this._resources.blurProgram.setUniform4fv("u_direction",[1,0,1/this._width,0]);this._resources.blurProgram.setUniformMatrix4fv("u_channelSelector",b.ALPHA_TO_RGBA_CHANNEL_SELECTOR_MATRIX);
a.bindVAO(this._resources.quadVAO);a.drawArrays(5,0,4);a.bindVAO()};a.prototype.finalBlur=function(a,e){a.bindTexture(e,h.TEXTURE_BINDING_HIGHLIGHT_0);a.bindProgram(this._resources.blurProgram);this._resources.blurProgram.setUniform4fv("u_direction",[0,1,0,1/this._height]);this._resources.blurProgram.setUniformMatrix4fv("u_channelSelector",b.RGBA_TO_RGBA_CHANNEL_SELECTOR_MATRIX);a.bindVAO(this._resources.quadVAO);a.drawArrays(5,0,4);a.bindVAO()};a.prototype.renderHighlight=function(a,b,e){a.bindTexture(b,
h.TEXTURE_BINDING_HIGHLIGHT_0);a.bindProgram(this._resources.highlightProgram);e.applyHighlightOptions(a,this._resources.highlightProgram);a.bindVAO(this._resources.quadVAO);a.setBlendingEnabled(!0);a.setBlendFunction(1,771);a.drawArrays(5,0,4);a.bindVAO()};a.prototype._initialize=function(a,l,f){this._width=l;this._height=f;l=new d.BufferObject(a,34962,35044,(new Int8Array([-1,-1,0,0,1,-1,1,0,-1,1,0,1,1,1,1,1])).buffer);f=new d.VertexArrayObject(a,{a_position:0,a_texcoord:1},{geometry:[{name:"a_position",
count:2,type:5120,offset:0,stride:4,normalized:!1},{name:"a_texcoord",count:2,type:5121,offset:2,stride:4,normalized:!1}]},{geometry:l});var c=d.createProgram(a,e.highlight);a=d.createProgram(a,e.blur);c.setUniform1i("u_texture",h.TEXTURE_BINDING_HIGHLIGHT_0);c.setUniform1i("u_shade",h.TEXTURE_BINDING_HIGHLIGHT_1);c.setUniform4fv("u_sigmas",b.SIGMAS);a.setUniform1i("u_texture",h.TEXTURE_BINDING_HIGHLIGHT_0);a.setUniform4fv("u_sigmas",b.SIGMAS);this._resources={quadGeometry:l,quadVAO:f,highlightProgram:c,
blurProgram:a}};a.prototype.setup=function(a,b,e){this._resources?(this._width=b,this._height=e):this._initialize(a,b,e)};return a}();a.default=g})},"esri/views/2d/engine/webgl/shaders/HighlightPrograms":function(){define(["require","exports","./sources/resolver"],function(g,a,d){Object.defineProperty(a,"__esModule",{value:!0});a.highlight={name:"highlight",shaders:{vertexShader:d.resolveIncludes("highlight/textured.vert"),fragmentShader:d.resolveIncludes("highlight/highlight.frag")},attributes:{a_position:0,
a_texcoord:1}};a.blur={name:"blur",shaders:{vertexShader:d.resolveIncludes("highlight/textured.vert"),fragmentShader:d.resolveIncludes("highlight/blur.frag")},attributes:{a_position:0,a_texcoord:1}}})},"esri/views/2d/engine/webgl/effects/highlight/HighlightSurfaces":function(){define(["require","exports","../../../../../webgl"],function(g,a,d){function h(a,e,m){e=new d.Texture(a,{target:3553,pixelFormat:6408,dataType:5121,wrapMode:33071,width:e,height:m,samplingMode:9729});a=new d.FramebufferObject(a,
{colorTarget:0,depthStencilTarget:2},e);return[e,a]}Object.defineProperty(a,"__esModule",{value:!0});g=function(){function a(){this._height=this._width=void 0;this._resources=null}a.prototype.dispose=function(){this._resources&&(this._resources.sharedBlur1Tex.dispose(),this._resources.sharedBlur1Fbo.dispose(),this._resources.sharedBlur2Tex.dispose(),this._resources.sharedBlur2Fbo.dispose(),this._resources=null)};a.prototype._initialize=function(a,b,c){this._width=b;this._height=c;var e=h(a,b,c),f=
e[0],e=e[1];a=h(a,b,c);this._resources={sharedBlur1Tex:f,sharedBlur1Fbo:e,sharedBlur2Tex:a[0],sharedBlur2Fbo:a[1]}};a.prototype.setup=function(a,b,c){!this._resources||this._width===b&&this._height===c||this.dispose();this._resources||this._initialize(a,b,c)};Object.defineProperty(a.prototype,"sharedBlur1Tex",{get:function(){return this._resources.sharedBlur1Tex},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"sharedBlur1Fbo",{get:function(){return this._resources.sharedBlur1Fbo},
enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"sharedBlur2Tex",{get:function(){return this._resources.sharedBlur2Tex},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"sharedBlur2Fbo",{get:function(){return this._resources.sharedBlur2Fbo},enumerable:!0,configurable:!0});return a}();a.default=g})},"esri/views/2d/engine/webgl/effects/HittestEffect":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/iteratorUtils ../../../../../core/maybe ../definitions ./Effect".split(" "),
function(g,a,d,h,b,e,m){Object.defineProperty(a,"__esModule",{value:!0});g=function(a){function c(){var b=null!==a&&a.apply(this,arguments)||this;b.name=b.constructor.name;b.defines=["id"];b._buf=new Uint8Array(4*e.HITTEST_SEARCH_SIZE*e.HITTEST_SEARCH_SIZE);b._buf32=new Uint32Array(b._buf.buffer);return b}d(c,a);c.prototype.dispose=function(){b.isSome(this._fbo)&&this._fbo.dispose()};c.prototype.bind=function(a){var b=a.context;a=a.painter;var c=b.getViewport();a=a.getFbos(c.width,c.height).effect0;
b.bindFramebuffer(a);b.setClearColor(0,0,0,0);b.clear(b.gl.COLOR_BUFFER_BIT)};c.prototype.unbind=function(){};c.prototype.draw=function(a,b,c){var f=this,d=a.context,l=a.state,m=a.pixelRatio;void 0===c&&(c=e.HITTEST_SEARCH_SIZE);var k=d.getBoundFramebufferObject(),r=l.size[1],z=c/2,q=c/2;b.forEach(function(a,e){var d=new Map;k.readPixels(Math.floor((e[0]-c/2)*m),Math.floor((r-e[1]-c/2)*m),c,c,6408,5121,f._buf);for(var l=0;l<f._buf32.length;l++){var p=f._buf32[l];if(4294967295!==p&&0!==p){var n=l%
c,A=c-Math.floor(l/c),n=(z-n)*(z-n)+(q-A)*(q-A),A=d.has(p)?d.get(p):4294967295;d.set(p,Math.min(n,A))}}d=h.pairsOfMap(d).sort(function(a,b){return a[1]-b[1]}).map(function(a){return a[0]});a.resolve(d);b.delete(e)})};return c}(m.Effect);a.HittestEffect=g})},"esri/views/2d/engine/webgl/painter/RenderPass":function(){define("require exports @dojo/framework/shim/iterator ../../../../../core/has ../../../../../core/maybe ../enums".split(" "),function(g,a,d,h,b,e){Object.defineProperty(a,"__esModule",
{value:!0});g=function(){function a(a,b){this.brushes=a;this.name=b.name;this.drawPhase=b.drawPhase||e.WGLDrawPhase.MAP;this._targetFn=b.target;this.effects=b.effects||[];this.has=b.has}a.prototype.render=function(a){var b=a.context,c=a.profiler,e=this._targetFn(),d=this.drawPhase&a.drawPhase;c.recordPassStart(this.name);if(d&&(!this.has||h(this.has))){this._doRender(a,e);c.recordPassEnd();for(var d=0,n=this.effects;d<n.length;d++){var p=n[d];if(p.enable()){var m=p.apply;c.recordPassStart(this.name+
"."+m.name);c.recordBrushStart(m.name);var p=p.args&&p.args(),u=b.getViewport(),k=u.x,r=u.y,z=u.width,u=u.height,q=b.getBoundFramebufferObject();m.bind(a,p);this._doRender(a,e,m.defines);m.draw(a,p);m.unbind(a,p);b.bindFramebuffer(q);b.setViewport(k,r,z,u);c.recordBrushEnd();c.recordPassEnd()}}}};a.prototype._doRender=function(a,e,f){if(!b.isNone(e))if(d.isArrayLike(e))for(var c=0;c<e.length;c++){var l=e[c];if(l.isReady&&l.visible)for(var n=0,p=this.brushes;n<p.length;n++){var m=p[n];a.profiler.recordBrushStart(m.name);
m.prepareState(a,l,f);m.draw(a,l,f);a.profiler.recordBrushEnd()}}else for(c=0,l=this.brushes;c<l.length;c++)m=l[c],a.profiler.recordBrushStart(m.name),m.prepareState(a,e,f),m.draw(a,e,f),a.profiler.recordBrushEnd()};return a}();a.default=g})},"esri/views/2d/engine/webgl/Profiler":function(){define("require exports ../../../../core/CircularArray ../../../../core/Evented ../../../../core/has ../../../../core/maybe ../../../webgl/capabilities/DisjointTimerQuery".split(" "),function(g,a,d,h,b,e,m){Object.defineProperty(a,
"__esModule",{value:!0});var c=b("esri-2d-profiler");g=function(){function a(a,b){var e=this;this._events=new h;this._entries=new Map;this._timings=new d.default(10);if(c){this._ext=m.load(a.gl,{});this._debugOutput=b;var f=a.gl;if(this.enableCommandLogging){a=function(a){if("function"===typeof f[a]){var b=f[a],c=-1!==a.indexOf("draw");f[a]=function(){for(var d=[],k=0;k<arguments.length;k++)d[k]=arguments[k];e._events.emit("command",{container:e._currentContainer,pass:e._currentPass,brush:e._currentBrush,
method:a,args:d,isDrawCommand:c});e._currentSummary&&(e._currentSummary.commands++,c&&e._currentSummary.drawCommands++);return b.apply(f,d)}}};for(var l in f)a(l)}}}Object.defineProperty(a.prototype,"enableCommandLogging",{get:function(){return!("object"===typeof c&&c.disableCommands)},enumerable:!0,configurable:!0});a.prototype.recordContainerStart=function(a){c&&(this._currentContainer=a)};a.prototype.recordContainerEnd=function(){c&&(this._currentContainer=null)};a.prototype.recordPassStart=function(a){c&&
(this._currentPass=a,this._initSummary())};a.prototype.recordPassEnd=function(){c&&(this._currentPass=null,this._emitSummary())};a.prototype.recordBrushStart=function(a){c&&(this._currentBrush=a)};a.prototype.recordBrushEnd=function(){c&&(this._currentBrush=null)};a.prototype.recordStart=function(a){if(c&&e.isSome(this._ext)){if(this._entries.has(a)){var b=this._entries.get(a),f=this._ext.resultAvailable(b.query),d=this._ext.disjoint();if(f&&!d){f=this._ext.getResult(b.query)/1E6;d=0;if(e.isSome(this._timings.enqueue(f))){for(var d=
this._timings.entries,l=d.length,m=0,h=0;h<d.length;h++)m+=d[h];d=m/l}f=f.toFixed(2);d=d?d.toFixed(2):"--";this.enableCommandLogging?(console.groupCollapsed("Frame report for "+a+", "+f+" ms ("+d+" last 10 avg)\n"+b.commandsLen+" Commands ("+b.drawCommands+" draw)"),console.log("RenderPass breakdown: "),console.table(b.summaries),console.log("Commands: ",b.commands),console.groupEnd()):console.log("Frame report for "+a+", "+f+" ms ("+d+" last 10 avg)");this._debugOutput.innerHTML=f+" ("+d+")"}f=0;
for(b=b.handles;f<b.length;f++)b[f].remove();this._entries.delete(a)}var k={name:a,query:this._ext.createQuery(),commands:[],commandsLen:0,drawCommands:0,summaries:[],handles:[]};this.enableCommandLogging&&(k.handles.push(this._events.on("command",function(a){k.commandsLen++;k.commands.push(a);a.isDrawCommand&&k.drawCommands++})),k.handles.push(this._events.on("summary",function(a){delete a.target;k.summaries.push(a)})));this._ext.beginTimeElapsed(k.query);this._entries.set(a,k)}};a.prototype.recordEnd=
function(a){c&&e.isSome(this._ext)&&this._entries.has(a)&&this._ext.endTimeElapsed()};a.prototype._initSummary=function(){this.enableCommandLogging&&(this._currentSummary={container:this._currentContainer,pass:this._currentPass,drawCommands:0,commands:0})};a.prototype._emitSummary=function(){this.enableCommandLogging&&this._events.emit("summary",this._currentSummary)};return a}();a.Profiler=g})},"esri/core/CircularArray":function(){define(["require","exports"],function(g,a){Object.defineProperty(a,
"__esModule",{value:!0});g=function(){function a(a){this._start=this.size=0;this.maxSize=a;this._buffer=Array(a)}Object.defineProperty(a.prototype,"entries",{get:function(){return this._buffer},enumerable:!0,configurable:!0});a.prototype.enqueue=function(a){if(this.size===this.maxSize){var b=this._buffer[this._start];this._buffer[this._start]=a;this._start=(this._start+1)%this.maxSize;return b}this._buffer[(this._start+this.size++)%this.maxSize]=a;return null};a.prototype.dequeue=function(){if(0===
this.size)return null;var a=this._buffer[this._start];this._buffer[this._start]=null;this.size--;this._start=(this._start+1)%this.maxSize;return a};return a}();a.default=g})},"esri/views/2d/engine/webgl/WebGLDriverTest":function(){define("require exports ../../../../core/Logger ../../../../core/maybe ../../../webgl ./VertexStream".split(" "),function(g,a,d,h,b,e){Object.defineProperty(a,"__esModule",{value:!0});var m=d.getLogger("esri.views.2d.engine.webgl.WebGLDriverTest"),c=function(){function b(a){this._ignoresSamplerPrecision=
null;this._context=a}Object.defineProperty(b.prototype,"ignoresSamplerPrecision",{get:function(){h.isNone(this._ignoresSamplerPrecision)&&(this._ignoresSamplerPrecision=a.testSamplerPrecision(this._context));return this._ignoresSamplerPrecision},enumerable:!0,configurable:!0});return b}();a.testWebGLDriver=function(a){return new c(a)};a.testSamplerPrecision=function(a){var c=new b.FramebufferObject(a,{colorTarget:0,depthStencilTarget:0},{target:3553,wrapMode:33071,pixelFormat:6408,dataType:5121,samplingMode:9728,
width:1,height:1}),d=new Uint8Array(4),l=new e(a,[0,0,1,0,0,1,1,1]),n=new b.Program(a,"\nprecision highp float;\n\nattribute vec2 a_pos;\n\nuniform highp sampler2D u_texture;\nvarying vec4 v_color;\n\nfloat getBit(in float bitset, in int bitIndex) {\n  float offset \x3d pow(2.0, float(bitIndex));\n\n  return mod(floor(bitset / offset), 2.0);\n}\n\nvoid main() {\n  vec4 value \x3d texture2D(u_texture, vec2(0.0));\n\n  float bit \x3d getBit(value.x * 255.0, 1);\n\n  v_color \x3d bit * vec4(1.0);\n\n  gl_Position \x3d vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\n}\n",
"\nprecision highp float;\n\nvarying vec4 v_color;\n\nvoid main() {\n  gl_FragColor \x3d v_color;\n}\n",{a_pos:0}),p=new b.Texture(a,{target:3553,wrapMode:33071,pixelFormat:6408,dataType:5121,samplingMode:9728,width:1,height:1},new Uint8Array([2,255,0,0]));n.setUniform1i("u_texture",0);a.bindTexture(p,0);a.bindFramebuffer(c);a.bindProgram(n);var h=a.getViewport(),p=h.x,u=h.y,k=h.width,h=h.height;a.setViewport(0,0,1,1);l.draw();a.setViewport(p,u,k,h);c.readPixels(0,0,1,1,6408,5121,d);n.dispose();l.dispose();
c.dispose();(a=255!==d[0]||255!==d[1]||255!==d[2]||255!==d[3])&&m.warn("A problem was detected with your graphics driver. Your driver does not appear to honor sampler precision specifiers, which may result in rendering issues due to numerical instability. We recommend ensuring that your drivers have been updated to the latest version. Applying lowp sampler workaround. ["+d[0]+"."+d[1]+"."+d[2]+"."+d[3]+"]");return a}})},"esri/views/2d/engine/webgl/shaders/StencilPrograms":function(){define(["require",
"exports","./sources/resolver"],function(g,a,d){Object.defineProperty(a,"__esModule",{value:!0});a.stencil={name:"stencil",shaders:{vertexShader:d.resolveIncludes("stencil/stencil.vert"),fragmentShader:d.resolveIncludes("stencil/stencil.frag")},attributes:{a_pos:0}}})},"esri/views/2d/engine/webgl/AttributeStoreView":function(){define("require exports ../../../../core/tsSupport/generatorHelper ../../../../core/tsSupport/awaiterHelper ../../../../core/Error ../../../../core/has ../../../../core/Logger ../../../../core/maybe ../../../../core/promiseUtils ../../../webgl ./definitions ./Utils ./util/debug ../../../webgl/FramebufferObject".split(" "),
function(g,a,d,h,b,e,m,c,l,f,t,x,n,p){Object.defineProperty(a,"__esModule",{value:!0});var y=m.getLogger("esri.views.2d.engine.webgl.AttributeStoreView"),u=n.createDebugLogger(n.DEBUG_ATTR_UPDATES,y),k=function(){function a(a,b,e){this._lastTexture=this._texture=null;this._fbos={};this.texelSize=4;var f=a.buffer,d=a.pixelType;a=a.textureOnly;var k=x.getPixelArrayCtor(d);this.shared=e;this.pixelType=d;this.size=b;this.textureOnly=a;a||(this.data=new k(c.expect(f)));this._resetRange()}a.prototype.destroy=
function(){c.andThen(this._texture,function(a){return a.dispose()});var a=function(a){c.andThen(b._fbos[a],function(b){"0"===a&&b.detachColorTexture();b.dispose()});b._fbos[a]=null},b=this,e;for(e in this._fbos)a(e);this._texture=null};Object.defineProperty(a.prototype,"_textureDesc",{get:function(){return{target:3553,wrapMode:33071,pixelFormat:6408,dataType:this.pixelType,samplingMode:9728,width:this.size,height:this.size}},enumerable:!0,configurable:!0});a.prototype.setData=function(a,b,e){a&=2147483647;
var f=c.expect(this.data);b=a*this.texelSize+b;!f||b>=f.length||(f[b]=e,this.dirtyStart=Math.min(this.dirtyStart,a),this.dirtyEnd=Math.max(this.dirtyEnd,a))};a.prototype.getData=function(a,b){if(c.isNone(this.data))return null;a=(a&2147483647)*this.texelSize+b;return!this.data||a>=this.data.length?null:this.data[a]};a.prototype.getTexture=function(a){var b=this;return c.unwrapOr(this._texture,function(){return b._initTexture(a)})};a.prototype.getFBO=function(a,b){void 0===b&&(b=0);if(c.isNone(this._fbos[b])){var e=
0===b?this.getTexture(a):this._textureDesc;this._fbos[b]=new p(a,{colorTarget:0,depthStencilTarget:0},e)}return this._fbos[b]};Object.defineProperty(a.prototype,"locked",{get:function(){return 5121===this.pixelType&&this.shared&&!this.textureOnly&&e("esri-atomics")&&this.data?1===Atomics.load(this.data,0):!1},enumerable:!0,configurable:!0});a.prototype.updateTexture=function(a){if(!this.locked)try{var e=this.dirtyStart,f=this.dirtyEnd;if(!(e>f)){this._resetRange();var d=c.expect(this.data).buffer,
k=this.getTexture(a),l=(e-e%this.size)/this.size,p=(f-f%this.size)/this.size,n=l*this.size*4,m=4*(this.size+p*this.size)-n,r=x.getPixelArrayCtor(this.pixelType),h=r.BYTES_PER_ELEMENT;try{new r(d,n*h,m)}catch(K){console.debug(K)}var z=new r(d,n*h,m),u=this.size;a=p-l+1;a>this.size?y.error(new b("mapview-webgl","Out-of-bounds index when updating AttributeData")):k.updateData(0,0,l,u,a,z)}}catch(K){console.debug(K)}};a.prototype.update=function(a){var b=a.data,e=a.start,f=a.end;if(c.isSome(b))for(var d=
this.data,k=e*this.texelSize,l=0;l<b.length;l++)a.layout&1<<l%this.texelSize&&(d[k+l]=b[l]);this.dirtyStart=Math.min(this.dirtyStart,e);this.dirtyEnd=Math.max(this.dirtyEnd,f)};a.prototype.resize=function(a,b){var e=this.size;this.size=b;this.textureOnly?e!==this.size&&(this._lastTexture=this._texture,this._texture=null):(b=x.getPixelArrayCtor(this.pixelType),this.destroy(),this.data=new b(c.expect(a.buffer)))};a.prototype._resetRange=function(){this.dirtyStart=2147483647;this.dirtyEnd=0};a.prototype._initTexture=
function(a){var b=new f.Texture(a,this._textureDesc,c.unwrapOr(this.data,void 0));if(c.isSome(this._lastTexture)&&this._fbos[0]){var e=this._lastTexture.descriptor.width,d=this._lastTexture.descriptor.height,k=this._lastTexture.descriptor.dataType,l=this._lastTexture.descriptor.pixelFormat,p=this.getFBO(a),n=x.getPixelBytes(k),m=x.getPixelArrayCtor(k),n=new ArrayBuffer(e*d*n*this.texelSize),m=new m(n),n=a.getBoundFramebufferObject(),r=a.getViewport(),h=r.x,u=r.y,z=r.width,r=r.height;a.bindFramebuffer(p);
p.readPixels(0,0,e,d,l,k,m);b.updateData(0,0,0,2*e,d/2,m);a.setViewport(h,u,z,r);a.bindFramebuffer(n)}this.destroy();return this._texture=b};return a}();g=function(){function a(){this._locked=this._forceNextUpload=this._initialized=!1}a.prototype.initialize=function(a){var b=a.blocks,e=a.shared,f=a.size;this.shared=e;this.size=f;u("Initializing AttributeStoreView",a);if(c.isNone(this._data))this._data=c.mapMany(b,function(a){return new k(a,f,e)});else for(a=0;a<this._data.length;a++){var d=this._data[a],
l=b[a];c.isSome(l)&&(c.isNone(d)?this._data[a]=new k(l,f,e):d.resize(l,f))}this._initialized=!0};a.prototype.destroy=function(){c.andThen(this._data,function(a){return c.mapMany(a,function(a){return a.destroy()})});c.andThen(this._defaultTexture,function(a){return a.dispose()})};a.prototype.getBlock=function(a){return c.isNone(this._data)?null:this._data[a]};a.prototype.setLabelMinZoom=function(a,b){this.setData(a,0,1,b)};a.prototype.getLabelMinZoom=function(a){return this.getData(a,0,1,255)};a.prototype.getFilterFlags=
function(a){return this.getData(a,0,0,0)};a.prototype.getVVSize=function(a){return this.getData(a,t.ATTRIBUTE_DATA_VV,0,0)};a.prototype.getData=function(a,b,e,f){if(!this._data)return 0;b=c.expect(this._data)[b];if(c.isNone(b))return 0;a=b.getData(a,e);return c.isSome(a)?a:f};a.prototype.setData=function(a,b,e,f){b=c.expect(this._data)[b];c.expect(b).setData(a,e,f)};a.prototype.lockTextureUpload=function(){this._locked=!0};a.prototype.unlockTextureUpload=function(){this._locked=!1};a.prototype.forceTextureUpload=
function(){this._forceNextUpload=!0};a.prototype.requestUpdate=function(a){return h(this,void 0,void 0,function(){var c;return d(this,function(e){if(this._pendingAttributeUpdate)return y.error(new b("mapview-webgl","Tried to update attribute data with a pending update")),[2];c=l.createResolver();u("AttributeStoreView Update Requested",a);this._pendingAttributeUpdate={data:a,resolver:c};return[2,c.promise]})})};a.prototype.update=function(){if(this._initialized&&c.isSome(this._pendingAttributeUpdate)){for(var a=
this._pendingAttributeUpdate,b=a.data,a=a.resolver,e=c.expect(this._data),f=function(a){var f=b.blocks[a];c.andThen(e[a],function(b){return c.andThen(f,function(c){u("Updating block "+a,c);b.update(c)})})},d=0;d<b.blocks.length;d++)f(d);this._pendingAttributeUpdate=null;a()}};a.prototype.bindTextures=function(a){this.update();var b=this._getDefaultTexture(a);if(this._initialized){var e=c.expect(this._data);if(!this._locked||this._forceNextUpload)c.forEachSome(e,function(b){return b.updateTexture(a)}),
this._forceNextUpload=!1;a.bindTexture(c.mapOr(e[0],b,function(b){return b.getTexture(a)}),t.TEXTURE_BINDING_ATTRIBUTE_DATA_0);a.bindTexture(c.mapOr(e[1],b,function(b){return b.getTexture(a)}),t.TEXTURE_BINDING_ATTRIBUTE_DATA_1);a.bindTexture(c.mapOr(e[2],b,function(b){return b.getTexture(a)}),t.TEXTURE_BINDING_ATTRIBUTE_DATA_2);a.bindTexture(c.mapOr(e[3],b,function(b){return b.getTexture(a)}),t.TEXTURE_BINDING_ATTRIBUTE_DATA_3)}else a.bindTexture(b,t.TEXTURE_BINDING_ATTRIBUTE_DATA_0),a.bindTexture(b,
t.TEXTURE_BINDING_ATTRIBUTE_DATA_1),a.bindTexture(b,t.TEXTURE_BINDING_ATTRIBUTE_DATA_2),a.bindTexture(b,t.TEXTURE_BINDING_ATTRIBUTE_DATA_3)};a.prototype._getDefaultTexture=function(a){c.isNone(this._defaultTexture)&&(this._defaultTexture=new f.Texture(a,{wrapMode:33071,pixelFormat:6408,dataType:5121,samplingMode:9728,width:1,height:1},new Uint8Array(4)));return this._defaultTexture};return a}();a.AttributeStoreView=g})},"esri/views/2d/engine/webgl/Utils":function(){define("require exports ../../../../core/tsSupport/assignHelper ../../../../core/Error ../../../../core/Logger ../../../../core/mathUtils ../../../../core/screenUtils ../../../../symbols/cim/enums ../../../webgl ./color ./enums ./SymbolProperties".split(" "),
function(g,a,d,h,b,e,m,c,l,f,t,x){function n(a){for(var b={},c=0;c<a.length;c++){var e=a[c];b[e.name]=e.strideInBytes}return b}function p(a){switch(a){case t.WGLGeometryType.MARKER:return E;case t.WGLGeometryType.FILL:return A;case t.WGLGeometryType.LINE:return B;case t.WGLGeometryType.TEXT:return C;case t.WGLGeometryType.LABEL:return D}return null}function y(a){switch(a%4){case 0:case 2:return 4;case 1:case 3:return 1}}function u(a){return"string"===typeof a}function k(a){switch(a){case 5120:case 5121:return 1;
case 5122:case 5123:return 2;case 5126:case 5124:case 5125:return 4}}function r(a){var b={},c=function(c){var e=0;b[c]=a[c].map(function(a){var b=d({},a,{normalized:a.normalized||!1,divisor:a.divisor||0,offset:e,stride:0});e+=a.count*k(a.type);return b});b[c].forEach(function(a){return a.stride=e})},e;for(e in a)c(e);return b}Object.defineProperty(a,"__esModule",{value:!0});var z,q=b.getLogger("esri.views.2d.engine.webgl.Utils");a.C_VBO_GEOMETRY="geometry";a.C_VBO_PERINSTANCE="per_instance";a.C_VBO_PERINSTANCE_VV=
"per_instance_vv";a.C_ICON_VERTEX_DEF=[{name:a.C_VBO_GEOMETRY,strideInBytes:32,divisor:0}];a.C_FILL_VERTEX_DEF=[{name:a.C_VBO_GEOMETRY,strideInBytes:32,divisor:0}];a.C_FILL_VERTEX_DEF_DD=[{name:a.C_VBO_GEOMETRY,strideInBytes:12,divisor:0}];a.C_LINE_VERTEX_DEF=[{name:a.C_VBO_GEOMETRY,strideInBytes:36,divisor:0}];a.C_TEXT_VERTEX_DEF=[{name:a.C_VBO_GEOMETRY,strideInBytes:24,divisor:0}];a.C_LABEL_VERTEX_DEF=[{name:a.C_VBO_GEOMETRY,strideInBytes:28,divisor:0}];a.C_ICON_STRIDE_SPEC=n(a.C_ICON_VERTEX_DEF);
a.C_FILL_STRIDE_SPEC=n(a.C_FILL_VERTEX_DEF);a.C_FILL_STRIDE_SPEC_DD=n(a.C_FILL_VERTEX_DEF_DD);a.C_LINE_STRIDE_SPEC=n(a.C_LINE_VERTEX_DEF);a.C_TEXT_STRIDE_SPEC=n(a.C_TEXT_VERTEX_DEF);a.C_LABEL_STRIDE_SPEC=n(a.C_LABEL_VERTEX_DEF);a.getStrides=function(b,c){switch(b){case t.WGLGeometryType.MARKER:return a.C_ICON_STRIDE_SPEC;case t.WGLGeometryType.FILL:return c?a.C_FILL_STRIDE_SPEC_DD:a.C_FILL_STRIDE_SPEC;case t.WGLGeometryType.LINE:return a.C_LINE_STRIDE_SPEC;case t.WGLGeometryType.TEXT:return a.C_TEXT_STRIDE_SPEC;
case t.WGLGeometryType.LABEL:return a.C_LABEL_STRIDE_SPEC}return null};var E=[a.C_VBO_GEOMETRY],A=[a.C_VBO_GEOMETRY],B=[a.C_VBO_GEOMETRY],C=[a.C_VBO_GEOMETRY],D=[a.C_VBO_GEOMETRY];a.getNamedBuffers=p;a.strideToPackingFactor=y;a.allocateTypedArrayBuffer=function(a,b){switch(b%4){case 0:case 2:return new Uint32Array(Math.floor(a*b/4));case 1:case 3:return new Uint8Array(a*b)}};a.allocateTypedArrayBufferwithData=function(a,b){switch(b%4){case 0:case 2:return new Uint32Array(a);case 1:case 3:return new Uint8Array(a)}};
a.getTextProperties=function(a){return x.TextProperties.pool.acquire(a.color?f.copyAndPremultiply(a.color):[255,255,255,255],a.haloColor?f.copyAndPremultiply(a.haloColor):[255,255,255,255],m.pt2px(a.haloSize),m.pt2px(a.font.size),a.angle*Math.PI/180,a.xoffset/a.font.size,a.yoffset/a.font.size,"left"===a.horizontalAlignment?0:"right"===a.horizontalAlignment?1:.5,"top"===a.verticalAlignment?0:"bottom"===a.verticalAlignment?1:.5)};a.isDefined=function(a){return null!=a};a.isNumber=function(a){return"number"===
typeof a};a.isString=u;a.isStringOrNull=function(a){return null==a||u(a)};a.getCapType=function(a,b){switch(a){case "butt":return c.CapType.BUTT;case "round":return b?c.CapType.SQUARE:c.CapType.ROUND;case "square":return c.CapType.SQUARE;default:return q.error(new h("mapview-invalid-type","Cap type "+a+" is not a valid option. Defaulting to round")),c.CapType.ROUND}};a.getJoinType=function(a){switch(a){case "miter":return c.JoinType.MITER;case "bevel":return c.JoinType.BEVEL;case "round":return c.JoinType.ROUND;
default:return q.error(new h("mapview-invalid-type","Join type "+a+" is not a valid option. Defaulting to round")),c.JoinType.ROUND}};a.getVVType=function(a){switch(a){case "opacity":return t.VVType.OPACITY;case "color":return t.VVType.COLOR;case "rotation":return t.VVType.ROTATION;case "size":return t.VVType.SIZE;default:return q.error("Cannot interpret unknown vv: "+a),null}};a.getTransformParams=function(a){return{transform:a.transform,hasZ:a.hasZ,hasM:a.hasM}};a.copyMeshData=function(a,b,c,e,
f,d,k){for(var l in d)for(var p=d[l].stride,n=y(p),m=d[l].data,q=c[l].data,h=p*f.vertexCount/n,r=p*a/n,n=p*f.vertexFrom/n,p=0;p<h;++p)q[p+r]=m[p+n];c=f.indexCount;for(p=0;p<c;++p)e[p+b]=k[p+f.indexFrom]-f.vertexFrom+a};a.C_VBO_INFO=(z={},z[a.C_VBO_GEOMETRY]=35044,z);a.createGeometryData=function(a,b){for(var c=[],e=0;5>e;++e){for(var f={},d=0,k=p(e);d<k.length;d++){var l=k[d];f[l]={data:b(e,l)}}c.push({data:a(e),buffers:f})}return c};a.createTextureFromTexelData=function(a,b){var c,f;e.isPowerOfTwo(b.width)&&
e.isPowerOfTwo(b.height)?(c=!0,f=9987):(c=!1,f=9729);return new l.Texture(a,{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,hasMipmap:c,samplingMode:f,wrapMode:33071,flipped:!0},b)};a.geometryToMappedGeometry=function(a){return{vertexFrom:void 0,vertexTo:void 0,geometry:a}};a.getBytes=k;a.getPixelBytes=function(a){switch(a){case 5121:return 1;case 32819:return 2;case 5126:return 4;default:q.error(new h("webgl-utils","Unable to handle type "+a))}};a.getPixelArrayCtor=function(a){switch(a){case 5121:return Uint8Array;
case 32819:return Uint16Array;case 5126:return Float32Array;default:q.error(new h("webgl-utils","Unable to handle type "+a))}};var I=new Map;a.createProgramDescriptor=function(a,b){if(!I.has(a)){var c=r(b),e={},f;for(f in c){var d=c[f];e[f]=d.length?d[0].stride:0}f={};for(var k in b)for(var d=0,l=b[k];d<l.length;d++){var p=l[d];f[p.name]=p.location}I.set(a,{strides:e,bufferLayouts:c,attributes:f})}return I.get(a)}})},"esri/symbols/cim/enums":function(){define(["require","exports"],function(g,a){Object.defineProperty(a,
"__esModule",{value:!0});(function(a){a[a.BUTT=0]="BUTT";a[a.ROUND=1]="ROUND";a[a.SQUARE=2]="SQUARE";a[a.UNKNOWN=4]="UNKNOWN"})(a.CapType||(a.CapType={}));(function(a){a[a.BEVEL=0]="BEVEL";a[a.ROUND=1]="ROUND";a[a.MITER=2]="MITER";a[a.UNKNOWN=4]="UNKNOWN"})(a.JoinType||(a.JoinType={}));(function(a){a[a.SCREEN=0]="SCREEN";a[a.MAP=1]="MAP"})(a.Alignment||(a.Alignment={}))})},"esri/views/2d/engine/webgl/color":function(){define(["require","exports","./number"],function(g,a,d){function h(a,b){Array.isArray(b)?
(a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3]):(a[0]=b.r,a[1]=b.g,a[2]=b.b,a[3]=b.a);return a}function b(a,b,e){void 0===b&&(b=0);void 0===e&&(e=!1);var c=a[b+3];a[b+0]*=c;a[b+1]*=c;a[b+2]*=c;e||(a[b+3]*=255);return a}Object.defineProperty(a,"__esModule",{value:!0});a.white=[255,255,255,1];var e=[0,0,0,0];a.premultiplyAlpha=b;a.copyAndPremultiply=function(a){return b(h([],a))};a.premultiplyAlphaUint32=function(a){b(h(e,a));return d.i8888to32(e[0],e[1],e[2],e[3])};a.premultiplyAlphaRGBA=function(a){if(!a)return 0;
var b=a.a;return d.i8888to32(a.r*b,a.g*b,a.b*b,255*b)}})},"esri/views/2d/engine/webgl/SymbolProperties":function(){define(["require","exports","../../../../core/ObjectPool"],function(g,a,d){Object.defineProperty(a,"__esModule",{value:!0});g=function(){function a(){this.color=[0,0,0,0];this.haloColor=[0,0,0,0];this.haloSize=0;this.size=12;this.vAnchor=this.hAnchor=this.offsetY=this.offsetX=this.angle=0}a.prototype.acquire=function(a,e,d,c,l,f,h,g,n){this.color=a;this.haloColor=e;this.haloSize=d;this.size=
c;this.angle=l;this.offsetX=f;this.offsetY=h;this.hAnchor=g;this.vAnchor=n};a.prototype.release=function(){this.color[0]=this.color[1]=this.color[2]=this.color[3]=0;this.vAnchor=this.hAnchor=this.offsetY=this.offsetX=this.angle=this.size=this.haloSize=this.haloColor[0]=this.haloColor[1]=this.haloColor[2]=this.haloColor[3]=0};a.pool=new d(a);return a}();a.TextProperties=g})},"esri/views/2d/engine/webgl/util/debug":function(){define(["require","exports"],function(g,a){Object.defineProperty(a,"__esModule",
{value:!0});a.createDebugLogger=function(a,h){return a&&function(){for(var a=[],e=0;e<arguments.length;e++)a[e]=arguments[e];return h.warn.apply(h,["DEBUG:"].concat(a))}||function(){return null}};a.DEBUG_ATTR_UPDATES=!1})},"esri/views/2d/engine/webgl/collisions/CollisionGrid":function(){define(["require","exports","../definitions"],function(g,a,d){Object.defineProperty(a,"__esModule",{value:!0});g=function(){function a(a){this._bucketSize=a;this._rowsLength=d.TILE_SIZE/a;this._colsLength=d.TILE_SIZE/
a;this._grid=this._initGrid()}a.prototype.checkOverlap=function(a,e){a=Math.floor(a/this._bucketSize);e=Math.floor(e/this._bucketSize);if(0>a||a>=this._rowsLength||0>e||e>=this._colsLength||this._grid[e][a])return!0;this._grid[e][a]=!0;return!1};a.prototype.reset=function(){this._grid=this._initGrid()};a.prototype._initGrid=function(){for(var a=[],e=0;e<this._rowsLength;e++)a.push(Array(this._colsLength));return a};return a}();a.CollisionGrid=g})},"esri/views/2d/engine/webgl/collisions/CollisionEngine":function(){define("require exports ../../../../../core/Error ../../../../../core/iteratorUtils ../../../../../core/Logger ../../../../../core/mathUtils ../definitions ./CollisionBucket ./LayerCollisionInfo".split(" "),
function(g,a,d,h,b,e,m,c,l){Object.defineProperty(a,"__esModule",{value:!0});var f=m.TILE_SIZE/m.COLLISION_BUCKET_SIZE,t=b.getLogger("esri.views.2d.engine.webgl.collisions.CollisionEngine");g=function(){function a(a){this._layers=new Map;this._collisionBuckets=new Map;this._didError=!1;this._tilingScheme=a}Object.defineProperty(a.prototype,"collisionInfos",{get:function(){return h.valuesOfMap(this._layers)},enumerable:!0,configurable:!0});a.prototype.registerLayerView=function(a,b){if(!this._layers.has(a)){var c=
l.default.create(a,b,this.collisionInfos,this._tilingScheme);this._layers.set(a,c);this._collisionBuckets.forEach(function(a){return a.onRegisterLayer(c.index)})}};a.prototype.unregisterLayerView=function(a){var b=this;if(this._layers.has(a)){var c=this._layers.get(a);l.default.delete(c.index,this.collisionInfos);this._layers.delete(a);this._collisionBuckets.forEach(function(a,e){var f=a.getTile(c.index);f&&(a.onUnregisterLayer(c.index),a.canDelete()&&b._collisionBuckets.delete(e),f.reference&&(f.reference.isDirty=
!1))})}};a.prototype.addTile=function(a,b){var e=b.key.id;this._layers.has(a)&&(this._collisionBuckets.has(e)||this._collisionBuckets.set(e,new c.default(b.key,this._layers.size)),a=this._getIndex(a),this._collisionBuckets.get(e).getTile(a).reference=b)};a.prototype.removeTile=function(a,b){this._layers.has(a)&&this._collisionBuckets.has(b)&&(a=this._getIndex(a),b=this._collisionBuckets.get(b).getTile(a),b.dirty=!1,b.reference=null)};a.prototype.run=function(a,b){var c=h.valuesOfMap(this._collisionBuckets).sort(function(a,
b){return a.key.compareRowMajor(b.key)}),e=!0,f=a.renderingOptions.labelCollisionsEnabled&&!this._didError,p=this.collisionInfos;try{for(var n=0;n<c.length;n++)for(var m=c[n],e=e||m.isDirty,g=0;g<this._layers.size;g++){var A=l.default.find(g,p);m.computeNeighbors(this._collisionBuckets);m.reset(a,e,A)}for(a=0;a<this._layers.size;a++)for(A=l.default.find(a,p),e=0,n=c;e<n.length;e++)m=n[e],this._run(f,m,A,b)}catch(B){t.error(new d("mapview-labeling","Encountered an error during decluttering. Disabling collisions",
B)),this._didError=!0}for(b=0;b<c.length;b++)m=c[b],m.ready()};a.prototype._run=function(a,b,c,e){var f=b.getReference(c.index);f&&f.hasData&&(f.key.level!==e?this._resetLabelsMinZoom(b,c):this._runVisibility(a,b,f,c,e))};a.prototype._resetLabelsMinZoom=function(a,b){if(a&&"polyline"!==b.geometryType&&(a=a.getReference(b.index))&&a.hasData){b=b.layerView.tileRenderer.featuresView.attributeView;var c=0;for(a=a.displayObjects;c<a.length;c++)b.setLabelMinZoom(a[c].id,255)}};a.prototype._checkLabelsVisible=
function(a,b){var c=!b.effect||b.effect.excludedLabelsVisible||!!(a&m.EFFECT_FLAG_0);return(!b.filter||!!(a&m.FILTER_FLAG_0))&&c};a.prototype._runVisibility=function(a,b,c,e,f){var d=e.layerView.tileRenderer.featuresView.attributeView,k=0;for(c=c.displayObjects.sort(function(a,b){a=d.getLabelMinZoom(a.id);b=d.getLabelMinZoom(b.id);return a-b});k<c.length;k++){var l=c[k];if(l.metrics.length){var p="polyline"===e.geometryType?0:10*(f-1),n=d.getFilterFlags(l.id),m=this._checkLabelsVisible(n,e.layerView);
if(a)for(var h=0;h<l.metrics.length;h++)n=l.metrics[h],n=m?-1!==n.minZoom?n.minZoom:this._computeLabelVisibility(l,n,e.index,b,n.baseZoom,f):255,p=Math.max(n,p);d.setLabelMinZoom(l.id,p);m=0;for(l=l.metrics;m<l.length;m++)n=l[m],n.minZoom=p}}};a.prototype._computeLabelVisibility=function(a,b,c,e,d,l){for(var k=b.xBucket,p=b.yBucket,n=b.xOverflow,m=b.yOverflow,h=k-n,k=k+n+1,n=p+m+1,p=p-m;p<n;p++)for(m=h;m<k;m++)if(!(m<-f||p<-f||m>f||p>f))for(var r=0;r<=c;r++){var g=this._getRelativeSubBucket(r,e,m,
p);if(g)for(var u=0;u<g.length;u++){var t=g[u];t.id!==a.id&&(t=this._compareLabels(b,t,d,l),d=Math.max(t,d))}}return d};a.prototype._compareLabels=function(a,b,c,f){if(-1===b.minZoom||b.minZoom>10*(f+1))return c;a=a.findCollisionDelta(b);f=e.clamp(Math.floor(10*(a+f)),0,255);return b.minZoom>=f?c:Math.max(c,f)};a.prototype._getNeighboringTile=function(a,b,c,e){return(b=b.neighbors[3*(1+e)+(1+c)])&&b.getTile(a)};a.prototype._getRelativeSubBucket=function(a,b,c,f){var d=e.sign(Math.floor(c/4)),l=e.sign(Math.floor(f/
4));return(a=this._getNeighboringTile(a,b,d,l))&&a.reference&&a.index&&a.reference.hasData?a.index[f-4*l][c-4*d]:null};a.prototype._getIndex=function(a){return this._layers.get(a).index};return a}();a.CollisionEngine=g})},"esri/views/2d/engine/webgl/collisions/CollisionBucket":function(){define(["require","exports","../../../tiling","./CollisionBucketEntry"],function(g,a,d,h){Object.defineProperty(a,"__esModule",{value:!0});g=function(){function a(a,b){this.neighbors=Array(9);this._tiles=Array(b);
for(var c=0;c<b;c++)this._tiles[c]=new h.default;this.key=a}Object.defineProperty(a.prototype,"isDirty",{get:function(){for(var a=0,b=this._tiles;a<b.length;a++)if(b[a].dirty)return!0;return!1},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"size",{get:function(){return this._tiles.length},enumerable:!0,configurable:!0});a.prototype.getTile=function(a){return this._tiles[a]};a.prototype.getReference=function(a){return(a=this._tiles[a])&&a.reference};a.prototype.onRegisterLayer=
function(a){this.invalidateRange(a);this._add(a)};a.prototype.onUnregisterLayer=function(a){this.invalidateRange(a);this._remove(a)};a.prototype.onLabelsRendered=function(){};a.prototype.invalidateRange=function(a){for(;a<this._tiles.length;a++)this._tiles[a].dirty=!0};a.prototype.add=function(a){this._add(a)};a.prototype.remove=function(a){this._remove(a)};a.prototype.canDelete=function(){return 0===this._tiles.length};a.prototype.ready=function(){for(var a=0,b=this._tiles;a<b.length;a++)b[a].dirty=
!1};a.prototype.computeNeighbors=function(a){this.neighbors[0]=this._getNeighbor(a,-1,-1);this.neighbors[1]=this._getNeighbor(a,0,-1);this.neighbors[2]=this._getNeighbor(a,1,-1);this.neighbors[3]=this._getNeighbor(a,-1,0);this.neighbors[4]=this;this.neighbors[5]=this._getNeighbor(a,1,0);this.neighbors[6]=this._getNeighbor(a,-1,1);this.neighbors[7]=this._getNeighbor(a,0,1);this.neighbors[8]=this._getNeighbor(a,1,1)};a.prototype.reset=function(a,b,c){for(var e=0,f=this._tiles;e<f.length;e++){var d=
f[e];d&&d.reset(a,b,c)}};a.prototype._add=function(a){var b=[];if(a>=this._tiles.length)this._tiles.push(new h.default);else{for(var c=0;c<this._tiles.length;c++)c===a&&b.push(new h.default),b.push(this._tiles[c]);this._tiles=b}};a.prototype._remove=function(a){for(var b=[],c=0;c<this._tiles.length;c++)c!==a&&b.push(this._tiles[c]);this._tiles=b};a.prototype._getNeighbor=function(a,b,c){var e=this.key;b=d.TileKey.getId(e.level,e.row+c,e.col+b,e.world);return a.has(b)?a.get(b):null};return a}();a.default=
g})},"esri/views/2d/engine/webgl/collisions/CollisionBucketEntry":function(){define(["require","exports","../../../../../core/libs/gl-matrix-2/vec2"],function(g,a,d){Object.defineProperty(a,"__esModule",{value:!0});g=function(){function a(){this._reference=null}Object.defineProperty(a.prototype,"dirty",{get:function(){return this.reference&&this.reference.isDirty},set:function(a){this.reference&&this.reference.hasData&&(a||this.reference.isDirty)&&(this.reference.isDirty=a)},enumerable:!0,configurable:!0});
Object.defineProperty(a.prototype,"index",{get:function(){return this._reference&&this._reference.labelIndex},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"reference",{get:function(){return this._reference},set:function(a){this._reference=a},enumerable:!0,configurable:!0});a.prototype.reset=function(a,e,m){a=a.state;var b=m.layerView.tileRenderer,l=this.reference;if(!l||!l.hasData)return!1;e&&(l.isDirty=!0);e=l.transforms.labelMat2d;for(var f=e[4],h=e[5],g=0,n=l.displayObjects;g<
n.length;g++)for(var p=n[g],y=b.featuresView.attributeView,y=m.hasVV()?y.getVVSize(p.id):0,u=0,p=p.metrics;u<p.length;u++){var k=p[u];m.hasVV()&&k.computeOffset(y,m.vvEval);var r=k.bounds.center,z=k.bounds.centerT;l.isDirty&&(k.minZoom=-1);var q=d.vec2.copy(z,k.anchor);a.rotation?d.vec2.transformMat2d(q,q,e):(z[0]=q[0]+f,z[1]=q[1]+h);d.vec2.add(z,q,r);z[0]+=k.offsetX;z[1]+=k.offsetY;if(k.boxes)for(r=0,z=k.boxes;r<z.length;r++){var q=z[r],E=q.centerT;d.vec2.add(E,k.anchor,q.center);a.rotation?d.vec2.transformMat2d(E,
E,e):(E[0]+=f,E[1]+=h)}}return!0};return a}();a.default=g})},"esri/views/2d/engine/webgl/collisions/LayerCollisionInfo":function(){define("require exports ../../../../../core/Logger ../../../../../core/mathUtils ../../../../../core/screenUtils ./visualVariableSimpleUtils".split(" "),function(g,a,d,h,b,e){function m(a){return function(c){return b.pt2px(e.getSizeForValueSimple(c,a))}}function c(a){if(!a)return null;for(var b=0;b<a.length;b++){var c=a[b];if("size"===c.type)return m(c)}return null}Object.defineProperty(a,
"__esModule",{value:!0});var l=function(a,b){return a.order-b.order},f=function(a,b){return a.index-b.index},t=d.getLogger("esri/views/2d/engine/webgl/collisions/CollisionEngine");a.createLabelVVEvaluator=c;g=function(){function a(a,b,e,f){var d=this;this._vvHandle=null;var l=a.layer,p=l.geometryType,n=l.labelingInfo,m=l.renderer;this.vvEval=c("visualVariables"in m&&m.visualVariables);this._vvHandle=l.watch("visualVariables",function(a){d.vvEval=c(a)});l=n.map(function(a){var b=!!a.maxScale,c=!!a.minScale&&
f.scaleToZoom(a.minScale)||0;a=b&&f.scaleToZoom(a.maxScale)||255;return{minZoom:h.clamp(Math.floor(10*c),0,255),maxZoom:h.clamp(Math.floor(10*a),0,255)}});this.layerView=a;this.geometryType=p;this.index=b;this.order=e;this.zoomRanges=l;this.layerView=a}a.prototype.hasVV=function(){return!!this.vvEval};a.prototype.allOrNothing=function(){return"polyline"!==this.geometryType};a.prototype.destroy=function(){this._vvHandle.remove()};a.create=function(b,c,e,f){e=e.sort(l);for(var d=!1,p=-1,n=0;n<e.length;n++){var m=
e[n];!d&&m.order>c&&(p=m.index,d=!0);d&&m.index++}d||(p=e.length);return new a(b,p,c,f)};a.delete=function(a,b){for(var c=b.sort(f),e=a+1;e<c.length;e++)b[e].index--;b[a].destroy();b.splice(a,1)};a.find=function(a,b){for(var c=0;c<b.length;c++){var e=b[c];if(e.index===a)return e}t.error("Tried to get a LayerCollisionInfo for an index that doesn't exist!");return null};return a}();a.default=g})},"esri/views/2d/engine/webgl/collisions/visualVariableSimpleUtils":function(){define(["require","exports",
"../../../../../core/mathUtils","../../../../../renderers/support/utils"],function(g,a,d,h){function b(a,b){switch(b.transformationType){case "additive":var f=e(b.minSize,a);return a+(f||b.minDataValue);case "constant":return f=(f=b.stops)&&f.length&&f[0].size,null==f&&(f=b.minSize),e(f,a);case "clamped-linear":var f=(a-b.minDataValue)/(b.maxDataValue-b.minDataValue),l=e(b.minSize,a),n=e(b.maxSize,a);a=a<=b.minDataValue?l:a>=b.maxDataValue?n:l+f*(n-l);return a;case "proportional":return f=a/b.minDataValue,
l=e(b.minSize,a),a=e(b.maxSize,a),d.clamp(f*l,l,a);case "stops":return l=m(a,b.cache.ipData),n=l[0],f=l[1],l=l[2],n===f?a=e(b.stops[n].size,a):(n=e(b.stops[n].size,a),a=e(b.stops[f].size,a),a=n+(a-n)*l),a;case "real-world-size":f=h.meterIn[b.valueUnit];l=e(b.minSize,a);n=e(b.maxSize,a);b=b.valueRepresentation;var p=null,p="area"===b?2*Math.sqrt(a/c)/f:"radius"===b||"distance"===b?2*a/f:a/f;return d.clamp(p,l,n);case "identity":return a;case "unknown":return null}}function e(a,c){return"number"===
typeof a?a:b(c,a)}function m(a,b){if(b){var c=0,e=b.length-1;b.some(function(b,f){if(a<b)return e=f,!0;c=f;return!1});return[c,e,(a-b[c])/(b[e]-b[c])]}}Object.defineProperty(a,"__esModule",{value:!0});var c=Math.PI;a.getSizeForValueSimple=b})},"esri/views/2d/engine/webgl/collisions/LayerViewSorter":function(){define(["require","exports","../../../../../core/Error","../../../../../core/Logger"],function(g,a,d,h){function b(a){return"esri.views.2d.layers.FeatureLayerView2D"===a.declaredClass||"esri.views.2d.layers.StreamLayerView2D"===
a.declaredClass}Object.defineProperty(a,"__esModule",{value:!0});var e=h.getLogger("esri.views.2d.engine.collisions.LayerViewSorter");g=function(){function a(a,b){this.registerLayer=a;this.unregisterLayer=b;this._layerViewState=new Map}a.prototype.findIndex=function(a){return a.view.allLayerViews.findIndex(function(b){return b.uid===a.uid})};a.prototype.update=function(a){for(var c=a.added,f=0,m=a.removed;f<m.length;f++)a=m[f],b(a)&&this._layerViewState.has(a)&&this._deleteState(a);for(f=0;f<c.length;f++){a=
c[f];if(m=b(a))a:if(a.layer&&a.layer.renderer)switch(a.layer.renderer.type){case "class-breaks":case "simple":case "unique-value":case "dictionary":m=!0;break a;default:e.error(new d("mapview-labeling","Renderer of type "+a.layer.renderer.type+" does not currently support labeling")),m=!1}else m=!1;m&&!this._layerViewState.has(a)&&this._createState(a)}this._recomputeOrder()};a.prototype.destroy=function(){this._layerViewState.forEach(function(a){return a.handle.remove()})};a.prototype._createState=
function(a){var b={priority:-1,handle:null};b.handle=a.watch("labelsVisible",this._recomputeOrder.bind(this));this._layerViewState.set(a,b);return b};a.prototype._deleteState=function(a){if(this._layerViewState.has(a)){var b=this._layerViewState.get(a);b.handle.remove();-1!==b.priority&&this.unregisterLayer(a);this._layerViewState.delete(a)}};a.prototype._recomputeOrder=function(){var a=this;this._layerViewState.forEach(function(b,c){var e=c.view.map.allLayers.findIndex(function(a){return a.uid===
c.layer.uid}),f=c.layer,e=f.visible&&f.labelsVisible&&f.labelingInfo?4294967295-e:-1;e!==b.priority&&(b.priority=e,a.unregisterLayer(c),-1!==e&&a.registerLayer(c,e))})};return a}();a.LayerViewSorter=g})},"esri/views/2d/engine/webgl/Geometry":function(){define(["require","exports"],function(g,a){Object.defineProperty(a,"__esModule",{value:!0});g=function(){function a(a,b){this.x=a;this.y=b}a.prototype.clone=function(){return new a(this.x,this.y)};a.prototype.equals=function(a,b){return a===this.x&&
b===this.y};a.prototype.isEqual=function(a){return a.x===this.x&&a.y===this.y};a.prototype.setCoords=function(a,b){this.x=a;this.y=b};a.prototype.normalize=function(){var a=this.x,b=this.y,a=Math.sqrt(a*a+b*b);this.x/=a;this.y/=a};a.prototype.rightPerpendicular=function(){var a=this.x;this.x=this.y;this.y=-a};a.prototype.move=function(a,b){this.x+=a;this.y+=b};a.prototype.assign=function(a){this.x=a.x;this.y=a.y};a.prototype.assignAdd=function(a,b){this.x=a.x+b.x;this.y=a.y+b.y};a.prototype.assignSub=
function(a,b){this.x=a.x-b.x;this.y=a.y-b.y};a.prototype.rotate=function(a,b){var e=this.x,d=this.y;this.x=e*a-d*b;this.y=e*b+d*a};a.prototype.scale=function(a){this.x*=a;this.y*=a};a.prototype.length=function(){var a=this.x,b=this.y;return Math.sqrt(a*a+b*b)};a.distance=function(a,b){var e=b.x-a.x;a=b.y-a.y;return Math.sqrt(e*e+a*a)};a.add=function(d,b){return new a(d.x+b.x,d.y+b.y)};a.sub=function(d,b){return new a(d.x-b.x,d.y-b.y)};return a}();a.Point=g})},"esri/views/2d/engine/webgl/alignmentUtils":function(){define(["require",
"exports"],function(g,a){Object.defineProperty(a,"__esModule",{value:!0});a.getXAnchorDirection=function(a){switch(a){case "left":return 1;case "right":return-1;case "center":case "justify":return 0}};a.getYAnchorDirection=function(a){switch(a){case "top":return-1;case "middle":return 0;case "baseline":case "bottom":return 1}};a.getJustification=function(a){switch(a){case "left":return 0;case "right":return 1;case "center":case "justify":return.5}}})},"esri/views/2d/engine/webgl/brushes/BrushBitmap":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../definitions ../VertexStream ./WGLBrush".split(" "),
function(g,a,d,h,b,e){Object.defineProperty(a,"__esModule",{value:!0});var m={nearest:{defines:[],samplingMode:9728,mips:!1},bilinear:{defines:[],samplingMode:9729,mips:!1},bicubic:{defines:["bicubic"],samplingMode:9729,mips:!1},trilinear:{defines:[],samplingMode:9987,mips:!0}};g=function(a){function c(){var b=null!==a&&a.apply(this,arguments)||this;b._desc={path:"raster/bitmap",attributes:{a_position:0,a_texcoord:1}};return b}d(c,a);c.prototype.dispose=function(){this._quad&&this._quad.dispose()};
c.prototype.prepareState=function(a,b){a=a.context;a.setBlendingEnabled(!0);a.setBlendFunctionSeparate(1,771,1,771);a.setColorMask(!0,!0,!0,!0);a.setStencilWriteMask(0);a.setStencilTestEnabled(!0);a.setStencilFunction(514,b.stencilRef,255)};c.prototype.draw=function(a,c){var e=a.context,f=a.renderingOptions,d=a.painter;if(c.source){a.timeline.begin(this.name);this._quad||(this._quad=new b(e,[0,0,1,0,0,1,1,1]));if("dynamic"===f.samplingMode)var f=a.state,l=c.resolution/c.pixelRatio/f.resolution,g=
Math.round(a.pixelRatio)!==a.pixelRatio,f=f.rotation||1.05<l||.95>l||g||c.isSourceScaled||c.rotation?m.bilinear:m.nearest;else f=m[f.samplingMode];d=d.materialManager.getProgram(a,this._desc,f.defines);c.setSamplingProfile(f);c.bind(h.TEXTURE_BINDING_BITMAP);e.bindProgram(d);d.setUniformMatrix3fv("u_dvsMat3",c.transforms.dvs);d.setUniform1i("u_texture",h.TEXTURE_BINDING_BITMAP);d.setUniform2fv("u_coordScale",c.coordScale);this._quad.draw();a.timeline.end(this.name)}};return c}(e.default);a.default=
g})},"esri/views/2d/engine/webgl/brushes/BrushClip":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/libs/gl-matrix-2/vec4f32 ../Utils ./WGLBrush ../shaders/BackgroundPrograms ../../../../webgl/programUtils".split(" "),function(g,a,d,h,b,e,m,c){Object.defineProperty(a,"__esModule",{value:!0});g=function(a){function e(){var b=null!==a&&a.apply(this,arguments)||this;b._color=h.vec4f32.fromValues(0,1,0,1);return b}d(e,a);e.prototype.dispose=function(){this._program&&
this._program.dispose()};e.prototype.prepareState=function(a){a=a.context;a.setStencilTestEnabled(!0);a.setBlendingEnabled(!1);a.setFaceCullingEnabled(!1);a.setColorMask(!1,!1,!1,!1);a.setStencilOp(7680,7680,7681);a.setStencilWriteMask(255);a.setStencilFunction(519,0,255)};e.prototype.draw=function(a,e){var f=a.context;a=a.state;this._program||(this._program=c.createProgram(f,m.background));var d=this._program,l=b.createProgramDescriptor("clip",{geometry:[{location:0,name:"a_pos",count:2,type:5122}]});
e=e.getVAO(f,a,l.attributes,l.bufferLayouts);f.bindProgram(this._program);d.setUniform2fv("u_coord_range",[1,1]);d.setUniform4fv("u_color",this._color);d.setUniformMatrix3fv("u_dvsMat3",a.displayMat3);f.bindVAO(e);f.drawElements(4,e.indexBuffer.size,5125,0);f.bindVAO()};return e}(e.default);a.default=g})},"esri/views/2d/engine/webgl/brushes/BrushRasterBitmap":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/tsSupport/assignHelper ../VertexStream ../WGLRasterUtils ./WGLBrush".split(" "),
function(g,a,d,h,b,e,m){Object.defineProperty(a,"__esModule",{value:!0});g=function(a){function c(){var b=null!==a&&a.apply(this,arguments)||this;b._desc={lut:{path:"raster/lut",attributes:{a_position:0,a_texcoord:1}},stretch:{path:"raster/stretch",attributes:{a_position:0,a_texcoord:1}}};return b}d(c,a);c.prototype.dispose=function(){this._quad&&this._quad.dispose()};c.prototype.prepareState=function(a,b){a=a.context;a.setBlendingEnabled(!0);a.setBlendFunctionSeparate(1,771,1,771);a.setColorMask(!0,
!0,!0,!0);a.setStencilWriteMask(0);a.setStencilTestEnabled(!0);a.setStencilFunction(514,b.stencilRef,255)};c.prototype.draw=function(a,c){var f=a.context,d=a.painter;if(c.source){a.timeline.begin(this.name);this._quad||(this._quad=new b(f,[0,0,1,0,0,1,1,1]));d=d.materialManager.getProgram(a,this._desc[c.symbolizerParameters.type]);f.bindProgram(d);var l=e.getUniformInfos(f,d),m=c.getTextures();e.setTextures(f,d,m.names,m.textures);m=c.getUniforms();c=h({u_opacity:c.opacity,u_coordScale:c.coordScale},
m);c.u_flipY=!1;e.setUniforms(f,d,l,c);this._quad.draw();a.timeline.end(this.name)}};return c}(m.default);a.default=g})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLBackground":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/libs/gl-matrix-2/mat3f32 ../../../../../core/libs/gl-matrix-2/vec4f32 ../../../../webgl ../../vectorTiles/shaders/Programs ../definitions ../enums ../number ./WGLBrush".split(" "),function(g,a,d,h,b,e,m,c,l,f,t){Object.defineProperty(a,
"__esModule",{value:!0});g=function(a){function n(){var c=null!==a&&a.apply(this,arguments)||this;c._color=b.vec4f32.fromValues(1,0,0,1);c._patternMatrix=h.mat3f32.create();c._programOptions={id:!1,pattern:!1};return c}d(n,a);n.prototype.dispose=function(){this._program&&(this._program.dispose(),this._program=null);this._vao&&(this._vao.dispose(),this._vao=null)};n.prototype.drawMany=function(a,b){var e=a.context,d=a.styleLayerId;this._loadWGLResources(e);var p=a.displayLevel,m=a.styleLayer,n=a.painter.getVectorTileProgramCach(),
h=m.getPaintValue("background-color",p),A=m.getPaintValue("background-opacity",p),g=m.getPaintValue("background-pattern",p),y=void 0!==g,t=h[3]*A,x=a.spriteMosaic,L,H=(window.devicePixelRatio|1)>c.VTL_HIGH_RES_CUTOFF?2:1;a=a.drawPhase===l.WGLDrawPhase.HITTEST;var G=this._programOptions;G.id=a;G.pattern=y;n=n.getProgram(0,(a?1:0)<<1|(y?1:0),G);e.bindVAO(this._vao);e.bindProgram(n);if(y){L=x.getMosaicItemPosition(g,!0);if(!L)return;n.setUniform1f("u_opacity",A);n.setUniform2f("u_pattern_tl",L.tl[0],
L.tl[1]);n.setUniform2f("u_pattern_br",L.br[0],L.br[1]);n.setUniform1i("u_texture",c.VTL_TEXTURE_BINDING_UNIT_SPRITES);x.bind(e,9729,L.page,c.VTL_TEXTURE_BINDING_UNIT_SPRITES)}else this._color[0]=t*h[0],this._color[1]=t*h[1],this._color[2]=t*h[2],this._color[3]=t,n.setUniform4fv("u_color",this._color);n.setUniform1f("u_depth",m.z||0);a&&(d=f.u32to4Xu8(d),n.setUniform4f("u_id",d[0],d[1],d[2],d[3]));for(d=0;d<b.length;d++)m=b[d],n.setUniform1f("u_coord_range",m.coordRange[0]),n.setUniformMatrix3fv("u_dvsMat3",
m.transforms.dvs),y&&(h=H*m.size[0]*Math.max(Math.pow(2,Math.round(p)-m.key.level),1),A=h/L.size[1],this._patternMatrix[0]=h/L.size[0],this._patternMatrix[4]=A,n.setUniformMatrix3fv("u_pattern_matrix",this._patternMatrix)),e.setStencilFunction(514,m.stencilRef,255),e.drawArrays(5,0,4)};n.prototype._loadWGLResources=function(a){if(!this._program||!this._vao){var b=e.createProgram(a,m.background);if(b){var c=new Int8Array([0,0,1,0,0,1,1,1]),c=e.BufferObject.createVertex(a,35044,c);a=new e.VertexArrayObject(a,
m.background.attributes,{geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}]},{geometry:c});this._program=b;this._vao=a}}};return n}(t.default);a.WGLBrushVTLBackground=g})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLCircle":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/libs/gl-matrix-2/vec4f32 ../../../../webgl ../enums ../number ./WGLBrush".split(" "),function(g,a,d,h,b,e,m,c){Object.defineProperty(a,"__esModule",
{value:!0});var l=[1,1,1,1];g=function(a){function c(){var b=null!==a&&a.apply(this,arguments)||this;b._color=h.vec4f32.create();b._strokeColor=h.vec4f32.create();b._programOptions={id:!1};b._vertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:16,normalized:!1,divisor:0},{name:"a_color",count:4,type:5121,offset:4,stride:16,normalized:!0,divisor:0},{name:"a_stroke_color",count:4,type:5121,offset:8,stride:16,normalized:!0,divisor:0},{name:"a_data",count:4,type:5121,offset:12,
stride:16,normalized:!1,divisor:0}]};return b}d(c,a);c.prototype.dispose=function(){};c.prototype.drawMany=function(a,b){var c=a.context,d=a.state,f=a.drawPhase,k=a.styleLayerId,n=a.displayLevel,h=a.styleLayer;a=a.painter.getVectorTileProgramCach();var q=h.hasDataDrivenRadius?1:h.getPaintValue("circle-radius",n),g=h.hasDataDrivenColor?l:h.getPaintValue("circle-color",n),A=h.hasDataDrivenOpacity?1:h.getPaintValue("circle-opacity",n),t=h.hasDataDrivenStrokeWidth?1:h.getPaintValue("circle-stroke-width",
n),x=h.hasDataDrivenStrokeColor?l:h.getPaintValue("circle-stroke-color",n),D=h.hasDataDrivenStrokeOpacity?1:h.getPaintValue("circle-stroke-opacity",n),I=h.hasDataDrivenBlur?0:h.getPaintValue("circle-blur",n),A=A*g[3];this._color[0]=A*g[0];this._color[1]=A*g[1];this._color[2]=A*g[2];this._color[3]=A;A=D*x[3];this._strokeColor[0]=A*x[0];this._strokeColor[1]=A*x[1];this._strokeColor[2]=A*x[2];this._strokeColor[3]=A;g=h.getPaintValue("circle-translate",n);n=h.getPaintValue("circle-translate-anchor",n);
x=f===e.WGLDrawPhase.HITTEST;f=this._programOptions;f.id=x;f=a.getProgram(5,x?1:0,f);c.bindProgram(f);f.setUniformMatrix3fv("u_displayMat3",1===n?d.displayMat3:d.displayViewMat3);f.setUniform2fv("u_circleTranslation",g);f.setUniform1f("u_depth",h.z);f.setUniform1f("u_radius",q);f.setUniform4fv("u_color",this._color);f.setUniform1f("u_blur",I);f.setUniform1f("u_stroke_width",t);f.setUniform4fv("u_stroke_color",this._strokeColor);f.setUniform1f("u_antialiasingWidth",1.2);x&&(d=m.u32to4Xu8(k),f.setUniform4f("u_id",
d[0],d[1],d[2],d[3]));for(d=0;d<b.length;d++)if(h=b[d],h.layerData[k]&&(q=h.layerData[k],t=this._getCircleVAO(c,h,a)))c.bindVAO(t),f.setUniformMatrix3fv("u_dvsMat3",h.transforms.dvs),c.setStencilFunction(514,h.stencilRef,255),c.drawElements(4,q.triangleElementCount,5125,12*q.triangleElementStart),h.triangleCount+=q.triangleElementCount/3};c.prototype._getCircleVAO=function(a,c,e){if(c.circleVertexArrayObject)return c.circleVertexArrayObject;var d=c.circleVertexBuffer,f=c.circleIndexBuffer;if(!d||
!f)return null;c.circleVertexArrayObject=new b.VertexArrayObject(a,e.getProgramAttributes(5),this._vertexAttributes,{geometry:d},f);return c.circleVertexArrayObject};return c}(c.default);a.WGLBrushVTLCircle=g})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLFill":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/libs/gl-matrix-2/mat3f32 ../../../../../core/libs/gl-matrix-2/vec4f32 ../../../../webgl ../definitions ../enums ../number ./WGLBrush".split(" "),
function(g,a,d,h,b,e,m,c,l,f){Object.defineProperty(a,"__esModule",{value:!0});var t=1/65536,x=[1,1,1,1];g=function(a){function f(){var c=null!==a&&a.apply(this,arguments)||this;c._fillVertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:4,normalized:!1,divisor:0}]};c._fillVertexAttributesDD={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:8,normalized:!1,divisor:0},{name:"a_color",count:4,type:5121,offset:4,stride:8,normalized:!0,divisor:0}]};c._outlineVertexAttributes=
{geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:8,normalized:!1,divisor:0},{name:"a_offset",count:2,type:5120,offset:4,stride:8,normalized:!1,divisor:0},{name:"a_xnormal",count:2,type:5120,offset:6,stride:8,normalized:!1,divisor:0}]};c._outlineVertexAttributesDD={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:12,normalized:!1,divisor:0},{name:"a_offset",count:2,type:5120,offset:4,stride:12,normalized:!1,divisor:0},{name:"a_xnormal",count:2,type:5120,offset:6,stride:12,normalized:!1,
divisor:0},{name:"a_color",count:4,type:5121,offset:8,stride:12,normalized:!0,divisor:0}]};c._color=b.vec4f32.create();c._outlineColor=b.vec4f32.create();c._fillProgramOptions={id:!1,dd:!1,pattern:!1};c._outlineProgramOptions={id:!1,dd:!1};c._patternMatrix=h.mat3f32.create();return c}d(f,a);f.prototype.dispose=function(){};f.prototype.drawMany=function(a,b){var e=a.displayLevel,f=a.drawPhase,d=a.renderPass,p=a.styleLayerId,m=a.styleLayer,n=m.getPaintValue("fill-pattern",e),h=m.hasDataDrivenColor?
x:m.getPaintValue("fill-color",e),g=m.hasDataDrivenOpacity?1:m.getPaintValue("fill-opacity",e),u=g*h[3],t=void 0!==n||1>u||m.hasDataDrivenFill;if(!t||"opaque"!==d){this._color[0]=u*h[0];this._color[1]=u*h[1];this._color[2]=u*h[2];this._color[3]=u;var y;f===c.WGLDrawPhase.HITTEST&&(y=l.u32to4Xu8(p));f=m.getPaintValue("fill-translate",e);e=m.getPaintValue("fill-translate-anchor",e);this._drawFill(a,p,m,b,f,e,n,t,y);this._drawOutline(a,p,m,b,f,e,n,y,g)}};f.prototype._drawFill=function(a,b,e,f,d,l,p,
n,h){var k=a.context,q=a.displayLevel,r=a.drawPhase,g=a.renderPass,A=a.spriteMosaic,u=a.state;if(n||"translucent"!==g){n=void 0!==p;var g=a.pixelRatio>m.VTL_HIGH_RES_CUTOFF?2:1,z=e.hasDataDrivenFill;a=a.painter.getVectorTileProgramCach();var y,B=r===c.WGLDrawPhase.HITTEST,r=this._fillProgramOptions;r.id=B;r.dd=z;r.pattern=n;r=a.getProgram(1,(B?1:0)<<2|(z?1:0)<<1|(n?1:0),r);k.bindProgram(r);if(n){y=A.getMosaicItemPosition(p,!0);if(!y){k.bindProgram();return}r.setUniform2f("u_pattern_tl",y.tl[0],y.tl[1]);
r.setUniform2f("u_pattern_br",y.br[0],y.br[1]);r.setUniform1i("u_texture",m.VTL_TEXTURE_BINDING_UNIT_SPRITES);A.bind(k,9729,y.page,m.VTL_TEXTURE_BINDING_UNIT_SPRITES)}r.setUniformMatrix3fv("u_displayMat3",1===l?u.displayMat3:u.displayViewMat3);r.setUniform2fv("u_fillTranslation",d);r.setUniform1f("u_depth",e.z+t);r.setUniform4fv("u_color",this._color);B&&r.setUniform4f("u_id",h[0],h[1],h[2],h[3]);for(e=0;e<f.length;e++)if(d=f[e],d.layerData[b]&&(p=this._getFillVAO(k,d,z,a)))l=d.layerData[b],k.bindVAO(p),
r.setUniformMatrix3fv("u_dvsMat3",d.transforms.dvs),n&&(p=d.coordRange[0]/(g*d.size[0]*Math.max(Math.pow(2,Math.round(q)-d.key.level),1)),h=1/(y.size[1]*p),this._patternMatrix[0]=1/(y.size[0]*p),this._patternMatrix[4]=h,r.setUniformMatrix3fv("u_pattern_matrix",this._patternMatrix)),k.setStencilFunction(514,d.stencilRef,255),k.drawElements(4,l.triangleElementCount,5125,12*l.triangleElementStart),d.triangleCount+=l.triangleElementCount/3}};f.prototype._drawOutline=function(a,b,e,f,d,l,p,m,n){var k=
a.context,h=a.displayLevel,q=a.drawPhase,r=a.pixelRatio,g=a.state;if("opaque"!==a.renderPass&&(p=void 0!==p,e.getPaintValue("fill-antialias",h)&&!p||e.hasDataDrivenOutlineColor)){a=a.painter.getVectorTileProgramCach();p=e.hasDataDrivenOutline;if(e.outlineUsesFillColor){if(1!==this._color[3])return;this._outlineColor[0]=this._color[0];this._outlineColor[1]=this._color[1];this._outlineColor[2]=this._color[2];this._outlineColor[3]=this._color[3]}else h=e.hasDataDrivenOutlineColor?x:e.getPaintValue("fill-outline-color",
h),n*=h[3],this._outlineColor[0]=n*h[0],this._outlineColor[1]=n*h[1],this._outlineColor[2]=n*h[2],this._outlineColor[3]=n;r=.75/r;n=q===c.WGLDrawPhase.HITTEST;q=this._outlineProgramOptions;q.id=n;q.dd=p;q=a.getProgram(2,(n?1:0)<<1|(p?1:0),q);k.bindProgram(q);q.setUniformMatrix3fv("u_displayMat3",1===l?g.displayMat3:g.displayViewMat3);q.setUniform2fv("u_fillTranslation",d);q.setUniform1f("u_depth",e.z+t);q.setUniform1f("u_outline_width",r);q.setUniform4fv("u_color",this._outlineColor);n&&q.setUniform4f("u_id",
m[0],m[1],m[2],m[3]);for(e=0;e<f.length;e++)if(d=f[e],d.layerData[b]){l=d.layerData[b];m=this._getOutlineVAO(k,d,p,a);if(!m)break;k.bindVAO(m);q.setUniformMatrix3fv("u_dvsMat3",d.transforms.dvs);k.setStencilFunction(514,d.stencilRef,255);k.drawElements(4,l.outlineElementCount,5125,12*l.outlineElementStart);d.triangleCount+=l.outlineElementCount/3}}};f.prototype._getFillVAO=function(a,b,c,d){if(c){if(b.fillDDVertexArrayObject)return b.fillDDVertexArrayObject;c=b.fillDDVertexBuffer;var f=b.fillIndexBuffer;
if(!c||!f)return null;b.fillDDVertexArrayObject=new e.VertexArrayObject(a,d.getProgramAttributes(1),this._fillVertexAttributesDD,{geometry:c},f);return b.fillDDVertexArrayObject}if(b.fillVertexArrayObject)return b.fillVertexArrayObject;c=b.fillVertexBuffer;f=b.fillIndexBuffer;if(!c||!f)return null;b.fillVertexArrayObject=new e.VertexArrayObject(a,d.getProgramAttributes(1),this._fillVertexAttributes,{geometry:c},f);return b.fillVertexArrayObject};f.prototype._getOutlineVAO=function(a,b,c,d){if(c){if(b.outlineDDVertexArrayObject)return b.outlineDDVertexArrayObject;
c=b.outlineDDVertexBuffer;var f=b.outlineIndexBuffer;if(!c||!f)return null;b.outlineDDVertexArrayObject=new e.VertexArrayObject(a,d.getProgramAttributes(2),this._outlineVertexAttributesDD,{geometry:c},f);return b.outlineDDVertexArrayObject}if(b.outlineVertexArrayObject)return b.outlineVertexArrayObject;c=b.outlineVertexBuffer;f=b.outlineIndexBuffer;if(!c||!f)return null;b.outlineVertexArrayObject=new e.VertexArrayObject(a,d.getProgramAttributes(2),this._outlineVertexAttributes,{geometry:c},f);return b.outlineVertexArrayObject};
return f}(f.default);a.WGLBrushVTLFill=g})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLLine":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/libs/gl-matrix-2/vec2f32 ../../../../../core/libs/gl-matrix-2/vec4f32 ../../../../webgl ../definitions ../enums ../number ./WGLBrush".split(" "),function(g,a,d,h,b,e,m,c,l,f){Object.defineProperty(a,"__esModule",{value:!0});a.C_DEG_TO_RAD=Math.PI/180;var t=[1,1,1,1];g=function(a){function f(){var c=null!==
a&&a.apply(this,arguments)||this;c._color=b.vec4f32.create();c._dashArray=h.vec2f32.create();c._programOptions={id:!1,dd:!1,pattern:!1};c._vertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:12,normalized:!1,divisor:0},{name:"a_offsetAndNormal",count:4,type:5120,offset:4,stride:12,normalized:!1,divisor:0},{name:"a_accumulatedDistance",count:2,type:5123,offset:8,stride:12,normalized:!1,divisor:0}]};c._vertexAttributesDD={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:20,
normalized:!1,divisor:0},{name:"a_offsetAndNormal",count:4,type:5120,offset:4,stride:20,normalized:!1,divisor:0},{name:"a_accumulatedDistance",count:2,type:5122,offset:8,stride:20,normalized:!1,divisor:0},{name:"a_color",count:4,type:5121,offset:12,stride:20,normalized:!0,divisor:0},{name:"a_width",count:1,type:5126,offset:16,stride:20,normalized:!1,divisor:0}]};return c}d(f,a);f.prototype.dispose=function(){};f.prototype.drawMany=function(a,b){var e=a.context,f=a.displayLevel,d=a.state,p=a.drawPhase,
n=a.styleLayerId,h=a.styleLayer,g=a.painter.getVectorTileProgramCach(),y=h.getPaintValue("line-translate",f),x=h.getPaintValue("line-translate-anchor",f),D=h.getPaintValue("line-pattern",f),I=void 0!==D,L=1/a.pixelRatio,H=h.getPaintValue("line-blur",f),G=h.hasDataDrivenColor?t:h.getPaintValue("line-color",f),M=h.hasDataDrivenOpacity?1:h.getPaintValue("line-opacity",f),O=h.hasDataDrivenWidth?1:h.getPaintValue("line-width",f),M=M*G[3];this._color[0]=M*G[0];this._color[1]=M*G[1];this._color[2]=M*G[2];
this._color[3]=M;var G=h.hasDataDrivenLine,M=p===c.WGLDrawPhase.HITTEST,K;M&&(K=l.u32to4Xu8(n));p=this._programOptions;p.id=M;p.dd=G;p.pattern=I;p=g.getProgram(3,(M?1:0)<<2|(G?1:0)<<1|(I?1:0),p);e.bindProgram(p);p.setUniformMatrix3fv("u_displayViewMat3",d.displayViewMat3);p.setUniformMatrix3fv("u_displayMat3",1===x?d.displayMat3:d.displayViewMat3);p.setUniform2fv("u_lineTranslation",y);p.setUniform1f("u_depth",h.z);p.setUniform1f("u_blur",H);p.setUniform1f("u_antialiasing",L);p.setUniform4fv("u_color",
this._color);p.setUniform1f("u_width",O);M&&p.setUniform4f("u_id",K[0],K[1],K[2],K[3]);if(I){if(a=a.spriteMosaic,D=a.getMosaicItemPosition(D,!0))a.bind(e,9729,D.page,m.VTL_TEXTURE_BINDING_UNIT_SPRITES),p.setUniform2f("u_pattern_tl",D.tl[0],D.br[1]),p.setUniform2f("u_pattern_br",D.br[0],D.tl[1]),p.setUniform2f("u_spriteSize",8*D.size[0],D.size[1]),p.setUniform1i("u_texture",m.VTL_TEXTURE_BINDING_UNIT_SPRITES)}else D=h.getPaintValue("line-dasharray",f),2>D.length&&(D=[1,-1]),this._dashArray[0]=8*D[0],
this._dashArray[1]=8*D[1],p.setUniform2fv("u_dasharray",this._dashArray);for(D=0;D<b.length;D++)if(a=b[D],a.layerData[n]&&(f=a.layerData[n],d=this._getLineVAO(e,a,G,g)))e.bindVAO(d),p.setUniformMatrix3fv("u_dvsMat3",a.transforms.dvs),e.setStencilFunction(514,a.stencilRef,255),e.drawElements(4,f.triangleElementCount,5125,12*f.triangleElementStart),a.triangleCount+=f.triangleElementCount/3};f.prototype._getLineVAO=function(a,b,c,f){if(c){if(b.lineDDVertexArrayObject)return b.lineDDVertexArrayObject;
c=b.lineDDVertexBuffer;var d=b.lineIndexBuffer;if(!c||!d)return null;b.lineDDVertexArrayObject=new e.VertexArrayObject(a,f.getProgramAttributes(3),this._vertexAttributesDD,{geometry:c},d);return b.lineDDVertexArrayObject}if(b.lineVertexArrayObject)return b.lineVertexArrayObject;c=b.lineVertexBuffer;d=b.lineIndexBuffer;if(!c||!d)return null;b.lineVertexArrayObject=new e.VertexArrayObject(a,f.getProgramAttributes(3),this._vertexAttributes,{geometry:c},d);return b.lineVertexArrayObject};return f}(f.default);
a.WGLBrushVTLLine=g})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLSymbol":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/libs/gl-matrix-2/vec2f32 ../../../../../core/libs/gl-matrix-2/vec4f32 ../../../../webgl ../definitions ../enums ../GeometryUtils ../number ./WGLBrush".split(" "),function(g,a,d,h,b,e,m,c,l,f,t){Object.defineProperty(a,"__esModule",{value:!0});var x=1/65536,n=[1,1,1,1];g=function(a){function p(){var c=null!==a&&a.apply(this,
arguments)||this;c._vertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:16,normalized:!1,divisor:0},{name:"a_vertexOffset",count:2,type:5122,offset:4,stride:16,normalized:!1,divisor:0},{name:"a_tex",count:4,type:5121,offset:8,stride:16,normalized:!1,divisor:0},{name:"a_levelInfo",count:4,type:5121,offset:12,stride:16,normalized:!1,divisor:0}]};c._vertexAttributesDD={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:24,normalized:!1,divisor:0},{name:"a_vertexOffset",
count:2,type:5122,offset:4,stride:24,normalized:!1,divisor:0},{name:"a_tex",count:4,type:5121,offset:8,stride:24,normalized:!1,divisor:0},{name:"a_levelInfo",count:4,type:5121,offset:12,stride:24,normalized:!1,divisor:0},{name:"a_color",count:4,type:5121,offset:16,stride:24,normalized:!0,divisor:0},{name:"a_size",count:1,type:5126,offset:20,stride:24,normalized:!1,divisor:0}]};c._iconProgramOptions={id:!1,dd:!1,sdf:!1};c._sdfProgramOptions={id:!1,dd:!1};c._spritesTextureSize=h.vec2f32.create();c._haloColor=
b.vec4f32.create();c._sdfColor=b.vec4f32.create();c._color=b.vec4f32.create();return c}d(p,a);p.prototype.dispose=function(){};p.prototype.drawMany=function(a,b){var e=a.drawPhase,d=a.styleLayerId,k=a.styleLayer,l=a.fadeRecorder.getFadeValues(),p;e===c.WGLDrawPhase.HITTEST&&(p=f.u32to4Xu8(d));this._drawIcons(a,k,b,l,p);this._drawText(a,k,b,l,p)};p.prototype._drawIcons=function(a,b,e,f,d){for(var k=this,p=a.context,h=a.displayLevel,q=a.drawPhase,r=a.painter,g=a.state,u=a.styleLayerId,z,t=!1,y=0;y<
e.length;y++){var x=e[y];if(x.layerData[u]&&(z=x.layerData[u],0<z.iconPerPageElementsMap.size)){t=!0;break}}if(t){var x=b.hasDataDrivenIconSize?1:b.getLayoutValue("icon-size",h),K=b.hasDataDrivenIconColor?n:b.getPaintValue("icon-color",h),Q=b.hasDataDrivenIconOpacity?1:b.getPaintValue("icon-opacity",h),t=b.getPaintValue("icon-translate",h),y=b.getPaintValue("icon-translate-anchor",h),P=r.getVectorTileProgramCach(),r=K[3]*Q;this._color[0]=r*K[0];this._color[1]=r*K[1];this._color[2]=r*K[2];this._color[3]=
r;r=b.getLayoutValue("icon-rotation-alignment",h);2===r&&(r=1===b.getLayoutValue("symbol-placement",h)?0:1);var K=z.isSDF,N=b.hasDataDrivenIcon,q=q===c.WGLDrawPhase.HITTEST,Q=this._iconProgramOptions;Q.id=q;Q.dd=N;Q.sdf=K;var J=P.getProgram(4,(q?1:0)<<2|(N?1:0)<<1|(K?1:0),Q);p.bindProgram(J);K&&(K=b.getPaintValue("icon-halo-color",h),Q=b.getPaintValue("icon-halo-width",h),J.setUniform4f("u_outlineColor",K[0],K[1],K[2],K[3]),J.setUniform1f("u_outlineSize",Q));J.setUniformMatrix3fv("u_displayViewMat3",
0===r?g.displayViewMat3:g.displayMat3);J.setUniformMatrix3fv("u_displayMat3",1===y?g.displayMat3:g.displayViewMat3);J.setUniform2fv("u_iconTranslation",t);J.setUniform1f("u_depth",b.z);J.setUniform1f("u_mapRotation",l.degToByte(g.rotation));J.setUniform1f("u_keepUpright",0);J.setUniform1f("u_level",10*h);J.setUniform1f("u_fadeSpeed",10*f.fadeSpeed);J.setUniform1f("u_minfadeLevel",10*f.minfadeLevel);J.setUniform1f("u_maxfadeLevel",10*f.maxfadeLevel);J.setUniform1f("u_fadeChange",10*(h+f.fadeChange));
J.setUniform1i("u_texture",m.VTL_TEXTURE_BINDING_UNIT_SPRITES);J.setUniform1f("u_size",x);J.setUniform4fv("u_color",this._color);q&&J.setUniform4fv("u_id",d);b=function(b){if(!b.layerData[u])return"continue";z=b.layerData[u];if(0===z.iconPerPageElementsMap.size)return"continue";var c=R._getIconVAO(p,b,N,P);if(!c)return"continue";p.bindVAO(c);J.setUniformMatrix3fv("u_dvsMat3",b.transforms.dvs);z.iconPerPageElementsMap.forEach(function(c,e){k._renderIconRange(a,J,c,e,b)})};var R=this;for(f=0;f<e.length;f++)x=
e[f],b(x)}};p.prototype._renderIconRange=function(a,b,c,e,f){var d=a.context,l=a.hasClipping,k=a.requiredLevel;a=a.spriteMosaic;this._spritesTextureSize[0]=a.getWidth(e)/4;this._spritesTextureSize[1]=a.getHeight(e)/4;b.setUniform2fv("u_mosaicSize",this._spritesTextureSize);a.bind(d,9729,e,m.VTL_TEXTURE_BINDING_UNIT_SPRITES);b=!0;k!==f.key.level||l?d.setStencilFunction(514,f.stencilRef,255):b=!1;d.setStencilTestEnabled(b);d.drawElements(4,c[1],5125,12*c[0]);f.triangleCount+=c[1]/3};p.prototype._drawText=
function(a,b,e,f,d){for(var k=this,p=a.context,q=a.displayLevel,r=a.drawPhase,g=a.glyphMosaic,u=a.hasClipping,z=a.painter,t=a.pixelRatio,y=a.requiredLevel,M=a.state,O=a.styleLayerId,K,Q=!1,P=0;P<e.length;P++)if(a=e[P],a.layerData[O]&&(K=a.layerData[O],0<K.glyphPerPageElementsMap.size)){Q=!0;break}if(Q){a=b.getLayoutValue("text-rotation-alignment",q);2===a&&(a=1===b.getLayoutValue("symbol-placement",q)?0:1);var Q=0===a,Q=b.getLayoutValue("text-keep-upright",q)&&Q,r=r===c.WGLDrawPhase.HITTEST,t=.8*
3/t,P=b.hasDataDrivenTextSize?1:b.getLayoutValue("text-size",q),N=b.hasDataDrivenTextColor?n:b.getPaintValue("text-color",q),J=b.hasDataDrivenTextOpacity?1:b.getPaintValue("text-opacity",q),R=b.getPaintValue("text-halo-color",q),Y=b.getPaintValue("text-halo-width",q),W=3*b.getPaintValue("text-halo-blur",q),X=3*Y,Z=z.getVectorTileProgramCach(),z=N[3]*J;this._sdfColor[0]=z*N[0];this._sdfColor[1]=z*N[1];this._sdfColor[2]=z*N[2];this._sdfColor[3]=z;z=R[3]*J;this._haloColor[0]=z*R[0];this._haloColor[1]=
z*R[1];this._haloColor[2]=z*R[2];this._haloColor[3]=z;this._glyphTextureSize||(this._glyphTextureSize=h.vec2f32.fromValues(g.width/4,g.height/4));var z=b.getPaintValue("text-translate",q),N=b.getPaintValue("text-translate-anchor",q),aa=b.hasDataDrivenText,J=this._sdfProgramOptions;J.id=r;J.dd=aa;var V=Z.getProgram(6,(r?1:0)<<1|(aa?1:0),J);p.bindProgram(V);V.setUniformMatrix3fv("u_displayViewMat3",0===a?M.displayViewMat3:M.displayMat3);V.setUniformMatrix3fv("u_displayMat3",1===N?M.displayMat3:M.displayViewMat3);
V.setUniform2fv("u_textTranslation",z);V.setUniform1f("u_depth",b.z+x);V.setUniform2fv("u_mosaicSize",this._glyphTextureSize);V.setUniform1f("u_mapRotation",l.degToByte(M.rotation));V.setUniform1f("u_keepUpright",Q?1:0);V.setUniform1f("u_level",10*q);V.setUniform1f("u_fadeSpeed",10*f.fadeSpeed);V.setUniform1f("u_minfadeLevel",10*f.minfadeLevel);V.setUniform1f("u_maxfadeLevel",10*f.maxfadeLevel);V.setUniform1f("u_fadeChange",10*(q+f.fadeChange));V.setUniform1i("u_texture",m.VTL_TEXTURE_BINDING_UNIT_GLYPHS);
V.setUniform1f("u_size",P);V.setUniform1f("u_antialiasingWidth",t);r&&V.setUniform4f("u_id",d[0],d[1],d[2],d[3]);b=function(a){if(!a.layerData[O])return"continue";K=a.layerData[O];if(0===K.glyphPerPageElementsMap.size)return"continue";var b=ca._getSDFVAO(p,a,aa,Z);if(!b)return"continue";p.bindVAO(b);V.setUniformMatrix3fv("u_dvsMat3",a.transforms.dvs);b=!0;y!==a.key.level||u?p.setStencilFunction(514,a.stencilRef,255):b=!1;p.setStencilTestEnabled(b);K.glyphPerPageElementsMap.forEach(function(b,c){k._renderGlyphRange(p,
b,c,g,V,R[3],Y,W,X,a)})};var ca=this;for(f=0;f<e.length;f++)a=e[f],b(a)}};p.prototype._renderGlyphRange=function(a,b,c,e,f,d,l,p,n,h){e.bind(a,9729,c,m.VTL_TEXTURE_BINDING_UNIT_GLYPHS);0<d&&0<l&&(f.setUniform4fv("u_color",this._haloColor),f.setUniform1f("u_halo",1),f.setUniform1f("u_edgeDistance",n),f.setUniform1f("u_edgeBlur",p),a.drawElements(4,b[1],5125,12*b[0]),h.triangleCount+=b[1]/3);0<this._sdfColor[3]&&(f.setUniform4fv("u_color",this._sdfColor),f.setUniform1f("u_halo",0),f.setUniform1f("u_edgeDistance",
0),f.setUniform1f("u_edgeBlur",0),a.drawElements(4,b[1],5125,12*b[0]),h.triangleCount+=b[1]/3)};p.prototype._getIconVAO=function(a,b,c,f){if(c){if(b.iconDDVertexArrayObject)return b.iconDDVertexArrayObject;c=b.iconDDVertexBuffer;var d=b.iconIndexBuffer;if(!c||!d)return null;b.iconDDVertexArrayObject=new e.VertexArrayObject(a,f.getProgramAttributes(4),this._vertexAttributesDD,{geometry:c},d);return b.iconDDVertexArrayObject}if(b.iconVertexArrayObject)return b.iconVertexArrayObject;c=b.iconVertexBuffer;
d=b.iconIndexBuffer;if(!c||!d)return null;b.iconVertexArrayObject=new e.VertexArrayObject(a,f.getProgramAttributes(4),this._vertexAttributes,{geometry:c},d);return b.iconVertexArrayObject};p.prototype._getSDFVAO=function(a,b,c,f){if(c){if(b.textDDVertexArrayObject)return b.textDDVertexArrayObject;c=b.textDDVertexBuffer;var d=b.textIndexBuffer;if(!c||!d)return null;b.textDDVertexArrayObject=new e.VertexArrayObject(a,f.getProgramAttributes(6),this._vertexAttributesDD,{geometry:c},d);return b.textDDVertexArrayObject}if(b.textVertexArrayObject)return b.textVertexArrayObject;
c=b.textVertexBuffer;d=b.textIndexBuffer;if(!c||!d)return null;b.textVertexArrayObject=new e.VertexArrayObject(a,f.getProgramAttributes(6),this._vertexAttributes,{geometry:c},d);return b.textVertexArrayObject};return p}(t.default);a.WGLBrushVTLSymbol=g})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrush":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../webgl ../definitions ./WGLBrush".split(" "),function(g,a,d,h,b,e){Object.defineProperty(a,"__esModule",
{value:!0});g=function(a){function c(){return null!==a&&a.apply(this,arguments)||this}d(c,a);c.prototype.prepareState=function(a,b,c){a=a.context;c=c&&-1!==c.indexOf("id");a.setBlendingEnabled(!c);a.setBlendFunctionSeparate(1,771,1,771);a.setColorMask(!0,!0,!0,!0);a.setStencilWriteMask(0);a.setStencilTestEnabled(!0);a.setStencilFunction(514,b.stencilRef,255)};c.prototype.draw=function(a,b,c){var e=this;if(b.isReady&&b.hasData){b.commitChanges();var f=this.getGeometryType(),d=b.getDisplayList(),l=
b.getGeometry(f);l&&d&&(a.timeline.begin(this.name),d.byType(f,function(f){e.drawGeometry(a,b,f,l,c)}),a.timeline.end(this.name))}};c.prototype._getVAO=function(a,b,c,e){e.vao||(e.vao=new h.VertexArrayObject(a,c,b,e.vertexBufferMap,e.indexBuffer));return e.vao};c.prototype._setSharedUniforms=function(a,c,e){a.setUniform1f("u_pixelRatio",c.pixelRatio);a.setUniformMatrix3fv("u_dvsMat3",e.transforms.dvs);a.setUniformMatrix3fv("u_displayViewMat3",c.state.displayViewMat3);a.setUniformMatrix4fv("u_insideEffectMat4",
c.rendererInfo.insideEffect);a.setUniformMatrix4fv("u_outsideEffectMat4",c.rendererInfo.outsideEffect);a.setUniform1fv("u_insideOpacities",c.rendererInfo.insideOpacities);a.setUniform1fv("u_outsideOpacities",c.rendererInfo.outsideOpacities);a.setUniform1i("u_attributeTextureSize",c.attributeView.size);a.setUniform1i("u_attributeData0",b.TEXTURE_BINDING_ATTRIBUTE_DATA_0);a.setUniform1i("u_attributeData1",b.TEXTURE_BINDING_ATTRIBUTE_DATA_1);a.setUniform1i("u_attributeData2",b.TEXTURE_BINDING_ATTRIBUTE_DATA_2);
a.setUniform1i("u_attributeData3",b.TEXTURE_BINDING_ATTRIBUTE_DATA_3)};return c}(e.default);a.default=g})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushFill":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/tsSupport/assignHelper ../../../../../core/RandomLCG ../../../../webgl ../definitions ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey".split(" "),function(g,a,d,h,b,e,m,c,l,f,t){Object.defineProperty(a,"__esModule",{value:!0});
g=function(a){function f(){var b=null!==a&&a.apply(this,arguments)||this;b._dotTextureSize=0;b._dotTextures=null;b._dotSamplers=new Int32Array([m.TEXTURE_BINDING_RENDERER_0,m.TEXTURE_BINDING_RENDERER_1]);return b}d(f,a);f.prototype.dispose=function(){this._disposeTextures()};f.prototype.getGeometryType=function(){return c.WGLGeometryType.FILL};f.prototype.drawGeometry=function(a,b,c,e,f){var d=a.context,k=a.painter,p=a.rendererInfo,n=a.requiredLevel,h=c.indexCount,r=c.indexFrom;c=t.FillMaterialKey.load(c.materialKey);
var g=l.createProgramDescriptor(c.data,{geometry:[{location:0,name:"a_pos",count:2,type:5122},{location:1,name:"a_id",count:4,type:5121}].concat(c.dotDensity?[]:[{location:2,name:"a_color",count:4,type:5121,normalized:!0},{location:3,name:"a_tlbr",count:4,type:5123},{location:4,name:"a_aux1",count:4,type:5121},{location:5,name:"a_aux2",count:2,type:5123},{location:6,name:"a_aux3",count:4,type:5121}],c.dotDensity?[{location:2,name:"a_inverseArea",count:1,type:5126}]:[])}),u=g.bufferLayouts,g=g.attributes;
f=k.materialManager.getMaterialProgram(a,c,"materials/fill",g,f);e=this._getVAO(d,u,g,e);d.bindProgram(f);d.bindVAO(e);this._setSharedUniforms(f,a,b);c.textureBinding&&(k.textureManager.bindTextures(d,f,c),k=1/Math.pow(2,n-b.key.level)/a.pixelRatio,f.setUniform1f("u_zoomFactor",k));c.vvColor&&(f.setUniform1fv("u_vvColorValues",p.vvColorValues),f.setUniform4fv("u_vvColors",p.vvColors));c.vvOpacity&&(f.setUniform1fv("u_vvOpacityValues",p.vvOpacityValues),f.setUniform1fv("u_vvOpacities",p.vvOpacities));
c.dotDensity&&(c=m.TILE_SIZE/p.ddDotSize,e=c*window.devicePixelRatio*c*window.devicePixelRatio,k=1/Math.pow(2,n-b.key.level),b=1/k*(1/k),a=p.ddDotScale?a.state.scale/p.ddDotScale:1,f.setUniform1f("u_tileZoomFactor",k),f.setUniform1f("u_tileDotsOverArea",e/(m.TILE_SIZE*window.devicePixelRatio*m.TILE_SIZE*window.devicePixelRatio)),f.setUniformMatrix4fv("u_dotColors",p.ddColors),f.setUniform4fv("u_isActive",p.ddActiveDots),f.setUniform4fv("u_dotBackgroundColor",p.ddBackgroundColor),f.setUniform1f("u_dotValue",
Math.max(1,p.ddDotValue*a*b)),this._bindDotDensityTextures(d,f,p,c));d.drawElements(4,h,5125,4*r);d.bindVAO(null)};f.prototype._disposeTextures=function(){if(this._dotTextures){for(var a=0;a<this._dotTextures.length;a++)this._dotTextures[a].dispose();this._dotTextures=null}};f.prototype._bindDotDensityTextures=function(a,b,c,e){c=this._createDotDensityTextures(a,e,c.ddSeed);b.setUniform1iv("u_dotTextures",this._dotSamplers);for(b=0;b<c.length;b++)a.bindTexture(c[b],this._dotSamplers[b])};f.prototype._createDotDensityTextures=
function(a,c,e){if(this._dotTextureSize!==c||this._seed!==e)this._disposeTextures(),this._dotTextureSize=c,this._seed=e;null===this._dotTextures&&(e=new b(e),this._dotTextures=[this._allocDotDensityTexture(a,c,e),this._allocDotDensityTexture(a,c,e)]);return this._dotTextures};f.prototype._allocDotDensityTexture=function(a,b,c){for(var f=new Float32Array(b*b*4),d=0;d<f.length;d++)f[d]=c.getFloat();return new e.Texture(a,{wrapMode:10497,pixelFormat:6408,dataType:5126,samplingMode:9728,width:b,height:b},
f)};return f}(f.default);a.default=g})},"esri/views/2d/engine/webgl/materialKey/MaterialKey":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/tsSupport/assignHelper ../../../../../renderers ../../../../../core/Error ../../../../../core/maybe ../enums ../mesh/templates/WGLLabelTemplate ../util/vvFlagUtils".split(" "),function(g,a,d,h,b,e,m,c,l,f){Object.defineProperty(a,"__esModule",{value:!0});a.createMaterialKey=function(a,b,e,f){if(m.isSome(b)){a:{if("heatmap"===
b.type)throw Error("Symbol processor does not support heatmap renderer");switch(a){case c.WGLGeometryType.FILL:a=p.from(b);break a;case c.WGLGeometryType.LINE:a=u.from(b,e);break a;case c.WGLGeometryType.MARKER:if("dot-density"===b.type)throw Error("Dot Density renderer does not support Marker GeometryTypes");a=y.from(b);break a;case c.WGLGeometryType.TEXT:if("dot-density"===b.type)throw Error("Dot Density renderer does not support Text GeometryTypes");a=k.from(b);break a;case c.WGLGeometryType.LABEL:if("dot-density"===
b.type)throw Error("Dot Density renderer does not support Label GeometryTypes");a=r.from(b,f);break a;default:throw Error("Unable to createMaterialKey for unknown geometryType "+a);}}return a}switch(a){case c.WGLGeometryType.FILL:return p.from(null);case c.WGLGeometryType.LINE:return u.from(null,e);case c.WGLGeometryType.MARKER:return y.from(null);case c.WGLGeometryType.TEXT:return k.from(null);case c.WGLGeometryType.LABEL:return r.from(null,f);default:throw Error("Unable to createMaterialKey for unknown geometryType "+
a);}};g=function(){function a(a){this._data=0;this._data=a}a.load=function(a){var b=this.shared;b.data=a;return b};Object.defineProperty(a.prototype,"data",{get:function(){return this._data},set:function(a){this._data=a},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"geometryType",{get:function(){return this.bits(5,8)},set:function(a){this.setBits(a,5,8)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"mapAligned",{get:function(){return!!this.bit(17)},set:function(a){this.setBit(17,
a)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"sdf",{get:function(){return!!this.bit(8)},set:function(a){this.setBit(8,a)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"pattern",{get:function(){return!!this.bit(9)},set:function(a){this.setBit(9,a)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"textureBinding",{get:function(){return this.bits(0,5)},set:function(a){this.setBits(a,0,5)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"geometryTypeString",{get:function(){switch(this.geometryType){case c.WGLGeometryType.FILL:return"fill";case c.WGLGeometryType.MARKER:return"marker";case c.WGLGeometryType.LINE:return"line";case c.WGLGeometryType.TEXT:return"text";case c.WGLGeometryType.LABEL:return"label";default:throw new e("Unable to handle unknown geometryType: "+this.geometryType);}},enumerable:!0,configurable:!0});a.prototype.setBit=function(a,b){a=1<<a;this._data=b?this._data|a:this._data&~a};a.prototype.bit=function(a){return(this._data&
1<<a)>>a};a.prototype.setBits=function(a,b,c){for(var e=0;b<c;b++,e++)this.setBit(b,0!==(a&1<<e))};a.prototype.bits=function(a,b){for(var c=0,e=0;a<b;a++,e++)c|=this.bit(a)<<e;return c};a.prototype.hasVV=function(){return!1};a.prototype.setVV=function(a,b){};a.prototype.getVariation=function(){var a={},b;for(b in this)"boolean"===typeof this[b]&&(a[b]=this[b]);return a};a.prototype.getVariationHash=function(){return this._data&~(4&this.textureBinding)};a.shared=new a(0);return a}();a.MaterialKeyBase=
g;h=function(a){return function(a){function b(){return null!==a&&a.apply(this,arguments)||this}d(b,a);Object.defineProperty(b.prototype,"vvSizeMinMaxValue",{get:function(){return 0!==this.bit(13)},set:function(a){this.setBit(13,a)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"vvSizeScaleStops",{get:function(){return 0!==this.bit(14)},set:function(a){this.setBit(14,a)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"vvSizeFieldStops",{get:function(){return 0!==
this.bit(15)},set:function(a){this.setBit(15,a)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"vvSizeUnitValue",{get:function(){return 0!==this.bit(16)},set:function(a){this.setBit(16,a)},enumerable:!0,configurable:!0});b.prototype.hasVV=function(){return a.prototype.hasVV.call(this)||this.vvSizeMinMaxValue||this.vvSizeScaleStops||this.vvSizeFieldStops||this.vvSizeUnitValue};b.prototype.setVV=function(b,e){a.prototype.setVV.call(this,b,e);b&=f.getSizeFlagsMask(b,e);this.vvSizeMinMaxValue=
!!(b&c.WGLVVFlag.SIZE_MINMAX_VALUE);this.vvSizeFieldStops=!!(b&c.WGLVVFlag.SIZE_FIELD_STOPS);this.vvSizeUnitValue=!!(b&c.WGLVVFlag.SIZE_UNIT_VALUE);this.vvSizeScaleStops=!!(b&c.WGLVVFlag.SIZE_SCALE_STOPS)};return b}(a)};var t=function(a){return function(a){function b(){return null!==a&&a.apply(this,arguments)||this}d(b,a);Object.defineProperty(b.prototype,"vvRotation",{get:function(){return 0!==this.bit(12)},set:function(a){this.setBit(12,a)},enumerable:!0,configurable:!0});b.prototype.hasVV=function(){return a.prototype.hasVV.call(this)||
this.vvRotation};b.prototype.setVV=function(b,e){a.prototype.setVV.call(this,b,e);this.vvRotation=!e&&!!(b&c.WGLVVFlag.ROTATION)};return b}(a)},x=function(a){return function(a){function b(){return null!==a&&a.apply(this,arguments)||this}d(b,a);Object.defineProperty(b.prototype,"vvColor",{get:function(){return 0!==this.bit(10)},set:function(a){this.setBit(10,a)},enumerable:!0,configurable:!0});b.prototype.hasVV=function(){return a.prototype.hasVV.call(this)||this.vvColor};b.prototype.setVV=function(b,
e){a.prototype.setVV.call(this,b,e);this.vvColor=!e&&!!(b&c.WGLVVFlag.COLOR)};return b}(a)},n=function(a){return function(a){function b(){return null!==a&&a.apply(this,arguments)||this}d(b,a);Object.defineProperty(b.prototype,"vvOpacity",{get:function(){return 0!==this.bit(11)},set:function(a){this.setBit(11,a)},enumerable:!0,configurable:!0});b.prototype.hasVV=function(){return a.prototype.hasVV.call(this)||this.vvOpacity};b.prototype.setVV=function(b,e){a.prototype.setVV.call(this,b,e);this.vvOpacity=
!e&&!!(b&c.WGLVVFlag.OPACITY)};return b}(a)},p=function(a){function e(){return null!==a&&a.apply(this,arguments)||this}d(e,a);e.load=function(a){var b=this.shared;b.data=a;return b};e.from=function(a){var e=this.load(0);e.geometryType=c.WGLGeometryType.FILL;m.isSome(a)&&(a instanceof b.DotDensityRenderer?e.dotDensity=!0:(a=f.getVVFlags(a.visualVariables),e.setVV(a,!1)));return e.data};e.prototype.getVariation=function(){return a.prototype.getVariation.call(this)};Object.defineProperty(e.prototype,
"dotDensity",{get:function(){return!!this.bit(12)},set:function(a){this.setBit(12,a)},enumerable:!0,configurable:!0});e.shared=new e(0);return e}(x(n(g)));a.FillMaterialKey=p;var y=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}d(b,a);b.load=function(a){var b=this.shared;b.data=a;return b};b.from=function(a){var b=this.load(0);b.geometryType=c.WGLGeometryType.MARKER;m.isSome(a)&&(a=f.getVVFlags(a.visualVariables),b.setVV(a,!1));return b.data};b.prototype.getVariation=function(){return a.prototype.getVariation.call(this)};
b.shared=new b(0);return b}(x(n(t(h(g)))));a.MarkerMaterialKey=y;var u=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}d(b,a);b.load=function(a){var b=this.shared;b.data=a;return b};b.from=function(a,b){var e=this.load(0);e.geometryType=c.WGLGeometryType.LINE;m.isSome(a)&&(a=f.getVVFlags(a.visualVariables),e.setVV(a,b));return e.data};b.prototype.getVariation=function(){return a.prototype.getVariation.call(this)};b.shared=new b(0);return b}(x(n(h(g))));a.LineMaterialKey=u;
var k=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}d(b,a);b.load=function(a){var b=this.shared;b.data=a;return b};b.from=function(a){var b=this.load(0);b.geometryType=c.WGLGeometryType.TEXT;m.isSome(a)&&(a=f.getVVFlags(a.visualVariables),b.setVV(a,!1));return b.data};b.prototype.getVariation=function(){return a.prototype.getVariation.call(this)};b.shared=new b(0);return b}(x(n(t(h(g)))));a.TextMaterialKey=k;var r=function(a){function b(){return null!==a&&a.apply(this,arguments)||
this}d(b,a);b.load=function(a){var b=this.shared;b.data=a;return b};b.from=function(a,b){var e=this.load(0);e.geometryType=c.WGLGeometryType.LABEL;m.isSome(a)&&(a=f.getVVFlags(a.visualVariables),e.setVV(a,!1));e.mapAligned=!!l.isMapAligned(b.labelPlacement);return e.data};b.prototype.getVariation=function(){return a.prototype.getVariation.call(this)};b.shared=new b(0);return b}(h(g));a.LabelMaterialKey=r})},"esri/views/2d/engine/webgl/mesh/templates/WGLLabelTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/mathUtils ../../../../../../core/mathUtils ../../../../../../core/libs/gl-matrix-2/mat2d ../../../../../../core/libs/gl-matrix-2/mat2df32 ../../../../../../core/libs/gl-matrix-2/vec2 ../../../../../../core/libs/gl-matrix-2/vec2f32 ../../../vectorTiles/GeometryUtils ../../color ../../definitions ../../enums ../../number ../../TextShaping ../../collisions/Metric ../../materialKey/MaterialKey ./GlyphGroup ./util ./WGLTextTemplate".split(" "),
function(g,a,d,h,b,e,m,c,l,f,t,x,n,p,y,u,k,r,z,q,E,A){function B(a){switch(a){case "above-left":return[-1,-1];case "above-center":case "above-along":return[0,-1];case "above-right":return[1,-1];case "center-left":return[-1,0];case "center-center":case "center-along":return[0,0];case "center-right":return[1,0];case "below-left":return[-1,1];case "below-center":case "below-along":return[0,1];case "below-right":return[1,1];case "always-horizontal":return[0,0];default:H("Found invalid placement type "+
a)}}Object.defineProperty(a,"__esModule",{value:!0});var C=b.getLogger("esri.views.2d.engine.webgl.WGLLabelTemplate"),D=t.vec2f32.create(),I=l.mat2df32.create(),L={xOffset:0,yOffset:0,width:0,height:0},H=function(a,b){void 0===b&&(b="mapview-labeling");return C.error(new h(b,a))};a.isMapAligned=function(a){switch(a){case "above-along":case "below-along":case "center-along":return 1;default:return 0}};g=function(a){function b(b,c,f,d){f=a.call(this,b,f.font.size,f.haloSize||0,f.color&&n.premultiplyAlphaRGBA(f.color)||
0,f.haloColor&&n.premultiplyAlphaRGBA(f.haloColor)||0,f.horizontalAlignment,f.verticalAlignment,f.font.decoration,!1,f.angle||0,f.xoffset,f.yoffset,f.id)||this;f._refTemplate=L;f.geometryType=y.WGLGeometryType.LABEL;var l=c.symbol,k;k=!!c.minScale&&d.scaleToZoom(c.minScale)||0;k=e.clamp(k,0,25.5);d=!!c.maxScale&&d.scaleToZoom(c.maxScale)||255;d=e.clamp(d,0,25.5);var p=B(c.labelPlacement),m=p[0],p=p[1];f._justify=(-1*m+1)/2;f._xAlignD=m;f._yAlignD=p;f._xPlacementD=m;f._yPlacementD=p;f._minZoom=k;f._maxZoom=
d;b=z.LabelMaterialKey.load(z.createMaterialKey(f.geometryType,b,!1,c));b.sdf=!0;f._materialKey=b.data;b=l.font.decoration.toLowerCase();"underline"===b?f._decorationTop=6:"line-through"===b&&(f._decorationTop=-5);return f}d(b,a);b.fromLabelClass=function(a,c,e){return new b(a,c,c.symbol,e)};b.prototype.bindTextInfo=function(a,b,c){a=this._computeShaping(a,this._justify).getShaping(b,c);isNaN(this._decorationTop)||k.TextShaping.addDecoration(a,this._decorationTop);this._shapedGlyphs=a;this._shapedBox=
k.TextShaping.getBox(a)};b.prototype._computeShaping=function(a,b){return new k.TextShaping([a],p.TEXT_MAX_WIDTH,p.TEXT_LINE_HEIGHT,p.TEXT_SPACING,[0,0],.5,.5,b)};Object.defineProperty(b.prototype,"bounds",{get:function(){return this._bounds},enumerable:!0,configurable:!0});b.prototype.bindReferenceTemplate=function(a){this._refTemplate=a||L};b.prototype._placeGlyphs=function(a,b,c,e){var f=this._size,d=this._haloSize,l=this._shapedBox,k=this._shapedGlyphs,p=this._computeGlyphTransform(l);if("esriGeometryPolyline"!==
a)for(var n=0;n<c.length;n++)for(var h=c[n],g=0,r=k;g<r.length;g++){var q=r[g];h.place(q,a,b,p,this._materialKey,f,d,l,e,this._minZoom,this._maxZoom)}else for(n=0;n<c.length;n++)for(var h=c[n],g=q=h.order,r=g-(g-1)/2-1,A=r-(r-1)/2-1,u=A-(A-1)/2-1,q=-1===q?0:g%2?r%2?A%2?u%2?0:e-3.1:e-2.1:e-1.1:e-.1,g=Math.max(e+m.log2((this._shapedBox.width*this._scale+48)/h.pathLen),Math.max(q,this._minZoom)),r=0,A=k;r<A.length;r++)q=A[r],h.place(q,a,b,p,this._materialKey,f,d,l,e,g,this._maxZoom)};b.prototype.writeMesh=
function(a,b,c,e,f,d,l){var k=this,m=this._computeAnchors(c,f),n=u.i8888to32(0,0,0,this._bitset);if(m.length&&this._shapedGlyphs.length)if(this._placeGlyphs(c,f,m,d),f=z.LabelMaterialKey.load(this._materialKey),"esriGeometryPolyline"!==c){c=m[0];d=this._computeGlyphTransform(this._shapedBox);d=this._createBounds(this._shapedBox,d);var h=c.glyphs.get(0),g=h[0],q=g.anchorX,A=g.anchorY,t=Math.floor(10*g.minZoom),g=Math.floor(10*g.maxZoom),y=a.length;h.forEach(function(a){a.minZoom=25.5;a.maxZoom=25.5});
y=new r.default(e,{from:y,count:a.length-y},q,A,t);q=Math.floor(q/p.COLLISION_BUCKET_SIZE);A=Math.floor(A/p.COLLISION_BUCKET_SIZE);q>=p.COLLISION_TILE_BOX_SIZE||A>=p.COLLISION_TILE_BOX_SIZE||0>q||0>A||(this._writeVertices(a,b,e,h,n,t,g),h=Math.max(this._refTemplate.height,this._refTemplate.width),f.vvSizeFieldStops||f.vvSizeMinMaxValue||f.vvSizeScaleStops||f.vvSizeUnitValue?y.setVV(h,this._xPlacementD,this._yPlacementD):(y.offsetX=(h/2+p.COLLISION_PLACEMENT_PADDING)*this._xPlacementD,y.offsetY=(h/
2+p.COLLISION_PLACEMENT_PADDING)*this._yPlacementD),y.bounds=d,l.push(y),c.clear())}else{f=function(c){var f=m[c],d=f.x,p=f.y;c=a.length;var h=new r.default(e,{from:c,count:-1},d,p,25.5);f.glyphs.forEach(function(c){for(var l=0;l<c.length;l++){var m=c[l];m.minZoom=Math.max(f.minZoom,m.minZoom);if(m.bounds){var g=m.anchorY-p;m.bounds.center[0]+=m.anchorX-d;m.bounds.center[1]+=g;h.add(m.bounds)}}h.bounds&&k._writeHalos(a,b,e,c,n)});f.glyphs.forEach(function(c){h.bounds&&k._writeText(a,b,e,c,n)});h.range.count=
a.length-c;h.bounds&&l.push(h);f.clear()};for(c=0;c<m.length;c++)f(c);this._computedGlyphs=[]}};b.prototype._outsideTile=function(a,b){return 0>a||512<=a||0>b||512<=b};b.prototype._smoothVertices=function(a,b){if(!(0>=b)){var c=a.length;if(!(3>c)){var e=[],f=0;e.push(0);for(var d=1;d<c;d++)f+=E.dist(a[d],a[d-1]),e.push(f);b=Math.min(b,.2*f);f=[];f.push(a[0][0]);f.push(a[0][1]);var l=a[c-1][0],k=a[c-1][1],d=E.sub([0,0],a[0],a[1]);E.normalize(d);a[0][0]+=b*d[0];a[0][1]+=b*d[1];E.sub(d,a[c-1],a[c-2]);
E.normalize(d);a[c-1][0]+=b*d[0];a[c-1][1]+=b*d[1];for(d=1;d<c;d++)e[d]+=b;e[c-1]+=b;for(var p=.5*b,d=1;d<c-1;d++){for(var m=0,n=0,h=0,g=d-1;0<=g&&!(e[g+1]<e[d]-p);g--){var r=p+e[g+1]-e[d],q=e[g+1]-e[g],A=e[d]-e[g]<p?1:r/q;if(1E-6>Math.abs(A))break;var u=A*A,t=A*r-.5*u*q,z=A*q/b,y=a[g+1],B=a[g][0]-y[0],x=a[g][1]-y[1],m=m+z/t*(y[0]*A*r+.5*u*(r*B-q*y[0])-u*A*q*B/3),n=n+z/t*(y[1]*A*r+.5*u*(r*x-q*y[1])-u*A*q*x/3),h=h+z}for(g=d+1;g<c&&!(e[g-1]>e[d]+p);g++){r=p-e[g-1]+e[d];q=e[g]-e[g-1];A=e[g]-e[d]<p?1:
r/q;if(1E-6>Math.abs(A))break;u=A*A;t=A*r-.5*u*q;z=A*q/b;y=a[g-1];B=a[g][0]-y[0];x=a[g][1]-y[1];m+=z/t*(y[0]*A*r+.5*u*(r*B-q*y[0])-u*A*q*B/3);n+=z/t*(y[1]*A*r+.5*u*(r*x-q*y[1])-u*A*q*x/3);h+=z}f.push(m/h);f.push(n/h)}f.push(l);f.push(k);for(g=d=0;d<c;d++)a[d][0]=f[g++],a[d][1]=f[g++]}}};b.prototype._computeLineAnchors=function(a,b,c){b=b.paths;var e=this._scale*this._shapedBox.width;c=e/2+c;for(var e=e/2+16,f=this._shapedBox.width*this._scale,d=0;d<b.length;d++){var l=b[d],k=[];k.push(l[0]);for(var p=
1;p<l.length;p++){var m=k[p-1],n=m[0],m=m[1],n=n+l[p][0],m=m+l[p][1];k.push([n,m])}this._smoothVertices(k,f);l=[];l.push(k[0]);for(p=1;p<k.length;p++){var m=k[p-1],h=k[p],n=Math.round(h[0]-m[0]),m=Math.round(h[1]-m[1]);l.push([n,m])}b[d]=l;k=this._getPathLength(l);if(!(k<2*e))for(var p=k/2,g=0,h=l[0][0],r=l[0][1],A=1;A<l.length;A++){var n=l[A][0],m=l[A][1],u=Math.sqrt(n*n+m*m),g=g+u;if(0<=g-p){var t=g-p,z=u-t,y=z/u,B=h+n*y,x=r+m*y;this._outsideTile(B,x)||(g=new q.default(B,x,y,d,A,h,r,u,k,-1),a.push(g));
for(var C=-1,x=0,x=z-c;0<=x;x-=c){var y=x/u,B=h+n*y,D=r+m*y;C++;this._outsideTile(B,D)||(g=new q.default(B,D,y,d,A,h,r,u,k,C),a.push(g))}g=x+c;x=u-t;y=h;B=r;for(D=A-1;0!==D;D--){var E=l[D][0],I=l[D][1],L=Math.sqrt(E*E+I*I);if(g+L>=c){for(var O=g=c-g;O<L;O+=c){var v=O/L,H=y-E*v,G=B-I*v;C++;(g=O+x+e<p)&&!this._outsideTile(H,G)&&(g=new q.default(H,G,1-v,d,D,y-E,B-I,L,k,C),a.push(g))}g=L-(O-c)}else g+=L;x+=L;y-=E;B-=I}C=-1;for(x=z+c;x<=u;x+=c)y=x/u,B=h+n*y,z=r+m*y,C++,this._outsideTile(B,z)||(g=new q.default(B,
z,y,d,A,h,r,u,k,C),a.push(g));y=h+n;B=r+m;g=u-(x-c);x=t;for(D=A+1;D<l.length;D++){n=l[D][0];m=l[D][1];h=Math.sqrt(n*n+m*m);if(g+h>=c){for(r=g=c-g;r<h;r+=c)A=r/h,u=y+n*A,t=B+m*A,C++,(g=r+x+e<p)&&!this._outsideTile(u,t)&&(g=new q.default(u,t,A,d,D,y,B,h,k,C),a.push(g));g=h-(r-c)}else g+=h;x+=h;y+=n;B+=m}break}h+=n;r+=m}}return a};b.prototype._computeAnchors=function(a,b){var c=[];switch(a){case "esriGeometryPoint":return b=b.geometry,a=b.x,b=b.y,a=new q.default(a,b),c.push(a),c;case "esriGeometryPolygon":if(b.centroid)return b=
b.centroid,a=b.x,b=b.y,a=new q.default(a,b),c.push(a),c;H("Non-centroid polygon anchor placement not supported");break;case "esriGeometryPolyline":return this._computeLineAnchors(c,b.geometry,376);default:return H("Unable to handle geometryType: "+a),c}};b.prototype._getPathLength=function(a){for(var b=0,c=1;c<a.length;c++)var e=a[c][0],f=a[c][1],b=b+Math.sqrt(e*e+f*f);return b};b.prototype._computeGlyphTransform=function(a){var b=this._scale,e=this._angle*x.C_DEG_TO_RAD,d=a.width/2,l=a.height/2,
d=this._xAlignD*d*b+(this._xOffset+this._refTemplate.xOffset)+(a.x+d);a=this._yAlignD*l*b-(this._yOffset+this._refTemplate.yOffset)-(a.y+l);l=c.mat2d.identity(I);c.mat2d.translate(l,l,f.vec2.set(D,d,a));c.mat2d.scale(l,l,f.vec2.set(D,b,b));c.mat2d.rotate(l,l,e);return l};b.prototype._writeVertex=function(a,b,c,e,f,d,l,k,p){b=b.get("geometry");l=Math.min(Math.floor(Math.max(this._refTemplate.width,this._refTemplate.height)),255);var m=this._xPlacementD+1,n=this._yPlacementD+1;k=u.i8888to32(k,p,0,0);
this._refSymbolAndPlacementOffset=u.i8888to32(d.angle,l,m,n);b.push(e);b.push(c);b.push(f);b.push(d.vertexOffsetUpperLeft);b.push(d.texFontSizeUpperLeft);b.push(this._refSymbolAndPlacementOffset);b.push(k);b.push(e);b.push(c);b.push(f);b.push(d.vertexOffsetUpperRight);b.push(d.texFontSizeUpperRight);b.push(this._refSymbolAndPlacementOffset);b.push(k);b.push(e);b.push(c);b.push(f);b.push(d.vertexOffsetLowerLeft);b.push(d.texFontSizeLowerLeft);b.push(this._refSymbolAndPlacementOffset);b.push(k);b.push(e);
b.push(c);b.push(f);b.push(d.vertexOffsetLowerRight);b.push(d.texFontSizeLowerRight);b.push(this._refSymbolAndPlacementOffset);b.push(k);a.vertexCount+=4};return b}(A.default);a.default=g})},"esri/views/2d/engine/vectorTiles/GeometryUtils":function(){define(["require","exports"],function(g,a){function d(a,e){a%=e;return 0<=a?a:a+e}Object.defineProperty(a,"__esModule",{value:!0});a.C_INFINITY=Number.POSITIVE_INFINITY;a.C_PI=Math.PI;a.C_2PI=2*a.C_PI;a.C_PI_BY_2=a.C_PI/2;a.C_RAD_TO_256=128/a.C_PI;a.C_256_TO_RAD=
a.C_PI/128;a.C_DEG_TO_256=256/360;a.C_DEG_TO_RAD=a.C_PI/180;a.C_SQRT2=1.414213562;a.C_SQRT2_INV=1/a.C_SQRT2;var h=1/Math.LN2;a.positiveMod=d;a.radToByte=function(b){return d(b*a.C_RAD_TO_256,256)};a.degToByte=function(b){return d(b*a.C_DEG_TO_256,256)};a.log2=function(a){return Math.log(a)*h};a.sqr=function(a){return a*a};a.interpolate=function(a,e,d){return a*(1-d)+e*d};a.between=function(a,e,d){return a>=e&&a<=d||a>=d&&a<=e}})},"esri/views/2d/engine/webgl/TextShaping":function(){define(["require",
"exports","./Rect"],function(g,a,d){Object.defineProperty(a,"__esModule",{value:!0});g=function(){function a(a,e,d,c,l,f,h,g){this._glyphItems=a;this._maxWidth=e;this._lineHeight=d;this._letterSpacing=c;this._offset=l;this._hAnchor=f;this._vAnchor=h;this._justify=g}a.prototype.getShaping=function(a,e){for(var b=this._letterSpacing,c=this._lineHeight,d=this._justify,f=this._maxWidth,h=[],g=0,n=0,p=0,y=0,u=-1,k=0,r=-1,z=a.length,q=0;q<z;q++){var E=a.charCodeAt(q);if(10===E){if(q!==z-1){if(u>=y){var g=
h[u],A=g.x+g.glyphMosaicItem.metrics.advance,k=Math.max(A,k);d&&this._applyJustification(h,y,u);y=h.length}n=e?n-c:n+c;g=0;++p}}else{for(var A=void 0,B=0,C=this._glyphItems;B<C.length&&!(A=C[B][E]);B++);if(A){h.push({codePoint:E,x:g,y:n,glyphMosaicItem:A});g+=A.metrics.advance+b;if(0<f&&g>f&&0<=r){B=r+1;A=h[B].x;k=Math.max(A,k);for(C=B;C<h.length;C++)h[C].y=e?h[C].y-c:h[C].y+c,h[C].x-=A;d&&this._applyJustification(h,y,r);n=e?n-c:n+c;g-=A;++p;y=B;r=-1}++u;32===E&&(r=h.length-1)}}}u>=y&&(g=h[u],k=Math.max(k,
g.x+g.glyphMosaicItem.metrics.advance),d&&this._applyJustification(h,y,u));if(0<h.length)for(a=(d-this._hAnchor)*k,b=(-this._vAnchor*(p+1)+.5)*c,e&&p&&(b+=p*c),a+=this._offset[0],b+=this._offset[1],e=0;e<h.length;e++)c=h[e],c.x+=a,c.y+=b;return h};a.getBox=function(a){if(!a.length)return null;for(var b=Infinity,d=Infinity,c=0,l=0,f=0;f<a.length;f++)var h=a[f],g=h.glyphMosaicItem.metrics,n=g.height,p=h.x,h=h.y-(n-Math.abs(g.top)),g=p+g.width+g.left,n=h+n,b=Math.min(b,p),c=Math.max(c,g),d=Math.min(d,
h),l=Math.max(l,n);return{x:b,y:d,width:c-b,height:l-d}};a.addDecoration=function(a,e){var b=a.length;if(0!==b){for(var c=a[0].x+a[0].glyphMosaicItem.metrics.left,l=a[0].y,f=1;f<b;f++){var h=a[f];if(h.y!==l){var g=a[f-1].x+a[f-1].glyphMosaicItem.metrics.left+a[f-1].glyphMosaicItem.metrics.width;a.push({codePoint:0,x:c,y:l+e-3,glyphMosaicItem:{sdf:!0,rect:new d.default(4,0,4,8),metrics:{width:g-c,height:8,left:0,top:0,advance:0},page:0}});l=h.y;c=h.x+h.glyphMosaicItem.metrics.left}}b=a[b-1].x+a[b-
1].glyphMosaicItem.metrics.left+a[b-1].glyphMosaicItem.metrics.width;a.push({codePoint:0,x:c,y:l+e-3,glyphMosaicItem:{sdf:!0,rect:new d.default(4,0,4,8),metrics:{width:b-c,height:8,left:0,top:0,advance:0},page:0}})}};a.prototype._applyJustification=function(a,e,d){for(var b=a[d],b=(b.x+b.glyphMosaicItem.metrics.advance)*this._justify;e<=d;e++)a[e].x-=b};return a}();a.TextShaping=g})},"esri/views/2d/engine/webgl/collisions/Metric":function(){define("require exports ../../../../../core/Logger ../../../../../core/libs/gl-matrix-2/vec2f32 ../definitions ./BoundingBox ../util/serializationUtils".split(" "),
function(g,a,d,h,b,e,m){Object.defineProperty(a,"__esModule",{value:!0});var c=d.getLogger("esri/views/2d/engine/webgl/collisions/Metric");g=function(){function a(a,b,c,e,d){this.id=a;this.range=b;this.boxes=null;this.minZoom=-1;this.offsetY=this.offsetX=this.directionY=this.directionX=this.size=0;this.anchor=h.vec2f32.fromValues(c,e);this.baseZoom=d}a.prototype.add=function(a){this.bounds?(this.boxes?this.boxes.push(a):(this.boxes=[this.bounds,a],this.bounds=this.bounds.clone()),this.bounds.extend(a)):
this.bounds=a};a.prototype.computeIndex=function(){var a=this.bounds,c=this.anchor[0],e=this.anchor[1],d=Math.floor(c/b.COLLISION_BUCKET_SIZE),l=Math.floor(e/b.COLLISION_BUCKET_SIZE),m=0;if(d>b.COLLISION_TILE_BOX_SIZE||l>b.COLLISION_TILE_BOX_SIZE)l=d=b.COLLISION_TILE_BOX_SIZE,m=1;if(0>d||0>l)l=d=0,m=1;a=2*Math.max(a.halfWidth+Math.abs(a.center[0]),a.halfHeight+Math.abs(a.center[1]));c%=b.COLLISION_BUCKET_SIZE;e%=b.COLLISION_BUCKET_SIZE;this.xBucket=d;this.yBucket=l;this.xOverflow=Math.ceil(Math.abs((a-
c)/b.COLLISION_BUCKET_SIZE))+m;this.yOverflow=Math.ceil(Math.abs((a-e)/b.COLLISION_BUCKET_SIZE))+m};a.prototype.findCollisionDelta=function(a){var c=this.bounds.findCollisionDelta(a.bounds),e=this.boxes&&this.boxes.length,d=a.boxes&&a.boxes.length;return Math.abs(c)>b.COLLISION_MAX_ZOOM_DELTA||!e&&!d?c:e&&d?this._boxesToBoxes(a):e?this._boxesToBox(a):this._boxToBoxes(a)};a.prototype.computeOffset=function(a,e){e||c.error("mapview-labeling","Unable to compute label offset. Expected an evaluator function but found "+
e);var d=this.size;this.hasVV&&(a=e(a),d=isNaN(a)||null==a||Infinity===a?this.size:a);this.offsetX=this.directionX*(d/2+b.COLLISION_PLACEMENT_PADDING);this.offsetY=this.directionY*(d/2+b.COLLISION_PLACEMENT_PADDING)};a.prototype.setVV=function(a,b,c){this.hasVV=!0;this.size=a;this.directionX=b;this.directionY=c};a.prototype.clone=function(){var b=new a(this.id,this.range,this.anchor[0],this.anchor[1],this.baseZoom);b.minZoom=this.minZoom;this.bounds&&(b.bounds=this.bounds.clone());this.boxes&&(b.boxes=
this.boxes.map(function(a){return a.clone()}));b.xBucket=this.xBucket;b.yBucket=this.yBucket;b.xOverflow=this.xOverflow;b.yOverflow=this.yOverflow;b.hasVV=this.hasVV;b.size=this.size;b.directionX=this.directionX;b.directionY=this.directionY;b.offsetX=this.offsetX;b.offsetY=this.offsetY;return b};a.prototype._boxToBoxes=function(a){var b=-Infinity,c=0;for(a=a.boxes;c<a.length;c++)var e=this.bounds.findCollisionDelta(a[c]),b=Math.max(e,b);return b};a.prototype._boxesToBox=function(a){for(var b=this.boxes[0].findCollisionDelta(a.bounds),
c=1;c<this.boxes.length;c++)var e=this.boxes[c].findCollisionDelta(a.bounds),b=Math.max(e,b);return b};a.prototype._boxesToBoxes=function(a){for(var b=-Infinity,c=0;c<this.boxes.length;c++)for(var e=this.boxes[c],d=0,f=a.boxes;d<f.length;d++)var l=e.findCollisionDelta(f[d]),b=Math.max(l,b);return b};a.prototype.serialize=function(a){a.push(this.id);this.bounds.serialize(a);a.push(this.range.from);a.push(this.range.count);a.push(this.anchor[0]);a.push(this.anchor[1]);a.push(this.baseZoom);a.push(this.hasVV?
1:0);a.push(this.size);a.push(this.directionX);a.push(this.directionY);a.push(this.offsetX);a.push(this.offsetY);m.serializeList(a,this.boxes);return a};a.deserialize=function(b){var c=b.readInt32(),d=e.default.deserialize(b),f=b.readInt32(),l=b.readInt32(),h={from:f,count:l},g=b.readInt32(),k=b.readInt32(),r=b.readInt32(),f=b.readInt32(),l=b.readInt32(),z=b.readInt32(),q=b.readInt32(),E=b.readInt32(),A=b.readInt32();b=m.deserializeList(b,e.default);c=new a(c,h,g,k,r);c.bounds=d;c.boxes=b;c.computeIndex();
f&&c.setVV(l,z,q);c.offsetX=E;c.offsetY=A;return c};return a}();a.default=g})},"esri/views/2d/engine/webgl/collisions/BoundingBox":function(){define(["require","exports","../../../../../core/mathUtils","../../../../../core/libs/gl-matrix-2/vec2f32"],function(g,a,d,h){Object.defineProperty(a,"__esModule",{value:!0});g=function(){function a(a,b,c,d){this.center=h.vec2f32.fromValues(a,b);this.centerT=h.vec2f32.create();this.halfWidth=c/2;this.halfHeight=d/2;this.width=c;this.height=d}Object.defineProperty(a.prototype,
"x",{get:function(){return this.center[0]},set:function(a){this.center[0]=a},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"y",{get:function(){return this.center[1]},set:function(a){this.center[1]=a},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"blX",{get:function(){return this.center[0]-this.halfWidth},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"blY",{get:function(){return this.center[1]-this.halfHeight},enumerable:!0,configurable:!0});
Object.defineProperty(a.prototype,"trX",{get:function(){return this.center[0]+this.halfWidth},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"trY",{get:function(){return this.center[1]+this.halfHeight},enumerable:!0,configurable:!0});a.prototype.clone=function(){return new a(this.x,this.y,this.width,this.height)};a.prototype.serialize=function(a){a.writeF32(this.center[0]);a.writeF32(this.center[1]);a.push(this.width);a.push(this.height);return a};a.prototype.findCollisionDelta=
function(a){return d.log2(Math.min((a.halfWidth+this.halfWidth)/Math.abs(a.centerT[0]-this.centerT[0]),(a.halfHeight+this.halfHeight)/Math.abs(a.centerT[1]-this.centerT[1])))};a.prototype.extend=function(a){var b=Math.min(this.blX,a.blX),c=Math.min(this.blY,a.blY),e=Math.max(this.trY,a.trY);this.width=Math.max(this.trX,a.trX)-b;this.height=e-c;this.halfWidth=this.width/2;this.halfHeight=this.height/2;this.x=b+this.halfWidth;this.y=c+this.halfHeight};a.deserialize=function(b){var e=b.readF32(),c=b.readF32(),
d=b.readInt32();b=b.readInt32();return new a(e,c,d,b)};return a}();a.default=g})},"esri/views/2d/engine/webgl/util/serializationUtils":function(){define(["require","exports"],function(g,a){Object.defineProperty(a,"__esModule",{value:!0});a.serializeList=function(a,h){if(null===h)a.push(0);else{a.push(h.length);for(var b=0;b<h.length;b++)h[b].serialize(a);return a}};a.deserializeList=function(a,h,b){for(var e=a.readInt32(),e=Array(e),d=0;d<e.length;d++)e[d]=h.deserialize(a,b);return e}})},"esri/views/2d/engine/webgl/mesh/templates/GlyphGroup":function(){define("require exports ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/mathUtils ../../../../../../core/libs/gl-matrix-2/mat2d ../../../../../../core/libs/gl-matrix-2/mat2df32 ../../definitions ../../materialKey/MaterialKey ./ComputedGlyph ./util".split(" "),
function(g,a,d,h,b,e,m,c,l,f,t){Object.defineProperty(a,"__esModule",{value:!0});var x=h.getLogger("esri.views.2d.engine.webgl.GlyphGroup");g=function(){function a(a,b,c,e,d,f,l,h,m,n){void 0===c&&(c=0);void 0===e&&(e=-1);void 0===d&&(d=-1);void 0===f&&(f=-1);void 0===l&&(l=-1);void 0===h&&(h=-1);void 0===m&&(m=0);void 0===n&&(n=-1);this.x=a;this.y=b;this.t=c;this.i=e;this.j=d;this.segmentPosX=f;this.segmentPosY=l;this.segmentLen=h;this.pathLen=m;this.order=n;this._glyphs=new Map;this.minZoom=0}Object.defineProperty(a.prototype,
"glyphs",{get:function(){return this._glyphs},enumerable:!0,configurable:!0});a.prototype.add=function(a,b){var c=this._glyphs.get(b);c?c.push(a):this._glyphs.set(b,[a])};a.prototype.clear=function(){this._glyphs.clear()};a.prototype.place=function(a,b,c,e,h,m,n,g,A,t,C){var k=a.x,p=a.y,r=a.codePoint,q=a.glyphMosaicItem;h=l.MaterialKeyBase.load(h);h.textureBinding=a.glyphMosaicItem.textureBinding;switch(b){case "esriGeometryPoint":case "esriGeometryPolygon":a=f.default.from(k,p,this.x,this.y,-1,t,
C,q,r,h.data,e,m,n);this.add(a,0);break;case "esriGeometryPolyline":b=c.geometry;this._placeGlyphAlongLine(a,h.data,b,e,g,m,n,A,t,C,-1);this._placeGlyphAlongLine(a,h.data,b,e,g,m,n,A,t,C,1);break;case "esriGeometryMultipoint":case "esriGeometryEnvelope":a=void 0,void 0===a&&(a="mapview-labeling"),x.error(new d(a,"Cannot place for unsupported geometryType: "+b))}};a.prototype._findLabelTheta=function(a,b,c,e){b*=e;a=Math.acos((0*b+-1*e*-a)/(1*c));0<b&&(a=2*Math.PI-a);return a};a.prototype._placeGlyphAlongLine=
function(a,d,l,k,h,n,g,x,A,B,C){l=l.paths[this.i];var p=l[this.j],r=p[0],q=p[1],p=a.x,u=a.y,z=a.glyphMosaicItem,y=a.codePoint,E=a.glyphMosaicItem.metrics,E=(a.x+E.left+E.width/2)*n/24;a=C*b.sign(E)||1;var E=Math.abs(E),K=t.len(r,q),Q=this._findLabelTheta(r,q,K,C),P=(a+1)/2,K=-a*(-1*P+this.t)*K,N=e.mat2d.rotate(m.mat2df32.create(),k,-Q),J=48<h.height;h=0===K?B:Math.max(Math.max(x+b.log2(Math.abs(E/K)),0),A);J&&(h=A);B=f.default.from(p,u,this.x,this.y,Q,h,B,z,y,d,N,n,g,J||h<=x&&B>=x&&1===C);this.add(B,
this.j);if(!J)for(B=this.segmentPosX+P*r,r=this.segmentPosY+P*q,N=h,q=this.j+a;0<q&&q<l.length;q+=a){var R=B,Y=r,P=l[q];h=P[0];var P=P[1],W=t.len(h,P),J=this._findLabelTheta(h,P,W,C),J=e.mat2d.rotate(m.mat2df32.create(),k,-J),R=R+-a*h/W*K,Y=Y+-a*P/W*K,K=K+W,W=N-.1,N=0===K?W:Math.max(Math.max(x+b.log2(Math.abs(E/K)),0),A),J=f.default.from(p,u,R,Y,Q,N,W,z,y,d,J,n,g,N<=x&&W>=x&&1===C);this.add(J,q);if(N<x-c.COLLISION_MAX_ZOOM_DELTA){this.minZoom=Math.max(N,this.minZoom);break}B+=a*h;r+=a*P}};return a}();
a.default=g})},"esri/views/2d/engine/webgl/mesh/templates/ComputedGlyph":function(){define("require exports ../../../../../../core/libs/gl-matrix-2/vec2 ../../../../../../core/libs/gl-matrix-2/vec2f32 ../../definitions ../../number ../../collisions/BoundingBox".split(" "),function(g,a,d,h,b,e,m){Object.defineProperty(a,"__esModule",{value:!0});var c=h.vec2f32.create();g=function(){function a(a,b,c,e,d,l,h,k,m,g,q,E,A,B,C){this.anchorX=a;this.anchorY=b;this.angle=c;this.bounds=e;this.minZoom=d;this.maxZoom=
l;this.materialKey=h;this.vertexOffsetUpperLeft=k;this.vertexOffsetUpperRight=m;this.vertexOffsetLowerLeft=g;this.vertexOffsetLowerRight=q;this.texFontSizeUpperLeft=E;this.texFontSizeUpperRight=A;this.texFontSizeLowerLeft=B;this.texFontSizeLowerRight=C}a.from=function(f,l,h,n,p,g,u,k,r,z,q,E,A,B,C){void 0===B&&(B=!1);void 0===C&&(C=!1);var y=k.rect,t=k.metrics;p=-1===p?255:Math.floor(180*p/Math.PI/360*254);var x=Math.round(y.x/4),H=Math.round(y.y/4);k=x+Math.round(y.width/4);var G=H+Math.round(y.height/
4),M=-24-t.top,O=t.left,K=-t.top,Q=y.width,y=y.height;r||(C||(M=0),O=4,Q=t.width);f+=O;r=C?l+K:l+M;Q=f+Q;M=r;l=f;K=r+y;y=Q;C=K;var O=l+t.width,P=K-t.height,N=t.width*E/24,t=t.height*E/24;q&&(d.vec2.transformMat2d(c,d.vec2.set(c,f,r),q),f=c[0],r=c[1],d.vec2.transformMat2d(c,d.vec2.set(c,Q,M),q),Q=c[0],M=c[1],d.vec2.transformMat2d(c,d.vec2.set(c,l,K),q),l=c[0],K=c[1],d.vec2.transformMat2d(c,d.vec2.set(c,y,C),q),y=c[0],C=c[1],d.vec2.transformMat2d(c,d.vec2.set(c,O,P),q),O=c[0],P=c[1]);q=B?new m.default(O,
P,N+b.COLLISION_BOX_PADDING,t+b.COLLISION_BOX_PADDING):null;B=e.i1616to32(8*f,8*r);t=e.i1616to32(8*Q,8*M);f=e.i1616to32(8*l,8*K);l=e.i1616to32(8*y,8*C);y=e.i8888to32(x,H,E,A);H=e.i8888to32(k,H,E,A);x=e.i8888to32(x,G,E,A);E=e.i8888to32(k,G,E,A);return new a(h|0,n|0,p,q,g,u,z,B,t,f,l,y,H,x,E)};return a}();a.default=g})},"esri/views/2d/engine/webgl/mesh/templates/util":function(){define(["require","exports"],function(g,a){function d(a,b){return Math.sqrt(a*a+b*b)}Object.defineProperty(a,"__esModule",
{value:!0});a.sub=function(a,b,e){a[0]=b[0]-e[0];a[1]=b[1]-e[1];return a};a.len=d;a.normalize=function(a){var b=d(a[0],a[1]);a[0]/=b;a[1]/=b};a.dist=function(a,b){return d(a[0]-b[0],a[1]-b[1])};a.isFunction=function(a){return"function"===typeof a};a.getLimitCosine=function(a){return 1/Math.max(a,1)}})},"esri/views/2d/engine/webgl/mesh/templates/WGLTextTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/screenUtils ../../alignmentUtils ../../color ../../fontUtils ../../materialKey/MaterialKey ./WGLBaseTextTemplate ./WGLMeshTemplate ../../util/BidiText".split(" "),
function(g,a,d,h,b,e,m,c,l,f,t){Object.defineProperty(a,"__esModule",{value:!0});g=function(a){function f(e,d,f,l,n,g,q,t,A,B,x,D,I){var k=a.call(this)||this;k._xOffset=h.pt2px(x);k._yOffset=h.pt2px(D);k._decorationTop=m.getFontDecorationTop(t);k._color=l;k._haloColor=n;k._haloSize=Math.min(Math.floor(5*h.pt2px(h.toPt(f))),127);k._size=Math.min(Math.round(h.pt2px(d)),127);d=Math.min(Math.round(h.pt2px(d)),127);k._referenceSize=Math.round(Math.sqrt(256*d));k._scale=k._size/24;k._angle=B;k._justify=
b.getJustification(g||"center");k._xAlignD=b.getXAnchorDirection(g||"center");k._yAlignD=-b.getYAnchorDirection(q||"baseline");k._baseline="baseline"===(q||"baseline");k._bitset=A?1:0;e=c.MaterialKeyBase.load(c.createMaterialKey(k.geometryType,e,!1));e.sdf=!0;k._materialKey=e.data;k.symbolId=I;return k}d(f,a);f.fromText=function(a,b,c){a=new f(a,b.font.size,b.haloSize||0,b.color&&e.premultiplyAlphaRGBA(b.color)||0,b.haloColor&&e.premultiplyAlphaRGBA(b.haloColor)||0,b.horizontalAlignment,b.verticalAlignment,
b.font.decoration,!1,b.angle||0,b.xoffset,b.yoffset,b.id);b=t.bidiText(b.text);a.bindTextInfo(c,b[0],b[1]);a._computeGlyphs(a._shapedGlyphs,a._shapedBox);return a};f.fromCIMText=function(a,b,c,d){a=new f(a,b.size*b.sizeRatio*c,b.outlineSize*b.sizeRatio,e.premultiplyAlphaRGBA(b.color),e.premultiplyAlphaRGBA(b.outlineColor),b.horizontalAlignment,b.verticalAlignment,b.decoration,b.colorLocked,b.angle,b.offsetX*b.sizeRatio*c,b.offsetY*b.sizeRatio*c,b.materialHash);b=t.bidiText(b.text);a.bindTextInfo(d,
b[0],b[1]);a._computeGlyphs(a._shapedGlyphs,a._shapedBox);return a};return f}(l.default(f.default));a.default=g})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseTextTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/libs/gl-matrix-2/mat2d ../../../../../../core/libs/gl-matrix-2/mat2df32 ../../../../../../core/libs/gl-matrix-2/vec2 ../../../../../../core/libs/gl-matrix-2/vec2f32 ../../definitions ../../enums ../../number ../../TextShapingNew ../../WGLDisplayRecord ../../collisions/BoundingBox ../../materialKey/MaterialKey ./ComputedGlyph".split(" "),
function(g,a,d,h,b,e,m,c,l,f,t,x,n,p,y,u,k){Object.defineProperty(a,"__esModule",{value:!0});var r=b.getLogger("esri.views.2d.engine.webgl.WGLTextTemplate"),z=Math.PI/180,q=m.mat2df32.create(),E=l.vec2f32.create();a.default=function(a){return function(a){function b(){for(var b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];b=a.apply(this,b)||this;b.geometryType=t.WGLGeometryType.TEXT;return b}d(b,a);b.prototype.bindTextInfo=function(a,b,c){a=this._computeShaping(a,this._justify).getShaping(b,c);
isNaN(this._decorationTop)||n.TextShaping.addDecoration(a,this._decorationTop);this._shapedGlyphs=a;this._shapedBox=n.TextShaping.getBox(a)};b.prototype.writeMesh=function(a,b,c,e,d){var f=this._computedGlyphs;if(f){var l=x.i8888to32(0,0,this._referenceSize,this._bitset);switch(c){case "esriGeometryPoint":d=d.geometry;c=d.x;d=d.y;for(var k=0;k<f.length;k++){var m=f[k];m.anchorX=c;m.anchorY=d}this._writeVertices(a,b,e,f,l,0,0);break;case "esriGeometryPolygon":if(d.centroid){d=d.centroid;c=d.x;d=d.y;
for(k=0;k<f.length;k++)m=f[k],m.anchorX=c,m.anchorY=d;this._writeVertices(a,b,e,f,l,0,0);break}case "esriGeometryMultipoint":for(var k=d.geometry.points,n=d=c=0;n<k.length;n++){m=k[n];c+=m[0];d+=m[1];for(var p=0,g=f;p<g.length;p++)m=g[p],m.anchorX=c,m.anchorY=d;this._writeVertices(a,b,e,f,l,0,0)}break;default:a=void 0,void 0===a&&(a="mapview-processing"),r.error(new h(a,"Unable to handle geometryType: "+c))}}};b.prototype._computeGlyphs=function(a,b){if(a&&0!==a.length){var c=Array(a.length);b=this._computeGlyphTransform(b);
for(var e=u.MaterialKeyBase.load(this._materialKey),d=0;d<a.length;d++){var f=a[d],l=f.x,m=f.y,h=f.codePoint,f=f.glyphMosaicItem;e.textureBinding=f.textureBinding;c[d]=k.default.from(l,m,0,0,-1,0,25,f,h,e.data,b,this._size,this._haloSize,!1,!0)}this._computedGlyphs=c}};b.prototype._createBounds=function(a,b){var e=a.width/2,d=a.height/2,k=b[4],m=b[5],h;if(this._angle){a=l.vec2f32.fromValues(-e,-d);h=l.vec2f32.fromValues(e,-d);var n=l.vec2f32.fromValues(-e,d),p=l.vec2f32.fromValues(e,d);c.vec2.transformMat2d(a,
a,b);c.vec2.transformMat2d(h,h,b);c.vec2.transformMat2d(n,n,b);c.vec2.transformMat2d(p,p,b);b=d=Infinity;var g=0,r=e=0;for(a=[a,h,n,p];r<a.length;r++)h=a[r],d=Math.min(h[0],d),g=Math.max(h[0],g),b=Math.min(h[1],b),e=Math.max(h[1],e);h=g-d;a=e-b}else h=a.width*this._scale,a=a.height*this._scale;return new y.default(k,m,h+f.COLLISION_BOX_PADDING,a+f.COLLISION_BOX_PADDING)};b.prototype._computeShaping=function(a,b){return new n.TextShaping([a],512,f.TEXT_LINE_HEIGHT,f.TEXT_SPACING,[0,.5*-f.TEXT_LINE_HEIGHT],
.5*(1-this._xAlignD),0,b)};b.prototype._computeGlyphTransform=function(a){var b=this._scale,d=this._angle*z,f=e.mat2d.identity(q);e.mat2d.rotate(f,f,d);e.mat2d.translate(f,f,c.vec2.set(E,this._xOffset,-this._yOffset));e.mat2d.scale(f,f,c.vec2.set(E,b,b));e.mat2d.translate(f,f,c.vec2.set(E,-4,-4-(this._baseline?25:a.y+(1-this._yAlignD)*a.height*.5)));return f};b.prototype._writeVertices=function(a,b,c,e,d,f,l){this._writeHalos(a,b,c,e,d,f,l);this._writeText(a,b,c,e,d,f,l)};b.prototype._writeHalos=
function(a,b,c,e,d,f,l){var k=b.indexVector,h=b.getVector("geometry").vertexCount,m=0;if(this._haloSize)for(var n=0;n<e.length;n++,m+=4){var g=e[n],r=x.i1616to32(2*g.anchorX+1,2*g.anchorY),q=null==f?Math.floor(10*g.minZoom):f,A=null==l?Math.floor(10*g.maxZoom):l,u=new p(c,this.geometryType,g.materialKey,q,A);u.vertexFrom=h+m;u.indexFrom=k.length;this._writeVertex(u,b,c,r,this._haloColor,g,d,q,A);this._writeIndices(u,k,h+m);a.push(u)}};b.prototype._writeText=function(a,b,c,e,d,f,l){for(var k=b.indexVector,
h=b.getVector("geometry").vertexCount,m=0,n=0;n<e.length;n++,m+=4){var g=e[n],r=x.i1616to32(2*g.anchorX,2*g.anchorY),q=null==f?Math.floor(10*g.minZoom):f,A=null==l?Math.floor(10*g.maxZoom):l,u=new p(c,this.geometryType,g.materialKey,q,A);u.vertexFrom=h+m;u.indexFrom=k.length;this._writeVertex(u,b,c,r,this._color,g,d,q,A);this._writeIndices(u,k,h+m);a.push(u)}};b.prototype._writeVertex=function(a,b,c,e,d,f,l,k,h){b=b.get("geometry");b.push(e);b.push(c);b.push(d);b.push(f.vertexOffsetUpperLeft);b.push(f.texFontSizeUpperLeft);
b.push(l);b.push(e);b.push(c);b.push(d);b.push(f.vertexOffsetUpperRight);b.push(f.texFontSizeUpperRight);b.push(l);b.push(e);b.push(c);b.push(d);b.push(f.vertexOffsetLowerLeft);b.push(f.texFontSizeLowerLeft);b.push(l);b.push(e);b.push(c);b.push(d);b.push(f.vertexOffsetLowerRight);b.push(f.texFontSizeLowerRight);b.push(l);a.vertexCount+=4};b.prototype._writeIndices=function(a,b,c){b.push(c+0);b.push(c+1);b.push(c+2);b.push(c+1);b.push(c+3);b.push(c+2);a.indexCount+=6};return b}(a)}})},"esri/views/2d/engine/webgl/TextShapingNew":function(){define(["require",
"exports","./Rect"],function(g,a,d){Object.defineProperty(a,"__esModule",{value:!0});g=function(){function a(a,e,d,c,l,f,h,g){this._glyphItems=a;this._maxWidth=e;this._lineHeight=d;this._letterSpacing=c;this._offset=l;this._hAnchor=f;this._vAnchor=h;this._justify=g}a.prototype.getShaping=function(a,e){for(var b=this._letterSpacing,c=this._lineHeight,d=this._justify,f=this._maxWidth,h=[],g=0,n=0,p=0,y=0,u=-1,k=0,r=-1,z=a.length,q=0;q<z;q++){var E=a.charCodeAt(q);if(10===E){if(q!==z-1){if(u>=y){var g=
h[u],A=g.x+g.glyphMosaicItem.metrics.advance,k=Math.max(A,k);d&&this._applyJustification(h,y,u);y=h.length}n=e?n-c:n+c;g=0;++p}}else{for(var A=void 0,B=0,C=this._glyphItems;B<C.length&&!(A=C[B][E]);B++);if(A){h.push({codePoint:E,x:g,y:n,glyphMosaicItem:A});g+=A.metrics.advance+b;if(0<f&&g>f&&0<=r){B=r+1;A=h[B].x;k=Math.max(A,k);for(C=B;C<h.length;C++)h[C].y=e?h[C].y-c:h[C].y+c,h[C].x-=A;d&&this._applyJustification(h,y,r);n=e?n-c:n+c;g-=A;++p;y=B;r=-1}++u;32===E&&(r=h.length-1)}}}u>=y&&(g=h[u],k=Math.max(k,
g.x+g.glyphMosaicItem.metrics.advance),d&&this._applyJustification(h,y,u));if(0<h.length)for(a=(d-this._hAnchor)*k,b=(-this._vAnchor*(p+1)+.5)*c,e&&p&&(b+=p*c),a+=this._offset[0],b+=this._offset[1],e=0;e<h.length;e++)c=h[e],c.x+=a,c.y+=b;return h};a.prototype.getEstimatedShaping=function(a,e,d){for(var b=this._letterSpacing,l=this._lineHeight,f=this._justify,h=this._maxWidth,m=[],n=0,p=0,g=0,u=0,k=-1,r=0,z=-1,q=a.length,E=0;E<q;E++){var A=a.charCodeAt(E);if(10===A){if(E!==q-1){if(k>=u){var n=m[k],
B=n.x+n.glyphMosaicItem.metrics.advance,r=Math.max(B,r);f&&this._applyJustification(m,u,k);u=m.length}p=e?p-l:p+l;n=0;++g}}else{B=d;m.push({codePoint:A,x:n,y:p,glyphMosaicItem:B});n+=B.metrics.advance+b;if(0<h&&n>h&&0<=z){for(var C=z+1,B=m[C].x,r=Math.max(B,r),D=C;D<m.length;D++)m[D].y=e?m[D].y-l:m[D].y+l,m[D].x-=B;f&&this._applyJustification(m,u,z);p=e?p-l:p+l;n-=B;++g;u=C;z=-1}++k;32===A&&(z=m.length-1)}}k>=u&&(n=m[k],r=Math.max(r,n.x+n.glyphMosaicItem.metrics.advance),f&&this._applyJustification(m,
u,k));if(0<m.length)for(a=(f-this._hAnchor)*r,d=(-this._vAnchor*(g+1)+.5)*l,e&&g&&(d+=g*l),a+=this._offset[0],d+=this._offset[1],e=0;e<m.length;e++)l=m[e],l.x+=a,l.y+=d;return m};a.getBox=function(a){if(!a.length)return null;for(var b=Infinity,d=Infinity,c=-Infinity,l=-Infinity,f=0;f<a.length;f++)var h=a[f],g=h.glyphMosaicItem.metrics,n=h.x+g.left,h=h.y-g.top,p=n+g.width,g=h+g.height,b=Math.min(b,n),c=Math.max(c,p),d=Math.min(d,h),l=Math.max(l,g);return{x:b,y:d,width:c-b,height:l-d}};a.addDecoration=
function(a,e){var b=a.length;if(0!==b){for(var c=a[0].x+a[0].glyphMosaicItem.metrics.left,l=a[0].y,f=1;f<b;f++){var h=a[f];if(h.y!==l){var g=a[f-1].x+a[f-1].glyphMosaicItem.metrics.left+a[f-1].glyphMosaicItem.metrics.width;a.push({codePoint:0,x:c,y:l,glyphMosaicItem:{sdf:!0,rect:new d.default(4,0,4,8),metrics:{width:g-c,height:2,left:0,top:e,advance:0},page:0}});l=h.y;c=h.x+h.glyphMosaicItem.metrics.left}}b=a[b-1].x+a[b-1].glyphMosaicItem.metrics.left+a[b-1].glyphMosaicItem.metrics.width;a.push({codePoint:0,
x:c,y:l,glyphMosaicItem:{sdf:!0,rect:new d.default(4,0,4,8),metrics:{width:b-c,height:2,left:0,top:e,advance:0},page:0}})}};a.prototype._applyJustification=function(a,e,d){for(var b=a[d],b=(b.x+b.glyphMosaicItem.metrics.advance)*this._justify;e<=d;e++)a[e].x-=b};return a}();a.TextShaping=g})},"esri/views/2d/engine/webgl/WGLDisplayRecord":function(){define(["require","exports","./MeshData","./Utils"],function(g,a,d,h){return function(){function a(a,b,c,d,f){void 0===d&&(d=0);void 0===f&&(f=0);this.id=
a;this.geometryType=b;this.materialKey=c;this.minZoom=d;this.maxZoom=f;this.meshData=null;this.indexCount=this.indexFrom=this.vertexCount=this.vertexFrom=this.zOrder=this.symbolLevel=0}Object.defineProperty(a.prototype,"sortKey",{get:function(){void 0===this._sortKey&&this._computeSortKey();return this._sortKey},enumerable:!0,configurable:!0});a.prototype.clone=function(){return this.copy()};a.prototype.copy=function(){var b=new a(this.id,this.geometryType,this.materialKey);b.vertexFrom=this.vertexFrom;
b.vertexCount=this.vertexCount;b.indexFrom=this.indexFrom;b.indexCount=this.indexCount;b.zOrder=this.zOrder;b.symbolLevel=this.symbolLevel;b.meshData=this.meshData;b.minZoom=this.minZoom;b.maxZoom=this.maxZoom;return b};a.prototype.setMeshDataFromBuffers=function(a,b,c){var e=new d,f;for(f in b){for(var m=b[f].stride,g=b[f].data,n=[],p=h.strideToPackingFactor(m),y=0;y<m*a.vertexCount/p;++y)n[y]=g[y+m*a.vertexFrom/p];e.vertexData.set(f,n)}for(y=e.indexData.length=0;y<a.indexCount;++y)e.indexData[y]=
c[y+a.indexFrom]-a.vertexFrom;e.vertexCount=a.vertexCount;this.meshData=e};a.prototype.readMeshDataFromBuffers=function(a,b){this.meshData?this.meshData.clear():this.meshData=new d;for(var c in a){for(var e=a[c].stride,f=a[c].data,m=[],g=h.strideToPackingFactor(e),n=0;n<e*this.vertexCount/g;++n)m[n]=f[n+e*this.vertexFrom/g];this.meshData.vertexData.set(c,m)}for(n=this.meshData.indexData.length=0;n<this.indexCount;++n)this.meshData.indexData[n]=b[n+this.indexFrom]-this.vertexFrom;this.meshData.vertexCount=
this.vertexCount};a.prototype.writeMeshDataToBuffers=function(a,b,c,d){for(var e in b)for(var l=b[e].stride,m=this.meshData.vertexData.get(e),n=b[e].data,p=h.strideToPackingFactor(l),g=0;g<l*this.meshData.vertexCount/p;++g)n[g+l*a/p]=m[g];for(g=0;g<this.meshData.indexData.length;++g)d[g+c]=this.meshData.indexData[g]+a;this.vertexFrom=a;this.vertexCount=this.meshData.vertexCount;this.indexFrom=c;this.indexCount=this.meshData.indexData.length};a.writeAllMeshDataToBuffers=function(a,b,c){for(var e=0,
d=0,h=0;h<a.length;h++){var m=a[h];m.writeMeshDataToBuffers(e,b,d,c);e+=m.vertexCount;d+=m.indexCount}};a.prototype._computeSortKey=function(){this._sortKey=(this.symbolLevel&31)<<12|(this.zOrder&127)<<4|this.geometryType&7};a.prototype.serialize=function(a){a.push(this.geometryType);a.push(this.materialKey);a.push(this.symbolLevel);a.push(this.zOrder);a.push(this.vertexFrom);a.push(this.vertexCount);a.push(this.indexFrom);a.push(this.indexCount);a.push(this.minZoom);a.push(this.maxZoom);return a};
a.deserialize=function(b,d){var c=b.readInt32(),e=b.readInt32();d=new a(d.id,c,e);d.symbolLevel=b.readInt32();d.zOrder=b.readInt32();d.vertexFrom=b.readInt32();d.vertexCount=b.readInt32();d.indexFrom=b.readInt32();d.indexCount=b.readInt32();d.minZoom=b.readInt32();d.maxZoom=b.readInt32();return d};return a}()})},"esri/views/2d/engine/webgl/MeshData":function(){define(["require","exports"],function(g,a){return function(){function a(){this.vertexData=new Map;this.vertexCount=0;this.indexData=[]}a.prototype.clear=
function(){this.vertexData.clear();this.vertexCount=0;this.indexData=[]};a.prototype.update=function(a,b,e){for(var d in a)this.vertexData.set(d,a[d]);for(d in this.vertexData)null===a[d]&&this.vertexData.delete(d);this.vertexCount=b;this.indexData=e};return a}()})},"esri/views/2d/engine/webgl/mesh/templates/WGLMeshTemplate":function(){define(["require","exports","../../../../../../core/tsSupport/extendsHelper"],function(g,a,d){Object.defineProperty(a,"__esModule",{value:!0});g=function(){function a(){}
a.prototype.writeMesh=function(a,e,d,c,l){};a.prototype.bindFeature=function(a,e,d){};return a}();a.default=g})},"esri/views/2d/engine/webgl/util/BidiText":function(){define(["require","exports","dojox/string/BidiEngine"],function(g,a,d){Object.defineProperty(a,"__esModule",{value:!0});var h=new d;a.bidiText=function(a){if(!h.hasBidiChar(a))return[a,!1];var b;b="rtl"===h.checkContextual(a)?"IDNNN":"ICNNN";return[h.bidiTransform(a,b,"VLYSN"),!0]}})},"dojox/string/BidiEngine":function(){define(["dojo/_base/lang",
"dojo/_base/declare","dojo/Stateful"],function(g,a,d){function h(a,d,f,l,k){var m=a;void 0===d&&(d=k.defInFormat);void 0===f&&(f=k.defOutFormat);void 0===l&&(l=k.defSwap);if(d!==f){var n,g=d.substring(0,1);n=d.substring(1,4);var p=f.substring(0,1),r=f.substring(1,4);"C"===n.charAt(0)&&(n=b(m),n="ltr"===n||"rtl"===n?n.toUpperCase():"L"===d.charAt(2)?"LTR":"RTL",d=g+n);"C"===r.charAt(0)&&(n=b(m),"rtl"===n?r="RTL":"ltr"===n?(m=m.split(""),m.reverse(),n=b(m.join("")),r=n.toUpperCase()):r="L"===f.charAt(2)?
"LTR":"RTL",f=p+r)}if(d===f)return a;p=d.substring(0,1);m=d.substring(1,4);g=f.substring(0,1);r=f.substring(1,4);k.inFormat=d;k.outFormat=f;k.swap=l;if("L"===p&&"VLTR"===f){if("LTR"===m)return k.dir=C,e(a,k);if("RTL"===m)return k.dir=D,e(a,k)}if("V"===p&&"V"===g)return k.dir="RTL"===m?D:C,c(a,k);if("L"===p&&"VRTL"===f)return k.dir="LTR"===m?C:D,a=e(a,k),c(a);if("VLTR"===d&&"LLTR"===f)return k.dir=C,e(a,k);if("V"===p&&"L"===g&&m!==r)return a=c(a),"RTL"===m?h(a,"LLTR","VLTR",l,k):h(a,"LRTL","VRTL",
l,k);if("VRTL"===d&&"LRTL"===f)return h(a,"LRTL","VRTL",l,k);if("L"===p&&"L"===g)return d=k.swap,k.swap=d.substr(0,1)+"N","RTL"===m?(k.dir=D,a=e(a,k),k.swap="N"+d.substr(1,2),k.dir=C,a=e(a,k)):(k.dir=C,a=e(a,k),k.swap="N"+d.substr(1,2),a=h(a,"VLTR","LRTL",k.swap,k)),a}function b(a){return(a=/[A-Za-z\u05d0-\u065f\u066a-\u06ef\u06fa-\u07ff\ufb1d-\ufdff\ufe70-\ufefc]/.exec(a))?"z">=a[0]?"ltr":"rtl":""}function e(a,b){a=a.split("");var c=[];m(a,c,b);if(0!==b.hiLevel&&b.swap.substr(0,1)!==b.swap.substr(1,
2))for(var e=0;e<a.length;e++)if(1===c[e]){var d=e,f;b:{f=a[e];for(var k=void 0,l=0,h=H.length-1;l<=h;)if(k=Math.floor((l+h)/2),f<H[k][0])h=k-1;else if(f>H[k][0])l=k+1;else{f=H[k][1];break b}}a[d]=f}t(2,a,c,b);t(1,a,c,b);q=c;return a.join("")}function m(a,b,c){var e=a.length,d=c.dir?aa:Z,f=null,k=null,l=null,f=0,k=k=null,h=-1,m=k=null,n=[],g=[];c.hiLevel=c.dir;c.lastArabic=!1;c.hasUbatAl=!1;c.hasUbatB=!1;c.hasUbatS=!1;for(k=0;k<e;k++){var m=k,l=a[k].charCodeAt(0),p=sa[l>>8];n[m]=p<ka?p:ta[p-ka][l&
255]}for(m=0;m<e;m++){g[m]=k=x(a,n,g,m,c);f=d[f][k];k=f&240;f&=15;b[m]=l=d[f][A];if(0<k){if(16===k)for(k=h;k<m;k++)b[k]=1;h=-1}if(k=d[f][B])-1===h&&(h=m);else if(-1<h){for(k=h;k<m;k++)b[k]=l;h=-1}n[m]===ea&&(b[m]=0);c.hiLevel|=l}if(c.hasUbatS)for(a=0;a<e;a++)if(n[a]===fa)for(b[a]=c.dir,d=a-1;0<=d;d--)if(n[d]===ja)b[d]=c.dir;else break}function c(a,b){a=a.split("");if(b){var c=[];m(a,c,b);q=c}a.reverse();r.reverse();return a.join("")}function l(a){for(var b=0;b<W.length;b++)if(a>=W[b]&&a<=X[b])return!0;
return!1}function f(a,b,c,e){for(;b*c<e&&p(a[b]);)b+=c;return b*c<e&&l(a[b])?!0:!1}function t(a,b,c,e){if(!(e.hiLevel<a))if(1!==a||e.dir!==D||e.hasUbatB){e=b.length;for(var d=0,f,k,l;d<e;){if(c[d]>=a){for(f=d+1;f<e&&c[f]>=a;)f++;for(k=f-1;d<k;d++,k--)l=b[d],b[d]=b[k],b[k]=l,l=r[d],r[d]=r[k],r[k]=l;d=f}d++}}else b.reverse(),r.reverse()}function x(a,b,c,e,d){return{UBAT_L:function(){d.lastArabic=!1;return V},UBAT_R:function(){d.lastArabic=!1;return ca},UBAT_ON:function(){return S},UBAT_AN:function(){return ba},
UBAT_EN:function(){return d.lastArabic?ba:da},UBAT_AL:function(){d.lastArabic=!0;d.hasUbatAl=!0;return ca},UBAT_WS:function(){return S},UBAT_CS:function(){var a,f;if(1>e||e+1>=b.length||(a=c[e-1])!==da&&a!==ba||(f=b[e+1])!==da&&f!==ba)return S;d.lastArabic&&(f=ba);return f===a?f:S},UBAT_ES:function(){return(0<e?c[e-1]:ea)===da&&e+1<b.length&&b[e+1]===da?da:S},UBAT_ET:function(){if(0<e&&c[e-1]===da)return da;if(d.lastArabic)return S;for(var a=e+1,f=b.length;a<f&&b[a]===na;)a++;return a<f&&b[a]===da?
da:S},UBAT_NSM:function(){if("VLTR"===d.inFormat){for(var f=b.length,k=e+1;k<f&&b[k]===ha;)k++;if(k<f&&(f=a[e],k=b[k],(1425<=f&&2303>=f||64286===f)&&(k===ca||k===ma)))return ca}return 1>e||b[e-1]===ea?S:c[e-1]},UBAT_B:function(){d.lastArabic=!0;d.hasUbatB=!0;return d.dir},UBAT_S:function(){d.hasUbatS=!0;return S},UBAT_LRE:function(){d.lastArabic=!1;return S},UBAT_RLE:function(){d.lastArabic=!1;return S},UBAT_LRO:function(){d.lastArabic=!1;return S},UBAT_RLO:function(){d.lastArabic=!1;return S},UBAT_PDF:function(){d.lastArabic=
!1;return S},UBAT_BN:function(){return S}}[pa[b[e]]]()}function n(a,b){for(var c=0;c<K.length;c++)if(a===K[c])return b[c];return a}function p(a){return"\u064b"<=a&&"\u0655">=a?!0:!1}function y(a){if("L"===a)return"LTR";if("R"===a)return"RTL";if("C"===a)return"CLR";if("D"===a)return"CRL"}function u(a,b){for(var c=0;c<G.length;c++)if(a===G[c])return b[c];return a}function k(a,b,c,e){for(var d=0;d<a.length;d++)if(a[d]>b||!c&&a[d]===b)a[d]+=e}g.getObject("string",!0,dojox);g=a("dojox.string.BidiEngine",
d,{inputFormat:"ILYNN",outputFormat:"VLNNN",sourceToTarget:[],targetToSource:[],levels:[],bidiTransform:function(a,b,c){this.sourceToTarget=[];this.targetToSource=[];if(!a)return"";var e=this.sourceToTarget,d=this.targetToSource,m=a.length;r=[];q=[];for(var g=0;g<m;g++)e[g]=g,d[g]=g,r[g]=g;if(!this.checkParameters(b,c))return a;b=this.inputFormat;c=this.outputFormat;var e=a,e=E,g=y(b.charAt(1)),d=y(c.charAt(1)),A="I"===b.charAt(0)?"L":b.charAt(0),m="I"===c.charAt(0)?"L":c.charAt(0),g=A+g,d=m+d,m=
b.charAt(2)+c.charAt(2);e.defInFormat=g;e.defOutFormat=d;e.defSwap=m;a=h(a,g,d,m,e);e=!1;if("R"===c.charAt(1))e=!0;else if("C"===c.charAt(1)||"D"===c.charAt(1))e=this.checkContextual(a);d=this.sourceToTarget=r;m=Array(d.length);for(g=0;g<d.length;g++)m[d[g]]=g;z=this.targetToSource=m;if(b.charAt(3)===c.charAt(3))e=a;else if("S"===c.charAt(3))if(b=e,c=!0,0===a.length)e=void 0;else{void 0===b&&(b=!0);void 0===c&&(c=!0);a=String(a);a=a.split("");var t=0,d=1,e=a.length;b||(t=a.length-1,d=-1,e=1);for(var m=
e,g=c,B=0,e=[],A=0;t*d<m;t+=d)if(l(a[t])||p(a[t])){var x;if(x="\u0644"===a[t])b:{for(var C=a,v=t+d,D=d,w=m;v*D<w&&p(C[v]);)v+=D;x=" ";if(v*D<w)for(x=C[v],C=0;C<G.length;C++)if(G[C]===x){x=!0;break b}x=!1}if(x){a[t]=0===B?u(a[t+d],M):u(a[t+d],O);t+=d;B=a;x=t;C=d;for(v=m;x*C<v&&p(B[x]);)x+=C;x*C<v&&(B[x]=" ");g&&(e[A]=t,A++);B=0}else{x=a[t];if(1===B){C=t;if(f(a,t+d,d,m))b:for(v=a[t],D=0;D<K.length;D++){if(v===K[D]){v=N[D];break b}}else v=n(a[t],P);a[C]=v}else!0===f(a,t+d,d,m)?a[t]=n(a[t],J):a[t]=n(a[t],
Q);p(x)||(B=1);b:{for(C=0;C<R.length;C++)if(R[C]===x){x=!0;break b}x=!1}!0===x&&(B=0)}}else B=0;d="";for(m=0;m<a.length;m++){if(g=c){b:{for(g=0;g<e.length;g++)if(e[g]===m)break b;g=-1}g=-1<g}g?(k(z,m,!b,-1),r.splice(m,1)):d+=a[m]}e=d}else if(b=a,c=e,a=!0,0===b.length)e=void 0;else for(void 0===a&&(a=!0),void 0===c&&(c=!0),b=String(b),e="",d=[],d=b.split(""),m=0;m<b.length;m++)g=!1,"\ufe70"<=d[m]&&"\ufeff">d[m]?(A=b.charCodeAt(m),"\ufef5"<=d[m]&&"\ufefc">=d[m]?(c?(0<m&&a&&" "===d[m-1]?e=e.substring(0,
e.length-1)+"\u0644":(e+="\u0644",g=!0),e+=G[(A-65269)/2]):(e+=G[(A-65269)/2],e+="\u0644",m+1<b.length&&a&&" "===d[m+1]?m++:g=!0),g&&(k(z,m,!0,1),r.splice(m,0,r[m]))):e+=Y[A-65136]):e+=d[m];this.sourceToTarget=r;this.targetToSource=z;this.levels=q;return e},_inputFormatSetter:function(a){if(!I.test(a))throw Error("dojox/string/BidiEngine: the bidi layout string is wrong!");this.inputFormat=a},_outputFormatSetter:function(a){if(!I.test(a))throw Error("dojox/string/BidiEngine: the bidi layout string is wrong!");
this.outputFormat=a},checkParameters:function(a,b){a?this.set("inputFormat",a):a=this.inputFormat;b?this.set("outputFormat",b):b=this.outputFormat;return a===b?!1:!0},checkContextual:function(a){a=b(a);if("ltr"!==a&&"rtl"!==a){try{a=document.dir.toLowerCase()}catch(ua){}"ltr"!==a&&"rtl"!==a&&(a="ltr")}return a},hasBidiChar:function(a){return L.test(a)}});var r=[],z=[],q=[],E={dir:0,defInFormat:"LLTR",defoutFormat:"VLTR",defSwap:"YN",inFormat:"LLTR",outFormat:"VLTR",swap:"YN",hiLevel:0,lastArabic:!1,
hasUbatAl:!1,hasBlockSep:!1,hasSegSep:!1},A=5,B=6,C=0,D=1,I=/^[(I|V)][(L|R|C|D)][(Y|N)][(S|N)][N]$/,L=/[\u0591-\u06ff\ufb1d-\ufefc]/,H=[["(",")"],[")","("],["\x3c","\x3e"],["\x3e","\x3c"],["[","]"],["]","["],["{","}"],["}","{"],["\u00ab","\u00bb"],["\u00bb","\u00ab"],["\u2039","\u203a"],["\u203a","\u2039"],["\u207d","\u207e"],["\u207e","\u207d"],["\u208d","\u208e"],["\u208e","\u208d"],["\u2264","\u2265"],["\u2265","\u2264"],["\u2329","\u232a"],["\u232a","\u2329"],["\ufe59","\ufe5a"],["\ufe5a","\ufe59"],
["\ufe5b","\ufe5c"],["\ufe5c","\ufe5b"],["\ufe5d","\ufe5e"],["\ufe5e","\ufe5d"],["\ufe64","\ufe65"],["\ufe65","\ufe64"]],G=["\u0622","\u0623","\u0625","\u0627"],M=["\ufef5","\ufef7","\ufef9","\ufefb"],O=["\ufef6","\ufef8","\ufefa","\ufefc"],K="\u0627\u0628\u062a\u062b\u062c\u062d\u062e\u062f\u0630\u0631\u0632\u0633\u0634\u0635\u0636\u0637\u0638\u0639\u063a\u0641\u0642\u0643\u0644\u0645\u0646\u0647\u0648\u064a\u0625\u0623\u0622\u0629\u0649\u0644\u0645\u0646\u0647\u0648\u064a\u0625\u0623\u0622\u0629\u0649\u06cc\u0626\u0624".split(""),
Q="\ufe8d\ufe8f\ufe95\ufe99\ufe9d\ufea1\ufea5\ufea9\ufeab\ufead\ufeaf\ufeb1\ufeb5\ufeb9\ufebd\ufec1\ufec5\ufec9\ufecd\ufed1\ufed5\ufed9\ufedd\ufee1\ufee5\ufee9\ufeed\ufef1\ufe87\ufe83\ufe81\ufe93\ufeef\ufbfc\ufe89\ufe85\ufe70\ufe72\ufe74\ufe76\ufe78\ufe7a\ufe7c\ufe7e\ufe80\ufe89\ufe85".split(""),P="\ufe8e\ufe90\ufe96\ufe9a\ufe9e\ufea2\ufea6\ufeaa\ufeac\ufeae\ufeb0\ufeb2\ufeb6\ufeba\ufebe\ufec2\ufec6\ufeca\ufece\ufed2\ufed6\ufeda\ufede\ufee2\ufee6\ufeea\ufeee\ufef2\ufe88\ufe84\ufe82\ufe94\ufef0\ufbfd\ufe8a\ufe86\ufe70\ufe72\ufe74\ufe76\ufe78\ufe7a\ufe7c\ufe7e\ufe80\ufe8a\ufe86".split(""),
N="\ufe8e\ufe92\ufe98\ufe9c\ufea0\ufea4\ufea8\ufeaa\ufeac\ufeae\ufeb0\ufeb4\ufeb8\ufebc\ufec0\ufec4\ufec8\ufecc\ufed0\ufed4\ufed8\ufedc\ufee0\ufee4\ufee8\ufeec\ufeee\ufef4\ufe88\ufe84\ufe82\ufe94\ufef0\ufbff\ufe8c\ufe86\ufe71\ufe72\ufe74\ufe77\ufe79\ufe7b\ufe7d\ufe7f\ufe80\ufe8c\ufe86".split(""),J="\ufe8d\ufe91\ufe97\ufe9b\ufe9f\ufea3\ufea7\ufea9\ufeab\ufead\ufeaf\ufeb3\ufeb7\ufebb\ufebf\ufec3\ufec7\ufecb\ufecf\ufed3\ufed7\ufedb\ufedf\ufee3\ufee7\ufeeb\ufeed\ufef3\ufe87\ufe83\ufe81\ufe93\ufeef\ufbfe\ufe8b\ufe85\ufe70\ufe72\ufe74\ufe76\ufe78\ufe7a\ufe7c\ufe7e\ufe80\ufe8b\ufe85".split(""),
R="\u0621\u0622\u0623\u0624\u0625\u0627\u0629\u062f\u0630\u0631\u0632\u0648\u0649".split(""),Y="\u064b\u064b\u064c\u061f\u064d\u061f\u064e\u064e\u064f\u064f\u0650\u0650\u0651\u0651\u0652\u0652\u0621\u0622\u0622\u0623\u0623\u0624\u0624\u0625\u0625\u0626\u0626\u0626\u0626\u0627\u0627\u0628\u0628\u0628\u0628\u0629\u0629\u062a\u062a\u062a\u062a\u062b\u062b\u062b\u062b\u062c\u062c\u062c\u062c\u062d\u062d\u062d\u062d\u062e\u062e\u062e\u062e\u062f\u062f\u0630\u0630\u0631\u0631\u0632\u0632\u0633\u0633\u0633\u0633\u0634\u0634\u0634\u0634\u0635\u0635\u0635\u0635\u0636\u0636\u0636\u0636\u0637\u0637\u0637\u0637\u0638\u0638\u0638\u0638\u0639\u0639\u0639\u0639\u063a\u063a\u063a\u063a\u0641\u0641\u0641\u0641\u0642\u0642\u0642\u0642\u0643\u0643\u0643\u0643\u0644\u0644\u0644\u0644\u0645\u0645\u0645\u0645\u0646\u0646\u0646\u0646\u0647\u0647\u0647\u0647\u0648\u0648\u0649\u0649\u064a\u064a\u064a\u064a\ufef5\ufef6\ufef7\ufef8\ufef9\ufefa\ufefb\ufefc\u061f\u061f\u061f".split(""),
W=["\u0621","\u0641"],X=["\u063a","\u064a"],Z=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],aa=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],V=0,ca=1,da=2,ba=3,S=4,ea=5,fa=6,ma=7,ja=8,na=11,ha=12,pa="UBAT_L UBAT_R UBAT_EN UBAT_AN UBAT_ON UBAT_B UBAT_S UBAT_AL UBAT_WS UBAT_CS UBAT_ES UBAT_ET UBAT_NSM UBAT_LRE UBAT_RLE UBAT_PDF UBAT_LRO UBAT_RLO UBAT_BN".split(" "),ka=100;a=V;d=ca;var T=da,ga=ba,v=S,la=ea,oa=fa,w=ma,ia=ja,U=
na,F=ha,sa=[ka+0,a,a,a,a,ka+1,ka+2,ka+3,d,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,ka+4,v,v,v,a,v,a,v,a,v,v,v,a,a,v,v,a,a,a,a,a,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,a,a,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,a,a,a,a,a,a,a,a,a,a,a,a,a,a,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,a,a,v,v,a,a,v,v,a,a,v,v,v,v,v,v,v,v,v,v,v,v,
v,v,v,v,v,v,v,v,v,v,v,a,a,a,ka+5,w,w,ka+6,ka+7],ta=[[18,18,18,18,18,18,18,18,18,oa,la,oa,ia,la,18,18,18,18,18,18,18,18,18,18,18,18,18,18,la,la,la,oa,ia,v,v,U,U,U,v,v,v,v,v,10,9,10,9,9,T,T,T,T,T,T,T,T,T,T,9,v,v,v,v,v,v,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,v,v,v,v,v,v,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,v,v,v,v,18,18,18,18,18,18,la,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,9,v,U,U,U,U,v,v,v,v,a,v,v,18,v,v,U,U,T,T,v,a,v,v,v,T,a,v,v,v,
v,v,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,v,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,v,a,a,a,a,a,a,a,a],[a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,v,v,v,v,v,v,v,v,v,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,v,v,a,a,a,a,a,a,a,v,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,v,a,v,v,v,v,v,v,v,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,
F,F,F,F,F,F,d,F,d,F,F,d,F,F,d,F,v,v,v,v,v,v,v,v,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,v,v,v,v,v,d,d,d,d,d,v,v,v,v,v,v,v,v,v,v,v],[ga,ga,ga,ga,v,v,v,v,w,U,U,w,9,w,v,v,F,F,F,F,F,F,F,F,F,F,F,w,v,v,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,ga,ga,ga,ga,ga,ga,ga,ga,ga,ga,U,ga,ga,w,w,w,F,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,
w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,F,F,F,F,F,F,F,ga,v,F,F,F,F,F,F,w,w,F,F,v,F,F,F,F,w,w,T,T,T,T,T,T,T,T,T,T,w,w,w,w,w,w],[w,w,w,w,w,w,w,w,w,w,w,w,w,w,v,w,w,F,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,v,v,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,
w,w,w,F,F,F,F,F,F,F,F,F,F,F,w,v,v,v,v,v,v,v,v,v,v,v,v,v,v,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,F,F,F,F,F,F,F,F,F,d,d,v,v,v,v,d,v,v,v,v,v],[ia,ia,ia,ia,ia,ia,ia,ia,ia,ia,ia,18,18,18,a,d,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,ia,la,13,14,15,16,17,9,U,U,U,U,U,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,9,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,ia,18,18,18,18,18,v,v,v,v,v,18,18,18,18,18,18,T,a,v,v,T,T,T,T,T,T,10,10,v,v,v,a,T,T,T,T,T,T,T,T,T,T,10,
10,v,v,v,v,a,a,a,a,a,a,a,a,a,a,a,a,a,v,v,v,U,U,U,U,U,U,U,U,U,U,U,U,U,U,U,U,U,U,U,U,U,U,U,U,U,U,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[a,a,a,a,a,a,a,v,v,v,v,v,v,v,v,v,v,v,v,a,a,a,a,a,v,v,v,v,v,d,F,d,d,d,d,d,d,d,d,d,d,10,d,d,d,d,d,d,d,d,d,d,d,d,d,v,d,d,d,d,d,v,d,v,d,d,v,d,d,v,d,d,d,d,d,d,d,d,d,d,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,
w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w],[F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,F,F,F,F,F,F,F,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,9,v,9,v,v,9,v,v,v,v,v,v,v,v,v,U,v,v,10,10,v,v,v,v,v,U,U,v,v,v,v,v,w,w,w,w,w,v,w,w,w,w,w,w,w,
w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,v,v,18],[v,v,v,U,U,U,v,v,v,v,v,10,9,10,9,9,T,T,T,T,T,T,T,T,T,T,9,v,v,v,v,v,v,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,v,v,v,v,v,v,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,v,v,v,v,v,v,v,v,v,v,v,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,
a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,v,v,v,a,a,a,a,a,a,v,v,a,a,a,a,a,a,v,v,a,a,a,a,a,a,v,v,a,a,a,v,v,v,U,U,v,v,v,U,U,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v]];return g})},"dojo/Stateful":function(){define(["./_base/declare","./_base/lang","./_base/array","./when"],function(g,a,d,h){return g("dojo.Stateful",null,{_attrPairNames:{},_getAttrNames:function(a){var b=this._attrPairNames;
return b[a]?b[a]:b[a]={s:"_"+a+"Setter",g:"_"+a+"Getter"}},postscript:function(a){a&&this.set(a)},_get:function(a,e){return"function"===typeof this[e.g]?this[e.g]():this[a]},get:function(a){return this._get(a,this._getAttrNames(a))},set:function(a,e){if("object"===typeof a){for(var b in a)a.hasOwnProperty(b)&&"_watchCallbacks"!=b&&this.set(b,a[b]);return this}b=this._getAttrNames(a);var c=this._get(a,b);b=this[b.s];var d;"function"===typeof b?d=b.apply(this,Array.prototype.slice.call(arguments,1)):
this[a]=e;if(this._watchCallbacks){var f=this;h(d,function(){f._watchCallbacks(a,c,e)})}return this},_changeAttrValue:function(a,e){var b=this.get(a);this[a]=e;this._watchCallbacks&&this._watchCallbacks(a,b,e);return this},watch:function(a,e){var b=this._watchCallbacks;if(!b)var c=this,b=this._watchCallbacks=function(a,e,d,l){var f=function(b){if(b){b=b.slice();for(var f=0,k=b.length;f<k;f++)b[f].call(c,a,e,d)}};f(b["_"+a]);l||f(b["*"])};e||"function"!==typeof a?a="_"+a:(e=a,a="*");var l=b[a];"object"!==
typeof l&&(l=b[a]=[]);l.push(e);a={};a.unwatch=a.remove=function(){var a=d.indexOf(l,e);-1<a&&l.splice(a,1)};return a}})})},"esri/views/2d/engine/webgl/util/vvFlagUtils":function(){define(["require","exports","../enums","../visualVariablesUtils"],function(g,a,d,h){function b(a,b){void 0===b&&(b=!1);var c=d.WGLVVFlag.SIZE_FIELD_STOPS|d.WGLVVFlag.SIZE_MINMAX_VALUE|d.WGLVVFlag.SIZE_SCALE_STOPS|d.WGLVVFlag.SIZE_UNIT_VALUE;a=(a&(d.WGLVVTarget.FIELD_TARGETS_OUTLINE|d.WGLVVTarget.MINMAX_TARGETS_OUTLINE|
d.WGLVVTarget.SCALE_TARGETS_OUTLINE|d.WGLVVTarget.UNIT_TARGETS_OUTLINE))>>>4;return b?c&a:c&~a}function e(a){var c=b(a,!1);return a&(d.WGLVVFlag.COLOR|d.WGLVVFlag.OPACITY|d.WGLVVFlag.ROTATION|c)}Object.defineProperty(a,"__esModule",{value:!0});a.getVVFlags=function(a){if(!a)return d.WGLVVFlag.NONE;for(var b=0,e=0;e<a.length;e++){var f=a[e];if("size"===f.type){var m=h.getTypeOfSizeVisualVariable(f),b=b|m;"outline"===f.target&&(b|=m<<4)}else"color"===f.type?b|=d.WGLVVFlag.COLOR:"opacity"===f.type?b|=
d.WGLVVFlag.OPACITY:"rotation"===f.type&&(b|=d.WGLVVFlag.ROTATION)}return b};a.getSizeFlagsMask=b;a.getMarkerVVFlags=e;a.getFillVVFlags=function(a){return a&(d.WGLVVFlag.COLOR|d.WGLVVFlag.OPACITY)};a.getLineVVFlags=function(a,c){if(c)return c=b(a,!0),a&c;c=b(a,!1);return a&(d.WGLVVFlag.COLOR|d.WGLVVFlag.OPACITY|c)};a.getTextVVFlags=function(a){return e(a)};a.getLabelVVFlags=function(a){var c=b(a,!1);return a&c}})},"esri/views/2d/engine/webgl/visualVariablesUtils":function(){define("require exports ../../../../core/Error ../../../../core/Logger ./enums ./Utils".split(" "),
function(g,a,d,h,b,e){Object.defineProperty(a,"__esModule",{value:!0});var m=h.getLogger("esri.views.2d.engine.webgl");a.getTypeOfSizeVisualVariable=function(a){if(e.isNumber(a.minDataValue)&&e.isNumber(a.maxDataValue)&&null!=a.minSize&&null!=a.maxSize)return b.WGLVVFlag.SIZE_MINMAX_VALUE;if((a.expression&&"view.scale"===a.expression||a.valueExpression&&"$view.scale"===a.valueExpression)&&Array.isArray(a.stops))return b.WGLVVFlag.SIZE_SCALE_STOPS;if((null!=a.field||a.expression&&"view.scale"!==a.expression||
a.valueExpression&&"$view.scale"!==a.valueExpression)&&(Array.isArray(a.stops)||"levels"in a&&a.levels))return b.WGLVVFlag.SIZE_FIELD_STOPS;if((null!=a.field||a.expression&&"view.scale"!==a.expression||a.valueExpression&&"$view.scale"!==a.valueExpression)&&null!=a.valueUnit)return b.WGLVVFlag.SIZE_UNIT_VALUE;m.error(new d("mapview-bad-type","Found invalid size VisualVariable",a));return b.WGLVVFlag.NONE}})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushLabel":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../webgl ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey".split(" "),
function(g,a,d,h,b,e,m,c){Object.defineProperty(a,"__esModule",{value:!0});g=function(a){function f(){return null!==a&&a.apply(this,arguments)||this}d(f,a);f.prototype.dispose=function(){};f.prototype.getGeometryType=function(){return b.WGLGeometryType.LABEL};f.prototype.drawGeometry=function(a,b,d,f,l){var h=a.context,k=a.painter,m=a.state,g=a.rendererInfo,n=d.indexCount,p=d.indexFrom;d=c.LabelMaterialKey.load(d.materialKey);var A=d.mapAligned?1:0;if(A||!(1<=Math.abs(b.key.level-Math.round(100*a.displayLevel)/
100))){var t=e.createProgramDescriptor(d.data,{geometry:[{location:0,name:"a_pos",count:2,type:5122},{location:1,name:"a_id",count:4,type:5121},{location:2,name:"a_color",count:4,type:5121,normalized:!0},{location:3,name:"a_vertexOffset",count:2,type:5122},{location:4,name:"a_texAndSize",count:4,type:5121},{location:5,name:"a_refSymbolAndPlacementOffset",count:4,type:5121},{location:6,name:"a_zoomRangeAndEmpty",count:4,type:5121}]}),y=t.bufferLayouts,t=t.attributes;l=k.materialManager.getMaterialProgram(a,
d,"materials/label",t,l);f=this._getVAO(h,y,t,f);a.context.setStencilFunction(514,0,255);h.bindProgram(l);h.bindVAO(f);this._setSharedUniforms(l,a,b);k.textureManager.bindTextures(h,l,d,4);k=1===A?m.displayViewMat3:m.displayMat3;d.vvSizeMinMaxValue&&l.setUniform4fv("u_vvSizeMinMaxValue",g.vvSizeMinMaxValue);d.vvSizeScaleStops&&l.setUniform1f("u_vvSizeScaleStopsValue",g.vvSizeScaleStopsValue);d.vvSizeFieldStops&&(b=g.getSizeVVFieldStops(b.key.level),l.setUniform1fv("u_vvSizeFieldStopsValues",b.values),
l.setUniform1fv("u_vvSizeFieldStopsSizes",b.sizes));d.vvSizeUnitValue&&l.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",g.vvSizeUnitValueToPixelsRatio);l.setUniform1f("u_mapRotation",Math.floor(m.rotation/360*254));l.setUniform1f("u_mapAligned",A);l.setUniformMatrix3fv("u_displayMat3",k);l.setUniform1f("u_opacity",1);l.setUniform1f("u_zoomLevel",Math.round(10*a.displayLevel));l.setUniform2fv("u_screenSize",a.state.size);h.drawElements(4,n,5125,4*p);h.bindVAO(null);h.setStencilTestEnabled(!0);
h.setBlendingEnabled(!0)}};return f}(m.default);a.default=g})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushLine":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../webgl ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey".split(" "),function(g,a,d,h,b,e,m,c){Object.defineProperty(a,"__esModule",{value:!0});g=function(a){function f(){return null!==a&&a.apply(this,arguments)||this}d(f,a);f.prototype.dispose=function(){};f.prototype.getGeometryType=
function(){return b.WGLGeometryType.LINE};f.prototype.drawGeometry=function(a,b,d,f,l){var h=a.context,k=a.painter,m=a.rendererInfo,g=a.requiredLevel,n=d.indexFrom,p=d.indexCount;d=c.LineMaterialKey.load(d.materialKey);var A=e.createProgramDescriptor(d.data,{geometry:[{location:0,name:"a_pos",count:2,type:5122},{location:1,name:"a_id",count:4,type:5121},{location:2,name:"a_color",count:4,type:5121,normalized:!0},{location:3,name:"a_offsetAndNormal",count:4,type:5120},{location:4,name:"a_accumulatedDistanceAndHalfWidth",
count:2,type:5123},{location:5,name:"a_tlbr",count:4,type:5123},{location:6,name:"a_segmentDirection",count:4,type:5120},{location:7,name:"a_aux",count:2,type:5123}]}),t=A.bufferLayouts,A=A.attributes;l=k.materialManager.getMaterialProgram(a,d,"materials/line",A,l);f=this._getVAO(h,t,A,f);t=1/a.pixelRatio;h.bindProgram(l);h.bindVAO(f);this._setSharedUniforms(l,a,b);d.textureBinding&&k.textureManager.bindTextures(h,l,d);l.setUniform1f("u_zoomFactor",Math.pow(2,g-b.key.level)/a.pixelRatio);l.setUniform1f("u_blur",
0+t);l.setUniform1f("u_antialiasing",t);d.vvSizeMinMaxValue&&l.setUniform4fv("u_vvSizeMinMaxValue",m.vvSizeMinMaxValue);d.vvSizeScaleStops&&l.setUniform1f("u_vvSizeScaleStopsValue",m.vvSizeScaleStopsValue);d.vvSizeFieldStops&&(a=m.getSizeVVFieldStops(b.key.level),l.setUniform1fv("u_vvSizeFieldStopsValues",a.values),l.setUniform1fv("u_vvSizeFieldStopsSizes",a.sizes));d.vvSizeUnitValue&&l.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",m.vvSizeUnitValueToPixelsRatio);d.vvColor&&(l.setUniform1fv("u_vvColorValues",
m.vvColorValues),l.setUniform4fv("u_vvColors",m.vvColors));d.vvOpacity&&(l.setUniform1fv("u_vvOpacityValues",m.vvOpacityValues),l.setUniform1fv("u_vvOpacities",m.vvOpacities));h.setFaceCullingEnabled(!0);h.setFrontFace(2305);h.setCullFace(1029);h.drawElements(4,p,5125,4*n);h.setFaceCullingEnabled(!1);h.bindVAO(null)};return f}(m.default);a.default=g})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushMarker":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/tsSupport/assignHelper ../../../../webgl ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey".split(" "),
function(g,a,d,h,b,e,m,c,l){Object.defineProperty(a,"__esModule",{value:!0});g=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}d(b,a);b.prototype.dispose=function(){};b.prototype.getGeometryType=function(){return e.WGLGeometryType.MARKER};b.prototype.drawGeometry=function(a,b,c,e,d){var f=a.context,h=a.painter,g=a.rendererInfo,n=a.state,p=c.indexCount,A=c.indexFrom;c=l.MarkerMaterialKey.load(c.materialKey);var u=m.createProgramDescriptor(c.data,{geometry:[{location:0,name:"a_pos",
count:2,type:5122},{location:1,name:"a_vertexOffset",count:2,type:5122},{location:2,name:"a_texCoords",count:2,type:5123},{location:3,name:"a_bitSetAndDistRatio",count:4,type:5121},{location:4,name:"a_id",count:4,type:5121},{location:5,name:"a_color",count:4,type:5121,normalized:!0},{location:6,name:"a_outlineColor",count:4,type:5121,normalized:!0},{location:7,name:"a_sizeAndOutlineWidth",count:4,type:5121}]}),t=u.bufferLayouts,u=u.attributes;d=h.materialManager.getMaterialProgram(a,c,"materials/icon",
u,d);e=this._getVAO(f,t,u,e);f.bindProgram(d);f.bindVAO(e);c.textureBinding&&h.textureManager.bindTextures(f,d,c,1);this._setSharedUniforms(d,a,b);d.setUniformMatrix3fv("u_displayMat3",c.vvRotation?n.displayViewMat3:n.displayMat3);c.vvSizeMinMaxValue&&d.setUniform4fv("u_vvSizeMinMaxValue",g.vvSizeMinMaxValue);c.vvSizeScaleStops&&d.setUniform1f("u_vvSizeScaleStopsValue",g.vvSizeScaleStopsValue);c.vvSizeFieldStops&&(a=g.getSizeVVFieldStops(b.key.level),d.setUniform1fv("u_vvSizeFieldStopsValues",a.values),
d.setUniform1fv("u_vvSizeFieldStopsSizes",a.sizes));c.vvSizeUnitValue&&d.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",g.vvSizeUnitValueToPixelsRatio);c.vvColor&&(d.setUniform1fv("u_vvColorValues",g.vvColorValues),d.setUniform4fv("u_vvColors",g.vvColors));c.vvOpacity&&(d.setUniform1fv("u_vvOpacityValues",g.vvOpacityValues),d.setUniform1fv("u_vvOpacities",g.vvOpacities));c.vvRotation&&d.setUniform1f("u_vvRotationType","geographic"===g.vvMaterialParameters.vvRotationType?0:1);f.drawElements(4,
p,5125,4*A);f.bindVAO(null)};return b}(c.default);a.default=g})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushText":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../webgl ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey".split(" "),function(g,a,d,h,b,e,m,c){Object.defineProperty(a,"__esModule",{value:!0});g=function(a){function f(){return null!==a&&a.apply(this,arguments)||this}d(f,a);f.prototype.dispose=function(){};f.prototype.getGeometryType=
function(){return b.WGLGeometryType.TEXT};f.prototype.drawGeometry=function(a,b,d,f,l){var h=a.context,k=a.painter,m=a.rendererInfo,g=a.state,n=d.indexCount,p=d.indexFrom;d=c.TextMaterialKey.load(d.materialKey);var A=e.createProgramDescriptor(d.data,{geometry:[{location:0,name:"a_pos",count:2,type:5122},{location:1,name:"a_id",count:4,type:5121},{location:2,name:"a_color",count:4,type:5121,normalized:!0},{location:3,name:"a_vertexOffset",count:2,type:5122},{location:4,name:"a_texFontSize",count:4,
type:5121},{location:5,name:"a_aux",count:4,type:5120}]}),t=A.bufferLayouts,A=A.attributes;l=k.materialManager.getMaterialProgram(a,d,"materials/text",A,l);f=this._getVAO(h,t,A,f);h.bindProgram(l);h.bindVAO(f);this._setSharedUniforms(l,a,b);k.textureManager.bindTextures(h,l,d,4);l.setUniformMatrix3fv("u_displayMat3",g.displayMat3);d.vvSizeMinMaxValue&&l.setUniform4fv("u_vvSizeMinMaxValue",m.vvSizeMinMaxValue);d.vvSizeScaleStops&&l.setUniform1f("u_vvSizeScaleStopsValue",m.vvSizeScaleStopsValue);d.vvSizeFieldStops&&
(a=m.getSizeVVFieldStops(b.key.level),l.setUniform1fv("u_vvSizeFieldStopsValues",a.values),l.setUniform1fv("u_vvSizeFieldStopsSizes",a.sizes));d.vvSizeUnitValue&&l.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",m.vvSizeUnitValueToPixelsRatio);d.vvColor&&(l.setUniform1fv("u_vvColorValues",m.vvColorValues),l.setUniform4fv("u_vvColors",m.vvColors));d.vvOpacity&&(l.setUniform1fv("u_vvOpacityValues",m.vvOpacityValues),l.setUniform1fv("u_vvOpacities",m.vvOpacities));d.vvRotation&&l.setUniform1f("u_vvRotationType",
"geographic"===m.vvMaterialParameters.vvRotationType?0:1);h.drawElements(4,n,5125,4*p);h.bindVAO(null)};return f}(m.default);a.default=g})},"esri/views/2d/engine/webgl/TileClipper":function(){define(["require","exports","./definitions","./Geometry","./GeometryUtils"],function(g,a,d,h,b){Object.defineProperty(a,"__esModule",{value:!0});var e=function(){return function(a,b,e){this.ratio=a;this.x=b;this.y=e}}();g=function(){function a(a,b,c,e,h){void 0===e&&(e=8);void 0===h&&(h=8);this.lines=[];this.starts=
[];this.pixelRatio=e;this.pixelMargin=h;this.tileSize=d.TILE_SIZE*e;this.dz=a;this.yPos=b;this.xPos=c}a.prototype.setExtent=function(a){this.finalRatio=this.tileSize/a*(1<<this.dz);var b=this.pixelRatio*this.pixelMargin,b=b/this.finalRatio;a>>=this.dz;b>a&&(b=a);this.margin=b;this.xmin=a*this.xPos-b;this.ymin=a*this.yPos-b;this.xmax=this.xmin+a+2*b;this.ymax=this.ymin+a+2*b};a.prototype.reset=function(a){this.type=a;this.lines=[];this.starts=[];this.line=null;this.start=0};a.prototype.moveTo=function(a,
b){this._pushLine();this._prevIsIn=this._isIn(a,b);this._moveTo(a,b,this._prevIsIn);this._prevPt=new h.Point(a,b);this._firstPt=new h.Point(a,b);this._dist=0};a.prototype.lineTo=function(a,b){var c=this._isIn(a,b),d=new h.Point(a,b),f=h.Point.distance(this._prevPt,d),l,m,g;if(c)this._prevIsIn?this._lineTo(a,b,!0):(l=this._prevPt,m=d,a=this._intersect(m,l),this.start=this._dist+f*(1-this._r),this._lineTo(a.x,a.y,!0),this._lineTo(m.x,m.y,!0));else if(this._prevIsIn)m=this._prevPt,l=d,a=this._intersect(m,
l),this._lineTo(a.x,a.y,!0),this._lineTo(l.x,l.y,!1);else{var k=this._prevPt;if(!(k.x<=this.xmin&&d.x<=this.xmin||k.x>=this.xmax&&d.x>=this.xmax||k.y<=this.ymin&&d.y<=this.ymin||k.y>=this.ymax&&d.y>=this.ymax)){a=[];if(k.x<this.xmin&&d.x>this.xmin||k.x>this.xmin&&d.x<this.xmin)b=(this.xmin-k.x)/(d.x-k.x),g=k.y+b*(d.y-k.y),g<=this.ymin?m=!1:g>=this.ymax?m=!0:a.push(new e(b,this.xmin,g));if(k.x<this.xmax&&d.x>this.xmax||k.x>this.xmax&&d.x<this.xmax)b=(this.xmax-k.x)/(d.x-k.x),g=k.y+b*(d.y-k.y),g<=this.ymin?
m=!1:g>=this.ymax?m=!0:a.push(new e(b,this.xmax,g));if(k.y<this.ymin&&d.y>this.ymin||k.y>this.ymin&&d.y<this.ymin)b=(this.ymin-k.y)/(d.y-k.y),g=k.x+b*(d.x-k.x),g<=this.xmin?l=!1:g>=this.xmax?l=!0:a.push(new e(b,g,this.ymin));if(k.y<this.ymax&&d.y>this.ymax||k.y>this.ymax&&d.y<this.ymax)b=(this.ymax-k.y)/(d.y-k.y),g=k.x+b*(d.x-k.x),g<=this.xmin?l=!1:g>=this.xmax?l=!0:a.push(new e(b,g,this.ymax));if(0===a.length)l?m?this._lineTo(this.xmax,this.ymax,!0):this._lineTo(this.xmax,this.ymin,!0):m?this._lineTo(this.xmin,
this.ymax,!0):this._lineTo(this.xmin,this.ymin,!0);else if(1<a.length&&a[0].ratio>a[1].ratio)this.start=this._dist+f*a[1].ratio,this._lineTo(a[1].x,a[1].y,!0),this._lineTo(a[0].x,a[0].y,!0);else for(this.start=this._dist+f*a[0].ratio,l=0;l<a.length;l++)this._lineTo(a[l].x,a[l].y,!0)}this._lineTo(d.x,d.y,!1)}this._dist+=f;this._prevIsIn=c;this._prevPt=d};a.prototype.close=function(){if(2<this.line.length){var a=this._firstPt,b=this._prevPt;a.x===b.x&&a.y===b.y||this.lineTo(a.x,a.y);a=this.line;for(b=
a.length;4<=b;)if(a[0].x===a[1].x&&a[0].x===a[b-2].x||a[0].y===a[1].y&&a[0].y===a[b-2].y)a.pop(),a[0].x=a[b-2].x,a[0].y=a[b-2].y,--b;else break}};a.prototype.result=function(a){void 0===a&&(a=!0);this._pushLine();if(0===this.lines.length)return null;3===this.type&&a&&m.simplify(this.tileSize,this.margin*this.finalRatio,this.lines);return this.lines};a.prototype.resultWithStarts=function(){if(2!==this.type)throw Error("Only valid for lines");this._pushLine();var a=this.lines,b=a.length;if(0===b)return null;
for(var c=[],e=0;e<b;e++)c.push({line:a[e],start:this.starts[e]||0});return c};a.prototype._isIn=function(a,b){return a>=this.xmin&&a<=this.xmax&&b>=this.ymin&&b<=this.ymax};a.prototype._intersect=function(a,b){var c,e,d;if(b.x>=this.xmin&&b.x<=this.xmax)e=b.y<=this.ymin?this.ymin:this.ymax,d=(e-a.y)/(b.y-a.y),c=a.x+d*(b.x-a.x);else if(b.y>=this.ymin&&b.y<=this.ymax)c=b.x<=this.xmin?this.xmin:this.xmax,d=(c-a.x)/(b.x-a.x),e=a.y+d*(b.y-a.y);else{e=b.y<=this.ymin?this.ymin:this.ymax;c=b.x<=this.xmin?
this.xmin:this.xmax;var f=(c-a.x)/(b.x-a.x),l=(e-a.y)/(b.y-a.y);f<l?(d=f,e=a.y+f*(b.y-a.y)):(d=l,c=a.x+l*(b.x-a.x))}this._r=d;return new h.Point(c,e)};a.prototype._pushLine=function(){this.line&&(1===this.type?0<this.line.length&&(this.lines.push(this.line),this.starts.push(this.start)):2===this.type?1<this.line.length&&(this.lines.push(this.line),this.starts.push(this.start)):3===this.type&&3<this.line.length&&(this.lines.push(this.line),this.starts.push(this.start)));this.line=[];this.start=0};
a.prototype._moveTo=function(a,b,c){3!==this.type?c&&(a=Math.round((a-(this.xmin+this.margin))*this.finalRatio),b=Math.round((b-(this.ymin+this.margin))*this.finalRatio),this.line.push(new h.Point(a,b))):(c||(a<this.xmin&&(a=this.xmin),a>this.xmax&&(a=this.xmax),b<this.ymin&&(b=this.ymin),b>this.ymax&&(b=this.ymax)),a=Math.round((a-(this.xmin+this.margin))*this.finalRatio),b=Math.round((b-(this.ymin+this.margin))*this.finalRatio),this.line.push(new h.Point(a,b)),this._is_v=this._is_h=!1)};a.prototype._lineTo=
function(a,b,c){if(3!==this.type)if(c){a=Math.round((a-(this.xmin+this.margin))*this.finalRatio);b=Math.round((b-(this.ymin+this.margin))*this.finalRatio);if(0<this.line.length&&(c=this.line[this.line.length-1],c.equals(a,b)))return;this.line.push(new h.Point(a,b))}else this.line&&0<this.line.length&&this._pushLine();else if(c||(a<this.xmin&&(a=this.xmin),a>this.xmax&&(a=this.xmax),b<this.ymin&&(b=this.ymin),b>this.ymax&&(b=this.ymax)),a=Math.round((a-(this.xmin+this.margin))*this.finalRatio),b=Math.round((b-
(this.ymin+this.margin))*this.finalRatio),this.line&&0<this.line.length){c=this.line[this.line.length-1];var e=c.x===a,d=c.y===b;e&&d||(this._is_h&&e?(c.x=a,c.y=b,c=this.line[this.line.length-2],c.x===a&&c.y===b?(this.line.pop(),1>=this.line.length?this._is_v=this._is_h=!1:(c=this.line[this.line.length-2],this._is_h=c.x===a,this._is_v=c.y===b)):(this._is_h=c.x===a,this._is_v=c.y===b)):this._is_v&&d?(c.x=a,c.y=b,c=this.line[this.line.length-2],c.x===a&&c.y===b?(this.line.pop(),1>=this.line.length?
this._is_v=this._is_h=!1:(c=this.line[this.line.length-2],this._is_h=c.x===a,this._is_v=c.y===b)):(this._is_h=c.x===a,this._is_v=c.y===b)):(this.line.push(new h.Point(a,b)),this._is_h=e,this._is_v=d))}else this.line.push(new h.Point(a,b))};return a}();a.TileClipper=g;g=function(){function a(){}a.prototype.setExtent=function(a){this._ratio=4096===a?1:4096/a};a.prototype.reset=function(a){this.type=a;this.lines=[];this.line=null};a.prototype.moveTo=function(a,b){this.line&&this.lines.push(this.line);
this.line=[];var c=this._ratio;this.line.push(new h.Point(Math.round(a*c),Math.round(b*c)))};a.prototype.lineTo=function(a,b){var c=this._ratio;this.line.push(new h.Point(Math.round(a*c),Math.round(b*c)))};a.prototype.close=function(){var a=this.line;a&&!a[0].isEqual(a[a.length-1])&&a.push(a[0])};a.prototype.result=function(){this.line&&this.lines.push(this.line);if(0===this.lines.length)return null;3===this.type&&1!==this._ratio&&m.simplify(4096,64,this.lines);return this.lines};return a}();a.SimpleBuilder=
g;var m=function(){function a(){}a.simplify=function(b,c,e){if(e){var d=-c,f=b+c,l=-c,h=b+c;b=[];c=[];for(var m=e.length,k=0;k<m;++k){var g=e[k];if(g&&!(2>g.length))for(var z=g[0],q=void 0,t=g.length,A=1;A<t;++A)q=g[A],z.x===q.x&&(z.x<=d&&(z.y>q.y?(b.push(k),b.push(A),b.push(0),b.push(-1)):(c.push(k),c.push(A),c.push(0),c.push(-1))),z.x>=f&&(z.y<q.y?(b.push(k),b.push(A),b.push(1),b.push(-1)):(c.push(k),c.push(A),c.push(1),c.push(-1)))),z.y===q.y&&(z.y<=l&&(z.x<q.x?(b.push(k),b.push(A),b.push(2),b.push(-1)):
(c.push(k),c.push(A),c.push(2),c.push(-1))),z.y>=h&&(z.x>q.x?(b.push(k),b.push(A),b.push(3),b.push(-1)):(c.push(k),c.push(A),c.push(3),c.push(-1)))),z=q}0!==b.length&&0!==c.length&&(a.fillParent(e,c,b),a.fillParent(e,b,c),d=[],a.calcDeltas(d,c,b),a.calcDeltas(d,b,c),a.addDeltas(d,e))}};a.fillParent=function(a,c,e){for(var d=e.length,f=c.length,l=0;l<f;l+=4){for(var h=c[l],m=c[l+1],k=c[l+2],g=a[h][m-1],h=a[h][m],m=8092,z=-1,q=0;q<d;q+=4)if(e[q+2]===k){var t=e[q],A=e[q+1],B=a[t][A-1],t=a[t][A];switch(k){case 0:case 1:b.between(g.y,
B.y,t.y)&&b.between(h.y,B.y,t.y)&&(B=Math.abs(t.y-B.y),B<m&&(m=B,z=q));break;case 2:case 3:b.between(g.x,B.x,t.x)&&b.between(h.x,B.x,t.x)&&(B=Math.abs(t.x-B.x),B<m&&(m=B,z=q))}}c[l+3]=z}};a.calcDeltas=function(b,c,e){for(var d=c.length,f=0;f<d;f+=4){var l=a.calcDelta(f,c,e,[]);b.push(c[f]);b.push(c[f+1]);b.push(c[f+2]);b.push(l)}};a.calcDelta=function(b,c,e,d){b=c[b+3];if(-1===b)return 0;var f=d.length;if(1<f&&d[f-2]===b)return 0;d.push(b);return a.calcDelta(b,e,c,d)+1};a.addDeltas=function(a,b){for(var c=
a.length,e=0,d=0;d<c;d+=4){var f=a[d+3];f>e&&(e=f)}for(d=0;d<c;d+=4){var l=b[a[d]],h=a[d+1],f=e-a[d+3];switch(a[d+2]){case 0:l[h-1].x-=f;l[h].x-=f;1===h&&(l[l.length-1].x-=f);h===l.length-1&&(l[0].x-=f);break;case 1:l[h-1].x+=f;l[h].x+=f;1===h&&(l[l.length-1].x+=f);h===l.length-1&&(l[0].x+=f);break;case 2:l[h-1].y-=f;l[h].y-=f;1===h&&(l[l.length-1].y-=f);h===l.length-1&&(l[0].y-=f);break;case 3:l[h-1].y+=f,l[h].y+=f,1===h&&(l[l.length-1].y+=f),h===l.length-1&&(l[0].y+=f)}}};return a}()})},"esri/views/2d/engine/webgl/TurboLine":function(){define(["require",
"exports","../../../../symbols/cim/enums","./mesh/templates/util"],function(g,a,d,h){function b(){if(q.cosine<x.innerBisectorAutoSplitThreshold){q.splitInner=!0;q.gapInner=!0;var a=Math.max(x.innerBisectorAutoSplitThreshold,q.cosine),a=Math.sqrt(1-a*a)/a;q.leftInner.x=q.nextNormal.x+q.sign*a*q.outbound.x;q.leftInner.y=q.nextNormal.y+q.sign*a*q.outbound.y;q.rightInner.x=q.prevNormal.x-q.sign*a*q.inbound.x;q.rightInner.y=q.prevNormal.y-q.sign*a*q.inbound.y}else x.enableInnerBisectorSplit&&(q.splitInner=
!0,q.gapInner=!1,q.leftInner.x=q.rightInner.x=q.bisector.x/q.cosine,q.leftInner.y=q.rightInner.y=q.bisector.y/q.cosine);q.cosine<x.outerBisectorAutoSplitThreshold?(q.splitOuter=!0,q.gapOuter=!0,a=Math.max(x.outerBisectorAutoSplitThreshold,q.cosine),a=Math.sqrt(1-a*a)/a,q.leftOuter.x=q.prevNormal.x-q.sign*a*q.inbound.x,q.leftOuter.y=q.prevNormal.y-q.sign*a*q.inbound.y,q.rightOuter.x=q.nextNormal.x+q.sign*a*q.outbound.x,q.rightOuter.y=q.nextNormal.y+q.sign*a*q.outbound.y):x.enableOuterBisectorSplit&&
(q.splitOuter=!0,q.gapOuter=!1,q.leftOuter.x=q.rightOuter.x=q.bisector.x/q.cosine,q.leftOuter.y=q.rightOuter.y=q.bisector.y/q.cosine)}function e(){if(k)q.distance=0,k=q.isCap=q.isFirstVertex=q.isLastVertex=!1;else{if(0===y)if(q.isFirstVertex=0===p,z=t[p],0===p){if(y=0,q.closed){q.inbound.x=z.x-t[t.length-2].x;q.inbound.y=z.y-t[t.length-2].y;var a=Math.sqrt(q.inbound.x*q.inbound.x+q.inbound.y*q.inbound.y);q.inbound.x/=a;q.inbound.y/=a}}else q.inbound.x=z.x-r.x,q.inbound.y=z.y-r.y,y=Math.sqrt(q.inbound.x*
q.inbound.x+q.inbound.y*q.inbound.y),q.inbound.x/=y,q.inbound.y/=y;q.distance+y-u<=x.wrapDistance?(p<t.length-1?(q.outbound.x=t[p+1].x-z.x,q.outbound.y=t[p+1].y-z.y,a=Math.sqrt(q.outbound.x*q.outbound.x+q.outbound.y*q.outbound.y),q.outbound.x/=a,q.outbound.y/=a):q.closed?(q.outbound.x=t[1].x-z.x,q.outbound.y=t[1].y-z.y,a=Math.sqrt(q.outbound.x*q.outbound.x+q.outbound.y*q.outbound.y),q.outbound.x/=a,q.outbound.y/=a):(q.outbound.x=q.inbound.x,q.outbound.y=q.inbound.y),0!==p||q.closed||(q.inbound.x=
q.outbound.x,q.inbound.y=q.outbound.y),++p,q.isLastVertex=p===t.length,q.isCap=!q.closed&&(q.isFirstVertex||q.isLastVertex),q.distance+=y-u,u=y=0,k=q.distance+y-u===x.wrapDistance,q.currentVertex.x=z.x,q.currentVertex.y=z.y,r=z,z=null):(q.outbound.x=q.inbound.x,q.outbound.y=q.inbound.y,u+=x.wrapDistance-q.distance,q.distance=x.wrapDistance,k=!0,a=u/y,q.currentVertex.x=(1-a)*r.x+a*z.x,q.currentVertex.y=(1-a)*r.y+a*z.y)}}function m(){q.prevNormal.x=-q.inbound.y;q.prevNormal.y=q.inbound.x;q.nextNormal.x=
-q.outbound.y;q.nextNormal.y=q.outbound.x}function c(){m();q.bisector.x=q.prevNormal.x+q.nextNormal.x;q.bisector.y=q.prevNormal.y+q.nextNormal.y;var a=Math.sqrt(q.bisector.x*q.bisector.x+q.bisector.y*q.bisector.y);.001>a?(q.bisector.x=void 0,q.bisector.y=void 0,q.cosine=0,q.sign=void 0):(q.bisector.x/=a,q.bisector.y/=a,q.cosine=q.bisector.x*q.nextNormal.x+q.bisector.y*q.nextNormal.y,q.sign=0<=q.prevNormal.x*q.nextNormal.y-q.prevNormal.y*q.nextNormal.x?1:-1)}function l(a){n.vertex(q);1===a?(q.leftEntry0=
q.entry0,q.leftEntry1=q.entry1,q.leftEntry2=q.entry2,q.leftExit0=q.exit0,q.leftExit1=q.exit1,q.leftExit2=q.exit2):2===a&&(q.rightEntry0=q.entry0,q.rightEntry1=q.entry1,q.rightEntry2=q.entry2,q.rightExit0=q.exit0,q.rightExit1=q.exit1,q.rightExit2=q.exit2)}function f(a){n.vertex(q);1===a?(q.leftEntry0=q.entry0,q.leftEntry2=q.entry2,q.leftExit0=q.exit0,q.leftExit2=q.exit2):2===a&&(q.rightEntry0=q.entry0,q.rightEntry2=q.entry2,q.rightExit0=q.exit0,q.rightExit2=q.exit2)}Object.defineProperty(a,"__esModule",
{value:!0});g=function(){return function(){this.isCap=this.isLastVertex=this.isFirstVertex=this.closed=void 0;this.currentVertex={x:void 0,y:void 0};this.inbound={x:void 0,y:void 0};this.outbound={x:void 0,y:void 0};this.prevNormal={x:void 0,y:void 0};this.nextNormal={x:void 0,y:void 0};this.bisector={x:void 0,y:void 0};this.leftInner={x:void 0,y:void 0};this.rightInner={x:void 0,y:void 0};this.leftOuter={x:void 0,y:void 0};this.rightOuter={x:void 0,y:void 0}}}();a.TessellationState=g;a.tessellate=
function(a,b,d){x.trackDistance=null!=b.trackDistance?b.trackDistance:!1;x.wrapDistance=null!=b.wrapDistance?b.wrapDistance:65535;x.thin=null!=b.thin?b.thin:!1;x.initialDistance=null!=b.initialDistance?b.initialDistance:0;x.enableOuterBisectorSplit=null!=b.enableOuterBisectorSplit?b.enableOuterBisectorSplit:!1;x.outerBisectorAutoSplitThreshold=null!=b.outerBisectorAutoSplitThreshold?b.outerBisectorAutoSplitThreshold:0;x.enableInnerBisectorSplit=null!=b.enableOuterBisectorSplit?b.enableOuterBisectorSplit:
!1;x.innerBisectorAutoSplitThreshold=null!=b.innerBisectorAutoSplitThreshold?b.innerBisectorAutoSplitThreshold:0;t=a;n=d;u=y=p=0;k=!1;z=r=null;q.currentVertex.x=null;q.currentVertex.y=null;q.distance=x.initialDistance;a=t[0];b=t[t.length-1];q.canSplit=!1;q.closed=a.x===b.x&&a.y===b.y;if(!(2>t.length||2===t.length&&q.closed))if(x.thin)if(x.trackDistance)for(e(),m(),f(1);y-u>x.wrapDistance||p<t.length;)e(),m(),f(2),n.bridge(q),q.leftExit0=q.rightExit0,q.leftExit2=q.rightExit2;else for(;p<t.length;)0<
p&&(q.inbound.x=q.outbound.x,q.inbound.y=q.outbound.y),p<t.length-1?(q.outbound.x=t[p+1].x-t[p].x,q.outbound.y=t[p+1].y-t[p].y,a=Math.sqrt(q.outbound.x*q.outbound.x+q.outbound.y*q.outbound.y),q.distance+=a,q.outbound.x/=a,q.outbound.y/=a):(q.outbound.x=q.inbound.x,q.outbound.y=q.inbound.y),0===p&&(q.inbound.x=q.outbound.x,q.inbound.y=q.outbound.y),q.currentVertex.x=t[p].x,q.currentVertex.y=t[p].y,q.prevNormal.x=-q.inbound.y,q.prevNormal.y=q.inbound.x,q.nextNormal.x=-q.outbound.y,q.nextNormal.y=q.outbound.x,
0===p?(n.vertex(q),q.leftEntry0=q.entry0,q.leftEntry2=q.entry2,q.leftExit0=q.exit0,q.leftExit2=q.exit2):(n.vertex(q),q.rightEntry0=q.entry0,q.rightEntry2=q.entry2,q.rightExit0=q.exit0,q.rightExit2=q.exit2,n.bridge(q),q.leftExit0=q.rightExit0,q.leftExit2=q.rightExit2),++p;else{if(x.enableOuterBisectorSplit||0<x.outerBisectorAutoSplitThreshold||x.enableInnerBisectorSplit||0<x.innerBisectorAutoSplitThreshold)for(q.canSplit=!0,e(),c(),q.splitInner=q.gapInner=q.splitOuter=q.gapOuter=!1,l(1),q.closure0=
q.leftEntry0,q.closure1=q.leftEntry1,q.closure2=q.leftEntry2;y-u>x.wrapDistance||p<t.length-1||p<t.length&&(!q.closed||x.trackDistance);)e(),c(),q.splitInner=q.gapInner=q.splitOuter=q.gapOuter=!1,l(2),n.bridge(q),q.leftExit0=q.rightExit0,q.leftExit1=q.rightExit1,q.leftExit2=q.rightExit2;else for(e(),c(),l(1),q.closure0=q.leftEntry0,q.closure1=q.leftEntry1,q.closure2=q.leftEntry2;y-u>x.wrapDistance||p<t.length-1||p<t.length&&(!q.closed||x.trackDistance);)e(),c(),l(2),n.bridge(q),q.leftExit0=q.rightExit0,
q.leftExit1=q.rightExit1,q.leftExit2=q.rightExit2;q.closed&&!x.trackDistance&&(q.rightEntry0=q.closure0,q.rightEntry1=q.closure1,q.rightEntry2=q.closure2,n.bridge(q),q.leftExit0=q.rightExit0,q.leftExit1=q.rightExit1,q.leftExit2=q.rightExit2)}};a.cleanup=function(){n=t=null};a.splitVertex=b;var t,x={},n,p=void 0,y,u,k,r,z,q=new g;g=function(){function a(a,b){this.writeVertex=a;this.writeTriangle=b;this.capType=d.CapType.BUTT;this.joinType=d.JoinType.MITER;this.miterLimitCosine=h.getLimitCosine(2);
this.roundLimitCosine=Math.cos(23*Math.PI/180);this.almostParallelCosine=.97;this.radsPerSlice=.8;this.joinOnUTurn=this.textured=!1}a.prototype.vertex=function(a){var c=this.joinType===d.JoinType.MITER?this.miterLimitCosine:this.roundLimitCosine,e=a.isCap&&this.capType!==d.CapType.BUTT,f=!1;a.cosine>this.almostParallelCosine?(a.exit0=a.entry0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.bisector.x/a.cosine,a.bisector.y/a.cosine,0,-1,a.distance),a.exit2=a.entry2=this.writeVertex(a.currentVertex.x,
a.currentVertex.y,0,0,-a.bisector.x/a.cosine,-a.bisector.y/a.cosine,0,1,a.distance)):a.cosine<1-this.almostParallelCosine?(f=!a.isCap&&this.joinOnUTurn,a.entry0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.prevNormal.x,a.prevNormal.y,0,-1,a.distance),a.entry2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.prevNormal.x,-a.prevNormal.y,0,1,a.distance),a.exit0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.nextNormal.x,a.nextNormal.y,0,-1,a.distance),a.exit2=this.writeVertex(a.currentVertex.x,
a.currentVertex.y,0,0,-a.nextNormal.x,-a.nextNormal.y,0,1,a.distance)):a.canSplit?(b(),0<a.sign?(a.splitInner?(a.exit0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,a.outbound.x,a.outbound.y,a.leftInner.x,a.leftInner.y,0,-1,a.distance),a.entry0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,a.inbound.x,a.inbound.y,a.rightInner.x,a.rightInner.y,0,-1,a.distance)):a.exit0=a.entry0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,a.inbound.x,a.inbound.y,a.bisector.x/a.cosine,a.bisector.y/
a.cosine,0,-1,a.distance),a.cosine<c?(f=!a.isCap,a.entry2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.prevNormal.x,-a.prevNormal.y,0,1,a.distance),a.exit2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.nextNormal.x,-a.nextNormal.y,0,1,a.distance)):a.splitOuter?(f=f||a.gapOuter,a.entry2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,a.inbound.x,a.inbound.y,-a.leftOuter.x,-a.leftOuter.y,0,1,a.distance),a.exit2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,a.outbound.x,
a.outbound.y,-a.rightOuter.x,-a.rightOuter.y,0,1,a.distance)):a.entry2=a.exit2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.bisector.x/a.cosine,-a.bisector.y/a.cosine,0,1,a.distance)):(a.splitInner?(a.exit2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,a.outbound.x,a.outbound.y,-a.leftInner.x,-a.leftInner.y,0,1,a.distance),a.entry2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,a.inbound.x,a.inbound.y,-a.rightInner.x,-a.rightInner.y,0,1,a.distance)):a.exit2=a.entry2=this.writeVertex(a.currentVertex.x,
a.currentVertex.y,0,0,-a.bisector.x/a.cosine,-a.bisector.y/a.cosine,0,1,a.distance),a.cosine<c?(f=!a.isCap,a.entry0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.prevNormal.x,a.prevNormal.y,0,-1,a.distance),a.exit0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.nextNormal.x,a.nextNormal.y,0,-1,a.distance)):a.splitOuter?(f=f||a.gapOuter,a.entry0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,a.inbound.x,a.inbound.y,a.leftOuter.x,a.leftOuter.y,0,-1,a.distance),a.exit0=
this.writeVertex(a.currentVertex.x,a.currentVertex.y,a.outbound.x,a.outbound.y,a.rightOuter.x,a.rightOuter.y,0,-1,a.distance)):a.exit0=a.entry0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.bisector.x/a.cosine,a.bisector.y/a.cosine,0,-1,a.distance))):0<a.sign?(a.exit0=a.entry0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,a.inbound.x,a.inbound.y,a.bisector.x/a.cosine,a.bisector.y/a.cosine,0,-1,a.distance),a.cosine<c?(f=!a.isCap,a.entry2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,
0,0,-a.prevNormal.x,-a.prevNormal.y,0,1,a.distance),a.exit2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.nextNormal.x,-a.nextNormal.y,0,1,a.distance)):a.entry2=a.exit2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.bisector.x/a.cosine,-a.bisector.y/a.cosine,0,1,a.distance)):(a.exit2=a.entry2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.bisector.x/a.cosine,-a.bisector.y/a.cosine,0,1,a.distance),a.cosine<c?(f=!a.isCap,a.entry0=this.writeVertex(a.currentVertex.x,
a.currentVertex.y,0,0,a.prevNormal.x,a.prevNormal.y,0,-1,a.distance),a.exit0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.nextNormal.x,a.nextNormal.y,0,-1,a.distance)):a.exit0=a.entry0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.bisector.x/a.cosine,a.bisector.y/a.cosine,0,-1,a.distance));c=a.canSplit&&(a.splitInner||a.splitOuter)||f||e?a.entry1=a.exit1=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,0,0,0,0,a.distance):a.entry1=a.exit1=null;if(f&&this.joinType!==
d.JoinType.ROUND)this.writeTriangle(c,0<a.sign?a.exit2:a.entry0,0<a.sign?a.entry2:a.exit0);else if(e&&this.capType===d.CapType.ROUND||f&&this.joinType===d.JoinType.ROUND){var k=f=e=void 0,l=void 0,h=void 0,m=void 0;if(a.isCap){var g=Math.PI,h=Math.ceil(g/this.radsPerSlice),m=g/h;a.isFirstVertex?(e=a.prevNormal.x,f=a.prevNormal.y,k=a.entry0,l=a.entry2):a.isLastVertex&&(e=-a.nextNormal.x,f=-a.nextNormal.y,k=a.exit2,l=a.exit0)}else g=2*Math.acos(a.cosine),h=Math.ceil(g/this.radsPerSlice),m=g/h,e=0<a.sign?
-a.prevNormal.x:a.nextNormal.x,f=0<a.sign?-a.prevNormal.y:a.nextNormal.y,k=0<a.sign?a.entry2:a.exit0,l=0<a.sign?a.exit2:a.entry0;for(var g=Math.cos(m),m=Math.sin(m),n=m*e+g*f,e=g*e-m*f,f=n,p,n=void 0,r=0;r<h;++r)p=n,r<h-1&&(n=a.isCap?this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,e,f,a.isFirstVertex?-1:1,0,a.distance):this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,e,f,0,a.sign,a.distance)),this.writeTriangle(0===r?k:p,c,r===h-1?l:n),p=m*e+g*f,e=g*e-m*f,f=p}else e&&this.capType===
d.CapType.SQUARE&&(e=a.isFirstVertex?1:-1,k=f=void 0,this.textured?(f=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.prevNormal.x-e*a.inbound.x,a.prevNormal.y-e*a.inbound.y,-e,-1,a.distance),k=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.prevNormal.x-e*a.inbound.x,-a.prevNormal.y-e*a.inbound.y,-e,1,a.distance)):(f=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.prevNormal.x-e*a.inbound.x,a.prevNormal.y-e*a.inbound.y,0,-1,a.distance),k=this.writeVertex(a.currentVertex.x,
a.currentVertex.y,0,0,-a.prevNormal.x-e*a.inbound.x,-a.prevNormal.y-e*a.inbound.y,0,1,a.distance)),0<e?(this.writeTriangle(c,a.entry2,k),this.writeTriangle(c,k,f),this.writeTriangle(c,f,a.entry0)):(this.writeTriangle(c,k,a.exit2),this.writeTriangle(c,f,k),this.writeTriangle(c,a.exit0,f)))};a.prototype.bridge=function(a){this.writeTriangle(a.leftExit0,a.rightEntry0,null!=a.leftExit1?a.leftExit1:a.leftExit2);this.writeTriangle(a.rightEntry0,null!=a.rightEntry1?a.rightEntry1:a.rightEntry2,null!=a.leftExit1?
a.leftExit1:a.leftExit2);null!=a.leftExit1&&null!=a.rightEntry1?(this.writeTriangle(a.leftExit1,a.rightEntry1,a.leftExit2),this.writeTriangle(a.rightEntry1,a.rightEntry2,a.leftExit2)):null!=a.leftExit1?this.writeTriangle(a.leftExit1,a.rightEntry2,a.leftExit2):null!=a.rightEntry1&&this.writeTriangle(a.rightEntry1,a.rightEntry2,a.leftExit2)};return a}();a.StandardTessellationCallbacks=g;g=function(){function a(a,b){this.writeVertex=a;this.writeTriangle=b}a.prototype.vertex=function(a){a.entry0=this.writeVertex(a.currentVertex.x,
a.currentVertex.y,0,0,a.prevNormal.x,a.prevNormal.y,0,-1,a.distance);a.entry2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.prevNormal.x,-a.prevNormal.y,0,1,a.distance);a.exit0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.nextNormal.x,a.nextNormal.y,0,-1,a.distance);a.exit2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.nextNormal.x,-a.nextNormal.y,0,1,a.distance)};a.prototype.bridge=function(a){this.writeTriangle(a.leftExit0,a.rightEntry0,a.leftExit2);this.writeTriangle(a.rightEntry0,
a.rightEntry2,a.leftExit2)};return a}();a.ThinTessellationCallbacks=g})},"esri/views/2d/engine/webgl/mesh/factories/matcherUtils":function(){define("require exports ../../../../../../core/tsSupport/generatorHelper ../../../../../../core/tsSupport/awaiterHelper ../../../../../../core/Error ../../../../../../core/Logger ../../util/Matcher".split(" "),function(g,a,d,h,b,e,m){Object.defineProperty(a,"__esModule",{value:!0});var c=e.getLogger("esri/views/2d/engine/webgl/mesh/factories/matcherUtils");a.createMatcher=
function(a,e,g){return h(this,void 0,void 0,function(){return d(this,function(d){switch(a.type){case "simple":case "dot-density":return[2,m.FeatureMatcher.fromBasicRenderer(a,e,g)];case "unique-value":return[2,m.MapMatcher.fromUVRenderer(a,e,g)];case "class-breaks":return[2,m.IntervalMatcher.fromCBRenderer(a,e,g)];case "dictionary":return[2,m.DictionaryMatcher.fromDictionaryRenderer(a,e,g)];default:return c.error(new b("mapview-mesh:invalid-renderer","Unable to handle unknown renderer type")),[2,
null]}})})}})},"esri/views/2d/engine/webgl/util/Matcher":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/tsSupport/generatorHelper ../../../../../core/tsSupport/awaiterHelper ../../../../../core/Logger ../../../../../core/promiseUtils ../../../../../support/arcadeOnDemand ../../../../../symbols/support/cimSymbolUtils ../../../arcade/utils".split(" "),function(g,a,d,h,b,e,m,c,l,f){Object.defineProperty(a,"__esModule",{value:!0});var t=e.getLogger("esri/views/2d/engine/webgl/util/Matcher");
g=function(){function a(){this._defaultResult=null}a.fromBasicRenderer=function(c,e,d){return b(this,void 0,void 0,function(){var b,f,m;return h(this,function(k){switch(k.label){case 0:return[4,l.expandSymbols(c.getSymbols())];case 1:return b=k.sent(),f=new a,b.length?[4,e.createTemplateGroup(b[0],null,c,d)]:[3,3];case 2:m=k.sent(),f.setDefault(m),k.label=3;case 3:return[2,f]}})})};a.prototype.size=function(){return 1};a.prototype.getDefault=function(){return this._defaultResult};a.prototype.setDefault=
function(a){this._defaultResult=a};a.prototype.match=function(a,b,c,e,d){return this.getDefault()};a.prototype.analyze=function(a,c,e,d){return b(this,void 0,void 0,function(){return h(this,function(a){return[2]})})};return a}();a.FeatureMatcher=g;e=function(a){function e(b,c,e,d){var k=a.call(this)||this;k._intervals=[];k._isMaxInclusive=c;d?k._getValue=f.callWithFeature.bind(null,d):b&&b.length?"function"===typeof b?(k._field=null,k._getValue=b):(k._field=b,k._normalizationInfo=e,k._getValue=k._getValueFromField.bind(k)):
k._field=null;return k}d(e,a);e.fromCBRenderer=function(a,d,f){return b(this,void 0,void 0,function(){var b,m,g,n,p,u,B,t,y,x,L,H,G,M,O,K,Q,P,N;return h(this,function(k){switch(k.label){case 0:return b=a.isMaxInclusive,m=a.normalizationField,g=a.normalizationTotal,n=a.normalizationType,p=a.field,u={normalizationField:m,normalizationTotal:g,normalizationType:n},(y=B=a.valueExpression)?[4,c.createRendererExpression(B,f.spatialReference,f.fields)]:[3,2];case 1:y=k.sent(),k.label=2;case 2:return t=y,
x=new e(p,b,u,t),[4,l.expandSymbol(a.backgroundFillSymbol)];case 3:L=k.sent(),H=0,G=a.classBreakInfos,k.label=4;case 4:if(!(H<G.length))return[3,8];M=G[H];return[4,l.expandSymbol(M.symbol)];case 5:return O=k.sent(),[4,d.createTemplateGroup(O,L,a,f)];case 6:K=k.sent(),Q={min:M.minValue,max:M.maxValue},x.add(Q,K),k.label=7;case 7:return H++,[3,4];case 8:return[4,l.expandSymbol(a.defaultSymbol)];case 9:return(P=k.sent())?[4,d.createTemplateGroup(P,L,a,f)]:[3,11];case 10:N=k.sent(),x.setDefault(N),k.label=
11;case 11:return[2,x]}})})};e.prototype.add=function(a,b){this._intervals.push({interval:a,result:b});this._intervals.sort(function(a,b){return a.interval.min-b.interval.min})};e.prototype.size=function(){return a.prototype.size.call(this)+this._intervals.length};e.prototype.match=function(a,b,c,e,d){if(!this._getValue)return this.getDefault();a=this._getValue(b,{$view:d},c,e);if(!a&&(null===a||void 0===a||isNaN(a)))return this.getDefault();for(b=0;b<this._intervals.length;b++)if(e=this._intervals[b],
c=e.interval,e=e.result,d=this._isMaxInclusive?a<=c.max:a<c.max,a>=c.min&&d)return e;return this.getDefault()};e.prototype._needsNormalization=function(){var a=this._normalizationInfo;return a&&(a.normalizationField||a.normalizationTotal||a.normalizationType)};e.prototype._getValueFromField=function(a){var b=a.attributes[this._field];if(!this._needsNormalization())return b;var c=this._normalizationInfo,e=c.normalizationField,d=c.normalizationTotal,c=c.normalizationType;a=!!e&&a.attributes[e];if(c)switch(c){case "field":return(a||
void 0)&&b/a;case "log":return Math.log(b)*Math.LOG10E;case "percent-of-total":return b/d*100;default:t.error("Found unknown normalization type: "+c)}else t.error("Normalization is required, but no type was set!")};return e}(g);a.IntervalMatcher=e;e=function(a){function e(b,c,e){var d=a.call(this)||this;d._nullResult=null;d._resultsMap=new Map;e?d._getValue=f.callWithFeature.bind(null,e):b&&b.length?"function"===typeof b[0]?(d._fields=null,d._getValue=b[0]):(d._fields=b,d._seperator=c||"",d._getValue=
d._getValueFromFields.bind(d)):d._fields=null;return d}d(e,a);e.fromUVRenderer=function(a,d,f){return b(this,void 0,void 0,function(){var b,m,g,n,p,u,B,t,y,x,L,H,G,M,O;return h(this,function(k){switch(k.label){case 0:return b=a.uniqueValueInfos,m=a.fieldDelimiter,g=[a.field],n=a.valueExpression,a.field2&&g.push(a.field2),a.field3&&g.push(a.field3),[4,l.expandSymbol(a.backgroundFillSymbol)];case 1:return p=k.sent(),(B=n)?[4,c.createRendererExpression(n,f.spatialReference,f.fields)]:[3,3];case 2:B=
k.sent(),k.label=3;case 3:u=B,t=new e(g,m,u),y=0,x=b,k.label=4;case 4:if(!(y<x.length))return[3,8];L=x[y];return[4,l.expandSymbol(L.symbol)];case 5:return H=k.sent(),[4,d.createTemplateGroup(H,p,a,f)];case 6:G=k.sent(),"\x3cNull\x3e"===L.value?t.setNullResult(G):t.add(L.value,G),k.label=7;case 7:return y++,[3,4];case 8:return[4,l.expandSymbol(a.defaultSymbol)];case 9:return(M=k.sent())?[4,d.createTemplateGroup(a.defaultSymbol,p,a,f)]:[3,11];case 10:O=k.sent(),t.setDefault(O),k.label=11;case 11:return[2,
t]}})})};e.prototype.setNullResult=function(a){this._nullResult=a};e.prototype.add=function(a,b){this._resultsMap.set(a.toString(),b)};e.prototype.size=function(){return a.prototype.size.call(this)+this._resultsMap.size};e.prototype.match=function(a,b,c,e,d){if(!this._getValue)return this.getDefault();a=this._getValue(b,{$view:d},c,e);if(null!==this._nullResult&&(null==a||""===a||"\x3cNull\x3e"===a))return this._nullResult;if(!a&&null==a)return this.getDefault();a=a.toString();return this._resultsMap.has(a)?
this._resultsMap.get(a):this.getDefault()};e.prototype._getValueFromFields=function(a){for(var b=[],c=0,e=this._fields;c<e.length;c++)b.push(a.attributes[e[c]]);return b.join(this._seperator)};return e}(g);a.MapMatcher=e;g=function(a){function c(b,c,e){var d=a.call(this)||this;d._fidToAttributeHash=new Map;d._attributeHashToGroup=new Map;d._renderer=b;d._fieldMap=b.fieldMap;d._templates=c;d._info=e;return d}d(c,a);c.fromDictionaryRenderer=function(a,e,d){return b(this,void 0,void 0,function(){return h(this,
function(b){a.fetchResources({spatialReference:d.spatialReference,fields:d.fields});return[2,new c(a,e,d)]})})};c.prototype.analyze=function(a,c,e,d){return b(this,void 0,void 0,function(){var b,f,k,l,g,n,p=this;return h(this,function(h){switch(h.label){case 0:b=[];f=function(c){var f=c.attributes[a],l=k._fidToAttributeHash.get(f),h=k._hashAttributes(c);if(l===h)return"continue";k._fidToAttributeHash.set(f,h);k._attributeHashToGroup.has(h)||(c=k._renderer.getSymbolAsync(c,{scale:e&&e.scale,viewingMode:e&&
e.viewingMode,spatialReference:k._info.spatialReference,abortOptions:d,fields:k._info.fields}).then(function(a){return p._templates.createTemplateGroup(a,null,p._renderer,p._info).then(function(a){return p._attributeHashToGroup.set(h,a)})}),b.push(c))};k=this;l=0;for(g=c;l<g.length;l++)n=g[l],f(n);return[4,m.all(b)];case 1:return h.sent(),[2]}})})};c.prototype.match=function(a,b){a=this._fidToAttributeHash.get(b.attributes[a]);return this._attributeHashToGroup.get(a)};c.prototype._hashAttributes=
function(a){var b="",c;for(c in this._fieldMap)b+=". "+a.attributes[this._fieldMap[c]];return b};return c}(g);a.DictionaryMatcher=g})},"esri/views/2d/engine/webgl/mesh/factories/WGLMeshFactory":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/tsSupport/generatorHelper ../../../../../../core/tsSupport/awaiterHelper ../../../../../../core/Error ../../../../../../core/has ../../../../../../core/Logger ../../../../../../core/maybe ../../../../../../core/promiseUtils ../../../../../../geometry/SpatialReference ../../../../../../geometry/support/jsonUtils ../../../../../../symbols/SimpleLineSymbol ../../definitions ../../enums ../../WGLDisplayObject ../MeshData ../VertexVector ../templates/WGLLabelTemplate ../templates/WGLLineTemplate ../templates/WGLMarkerTemplate ../templates/WGLTemplateStore".split(" "),
function(g,a,d,h,b,e,m,c,l,f,t,x,n,p,y,u,k,r,z,q,E,A){function B(a){var b=(a.attributes?Object.keys(a.attributes):[]).map(function(b){return{name:b,alias:b,type:"string"===typeof a.attributes[b]?"esriFieldTypeString":"esriFieldTypeDouble"}});return{geometryType:null!=a.centroid?"esriGeometryPolygon":x.getJsonType(a.geometry),spatialReference:t.fromJSON(a.geometry.spatialReference),fields:b}}Object.defineProperty(a,"__esModule",{value:!0});var C=c.getLogger("esri.views.2d.engine.webgl.WGLMeshFactory"),
D={esriGeometryPoint:"above-right above-center above-left center-center center-left center-right below-center below-left below-right".split(" "),esriGeometryPolygon:["always-horizontal"],esriGeometryPolyline:["center-along"],esriGeometryMultipoint:null,esriGeometryEnvelope:null};g=function(){function a(a,b,c,e,d,f){this._isDD=!1;this._labelsDebugTemplate=null;this._isDD=l.isSome(c)&&"dot-density"===c.type;this._geometryType=a;this._idField=b;this._templateStore=e;this._setLabelTemplates(d,c,f)}a.prototype.update=
function(a,b,c){this._isDD=l.isSome(b)&&"dot-density"===b.type;this._setLabelTemplates(a,b,c)};a.prototype._setLabelTemplates=function(a,b,c){a&&this._validateLabelingInfo(a)&&(this._labelTemplates=a.map(function(a){return z.default.fromLabelClass(b,a,c)}))};Object.defineProperty(a.prototype,"templates",{get:function(){return this._templateStore},enumerable:!0,configurable:!0});a.prototype.createMeshData=function(a){var b=Array(5),c=this._labelTemplates&&0<this._labelTemplates.length,e="esriGeometryPolyline"===
this._geometryType?p.HEURISTIC_GLYPHS_PER_LINE:p.HEURISTIC_GLYPHS_PER_FEATURE;b[y.WGLGeometryType.MARKER]=new r.VertexVectors(y.WGLGeometryType.MARKER,a);b[y.WGLGeometryType.FILL]=new r.VertexVectors(y.WGLGeometryType.FILL,a,this._isDD);b[y.WGLGeometryType.LINE]=new r.VertexVectors(y.WGLGeometryType.LINE,a);b[y.WGLGeometryType.TEXT]=new r.VertexVectors(y.WGLGeometryType.TEXT,a);b[y.WGLGeometryType.LABEL]=new r.VertexVectors(y.WGLGeometryType.LABEL,c?e:0);return new k.MeshData([],b)};a.prototype.analyze=
function(a,c,e,d,k,g){return b(this,void 0,void 0,function(){var b,m,n,p,r,q,z,u,t,y,C;return h(this,function(h){switch(h.label){case 0:return b=a,f.isAborted(g)?[2,[]]:l.isSome(e)?[4,e.analyze(this._idField,a,k,g)]:[3,2];case 1:h.sent(),h.label=2;case 2:m=0,n=b,h.label=3;case 3:if(!(m<n.length))return[3,10];p=n[m];r=-1;if(!c)return[3,7];q=p;if(null==q.symbol)return[3,5];z=null;"cim"===q.symbol.type&&(z=B(p));return[4,this._templateStore.createTemplateGroup(q.symbol,null,null,z)];case 4:return r=
h.sent(),[3,6];case 5:l.isSome(e)&&(r=e.match(this._idField,p,null,null,k)),h.label=6;case 6:return[3,8];case 7:l.isSome(e)&&(r=e.match(this._idField,p,this._geometryType,d,k)),h.label=8;case 8:if(A.isDynamicId(r))for(u=this._templateStore.getDynamicTemplateGroup(r),t=0,y=u;t<y.length;t++)(C=y[t])&&C.analyze&&C.analyze(this._templateStore,p,d,k);p.groupId=r;h.label=9;case 9:return m++,[3,3];case 10:return[2,this._templateStore.finalize(g).then(function(){return b})]}})})};a.prototype.write=function(a,
b,c,e,d,f,k){var l=this._templateStore.getTemplateGroup(b.groupId),h=b.localId;if(null!=h){var g=new u(h),m=!!f&&!!this._labelTemplates&&f.has(h);if(A.isDynamicId(b.groupId))for(var n=0;n<l.length;n++){var p=l[n];p.bindFeature(b,c,e)}if(l&&(b.geometry||b.centroid)){e=g.displayRecords;p=b.insertAfter;void 0!==p&&(g.insertAfter=p);(c=this._geometryType)||(c=null!=b.centroid?"esriGeometryPolygon":x.getJsonType(b.geometry));for(n=0;n<l.length;n++){var p=l[n],r=a.get(p.geometryType);p.writeMesh(e,r,c,
h,b)}m&&(l=this._getLabelReference(l),f=f.get(h),this._writeLabelMesh(g,a,h,b,k,f,l,d,c));a.pushDisplayObject(g)}}};a.prototype._hasBadLabelClass=function(a,b){var c=a.labelPlacement,d=D[b];if(!a.symbol)return C.warn("No LabelClass symbol specified."),!0;if(!d)return C.error(new e("mapview-labeling:unsupported-geometry-type","Unable to create labels for Feature Layer, "+b+" is not supported")),!0;d.some(function(a){return a===c})||(d=d[0],c&&C.warn("Found invalid label placement type "+c+" for "+
b+". Defaulting to "+d),a.labelPlacement=d);return!1};a.prototype._validateLabelingInfo=function(a){var b=this;return!a.some(function(a){return b._hasBadLabelClass(a,b._geometryType)})};a.prototype._getLabelReference=function(a){for(var b=0;b<a.length;b++){var c=a[b];if(c instanceof E.default)return c}return null};a.prototype._writeLabelMesh=function(a,b,c,e,d,f,k,l,h){for(var g=a.displayRecords,m=[],n=0;n<f.length;n++){var r=f[n],q=r.text,z=r.rtl,r=this._labelTemplates[r.id],u=b.get(r.geometryType),
B=d.get(r.symbolId).glyphMosaicItems;r.bindReferenceTemplate(k);r.bindTextInfo(B,q,z);r.writeMesh(g,u,h,c,e,l,m)}a.metrics=m;p.DEBUG_LABELS&&this._debugLabels(a,b)};a.prototype._debugLabels=function(a,b){var c=a.displayRecords,e=a.id,d=0;for(a=a.metrics;d<a.length;d++)for(var f=a[d],k=0,l=f.boxes?f.boxes.concat([f.bounds]):[f.bounds];k<l.length;k++){var h=l[k],h={geometry:{paths:[[[f.anchor[0]+f.offsetX+h.center[0]-h.width/2,f.anchor[1]+f.offsetY+h.center[1]+h.height/2],[0,-h.height],[h.width,0],
[0,h.height],[-h.width,0]]]},attributes:{}},g=this._getLabelDebugTemplate(),m=b.get(g.geometryType);g.writeMesh(c,m,"esriGeometryPolyline",e,h)}};a.prototype._getLabelDebugTemplate=function(){this._labelsDebugTemplate||(this._labelsDebugTemplate=this._createLabelsDebugTemplate());return this._labelsDebugTemplate};a.prototype._createLabelsDebugTemplate=function(){var a=new n({style:"solid",width:1,color:[255,0,0,1]});return q.default.fromSimpleLine(null,!1,a,null,!1)};return a}();a.WGLMeshFactory=
g})},"esri/views/2d/engine/webgl/WGLDisplayObject":function(){define(["require","exports","./WGLDisplayRecord","./collisions/Metric","./util/serializationUtils"],function(g,a,d,h,b){return function(){function a(a){this.insertAfter=null;this.id=a;this.displayRecords=[];this.metrics=[]}a.prototype.copy=function(){var b=new a(this.id);b.set(this);return b};a.prototype.clone=function(){var b=new a(this.id);b.displayRecords=this.displayRecords.map(function(a){return a.clone()});b.metrics=this.metrics.map(function(a){return a.clone()});
b.insertAfter=this.insertAfter;return b};a.prototype.set=function(a){this.id=a.id;this.displayRecords=a.displayRecords;this.metrics=a.metrics;this.insertAfter=a.insertAfter};a.prototype.serialize=function(a){a.push(this.id);b.serializeList(a,this.metrics);b.serializeList(a,this.displayRecords);return a};a.deserialize=function(e){var c=e.readInt32(),l=new a(c),c={id:c},f=b.deserializeList(e,h.default);f.length&&(l.metrics=f);l.displayRecords=b.deserializeList(e,d,c);return l};return a}()})},"esri/views/2d/engine/webgl/mesh/MeshData":function(){define(["require",
"exports","../util/serializationUtils","../util/Writer"],function(g,a,d,h){Object.defineProperty(a,"__esModule",{value:!0});g=function(){function a(a,b){this.displayObjects=a;this.vertexVectorsMap=b}Object.defineProperty(a.prototype,"vertexBuffersMap",{get:function(){if(!this._vertexBuffersMap){this._vertexBuffersMap={};for(var a=0;a<this.vertexVectorsMap.length;a++)this._vertexBuffersMap[a]=this.vertexVectorsMap[a].intoBuffers();this.vertexVectorsMap=null}return this._vertexBuffersMap},enumerable:!0,
configurable:!0});a.prototype.get=function(a){return this.vertexVectorsMap[a]};a.prototype.pushDisplayObject=function(a){this.displayObjects.push(a)};a.prototype.encode=function(a,b){var c=d.serializeList(new h.default(Uint32Array,this._guessSize()),this.displayObjects).buffer(),e={};b.push(c);for(var f=0;f<this.vertexVectorsMap.length;f++){var g=this.vertexVectorsMap[f];e[f]={};g.transfer(e[f],b)}a.displayObjects=c;a.vertexBuffersMap=e;this.destroy()};a.prototype.destroy=function(){this.displayObjects=
this.vertexVectorsMap=null};a.prototype._guessSize=function(){for(var a=this.displayObjects,b=Math.min(a.length,4),c=0,d=0;d<b;d++)c=Math.max(c,a[d].displayRecords.length);return 2*(12*a.length+a.length*c*40)};return a}();a.MeshData=g})},"esri/views/2d/engine/webgl/util/Writer":function(){define(["require","exports"],function(g,a){Object.defineProperty(a,"__esModule",{value:!0});g=function(){function a(a,b){this._pos=0;b=b?this._roundToNearest(b,a.BYTES_PER_ELEMENT):40;this._array=new ArrayBuffer(b);
this._buffer=new a(this._array);this._ctor=a}Object.defineProperty(a.prototype,"length",{get:function(){return this._pos},enumerable:!0,configurable:!0});a.prototype._roundToNearest=function(a,b){a=Math.round(a);return a+(b-a%b)};a.prototype._ensureSize=function(a){if(this._pos+a>=this._buffer.length){a=this._roundToNearest(1.5*(this._array.byteLength+a*this._buffer.BYTES_PER_ELEMENT),this._buffer.BYTES_PER_ELEMENT);a=new ArrayBuffer(a);var b=new this._ctor(a);b.set(this._buffer,0);this._array=a;
this._buffer=b}};a.prototype.writeF32=function(a){this._ensureSize(1);var b=this._pos;(new Float32Array(this._array,4*this._pos,1))[0]=a;this._pos++;return b};a.prototype.push=function(a){this._ensureSize(1);var b=this._pos;this._buffer[this._pos++]=a;return b};a.prototype.writeRegion=function(a){this._ensureSize(a.length);var b=this._pos;this._buffer.set(a,this._pos);this._pos+=a.length;return b};a.prototype.buffer=function(){var a=this._array.slice(0,4*this._pos);this.destroy();return a};a.prototype.seek=
function(a){this._pos=a};a.prototype.destroy=function(){this._buffer=this._array=null};return a}();a.default=g})},"esri/views/2d/engine/webgl/mesh/VertexVector":function(){define(["require","exports","../Utils","./VertexBuffer","../util/Writer"],function(g,a,d,h,b){Object.defineProperty(a,"__esModule",{value:!0});var e=function(){function a(a,b){this.data=a;this.stride=b}Object.defineProperty(a.prototype,"vertexCount",{get:function(){return this.data.length/(this.stride/4)},enumerable:!0,configurable:!0});
a.prototype.transfer=function(a,b){var c=this.data.buffer();a.vertexCount=this.vertexCount;a.data=c;a.stride=this.stride;b.push(c)};return a}();a.default=e;g=function(){function a(a,l,f){void 0===f&&(f=!1);this.geometryType=a;this.indexVector=new b.default(Uint32Array,l);this.namedVectors={};a=d.getStrides(a,f);for(var c in a){f=a[c];var h=void 0;switch(f%4){case 0:case 2:h=new b.default(Uint32Array,f/4*l);break;case 1:case 3:h=new b.default(Uint8Array,f*l)}this.namedVectors[c]=new e(h,f)}}a.prototype.get=
function(a){return this.namedVectors[a].data};a.prototype.getVector=function(a){return this.namedVectors[a]};a.prototype.transfer=function(a,b){var c=this.indexVector.buffer(),e={};b.push(c);for(var d in this.namedVectors){var l=this.namedVectors[d];e[d]={};l.transfer(e[d],b)}a.geometryType=this.geometryType;a.indexBuffer=c;a.namedBuffers=e;this.destroy()};a.prototype.intoBuffers=function(){var a=h.VertexBuffers.fromVertexVectors(this);this.destroy();return a};a.prototype.destroy=function(){this.namedVectors=
this.indexVector=null};return a}();a.VertexVectors=g})},"esri/views/2d/engine/webgl/mesh/VertexBuffer":function(){define(["require","exports","../Utils"],function(g,a,d){Object.defineProperty(a,"__esModule",{value:!0});var h=function(){function a(a,b,c){this.data=a;this.stride=b;this.vertexCount=c}a.decode=function(b){var e=d.allocateTypedArrayBufferwithData(b.data,b.stride);return new a(e,b.stride,b.vertexCount)};a.fromVertexVector=function(b){var e=d.allocateTypedArrayBufferwithData(b.data.buffer(),
b.stride);return new a(e,b.stride,b.vertexCount)};return a}();a.default=h;g=function(){function a(a,b,c){this.geometryType=a;this.indexBuffer=new Uint32Array(b);this.namedBuffers=c}a.decode=function(b){var e=b.geometryType,c=b.indexBuffer,d={},f;for(f in b.namedBuffers)d[f]=h.decode(b.namedBuffers[f]);return new a(e,c,d)};a.fromVertexVectors=function(b){var e=b.geometryType,c=b.indexVector.buffer(),d={},f;for(f in b.namedVectors)d[f]=h.fromVertexVector(b.namedVectors[f]);return new a(e,c,d)};return a}();
a.VertexBuffers=g})},"esri/views/2d/engine/webgl/mesh/templates/WGLLineTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/Logger ../../../../../../core/screenUtils ../../../../../../symbols/cim/enums ../../color ../../number ../../Utils ../../materialKey/MaterialKey ./util ./WGLBaseLineTemplate ./WGLMeshTemplate".split(" "),function(g,a,d,h,b,e,m,c,l,f,t,x,n){Object.defineProperty(a,"__esModule",{value:!0});var p=h.getLogger("esri.views.2d.engine.webgl.WGLLineTemplate");
g=function(a){function h(b,c,e,d,l,h,g,m,n,p,u,y,x,M,O,K){var k=a.call(this)||this;b=f.LineMaterialKey.load(f.createMaterialKey(k.geometryType,b,x));c&&(b.sdf=c.sdf,b.pattern=!0,b.textureBinding=c.textureBinding);k._capType=d;k._joinType=l;k._miterLimitCosine=t.getLimitCosine(h);k.tessellationProperties._fillColor=g;k.tessellationProperties._tl=m;k.tessellationProperties._br=n;k._hasPattern=p;k._isDashed=u;k._joinOnUTurn=K;k._isColorLocked=y;k._isOutline=x;k._zOrder=O;k._materialKey=b.data;k.tessellationProperties._bitset=
y?1:0;k.tessellationProperties._halfWidth=.5*e;k.tessellationProperties._halfReferenceWidth=.5*M;k._initializeTessellator(!1);return k}d(h,a);h.fromCIMLine=function(a,d,f,l,g,n){var k=d.color,p=d.isDashed,r=d.cap;p&&r===e.CapType.ROUND&&(r=e.CapType.SQUARE);var q=d.join;n*=b.pt2px(d.width);var z=b.pt2px(d.referenceWidth),u=b.pt2px(d.miterLimit),k=k&&m.premultiplyAlphaRGBA(k)||0;if(!f)return new h(a,f,n,r,q,u,k,0,0,!1,p,d.colorLocked,l,z,d.zOrder,g);var t=f.rect,y=t.x+1+f.width,A=t.y+1+f.height,t=
c.i1616to32(t.x+1,t.y+1),y=c.i1616to32(y,A);return new h(a,f,n,r,q,u,k,t,y,!0,p,d.colorLocked,l,z,d.zOrder,g)};h.fromSimpleLine=function(a,e,d,f,g){var k=d.color,n="solid"!==d.style&&"none"!==d.style,p=l.getCapType(d.cap||"round",n),r=l.getJoinType(d.join||"round"),k=k&&"none"!==d.style&&m.premultiplyAlphaRGBA(k)||0;"none"===d.style&&(k=0);var q=b.pt2px(d.width);d=d.miterLimit;if(!f)return new h(a,f,q,p,r,d,k,0,0,!1,n,!1,e,q,0,g);var z=f.rect,u=z.x+1+f.width,t=z.y+1+f.height,z=c.i1616to32(z.x+1,z.y+
1),u=c.i1616to32(u,t);return new h(a,f,q,p,r,d,k,z,u,!0,n,!1,e,q,0,g)};h.fromPictureLineSymbol=function(a,b,c,e){p.error("PictureLineSymbol support does not exist!");return null};return h}(x.default(n.default));a.default=g})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseLineTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/has ../../../../../../core/Logger ../../definitions ../../enums ../../number ../../TileClipper ../../TurboLine ../../WGLDisplayRecord ../../materialKey/MaterialKey".split(" "),
function(g,a,d,h,b,e,m,c,l,f,t,x){Object.defineProperty(a,"__esModule",{value:!0});var n=b.getLogger("esri.views.2d.engine.webgl.WGLLineTemplateBase"),p=e.TILE_SIZE+16,y=1/3.8,u=new l.TileClipper(0,0,0,1,16);u.setExtent(e.TILE_SIZE);var k=new Uint32Array(9),r=new Uint32Array(36),z=new Uint32Array(3),q=new Uint32Array(6),E=function(a){return function(b){b.entry0=a.offset+a.vertexCount++;var e=c.i1616to32(b.distance,31*a._halfWidth),d=c.i8888to32(Math.round(31*b.prevNormal.x),Math.round(31*b.prevNormal.y),
Math.round(0),Math.round(-31)),f=c.i8888to32(0,0,0,a._bitset);r[0]=c.i1616to32(b.currentVertex.x,b.currentVertex.y);r[1]=a.id;r[2]=a._fillColor;r[3]=d;r[4]=e;r[5]=a._tl;r[6]=a._br;r[7]=f;r[8]=c.i1616to32(31*a._halfReferenceWidth,0);b.entry2=a.offset+a.vertexCount++;e=c.i1616to32(b.distance,31*a._halfWidth);d=c.i8888to32(Math.round(31*-b.prevNormal.x),Math.round(31*-b.prevNormal.y),Math.round(0),Math.round(31));f=c.i8888to32(0,0,0,a._bitset);r[9]=c.i1616to32(b.currentVertex.x,b.currentVertex.y);r[10]=
a.id;r[11]=a._fillColor;r[12]=d;r[13]=e;r[14]=a._tl;r[15]=a._br;r[16]=f;r[17]=c.i1616to32(31*a._halfReferenceWidth,0);b.exit0=a.offset+a.vertexCount++;e=c.i1616to32(b.distance,31*a._halfWidth);d=c.i8888to32(Math.round(31*b.nextNormal.x),Math.round(31*b.nextNormal.y),Math.round(0),Math.round(-31));f=c.i8888to32(0,0,0,a._bitset);r[18]=c.i1616to32(b.currentVertex.x,b.currentVertex.y);r[19]=a.id;r[20]=a._fillColor;r[21]=d;r[22]=e;r[23]=a._tl;r[24]=a._br;r[25]=f;r[26]=c.i1616to32(31*a._halfReferenceWidth,
0);b.exit2=a.offset+a.vertexCount++;e=c.i1616to32(b.distance,31*a._halfWidth);d=c.i8888to32(Math.round(31*-b.nextNormal.x),Math.round(31*-b.nextNormal.y),Math.round(0),Math.round(31));f=c.i8888to32(0,0,0,a._bitset);r[27]=c.i1616to32(b.currentVertex.x,b.currentVertex.y);r[28]=a.id;r[29]=a._fillColor;r[30]=d;r[31]=e;r[32]=a._tl;r[33]=a._br;r[34]=f;r[35]=c.i1616to32(31*a._halfReferenceWidth,0);a.geometryBuf.writeRegion(r)}},A=function(a){return function(b){q[0]=b.leftExit0;q[1]=b.rightEntry0;q[2]=b.leftExit2;
q[3]=b.rightEntry0;q[4]=b.rightEntry2;q[5]=b.leftExit2;a.indexCount+=6;a.indexBuf.writeRegion(q)}},B=function(a){return function(b,e,d,f,l,h,g,m,n){n=c.i1616to32(n,31*a._halfWidth);l=c.i8888to32(Math.round(31*l),Math.round(31*h),Math.round(31*g),Math.round(31*m));d=c.i8888to32(31*d,31*f,0,a._bitset);k[0]=c.i1616to32(b,e);k[1]=a.id;k[2]=a._fillColor;k[3]=l;k[4]=n;k[5]=a._tl;k[6]=a._br;k[7]=d;k[8]=c.i1616to32(31*a._halfReferenceWidth,0);a.geometryBuf.writeRegion(k);return a.offset+a.vertexCount++}},
C=function(a){return function(b,c,e){z[0]=b;z[1]=c;z[2]=e;a.indexCount+=3;a.indexBuf.writeRegion(z)}};a.default=function(a){return function(a){function b(){for(var b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];b=a.apply(this,b)||this;b.tessellationProperties={_fillColor:null,_tl:null,_br:null,_halfWidth:null,_bitset:null,_halfReferenceWidth:null,id:null,indexBuf:null,indexCount:null,geometryBuf:null,vertexCount:null,offset:null};b._tessellationOptions={};b.geometryType=m.WGLGeometryType.LINE;
return b}d(b,a);b.prototype.writeMesh=function(a,b,c,e,d){var f=b.indexVector,k=b.get("geometry"),l=new t(e,this.geometryType,this._materialKey);b=b.getVector("geometry").vertexCount;l.vertexFrom=b;l.indexFrom=f.length;switch(c){case "esriGeometryPolyline":c=this._clipLines(d.geometry.paths);if(0===c.length)break;this._write(l,f,k,b,e,c);a.push(l);break;case "esriGeometryPolygon":c=this._clipLines(d.geometry.rings);if(0===c.length)break;this._write(l,f,k,b,e,c);a.push(l);break;default:n.error("Unable to handle geometryType: "+
c)}};b.prototype._clipLines=function(a){for(var b=[],c=!1,e=0;e<a.length;){var d=[],f=a[e];u.reset(2);var k=f[0],l=k[0],k=k[1];if(c)u.moveTo(l,k);else{if(-16>l||l>p||-16>k||k>p){c=!0;continue}d.push({x:l,y:k})}for(var h=!1,g=f.length,m=1;m<g;++m)if(l+=f[m][0],k+=f[m][1],c)u.lineTo(l,k);else{if(-16>l||l>p||-16>k||k>p){h=!0;break}d.push({x:l,y:k})}if(h)c=!0;else{if(c){if(d=u.resultWithStarts())for(c=0;c<d.length;c++)b.push(d[c])}else b.push({line:d,start:0});e++;c=!1}}return b};b.prototype._write=function(a,
b,c,e,d,k){this.tessellationProperties.id=d;this.tessellationProperties.indexBuf=b;this.tessellationProperties.indexCount=0;this.tessellationProperties.geometryBuf=c;this.tessellationProperties.vertexCount=0;this.tessellationProperties.offset=e;for(b=0;b<k.length;b++)c=k[b],e=c.line,2>e.length||(this._tessellationOptions.initialDistance=c.start%65535,this._tessellationCallbacks instanceof f.StandardTessellationCallbacks&&(this._tessellationCallbacks.capType=this._capType,this._tessellationCallbacks.joinType=
this._joinType),f.tessellate(e,this._tessellationOptions,this._tessellationCallbacks),f.cleanup());a.vertexCount=this.tessellationProperties.vertexCount;a.indexCount=this.tessellationProperties.indexCount;a.zOrder=this._zOrder};b.prototype._initializeTessellator=function(a){var b=x.LineMaterialKey.load(this._materialKey);this._tessellationOptions.trackDistance=this._isDashed||this._hasPattern;this._tessellationOptions.thin=!a&&this.tessellationProperties._halfWidth<e.THIN_LINE_THRESHOLD/2&&!(b.vvSizeFieldStops||
b.vvSizeMinMaxValue||b.vvSizeScaleStops||b.vvSizeUnitValue);this._tessellationOptions.wrapDistance=65535;this._tessellationOptions.outerBisectorAutoSplitThreshold=y;this._tessellationOptions.enableOuterBisectorSplit=this._isDashed||this._hasPattern;this._tessellationOptions.innerBisectorAutoSplitThreshold=y;this._tessellationOptions.enableInnerBisectorSplit=this._isDashed||this._hasPattern;this._tessellationOptions.thin?this._tessellationCallbacks={vertex:E(this.tessellationProperties),bridge:A(this.tessellationProperties)}:
(a=new f.StandardTessellationCallbacks(B(this.tessellationProperties),C(this.tessellationProperties)),a.miterLimitCosine=this._miterLimitCosine,a.textured=this._isDashed||this._hasPattern,a.joinOnUTurn=this._joinOnUTurn,this._tessellationCallbacks=a)};return b}(a)}})},"esri/views/2d/engine/webgl/mesh/templates/WGLMarkerTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/screenUtils ../../../../../../core/libs/gl-matrix-2/mat2d ../../../../../../core/libs/gl-matrix-2/mat2df32 ../../../../../../core/libs/gl-matrix-2/vec2 ../../../../../../core/libs/gl-matrix-2/vec2f32 ../../../../../../symbols/cim/enums ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./WGLBaseMarkerTemplate ./WGLMeshTemplate".split(" "),
function(g,a,d,h,b,e,m,c,l,f,t,x,n,p,y){Object.defineProperty(a,"__esModule",{value:!0});g=function(a){function k(d,f,k,h,g,p,u,t,y,L,H,G,M,O,K,Q,P,N,J){var r=a.call(this)||this;r.height=u;r.width=p;r.xOffset=f*J;r.yOffset=k*J;f=c.vec2f32.create();k=e.mat2df32.create();H=(O===l.Alignment.MAP?1:0)|(H?1:0)<<1|(M?1:0)<<2|(G?1:0)<<3;G=K&&K.sdf;b.mat2d.translate(k,k,c.vec2f32.fromValues(r.xOffset,-r.yOffset));h&&b.mat2d.rotate(k,k,3.14159265359/180*h);d=n.MarkerMaterialKey.load(n.createMaterialKey(r.geometryType,
d,!1));d.sdf=G;d.pattern=!0;d.textureBinding=K.textureBinding;r._materialKey=d.data;r._fillColor=g;r._outlineColor=y;r._sizeOutlineWidth=x.i8888to32(Math.round(Math.sqrt(256*p)),Math.round(Math.sqrt(256*u)),Math.round(Math.sqrt(256*L)),Math.round(Math.sqrt(256*t)));g=K.rect.x;t=K.rect.y;y=g+K.rect.width;L=t+K.rect.height;Q=.5-((.5+Q)*K.width+1)/K.rect.width;P=.5-((.5+P)*K.height+1)/K.rect.height;d=Math.round(Math.min(64*N,255));p*=K.rect.width/K.width*N*J;u*=K.rect.height/K.height*N*J;K=(Q-.5)*p;
P=(P-.5)*u;r._bitestAndDistRatio=x.i8888to32(0,0,H,d);m.vec2.set(f,K,P);m.vec2.transformMat2d(f,f,k);r._offsetUpperLeft=x.i1616to32(16*f[0],16*f[1]);r._texUpperLeft=x.i1616to32(g,t);m.vec2.set(f,K+p,P);m.vec2.transformMat2d(f,f,k);r._offsetUpperRight=x.i1616to32(16*f[0],16*f[1]);r._texUpperRight=x.i1616to32(y,t);m.vec2.set(f,K,P+u);m.vec2.transformMat2d(f,f,k);r._offsetBottomLeft=x.i1616to32(16*f[0],16*f[1]);r._texBottomLeft=x.i1616to32(g,L);m.vec2.set(f,K+p,P+u);m.vec2.transformMat2d(f,f,k);r._offsetBottomRight=
x.i1616to32(16*f[0],16*f[1]);r._texBottomRight=x.i1616to32(y,L);return r}d(k,a);k.fromCIMMarker=function(a,b,c,e){var d=b.size,g=(c&&c.width||1)/(c&&c.height||1)*b.scaleX,m=b.scaleSymbolsProportionally&&b.frameHeight?d/b.frameHeight:1,n=f.premultiplyAlphaRGBA(b.color),p=f.premultiplyAlphaRGBA(b.outlineColor),r=h.pt2px(d),q=r*g,u=h.pt2px(b.offsetX||0),z=h.pt2px(b.offsetY||0),m=h.pt2px(b.outlineWidth||0)*m,t=b.alignment||l.Alignment.SCREEN,y=h.pt2px(b.referenceSize),x=b.rotation||0;b.rotateClockwise||
(x=-x);var E=0,N=0,J=b.anchorPoint;J&&(b.isAbsoluteAnchorPoint?d&&(E=-J.x/(d*g),N=J.y/d):(E=J.x,N=J.y));return new k(a,u,z,x,n,q,r,y,p,m,b.colorLocked,b.scaleSymbolsProportionally,!1,t,c,E,N,b.sizeRatio,e)};k.fromPictureMarker=function(a,b,c){var e=Math.round(h.pt2px(b.width)),d=Math.round(h.pt2px(b.height)),f=t.PICTURE_FILL_COLOR,g=Math.round(h.pt2px(b.xoffset||0)),m=Math.round(h.pt2px(b.yoffset||0));return new k(a,g,m,b.angle,f,e,d,d,0,0,!1,!1,!1,l.Alignment.SCREEN,c,0,0,1,1)};k.fromSimpleMarker=
function(a,b,c){var e=f.premultiplyAlphaRGBA(b.color),d=Math.round(h.pt2px(b.size)),g=Math.round(h.pt2px(b.xoffset||0)),m=Math.round(h.pt2px(b.yoffset||0)),n=b.style,p=b.outline,r=(p&&p.color&&f.premultiplyAlphaRGBA(p.color))|0,p=(p&&p.width&&Math.round(h.pt2px(p.width)))|0;return new k(a,g,m,b.angle,e,d,d,d,r,p,!1,!1,"cross"===n||"x"===n,l.Alignment.SCREEN,c,0,0,1.96875,1)};return k}(p.default(y.default));a.default=g})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseMarkerTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/Logger ../../enums ../../number ../../WGLDisplayRecord".split(" "),
function(g,a,d,h,b,e,m){Object.defineProperty(a,"__esModule",{value:!0});var c=h.getLogger("esri.views.2d.engine.webgl.WGLMarkerTemplateBase");a.default=function(a){return function(a){function f(){for(var c=[],e=0;e<arguments.length;e++)c[e]=arguments[e];c=a.apply(this,c)||this;c.xOffset=0;c.yOffset=0;c.width=0;c.height=0;c.geometryType=b.WGLGeometryType.MARKER;return c}d(f,a);f.prototype.writeMesh=function(a,b,e,d,f){var k=b.indexVector,l=b.get("geometry"),h=new m(d,this.geometryType,this._materialKey);
b=b.getVector("geometry").vertexCount;a.push(h);h.vertexFrom=b;h.indexFrom=k.length;switch(e){case "esriGeometryPoint":e=f.geometry;a=e.x;e=e.y;this._writeVertices(h,l,d,this._getPos(a,e));this._writeIndices(h,k,b);break;case "esriGeometryPolyline":this._writeMany(h,k,l,b,d,f.geometry.paths[0]);break;case "esriGeometryPolygon":(e=f.centroid)?(a=e.x,e=e.y,this._writeVertices(h,l,d,this._getPos(a,e)),this._writeIndices(h,k,b)):c.error("Tried to render polygon geometries as markers, but found no centroid!");
break;case "esriGeometryMultipoint":this._writeMany(h,k,l,b,d,f.geometry.points);break;default:c.error("Unable to handle geometryType: "+e)}};f.prototype._getPos=function(a,b){return e.i1616to32(a,b)};f.prototype._writeMany=function(a,b,c,e,d,f){for(var k=0,l=0,h=0,g=0;g<f.length;g++){var m=f[g],n=m[0],m=m[1],p=this._getPos(n+k,m+l);this._writeVertices(a,c,d,p);this._writeIndices(a,b,e+h);k+=n;l+=m;h+=4}};f.prototype._writeVertices=function(a,b,c,e){b.push(e);b.push(this._offsetUpperLeft);b.push(this._texUpperLeft);
b.push(this._bitestAndDistRatio);b.push(c);b.push(this._fillColor);b.push(this._outlineColor);b.push(this._sizeOutlineWidth);b.push(e);b.push(this._offsetUpperRight);b.push(this._texUpperRight);b.push(this._bitestAndDistRatio);b.push(c);b.push(this._fillColor);b.push(this._outlineColor);b.push(this._sizeOutlineWidth);b.push(e);b.push(this._offsetBottomLeft);b.push(this._texBottomLeft);b.push(this._bitestAndDistRatio);b.push(c);b.push(this._fillColor);b.push(this._outlineColor);b.push(this._sizeOutlineWidth);
b.push(e);b.push(this._offsetBottomRight);b.push(this._texBottomRight);b.push(this._bitestAndDistRatio);b.push(c);b.push(this._fillColor);b.push(this._outlineColor);b.push(this._sizeOutlineWidth);a.vertexCount+=4};f.prototype._writeIndices=function(a,b,c){b.push(c+0);b.push(c+1);b.push(c+2);b.push(c+1);b.push(c+3);b.push(c+2);a.indexCount+=6};return f}(a)}})},"esri/views/2d/engine/webgl/mesh/templates/WGLTemplateStore":function(){define("require exports ../../../../../../core/tsSupport/awaiterHelper ../../../../../../core/tsSupport/generatorHelper ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/promiseUtils ../../../../../../support/arcadeOnDemand ../../../../../../symbols/cim/cimAnalyzer ../../../../../../symbols/support/defaults ../../../../arcade/utils ./WGLDynamicLineTemplate ./WGLDynamicMarkerTemplate ./WGLDynamicTextTemplate ./WGLFillTemplate ./WGLLineTemplate ./WGLMarkerTemplate ./WGLTextTemplate ../../util/BidiText ../../util/Lock ../../util/Result".split(" "),
function(g,a,d,h,b,e,m,c,l,f,t,x,n,p,y,u,k,r,z,q,E){function A(a,b){var c=a.length;a.push(null);b.then(function(b){return a[c]=b});return a}function B(a){return!!(a&1)}Object.defineProperty(a,"__esModule",{value:!0});var C=e.getLogger("esri.views.2d.engine.webgl.mesh.templates.WGLTemplateStore"),D=[];a.isDynamicId=B;g=function(){function a(a,b){this._templateIdCounter=this._idCounter=0;this._idToTemplateGroup=new Map;this._symbolToTemplate=new Map;this._fetchQueue=[];this._idToResolver=new Map;this._cimTemplateCache=
new Map;this._cimAnalyses=[];this._lock=new q.default;this._fetchResource=a;this._joinOnUTurn=b}Object.defineProperty(a.prototype,"_markerError",{get:function(){return this._errorTemplates.marker[0]},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"_fillError",{get:function(){return this._errorTemplates.fill[0]},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"_lineError",{get:function(){return this._errorTemplates.line[0]},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"_textError",{get:function(){return this._errorTemplates.line[0]},enumerable:!0,configurable:!0});a.prototype.createTemplateGroup=function(a,b,c,e){return d(this,void 0,void 0,function(){var d,f,k;return h(this,function(l){switch(l.label){case 0:return[4,this._initErrorTemplates()];case 1:l.sent();d=JSON.stringify(a);if(this._symbolToTemplate.has(d))return[2,this._symbolToTemplate.get(d)];f=[];return b?[4,this._createMeshTemplates(f,b,c,e,!0)]:[3,3];case 2:l.sent(),l.label=3;case 3:return[4,this._createMeshTemplates(f,
a,c,e,!1)];case 4:return l.sent(),k=this._createGroupId("cim"===a.type),this._idToTemplateGroup.set(k,f),this._symbolToTemplate.set(d,k),[2,k]}})})};a.prototype.getCIMMosaicItem=function(a,b){var c=this,e=this._createTemplateId(),d=m.create(function(a){return c._idToResolver.set(e,a)});this._fetchQueue.push({symbol:a,id:e,glyphIds:b});return d};a.prototype.getTemplateGroup=function(a){return this._idToTemplateGroup.has(a)?this._idToTemplateGroup.get(a):D};a.prototype.getDynamicTemplateGroup=function(a){if(!this._idToTemplateGroup.has(a))return D;
B(a)||C.error("mapview-template-store","Id "+a+" does not refer to a dynamic template");return this._idToTemplateGroup.get(a)};a.prototype.finalize=function(a){return this._fetchQueue.length||this._lock.isHeld()?q.withLock(this._lock,this._fetchAllQueuedResources.bind(this),a):m.resolve()};a.prototype._initErrorTemplates=function(){return d(this,void 0,void 0,function(){var a,b,c,e;return h(this,function(d){switch(d.label){case 0:if(this._errorTemplates)return[2];a=this._createMeshTemplates([],f.errorPolygonSymbol2D,
null,null,!1);b=this._createMeshTemplates([],f.errorPointSymbol2D,null,null,!1);c=this._createMeshTemplates([],f.errorPolylineSymbol2D,null,null,!1);return[4,m.all([a,b,c])];case 1:return e=d.sent(),this._errorTemplates={fill:e[0],marker:e[1],line:e[2]},[2]}})})};a.prototype._fetchAllQueuedResources=function(a){var c=this;if(!this._fetchQueue.length)return m.resolve();var e=this._fetchQueue,d=this._cimAnalyses;this._fetchQueue=[];this._cimAnalyses=[];return m.all(d).then(function(){return c._fetchResource(e,
a).then(function(a){for(var b=0;b<a.length;b++){var e=a[b],d=e.id,e=e.mosaicItem;c._idToResolver.get(d)(e);c._idToResolver.delete(d)}})}).catch(function(a){m.isAbortError(a)?c._fetchQueue=c._fetchQueue.concat(e):C.error(new b("mapview-template-store","Unable to fetch requested texture resources",a))})};a.prototype._createGroupId=function(a){return this._idCounter++<<1|(a?1:0)};a.prototype._createTemplateId=function(){return this._templateIdCounter++};a.prototype._getCodepoints=function(a){a=z.bidiText(a.text)[0];
for(var b=[],c=0;c<a.length;c++)b.push(a.charCodeAt(c));return b};a.prototype._getMosaicItem=function(a){var b=this,c=this._createTemplateId(),e="text"===a.type&&this._getCodepoints(a),d=m.create(function(a){return b._idToResolver.set(c,a)});this._fetchQueue.push({symbol:a.toJSON(),id:c,glyphIds:e});return d};a.prototype._createSMS=function(a,b){return d(this,void 0,void 0,function(){var c;return h(this,function(e){switch(e.label){case 0:return[4,this._getMosaicItem(a)];case 1:return c=e.sent().spriteMosaicItem,
E.ok(c,C)?[2,k.default.fromSimpleMarker(b,a,c)]:[2,this._markerError]}})})};a.prototype._createPMS=function(a,b){return d(this,void 0,void 0,function(){var c;return h(this,function(e){switch(e.label){case 0:return[4,this._getMosaicItem(a)];case 1:return c=e.sent().spriteMosaicItem,E.ok(c,C)?[2,k.default.fromPictureMarker(b,a,c)]:[2,this._markerError]}})})};a.prototype._createSFS=function(a,b,c){return d(this,void 0,void 0,function(){var e,d;return h(this,function(f){switch(f.label){case 0:return[4,
this._getMosaicItem(a)];case 1:return e=f.sent().spriteMosaicItem,d=a,E.ok(e,C)?[2,y.default.fromSimpleFill(b,d,e,c)]:[2,this._fillError]}})})};a.prototype._createPFS=function(a,b,c){return d(this,void 0,void 0,function(){var e,d;return h(this,function(f){switch(f.label){case 0:return[4,this._getMosaicItem(a)];case 1:return e=f.sent().spriteMosaicItem,d=a,E.ok(e,C)?[2,y.default.fromPictureFill(b,d,e,c)]:[2,this._fillError]}})})};a.prototype._createSLS=function(a,b,c){return d(this,void 0,void 0,function(){var e,
d;return h(this,function(f){switch(f.label){case 0:return[4,this._getMosaicItem(a)];case 1:return e=f.sent().spriteMosaicItem,d=a,E.ok(e,C)?[2,u.default.fromSimpleLine(b,c,d,e,this._joinOnUTurn)]:[2,this._lineError]}})})};a.prototype._createTS=function(a,b){return d(this,void 0,void 0,function(){var c;return h(this,function(e){switch(e.label){case 0:return[4,this._getMosaicItem(a)];case 1:return c=e.sent().glyphMosaicItems,[2,r.default.fromText(b,a,c)]}})})};a.prototype._createCIMText=function(a,
b,c){return d(this,void 0,void 0,function(){var e,d,f,k,l,g;return h(this,function(h){switch(h.label){case 0:if("function"===typeof a.materialHash||"function"===typeof c)return[2,m.resolve(p.default.fromCIMText(b,a,c))];e=[];if(d=a.text)for(f=d.length,k=0;k<f;k++)l=d.charCodeAt(k),e.push(l);a.cim.mosaicHash=a.materialHash;return[4,this.getCIMMosaicItem(a.cim,e)];case 1:return g=h.sent().glyphMosaicItems,E.ok(g,C)?[2,r.default.fromCIMText(b,a,c,g)]:[2,this._textError]}})})};a.prototype._createCIMFill=
function(a,b){return d(this,void 0,void 0,function(){var c;return h(this,function(e){switch(e.label){case 0:return a.cim.mosaicHash=a.materialHash,[4,this.getCIMMosaicItem(a.cim)];case 1:return c=e.sent().spriteMosaicItem,E.ok(c,C)?[2,y.default.fromCIMFill(b,a,c,!1)]:[2,this._fillError]}})})};a.prototype._createCIMLine=function(a,b,c){return d(this,void 0,void 0,function(){var e;return h(this,function(d){switch(d.label){case 0:if("function"===typeof a.materialHash||"function"===typeof c)return[2,
m.resolve(x.default.fromCIMLine(b,a,c))];a.cim.mosaicHash=a.materialHash;return[4,this.getCIMMosaicItem(a.cim)];case 1:return e=d.sent().spriteMosaicItem,E.ok(e,C)?[2,u.default.fromCIMLine(b,a,e,!1,this._joinOnUTurn,c)]:[2,this._lineError]}})})};a.prototype._createCIMMarker=function(a,b,c){return d(this,void 0,void 0,function(){var e;return h(this,function(d){switch(d.label){case 0:if("function"===typeof a.materialHash||"function"===typeof c)return[2,m.resolve(n.default.fromCIMMarker(b,a,c))];a.cim.mosaicHash=
a.materialHash;return[4,this.getCIMMosaicItem(a.cim)];case 1:return e=d.sent().spriteMosaicItem,E.ok(e,C)?[2,k.default.fromCIMMarker(b,a,e,c)]:[2,this._markerError]}})})};a.prototype._createCIM=function(a,b,c){return d(this,void 0,void 0,function(){var e,d,f=this;return h(this,function(k){e=a.templateHash;if(this._cimTemplateCache.has(e))return[2,this._cimTemplateCache.get(e)];switch(a.type){case "marker":d=this._createCIMMarker(a,b,c);break;case "line":d=this._createCIMLine(a,b,c);break;case "fill":d=
this._createCIMFill(a,b);break;case "text":d=this._createCIMText(a,b,c)}d.then(function(a){return f._cimTemplateCache.set(e,a)});return[2,d]})})};a.prototype._getCIMSymbolLayers=function(a,b,c){return d(this,void 0,void 0,function(){var e,d;return h(this,function(f){switch(f.label){case 0:return e=[],d=[],e.push(l.analyzeCIMSymbol(a.data,b,c,d)),[4,m.all(e)];case 1:return f.sent(),[2,d]}})})};a.prototype._createCIMMeshTemplates=function(a,b,e,f){return d(this,void 0,void 0,function(){var d,k,l,g,
m,n,p,r,q,u,z;return h(this,function(h){switch(h.label){case 0:k=(d=e)?d.fieldMap:null;l=b;if(!d||!d.scaleExpression)return[3,3];if(!isNaN(d.scaleExpression))return[3,2];n=d.scaleExpression;return[4,c.createRendererExpression(n,f.spatialReference,f.fields)];case 1:return p=h.sent(),g=function(a,b,c){a=t.callWithFeature(p,a,{$view:c},f.geometryType,b);return null!==a?a:1},[3,3];case 2:m=Number(d.scaleExpression),h.label=3;case 3:return[4,this._getCIMSymbolLayers(l,k,f)];case 4:r=h.sent();q=0;for(u=
r;q<u.length;q++)z=u[q],A(a,this._createCIM(z,e,m||g||1));return[2]}})})};a.prototype._createMeshTemplates=function(a,b,c,e,f){return d(this,void 0,void 0,function(){var d,k,l;return h(this,function(h){switch(h.label){case 0:if(-1!==b.type.indexOf("3d"))return C.error("3D symbols are not supported with MapView"),[2,a];d=b.type;switch(d){case "cim":return[3,1];case "simple-marker":return[3,3];case "picture-marker":return[3,4];case "simple-fill":return[3,5];case "picture-fill":return[3,6];case "simple-line":return[3,
7];case "text":return[3,8]}return[3,9];case 1:return[4,this._createCIMMeshTemplates(a,b,c,e)];case 2:return h.sent(),[2,a];case 3:return[2,A(a,this._createSMS(b,c))];case 4:return[2,A(a,this._createPMS(b,c))];case 5:return k=b,A(a,this._createSFS(k,c,f)),k.outline&&A(a,this._createSLS(k.outline,c,!0)),[2,a];case 6:return l=b,A(a,this._createPFS(l,c,f)),l.outline&&A(a,this._createSLS(l.outline,c,!0)),[2,a];case 7:return[2,A(a,this._createSLS(b,c,!1))];case 8:return[2,A(a,this._createTS(b,c))];case 9:return C.error("Unable to create mesh template for unknown symbol type {: $ }{symbol.type}"),
[2,a]}})})};return a}();a.WGLTemplateStore=g})},"esri/symbols/cim/cimAnalyzer":function(){define("require exports ../../core/tsSupport/generatorHelper ../../core/tsSupport/awaiterHelper ../../core/tsSupport/assignHelper ../../Color ../../core/Logger ../../core/promiseUtils ../../core/string ../../support/arcadeOnDemand ./CIMSymbolHelper ./enums ./SDFHelper ../../views/2d/arcade/utils".split(" "),function(g,a,d,h,b,e,m,c,l,f,t,x,n,p){function y(a){return a?{r:a[0],g:a[1],b:a[2],a:a[3]/255}:{r:0,g:0,
b:0,a:0}}function u(a){switch(a){case "Butt":return x.CapType.BUTT;case "Square":return x.CapType.SQUARE;default:return x.CapType.ROUND}}function k(a){switch(a){case "Bevel":return x.JoinType.BEVEL;case "Miter":return x.JoinType.MITER;default:return x.JoinType.ROUND}}function r(a){switch(a){default:return"left";case "Right":return"right";case "Center":return"center";case "Justify":return"justify"}}function z(a){switch(a){default:return"top";case "Center":return"middle";case "Baseline":return"baseline";
case "Bottom":return"bottom"}}function q(a){var b="normal",c="normal";a&&(a=a.toLowerCase(),-1!==a.indexOf("italic")?b="italic":-1!==a.indexOf("oblique")&&(b="oblique"),-1!==a.indexOf("bold")?c="bold":-1!==a.indexOf("light")&&(c="lighter"));return{style:b,weight:c}}function E(a,b,c,e,f,k){return h(this,void 0,void 0,function(){var l,h,g,m,n,p,r;return d(this,function(d){switch(d.label){case 0:if(!a)return[2];l=a.symbolLayers;if(!l)return[2];g=t.CIMSymbolHelper.getSize(a);"CIMPointSymbol"===a.type&&
"Map"===a.angleAlignment&&(h=x.Alignment.MAP);m=l.length;d.label=1;case 1:if(!m--)return[3,23];n=l[m];if(!n||!1===n.enable)return[3,1];p=[];t.OverrideHelper.findApplicableOverrides(n,b,p);r=n.type;switch(r){case "CIMSolidFill":return[3,2];case "CIMPictureFill":return[3,4];case "CIMHatchFill":return[3,6];case "CIMGradientFill":return[3,8];case "CIMSolidStroke":return[3,10];case "CIMPictureStroke":return[3,12];case "CIMGradientStroke":return[3,14];case "CIMCharacterMarker":return[3,16];case "CIMPictureMarker":return[3,
17];case "CIMVectorMarker":return[3,19]}return[3,21];case 2:return[4,A(n,p,e,f)];case 3:return d.sent(),[3,22];case 4:return[4,B(n,p,e,f)];case 5:return d.sent(),[3,22];case 6:return[4,C(n,p,e,f)];case 7:return d.sent(),[3,22];case 8:return[4,D(n,p,e,f)];case 9:return d.sent(),[3,22];case 10:return[4,I(n,p,e,f,"CIMPolygonSymbol"===a.type,g)];case 11:return d.sent(),[3,22];case 12:return[4,L(n,p,e,f,"CIMPolygonSymbol"===a.type,g)];case 13:return d.sent(),[3,22];case 14:return[4,H(n,p,e,f,"CIMPolygonSymbol"===
a.type,g)];case 15:return d.sent(),[3,22];case 16:return[3,22];case 17:return[4,G(n,p,e,f,h,g)];case 18:return d.sent(),[3,22];case 19:return[4,M(n,p,c,e,f,h,g,k)];case 20:return d.sent(),[3,22];case 21:X.error("Cannot analyze CIM layer",n.type),d.label=22;case 22:return[3,1];case 23:return[2]}})})}function A(a,b,c,e){return h(this,void 0,void 0,function(){var f,k,h,g,m,n;return d(this,function(d){switch(d.label){case 0:return f=a.primitiveName,k=y(a.color),h=l.numericHash(JSON.stringify(a)).toString(),
m=(g=e).push,n={type:"fill",templateHash:h,materialHash:0===b.length?h:function(){return h},cim:a,materialOverrides:null,colorLocked:a.colorLocked},[4,J(f,"Color",b,c,k,N)];case 1:return m.apply(g,[(n.color=d.sent(),n.height=0,n.angle=0,n.offsetX=0,n.offsetY=0,n.scaleX=1,n)]),[2]}})})}function B(a,b,c,e){return h(this,void 0,void 0,function(){var f,k,h,g,m,n,p;return d(this,function(d){switch(d.label){case 0:return f=a.primitiveName,k=y(a.tintColor),h=l.numericHash(JSON.stringify(a)).toString(),g=
l.numericHash(""+a.url+JSON.stringify(a.colorSubstitutions)).toString(),n=(m=e).push,p={type:"fill",templateHash:h,materialHash:0===b.length?g:function(){return g},cim:a,materialOverrides:null,colorLocked:a.colorLocked},[4,J(f,"TintColor",b,c,k,N)];case 1:return p.color=d.sent(),[4,J(f,"Height",b,c,a.height)];case 2:return p.height=d.sent(),[4,J(f,"ScaleX",b,c,a.scaleX)];case 3:return p.scaleX=d.sent(),[4,J(f,"Rotation",b,c,a.rotation)];case 4:return p.angle=d.sent(),[4,J(f,"OffsetX",b,c,a.offsetX)];
case 5:return p.offsetX=d.sent(),[4,J(f,"OffsetY",b,c,a.offsetY)];case 6:return n.apply(m,[(p.offsetY=d.sent(),p)]),[2]}})})}function C(a,b,c,e){return h(this,void 0,void 0,function(){var f,k,h,g,m,n,p,r;return d(this,function(d){switch(d.label){case 0:f=["Rotation","OffsetX","OffsetY"];k=b.filter(function(b){return b.primitiveName!==a.primitiveName&&-1===f.indexOf(b.propertyName)});h=a.primitiveName;g=l.numericHash(JSON.stringify(a)).toString();n=(m=e).push;p={type:"fill",templateHash:g};if(0!==
b.length)return[3,1];r=g;return[3,3];case 1:return[4,W(g,k,c)];case 2:r=d.sent(),d.label=3;case 3:return p.materialHash=r,p.cim=a,p.materialOverrides=k,p.colorLocked=a.colorLocked,p.color={r:128,g:128,b:128,a:1},p.height=0,p.scaleX=1,[4,J(h,"Rotation",b,c,a.rotation)];case 4:return p.angle=d.sent(),[4,J(h,"OffsetX",b,c,a.offsetX)];case 5:return p.offsetX=d.sent(),[4,J(h,"OffsetY",b,c,a.offsetY)];case 6:return n.apply(m,[(p.offsetY=d.sent(),p)]),[2]}})})}function D(a,b,c,e){return h(this,void 0,void 0,
function(){var f,k,h,g,m;return d(this,function(d){switch(d.label){case 0:f=l.numericHash(JSON.stringify(a)).toString();h=(k=e).push;g={type:"fill",templateHash:f};if(0!==b.length)return[3,1];m=f;return[3,3];case 1:return[4,W(f,b,c)];case 2:m=d.sent(),d.label=3;case 3:return h.apply(k,[(g.materialHash=m,g.cim=a,g.materialOverrides=null,g.colorLocked=a.colorLocked,g.color={r:128,g:128,b:128,a:1},g.height=0,g.angle=0,g.offsetX=0,g.offsetY=0,g.scaleX=1,g)]),[2]}})})}function I(a,b,c,e,f,g){return h(this,
void 0,void 0,function(){var h,m,n,p,r,q,z,t,B,A;return d(this,function(d){switch(d.label){case 0:return h=l.numericHash(JSON.stringify(a)).toString(),m=a.primitiveName,n=y(a.color),p=void 0!==a.width?a.width:4,r=u(a.capStyle),q=k(a.joinStyle),z=a.miterLimit,B=(t=e).push,A={type:"line",templateHash:h,materialHash:0===b.length?h:function(){return h},cim:a,materialOverrides:null,isOutline:f,colorLocked:a.colorLocked},[4,J(m,"Color",b,c,n,N)];case 1:return A.color=d.sent(),[4,J(m,"Width",b,c,p)];case 2:return A.width=
d.sent(),[4,J(m,"CapStyle",b,c,r)];case 3:return A.cap=d.sent(),[4,J(m,"JoinStyle",b,c,q)];case 4:return A.join=d.sent(),[4,J(m,"MiterLimit",b,c,z)];case 5:return B.apply(t,[(A.miterLimit=d.sent(),A.referenceWidth=g,A.zOrder=P(a.name),A.isDashed=!1,A)]),[2]}})})}function L(a,b,c,e,f,g){return h(this,void 0,void 0,function(){var h,m,n,p,r,q,z,t,B,A,C;return d(this,function(d){switch(d.label){case 0:return h=l.numericHash(""+a.url+JSON.stringify(a.colorSubstitutions)).toString(),m=a.primitiveName,n=
y(a.tintColor),p=void 0!==a.width?a.width:4,r=u(a.capStyle),q=k(a.joinStyle),z=a.miterLimit,t=l.numericHash(JSON.stringify(a)).toString(),A=(B=e).push,C={type:"line",templateHash:t,materialHash:0===b.length?h:function(){return h},cim:a,materialOverrides:null,isOutline:f,colorLocked:a.colorLocked},[4,J(m,"TintColor",b,c,n,N)];case 1:return C.color=d.sent(),[4,J(m,"Width",b,c,p)];case 2:return C.width=d.sent(),[4,J(m,"CapStyle",b,c,r)];case 3:return C.cap=d.sent(),[4,J(m,"JoinStyle",b,c,q)];case 4:return C.join=
d.sent(),[4,J(m,"MiterLimit",b,c,z)];case 5:return A.apply(B,[(C.miterLimit=d.sent(),C.referenceWidth=g,C.zOrder=P(a.name),C.isDashed=!1,C)]),[2]}})})}function H(a,b,c,e,f,g){return h(this,void 0,void 0,function(){var h,m,n,p,r,q,z,t,B,y;return d(this,function(d){switch(d.label){case 0:h=a.primitiveName;m=void 0!==a.width?a.width:4;n=u(a.capStyle);p=k(a.joinStyle);r=a.miterLimit;q=l.numericHash(JSON.stringify(a)).toString();t=(z=e).push;B={type:"line",templateHash:q};if(0!==b.length)return[3,1];y=
q;return[3,3];case 1:return[4,W(q,b,c)];case 2:y=d.sent(),d.label=3;case 3:return B.materialHash=y,B.cim=a,B.materialOverrides=null,B.isOutline=f,B.colorLocked=a.colorLocked,B.color={r:128,g:128,b:128,a:1},[4,J(h,"Width",b,c,m)];case 4:return B.width=d.sent(),[4,J(h,"CapStyle",b,c,n)];case 5:return B.cap=d.sent(),[4,J(h,"JoinStyle",b,c,p)];case 6:return B.join=d.sent(),[4,J(h,"MiterLimit",b,c,r)];case 7:return t.apply(z,[(B.miterLimit=d.sent(),B.referenceWidth=g,B.zOrder=P(a.name),B.isDashed=!1,B)]),
[2]}})})}function G(a,b,c,e,f,k){return h(this,void 0,void 0,function(){var h,g,m,n,p,r,q,u,z,t,B,A,C,x,w,E;return d(this,function(d){switch(d.label){case 0:h=a.primitiveName;g=a.size;m=a.scaleX;n=a.rotation;p=a.offsetX;r=a.offsetY;q=y(a.tintColor);u=l.numericHash(""+a.url+JSON.stringify(a.colorSubstitutions)).toString();z=!1;t="";B=0;for(A=b;B<A.length;B++)C=A[B],C.primitiveName===h&&(void 0!==C.value?t+="|"+C.primitiveName+"|"+C.propertyName+"|"+JSON.stringify(C.value):C.valueExpressionInfo&&(z=
!0));w=(x=e).push;E={type:"marker",templateHash:l.numericHash(JSON.stringify(a)+t).toString(),materialHash:z?function(){return u}:u,cim:a,materialOverrides:null,colorLocked:a.colorLocked,scaleSymbolsProportionally:!1,alignment:f,anchorPoint:a.anchorPoint,isAbsoluteAnchorPoint:"Relative"!==a.anchorPointUnits};return[4,J(h,"Size",b,c,g)];case 1:return E.size=d.sent(),[4,J(h,"ScaleX",b,c,m)];case 2:return E.scaleX=d.sent(),[4,J(h,"Rotation",b,c,n)];case 3:return E.rotation=d.sent(),[4,J(h,"OffsetX",
b,c,p)];case 4:return E.offsetX=d.sent(),[4,J(h,"OffsetY",b,c,r)];case 5:return E.offsetY=d.sent(),[4,J(h,"TintColor",b,c,q,N)];case 6:return w.apply(x,[(E.color=d.sent(),E.outlineColor={r:0,g:0,b:0,a:0},E.outlineWidth=0,E.frameHeight=0,E.rotateClockwise=a.rotateClockwise,E.referenceSize=k,E.sizeRatio=1,E)]),[2]}})})}function M(a,b,e,f,k,l,g,m){return h(this,void 0,void 0,function(){var h,n,p,r,q,u,z,t;return d(this,function(d){switch(d.label){case 0:h=a.markerGraphics;if(!h)return[2];n=0;a.scaleSymbolsProportionally&&
(p=a.frame)&&(n=p.ymax-p.ymin);r=[];q=0;for(u=h;q<u.length;q++)if(z=u[q])if(t=z.symbol)switch(t.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":r.push(K(a,z,b,f,k,l,g,n,m));break;case "CIMTextSymbol":r.push(O(a,z,b,e,f,k,l,g,n))}return[4,c.all(r)];case 1:return d.sent(),[2]}})})}function O(a,c,e,f,k,g,m,n,p){return h(this,void 0,void 0,function(){var h,u,B,A,C,x,E,S,v,D,O,w,I,ea,ca,fa,ba,L,H,K,P,G,da,N;return d(this,function(d){switch(d.label){case 0:h=[];t.OverrideHelper.findApplicableOverrides(c,
e,h);u=c.geometry;if(!("x"in u&&"y"in u))return[2];B=c.symbol;A=B.underline?"underline":B.strikethrough?"line-through":"none";C=q(B.fontStyleName);B.font=b({family:B.fontFamilyName,decoration:A},C);x=a.frame;E=u.x-.5*(x.xmin+x.xmax);S=u.y-.5*(x.ymin+x.ymax);v=a.size/p;D=a.primitiveName;O=(B.height||0)*v;w=B.angle||0;I=((B.offsetX||0)+E)*v;ea=((B.offsetY||0)+S)*v;ca=y(t.CIMSymbolHelper.getFillColor(B));fa=y(t.CIMSymbolHelper.getStrokeColor(B));ba=t.CIMSymbolHelper.getStrokeWidth(B);ba||(fa=y(t.CIMSymbolHelper.getFillColor(B.haloSymbol)),
ba=B.haloSize*v);L="";H=0;for(K=e;H<K.length;H++)P=K[H],P.primitiveName===D&&void 0!==P.value&&(L+="|"+P.primitiveName+"|"+P.propertyName+"|"+JSON.stringify(P.value));da=(G=g).push;N={type:"text",templateHash:l.numericHash(JSON.stringify(c)+L).toString(),materialHash:function(){return l.numericHash(JSON.stringify(B.font)).toString()},cim:B,materialOverrides:null,colorLocked:a.colorLocked,alignment:m,anchorPoint:{x:a.anchorPoint?a.anchorPoint.x:0,y:a.anchorPoint?a.anchorPoint.y:0},isAbsoluteAnchorPoint:"Relative"!==
a.anchorPointUnits,fontName:B.fontFamilyName,decoration:"none",weight:"normal",style:"normal"};return[4,J(D,"Height",e,k,O)];case 1:return N.size=d.sent(),[4,J(D,"Rotation",e,k,w)];case 2:return N.angle=d.sent(),[4,J(D,"OffsetX",e,k,I)];case 3:return N.offsetX=d.sent(),[4,J(D,"OffsetY",e,k,ea)];case 4:return da.apply(G,[(N.offsetY=d.sent(),N.horizontalAlignment=r(B.horizontalAlignment),N.verticalAlignment=z(B.verticalAlignment),N.text=Y(f,c.textString,B.textCase),N.color=ca,N.outlineColor=fa,N.outlineSize=
ba,N.referenceSize=n,N.sizeRatio=1,N)]),[2]}})})}function K(a,b,c,e,f,k,g,m,p){return h(this,void 0,void 0,function(){var h,r,q,u,B,z;return d(this,function(A){switch(A.label){case 0:h=b.symbol;r=b.geometry;if(!r)return[2];q=n.getExtent(r);if("CIMTextSymbol"===h.type)return[2];u=h.symbolLayers;if(!u)return[2];B=u.length;z=function(){var h,z,A,C,x,E,S,D,O,I,ea,ca,fa,L,ba,H,K,P,G,da,ma,ja,na,M,R,Z,ha,T,V;return d(this,function(d){switch(d.label){case 0:return(h=u[B])&&!1!==h.enable?p?[4,Q(a,b,c,e,f,
k,g,m)]:[3,2]:[2,"continue"];case 1:return d.sent(),[2,"continue"];case 2:z=h.type;switch(z){case "CIMSolidFill":return[3,3];case "CIMSolidStroke":return[3,3]}return[3,15];case 3:A=n.getSDFMetrics(q,a.frame,a.size,a.anchorPoint,"Relative"!==a.anchorPointUnits);C=A[0];x=A[1];E=A[2];S="CIMSolidFill"===h.type;D={type:"sdf",geom:r,asFill:S};O=a.primitiveName;I=a.size;ea=a.rotation;ca=a.offsetX;fa=a.offsetY;L=h.primitiveName;ba=S?y(t.CIMSymbolHelper.getFillColor(h)):y(t.CIMSymbolHelper.getStrokeColor(h));
H=S?{r:0,g:0,b:0,a:0}:y(t.CIMSymbolHelper.getStrokeColor(h));K=t.CIMSymbolHelper.getStrokeWidth(h);if(!S&&!K)return[3,16];P=!1;G="";da=0;for(ma=c;da<ma.length;da++)if(ja=ma[da],ja.primitiveName===L||ja.primitiveName===O)void 0!==ja.value?G+="|"+ja.primitiveName+"|"+ja.propertyName+"|"+JSON.stringify(ja.value):ja.valueExpressionInfo&&(P=!0);na=l.numericHash(JSON.stringify(D)).toString();M=l.numericHash(JSON.stringify(h)+JSON.stringify(b)+G).toString();Z=(R=f).push;ha={type:"marker",templateHash:M,
materialHash:P?function(){return na}:na,cim:D,materialOverrides:null,colorLocked:a.colorLocked,scaleSymbolsProportionally:a.scaleSymbolsProportionally,alignment:k,anchorPoint:{x:x,y:E},isAbsoluteAnchorPoint:!1};return[4,J(O,"Size",c,e,I)];case 4:return ha.size=d.sent(),ha.scaleX=1,[4,J(O,"Rotation",c,e,ea)];case 5:return ha.rotation=d.sent(),[4,J(O,"OffsetX",c,e,ca)];case 6:return ha.offsetX=d.sent(),[4,J(O,"OffsetY",c,e,fa)];case 7:return ha.offsetY=d.sent(),[4,J(L,"Color",c,e,ba,N)];case 8:ha.color=
d.sent();if(!S)return[3,9];T={r:0,g:0,b:0,a:0};return[3,11];case 9:return[4,J(L,"Color",c,e,H,N)];case 10:T=d.sent(),d.label=11;case 11:ha.outlineColor=T;if(!S)return[3,12];V=0;return[3,14];case 12:return[4,J(L,"Width",c,e,K)];case 13:V=d.sent(),d.label=14;case 14:return Z.apply(R,[(ha.outlineWidth=V,ha.frameHeight=m,ha.rotateClockwise=a.rotateClockwise,ha.referenceSize=g,ha.sizeRatio=C,ha)]),[3,16];case 15:return Q(a,b,c,e,f,k,g,m),[3,16];case 16:return[2]}})};A.label=1;case 1:return B--?[5,z()]:
[3,3];case 2:return A.sent(),[3,1];case 3:return[2]}})})}function Q(a,b,c,e,f,k,g,m){return h(this,void 0,void 0,function(){var h,n,p,r,q,u,z,B,y,A,C,x,w,E,S,D;return d(this,function(d){switch(d.label){case 0:h={type:a.type,enable:!0,name:a.name,colorLocked:a.colorLocked,primitiveName:a.primitiveName,anchorPoint:a.anchorPoint,anchorPointUnits:a.anchorPointUnits,offsetX:0,offsetY:0,rotateClockwise:a.rotateClockwise,rotation:0,size:a.size,billboardMode3D:a.billboardMode3D,depth3D:a.depth3D,frame:a.frame,
markerGraphics:[b],scaleSymbolsProportionally:a.scaleSymbolsProportionally,respectFrame:a.respectFrame,clippingPath:a.clippingPath};n=[];p=["Rotation","OffsetX","OffsetY"];n=c.filter(function(b){return b.primitiveName!==a.primitiveName||-1===p.indexOf(b.propertyName)});r=t.CIMSymbolHelper.getTextureAnchor(h);q=r[0];u=r[1];z=JSON.stringify(h);B=a.primitiveName;y=a.rotation;A=a.offsetX;C=a.offsetY;x=l.numericHash(JSON.stringify(h)).toString();E=(w=f).push;S={type:"marker",templateHash:x};if(0!==n.length)return[3,
1];D=x;return[3,3];case 1:return[4,W(z,n,e)];case 2:D=d.sent(),d.label=3;case 3:return S.materialHash=D,S.cim=h,S.materialOverrides=n,S.colorLocked=a.colorLocked,S.scaleSymbolsProportionally=a.scaleSymbolsProportionally,S.alignment=k,S.anchorPoint={x:q,y:u},S.isAbsoluteAnchorPoint=!1,S.size=a.size,S.scaleX=1,[4,J(B,"Rotation",c,e,y)];case 4:return S.rotation=d.sent(),[4,J(B,"OffsetX",c,e,A)];case 5:return S.offsetX=d.sent(),[4,J(B,"OffsetY",c,e,C)];case 6:return E.apply(w,[(S.offsetY=d.sent(),S.color=
{r:0,g:0,b:0,a:0},S.outlineColor={r:0,g:0,b:0,a:0},S.outlineWidth=0,S.frameHeight=m,S.rotateClockwise=a.rotateClockwise,S.referenceSize=g,S.sizeRatio=1,S)]),[2]}})})}function P(a){return a&&0===a.indexOf("Level_")?parseInt(a.substr(6),10):0}function N(a){if(!a||0===a.length)return null;a=(new e(a)).toRgba();return{r:a[0],g:a[1],b:a[2],a:a[3]}}function J(a,b,c,e,k,l){return h(this,void 0,void 0,function(){var h,g,m,n,r;return d(this,function(q){switch(q.label){case 0:if(!a)return[3,4];h=function(c){var h,
g,m;return d(this,function(d){switch(d.label){case 0:if(c.primitiveName!==a||c.propertyName!==b)return[3,2];if(void 0!==c.value)return[2,{value:l?l(c.value):c.value}];h=c.valueExpressionInfo;if(!h)return[3,2];g=h.expression;return[4,f.createRendererExpression(g,e.spatialReference,e.fields)];case 1:return m=d.sent(),[2,{value:function(a,b,c){a=p.callWithFeature(m,a,{$view:c},e.geometryType,b);null!==a&&l&&(a=l(a));return null!==a?a:k}}];case 2:return[2]}})};g=0;m=c;q.label=1;case 1:if(!(g<m.length))return[3,
4];n=m[g];return[5,h(n)];case 2:r=q.sent();if("object"===typeof r)return[2,r.value];q.label=3;case 3:return g++,[3,1];case 4:return[2,k]}})})}function R(a,b){switch(b){case "LowerCase":return a.toLowerCase();case "Allcaps":return a.toUpperCase();default:return a}}function Y(a,b,c){if(!a||-1===b.indexOf("["))return R(b,c);var e=function(a){for(var b=a.length;b--;)if(-1===" /-,\n".indexOf(a.charAt(b)))return!1;return!0},d=[],f=0,k=-1;do k=b.indexOf("[",f),k>=f&&(k>f&&(f=b.substr(f,k-f),d.push([f,null,
e(f)])),f=k+1,k=b.indexOf("]",f),k>=f&&(k>f&&(f=b.substr(f,k-f),(f=a[f])&&d.push([null,f,!1])),f=k+1));while(-1!==k);f<b.length-1&&(f=b.substr(f),d.push([f,null,e(f)]));return function(a){for(var b="",e=null,f=0;f<d.length;f++){var k=d[f],h=k[0],l=k[1],k=k[2];if(h)k?e=h:(e&&(b+=e,e=null),b+=h);else if(h=a.attributes[l])e&&(b+=e,e=null),b+=h}return R(b,c)}}function W(a,b,c){return h(this,void 0,void 0,function(){var e,k,h,g;return d(this,function(m){switch(m.label){case 0:e=function(a){var b,e,k;return d(this,
function(d){switch(d.label){case 0:b=a.valueExpressionInfo;if(!b)return[3,2];e=b.expression;return[4,f.createRendererExpression(e,c.spatialReference,c.fields)];case 1:k=d.sent(),a.fn=function(a,b,e){return p.callWithFeature(k,a,{$view:e},c.geometryType,b)},d.label=2;case 2:return[2]}})},k=0,h=b,m.label=1;case 1:if(!(k<h.length))return[3,4];g=h[k];return[5,e(g)];case 2:m.sent(),m.label=3;case 3:return k++,[3,1];case 4:return[2,function(c,e,d){for(var f=0;f<b.length;f++){var k=b[f];k.fn&&(k.value=k.fn(c,
e,d))}return l.numericHash(a+t.OverrideHelper.buildOverrideKey(b)).toString()}]}})})}Object.defineProperty(a,"__esModule",{value:!0});var X=m.getLogger("esri.symbols.cim.cimAnalyzer");a.analyzeCIMSymbol=function(a,b,c,e,f){return h(this,void 0,void 0,function(){var k,h,l,g;return d(this,function(d){switch(d.label){case 0:k=e?e:[];if(!a)return[2,k];"CIMSymbolReference"===a.type?(h=a.symbol,l=a.primitiveOverrides):(h=a,l=null);g=h.type;switch(g){case "CIMPointSymbol":return[3,1];case "CIMLineSymbol":return[3,
1];case "CIMPolygonSymbol":return[3,1];case "CIMTextSymbol":return[3,3]}return[3,4];case 1:return[4,E(h,l,b,c,k,f)];case 2:return d.sent(),[3,4];case 3:return[3,4];case 4:return[2,k]}})})};a.analyzeCIMResource=function(a,b){if(!b||0===b.length)return a;a=JSON.parse(JSON.stringify(a));t.OverrideHelper.applyOverrides(a,b);return a}})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicLineTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/screenUtils ../../color ../../number ../../materialKey/MaterialKey ./util ./WGLBaseLineTemplate ./WGLDynamicMeshTemplate ../../util/Result".split(" "),
function(g,a,d,h,b,e,m,c,l,f,t){Object.defineProperty(a,"__esModule",{value:!0});g=function(a){function f(e,d,f){var k=a.call(this,d)||this;k._cimLineLayer=d;var l=0;c.isFunction(d.width)||(l=.5*h.pt2px(d.width));k._dynamicPropertyMap.set("_halfWidth",function(a,b,e){return c.isFunction(d.width)?.5*h.pt2px(d.width(a,b,e)):l});c.isFunction(d.cap)?k._dynamicPropertyMap.set("_capType",d.cap):k._capType=d.cap;c.isFunction(d.join)?k._dynamicPropertyMap.set("_joinType",d.join):k._joinType=d.join;if(c.isFunction(d.color))k._dynamicPropertyMap.set("_fillColor",
function(a,c,e){return(a=d.color(a,c,e))&&b.premultiplyAlphaRGBA(a)||0});else{var g=d.color;k._fillColor=g&&b.premultiplyAlphaRGBA(g)||0}c.isFunction(d.miterLimit)?k._dynamicPropertyMap.set("_miterLimitCosine",function(a,b,e){return c.getLimitCosine(d.miterLimit(a,b,e))}):k._miterLimitCosine=c.getLimitCosine(d.miterLimit);c.isFunction(f)?k._dynamicPropertyMap.set("_scaleFactor",f):k._scaleFactor=f;k._isDashed=d.isDashed;k.tessellationProperties._bitset=d.colorLocked?1:0;k._materialKey=m.createMaterialKey(k.geometryType,
e,d.isOutline);k._initializeTessellator(!0);return k}d(f,a);f.fromCIMLine=function(a,b,c){return new f(a,b,c)};f.prototype.bindFeature=function(a,b,c){var d=this;this._dynamicPropertyMap.forEach(function(e,f){d[f]=e(a,b,c)});this._halfWidth*=this._scaleFactor;var f=this._materialCache,h=this._cimLineLayer.materialHash,h=h(a,b,c),h=f.get(h),f=null;h&&t.ok(h.spriteMosaicItem)&&(f=h.spriteMosaicItem);if(f){this._hasPattern=!0;var h=f.rect,l=h.x+1+f.width,g=h.y+1+f.height;this.tessellationProperties._tl=
e.i1616to32(h.x+1,h.y+1);this.tessellationProperties._br=e.i1616to32(l,g)}else this._hasPattern=!1,this.tessellationProperties._tl=0,this.tessellationProperties._br=0;this.tessellationProperties._fillColor=this._fillColor;this.tessellationProperties._halfWidth=this._halfWidth;this.tessellationProperties._halfReferenceWidth=this.tessellationProperties._halfWidth;h=m.LineMaterialKey.load(this._materialKey);f&&(h.sdf=f.sdf,h.pattern=!0,h.textureBinding=f.textureBinding);this._materialKey=h.data};return f}(l.default(f.default));
a.default=g})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicMeshTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/Logger ../../../../../../core/promiseUtils ../../../../../../symbols/cim/cimAnalyzer ./WGLMeshTemplate".split(" "),function(g,a,d,h,b,e,m){Object.defineProperty(a,"__esModule",{value:!0});var c=h.getLogger("esri.views.2d.engine.webgl.WGLDynamicMeshTemplate");g=function(a){function f(b){var c=a.call(this)||this;c._ongoingMaterialRequestMap=
new Map;c._materialCache=new Map;c._dynamicPropertyMap=new Map;c._cimLayer=b;return c}d(f,a);f.prototype.analyze=function(a,d,f,h){var l=this,g=this._materialCache,k=this._cimLayer.materialHash;if(!k)return c.error("A Dynamic mesh template must have a material hash value or function!"),b.reject(null);var m="function"===typeof k?k(d,f,h):k;if(g.has(m))return a=g.get(m),b.resolve(a);if(this._ongoingMaterialRequestMap.has(m))return this._ongoingMaterialRequestMap.get(m);d=e.analyzeCIMResource(this._cimLayer.cim,
this._cimLayer.materialOverrides);d.mosaicHash=m;a=a.getCIMMosaicItem(d).then(function(a){l._ongoingMaterialRequestMap.delete(m);g.set(m,a);return a}).catch(function(a){l._ongoingMaterialRequestMap.delete(m);c.error(".analyze()",a.message);return null});this._ongoingMaterialRequestMap.set(m,a);return a};return f}(m.default);a.default=g})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicMarkerTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/screenUtils ../../../../../../core/libs/gl-matrix-2/mat2d ../../../../../../core/libs/gl-matrix-2/mat2df32 ../../../../../../core/libs/gl-matrix-2/vec2 ../../../../../../core/libs/gl-matrix-2/vec2f32 ../../../../../../symbols/cim/enums ../../color ../../number ../../materialKey/MaterialKey ./util ./WGLBaseMarkerTemplate ./WGLDynamicMeshTemplate ../../util/Result".split(" "),
function(g,a,d,h,b,e,m,c,l,f,t,x,n,p,y,u,k,r){Object.defineProperty(a,"__esModule",{value:!0});var z=3.14159265359/180,q=f.vec2f32.create(),E=c.mat2df32.create(),A=b.getLogger("esri.views.2d.engine.webgl.WGLDynamicMarkerTemplate");g=function(a){function b(b,c,d){var f=a.call(this,c)||this;f._cimMarkerLayer=c;y.isFunction(c.color)?f._dynamicPropertyMap.set("_fillColor",function(a,b,e){return x.premultiplyAlphaRGBA(c.color(a,b,e))}):f._fillColor=x.premultiplyAlphaRGBA(c.color);y.isFunction(c.outlineColor)?
f._dynamicPropertyMap.set("_outlineColor",function(a,b,e){return x.premultiplyAlphaRGBA(c.outlineColor(a,b,e))}):f._outlineColor=x.premultiplyAlphaRGBA(c.outlineColor);y.isFunction(c.size)?f._dynamicPropertyMap.set("_size",function(a,b,d){return e.pt2px(c.size(a,b,d))}):f._size=e.pt2px(c.size);y.isFunction(c.scaleX)?f._dynamicPropertyMap.set("_scaleX",c.scaleX):f._scaleX=c.scaleX;y.isFunction(c.offsetX)?f._dynamicPropertyMap.set("xOffset",function(a,b,d){return e.pt2px(c.offsetX(a,b,d))}):f.xOffset=
e.pt2px(c.offsetX);y.isFunction(c.offsetY)?f._dynamicPropertyMap.set("yOffset",function(a,b,d){return e.pt2px(c.offsetY(a,b,d))}):f.yOffset=e.pt2px(c.offsetY);y.isFunction(c.outlineWidth)?f._dynamicPropertyMap.set("_outlineWidth",function(a,b,d){return e.pt2px(c.outlineWidth(a,b,d))}):f._outlineWidth=e.pt2px(c.outlineWidth);y.isFunction(c.rotation)?f._dynamicPropertyMap.set("_angle",c.rotation):f._angle=c.rotation;y.isFunction(d)?f._dynamicPropertyMap.set("_scaleFactor",d):f._scaleFactor=d;f._bitSet=
(c.alignment===t.Alignment.MAP?1:0)|(c.colorLocked?1:0)<<1|(c.scaleSymbolsProportionally?1:0)<<3;f._materialKey=p.createMaterialKey(f.geometryType,b,!1);return f}d(b,a);b.fromCIMMarker=function(a,c,e){return new b(a,c,e)};b.prototype.bindFeature=function(a,b,c){var d=this;this._dynamicPropertyMap.forEach(function(e,f){d[f]=e(a,b,c)});var k=this._cimMarkerLayer.materialHash,k="function"===typeof k?k(a,b,c):k;if((k=this._materialCache.get(k))&&r.ok(k.spriteMosaicItem)&&k.spriteMosaicItem){var k=k.spriteMosaicItem,
g=this._cimMarkerLayer.sizeRatio,u=k.width/k.height*this._scaleX,B=this._cimMarkerLayer.rotateClockwise?this._angle:-this._angle,t=this._size,y=t*u,C=this.xOffset*this._scaleFactor,x=this.yOffset*this._scaleFactor,D=this._cimMarkerLayer.scaleSymbolsProportionally&&this._cimMarkerLayer.frameHeight?this._size/e.pt2px(this._cimMarkerLayer.frameHeight):1,I=this._outlineWidth*D,L=e.pt2px(this._cimMarkerLayer.referenceSize),X=0,D=0,Z=this._cimMarkerLayer.anchorPoint;Z&&(this._cimMarkerLayer.isAbsoluteAnchorPoint?
this._size&&(X=-Z.x/(this._size*u),D=Z.y/this._size):(X=Z.x,D=Z.y));this._sizeOutlineWidth=n.i8888to32(Math.round(Math.sqrt(256*y)),Math.round(Math.sqrt(256*t)),Math.round(Math.sqrt(256*I)),Math.round(Math.sqrt(256*L)));m.mat2d.identity(E);m.mat2d.translate(E,E,f.vec2f32.fromValues(C,-x));B&&m.mat2d.rotate(E,E,z*B);u=k.rect.x;B=k.rect.y;C=u+k.rect.width;x=B+k.rect.height;X=.5-((.5+X)*k.width+1)/k.rect.width;D=.5-((.5+D)*k.height+1)/k.rect.height;y=y*g*this._scaleFactor;t=t*g*this._scaleFactor;g=Math.round(64*
g);y*=k.rect.width/k.width;t*=k.rect.height/k.height;X=(X-.5)*y;D=(D-.5)*t;this._bitestAndDistRatio=n.i8888to32(0,0,this._bitSet,g);l.vec2.set(q,X,D);l.vec2.transformMat2d(q,q,E);this._offsetUpperLeft=n.i1616to32(16*q[0],16*q[1]);this._texUpperLeft=n.i1616to32(u,B);l.vec2.set(q,X+y,D);l.vec2.transformMat2d(q,q,E);this._offsetUpperRight=n.i1616to32(16*q[0],16*q[1]);this._texUpperRight=n.i1616to32(C,B);l.vec2.set(q,X,D+t);l.vec2.transformMat2d(q,q,E);this._offsetBottomLeft=n.i1616to32(16*q[0],16*q[1]);
this._texBottomLeft=n.i1616to32(u,x);l.vec2.set(q,X+y,D+t);l.vec2.transformMat2d(q,q,E);this._offsetBottomRight=n.i1616to32(16*q[0],16*q[1]);this._texBottomRight=n.i1616to32(C,x);t=p.MarkerMaterialKey.load(this._materialKey);t.sdf=k.sdf;t.pattern=!0;t.textureBinding=k.textureBinding;this._materialKey=t.data}else A.error(new h("mapview-cim","Encountered an error when binding feature"))};return b}(u.default(k.default));a.default=g})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicTextTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/screenUtils ../../alignmentUtils ../../color ../../fontUtils ../../materialKey/MaterialKey ./util ./WGLBaseTextTemplate ./WGLDynamicMeshTemplate ../../util/BidiText".split(" "),
function(g,a,d,h,b,e,m,c,l,f,t,x){Object.defineProperty(a,"__esModule",{value:!0});var n=new Set;g=function(a){function f(b,d,f){var k=a.call(this,d)||this;k._horizontalAlignment="center";k._verticalAlignment="middle";k._glyphs=[];k._cimTextLayer=d;l.isFunction(d.color)?k._dynamicPropertyMap.set("_color",function(a,b,c){return e.premultiplyAlphaRGBA(d.color(a,b,c))}):k._color=e.premultiplyAlphaRGBA(d.color);l.isFunction(d.color)?k._dynamicPropertyMap.set("_haloColor",function(a,b,c){return e.premultiplyAlphaRGBA(d.outlineColor(a,
b,c))}):k._haloColor=e.premultiplyAlphaRGBA(d.outlineColor);var g;l.isFunction(d.size)||(g=Math.min(Math.round(h.pt2px(d.size*d.sizeRatio)),127));k._dynamicPropertyMap.set("_size",function(a,b,c){return l.isFunction(d.size)?Math.min(Math.round(h.pt2px(d.size(a,b,c)*d.sizeRatio)),127):g});l.isFunction(d.outlineSize)?k._dynamicPropertyMap.set("_haloSize",function(a,b,c){return Math.min(Math.floor(5*h.pt2px(d.outlineSize(a,b,c)*d.sizeRatio)),127)}):k._haloSize=Math.min(Math.floor(5*h.pt2px(d.outlineSize*
d.sizeRatio)),127);var n;l.isFunction(d.offsetX)||(n=Math.round(h.pt2px(d.offsetX*d.sizeRatio)));k._dynamicPropertyMap.set("_xOffset",function(a,b,c){return l.isFunction(d.offsetX)?Math.round(h.pt2px(d.offsetX(a,b,c)*d.sizeRatio)):n});var p;l.isFunction(d.offsetY)||(p=Math.round(h.pt2px(d.offsetY*d.sizeRatio)));k._dynamicPropertyMap.set("_yOffset",function(a,b,c){return l.isFunction(d.offsetY)?Math.round(h.pt2px(d.offsetY(a,b,c)*d.sizeRatio)):p});l.isFunction(d.decoration)?k._dynamicPropertyMap.set("_decorationTop",
function(a,b,c){return m.getFontDecorationTop(d.decoration(a,b,c))}):k._decorationTop=m.getFontDecorationTop(d.decoration);l.isFunction(d.angle)?k._dynamicPropertyMap.set("_angle",d.angle):k._angle=d.angle;l.isFunction(d.horizontalAlignment)?k._dynamicPropertyMap.set("_horizontalAlignment",d.horizontalAlignment):k._horizontalAlignment=d.horizontalAlignment;l.isFunction(d.verticalAlignment)?k._dynamicPropertyMap.set("_verticalAlignment",d.verticalAlignment):k._verticalAlignment=d.verticalAlignment;
l.isFunction(f)?k._dynamicPropertyMap.set("_scaleFactor",f):k._scaleFactor=f;l.isFunction(d.text)?k._dynamicPropertyMap.set("_text",d.text):k._text=d.text;f=Math.min(Math.round(h.pt2px(d.referenceSize*d.sizeRatio)),127);k._referenceSize=Math.round(Math.sqrt(256*f));k._materialKey=c.createMaterialKey(k.geometryType,b,!1);b=c.TextMaterialKey.load(k._materialKey);b.sdf=!0;k._bitset=d.colorLocked?1:0;k._materialKey=b.data;return k}d(f,a);f.fromCIMText=function(a,b,c){return new f(a,b,c)};f.prototype.analyze=
function(a,b,c,e){var d=this._cimTextLayer;b="string"===typeof d.text?d.text:"function"===typeof d.text?d.text(b,c,e):"";var f=this._glyphs;n.clear();for(c=0;c<b.length;c++)n.add(b.charCodeAt(c));var k=[];n.forEach(function(a){if(f.length<a||void 0===f[a])k[a]=a});return a.getCIMMosaicItem(d.cim,k).then(function(a){if(a.glyphMosaicItems&&0<a.glyphMosaicItems.length)for(var b=a.glyphMosaicItems,c=0;c<b.length;c++)void 0!==b[c]&&(f[c]=b[c]);return a})};f.prototype.bindFeature=function(a,c,e){var d=
this;this._dynamicPropertyMap.forEach(function(b,f){d[f]=b(a,c,e)});if(this._text&&0!==this._text.length){this._size*=this._scaleFactor;this._scale=this._size/24;this._xOffset*=this._scaleFactor;this._yOffset*=this._scaleFactor;this._justify=b.getJustification(this._horizontalAlignment||"center");this._xAlignD=b.getXAnchorDirection(this._horizontalAlignment||"center");this._yAlignD=-b.getYAnchorDirection(this._verticalAlignment||"baseline");this._baseline="baseline"===(this._verticalAlignment||"baseline");
for(var f=this._glyphs,k=x.bidiText(this._text),h=k[0],k=k[1],l=[],g=0;g<h.length;g++)l[h.charCodeAt(g)]=f[h.charCodeAt(g)];this.bindTextInfo(l,h,k);this._computeGlyphs(this._shapedGlyphs,this._shapedBox)}else this._shapedBox=this._shapedGlyphs=this._computedGlyphs=null};return f}(f.default(t.default));a.default=g})},"esri/views/2d/engine/webgl/mesh/templates/WGLFillTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/Logger ../../../../../../core/mathUtils ../../../../../../core/screenUtils ../../../../../../core/libs/earcut/earcut ../../color ../../definitions ../../enums ../../number ../../TileClipper ../../WGLDisplayRecord ../../materialKey/MaterialKey ../Tesselator ./WGLMeshTemplate".split(" "),
function(g,a,d,h,b,e,m,c,l,f,t,x,n,p,y,u){Object.defineProperty(a,"__esModule",{value:!0});var k=h.getLogger("esri.views.2d.engine.webgl.mesh.templates.WGLFillTemplate"),r=[],z=[];g=function(a){function h(b,c,e,d,k,h,g,m,n){var r=a.call(this)||this;r.fillColor=e;r.tl=d;r.br=k;r.aux1=h;r.aux2=g;r.aux3=m;r.isBFS=n;r.geometryType=f.WGLGeometryType.FILL;r.forceLibtess=!1;b=p.FillMaterialKey.load(p.createMaterialKey(r.geometryType,b,!1));c&&(b.sdf=c.sdf,b.pattern=!0,b.textureBinding=c.textureBinding);
r._materialKey=b.data;r._tesselator=new y.default;r._tileClipper=new x.TileClipper(0,0,0,1,8);r._tileClipper.setExtent(l.TILE_SIZE);return r}d(h,a);h.fromCIMFill=function(a,d,f,k){void 0===k&&(k=!1);var l=d.color,l=l&&c.premultiplyAlphaRGBA(l)||0,g=t.i8888to32(0,0,0,d.colorLocked?1:0);if(!f)return new h(a,null,l,0,0,0,0,g,k);var g=f.rect,m=f.width,n=f.height,p=g.x+1,r=g.y+1,q=p+m,u=r+n,g=b.nextHighestPowerOfTwo(e.pt2px(d.height||0));255<g?g=255:0>=g&&(g=b.nextHighestPowerOfTwo(u-r));m=b.nextHighestPowerOfTwo(e.pt2px(d.height/
n*m||0));255<m?m=255:0>=m&&(m=b.nextHighestPowerOfTwo(q-p));n=e.pt2px(d.offsetX||0)+128;255<n&&(n=255);var B=e.pt2px(-d.offsetY||0)+128;255<B&&(B=255);d=d.scaleX||1;p=t.i1616to32(p,r);q=t.i1616to32(q,u);g=t.i8888to32(m,g,n,B);d=t.i1616to32(128*d,128);return new h(a,f,l,p,q,g,d,0,k)};h.fromSimpleFill=function(a,e,d,f){void 0===f&&(f=!1);var k=e.color;e=k&&"none"!==e.style&&c.premultiplyAlphaRGBA(k)||0;k=t.i8888to32(0,0,0,f?255:0);if(!d)return new h(a,null,e,0,0,0,0,k,f);var l=d.rect,g=l.x+1,m=l.y+
1,n=l.x+1+d.width,p=l.y+1+d.height,l=t.i1616to32(g,m),r=t.i1616to32(n,p),g=t.i8888to32(b.nextHighestPowerOfTwo(n-g),b.nextHighestPowerOfTwo(p-m),0,0),m=t.i1616to32(128,128);return new h(a,d,e,l,r,g,m,k,f)};h.fromPictureFill=function(a,c,d,f){void 0===f&&(f=!1);var k=l.PICTURE_FILL_COLOR,g=d.rect,m=g.x+1,n=g.y+1,g=m+d.width,p=n+d.height,m=t.i1616to32(m,n),g=t.i1616to32(g,p),p=b.nextHighestPowerOfTwo(e.pt2px(c.width));255<p&&(p=255);n=b.nextHighestPowerOfTwo(e.pt2px(c.height));255<n&&(n=255);var r=
e.pt2px(c.xoffset)+128;255<r&&(r=255);var q=e.pt2px(-c.yoffset)+128;255<q&&(q=255);p=t.i8888to32(p,n,r,q);c=t.i1616to32(128*c.xscale,128*c.yscale);n=t.i8888to32(0,0,0,f?255:0);return new h(a,d,k,m,g,p,c,n,f)};h.prototype.writeMesh=function(a,b,c,e,d){r.length=0;if("esriGeometryPolygon"!==c)"esriGeometryPolyline"!==c&&k.error("Unable to handle geometryType: "+c);else{var f=d.geometry;c=p.FillMaterialKey.load(this._materialKey);var h=(d=this._isClippingRequired(f))?this._clip(f,!1):f.rings;if(c.dotDensity){for(var f=
f.rings,l=0,g=0;g<f.length;g++)for(var m=f[g],n=m[0],q=n[0],n=n[1],u=1;u<m.length;u++)var t=m[u],B=q+t[0],t=n+t[1],l=l-(B-q)*(t+n)/2,q=B,n=t;f=l}else f=0;this.forceLibtess?this._writeMeshLibtess(a,b,e,h,d,c,f):this._writeMeshEarcut(a,b,e,h,d,c,f)||this._writeMeshLibtess(a,b,e,h,d,c,f)}};h.prototype._isClippingRequired=function(a){var b=l.TILE_SIZE+8,c=0;for(a=a.rings;c<a.length;c++){var e=a[c],d=e.length;if(!(3>d)){var f=e[0][0],k=e[0][1];if(-8>f||f>b||-8>k||k>b)return!0;for(var h=1;h<d;++h)if(f+=
e[h][0],k+=e[h][1],-8>f||f>b||-8>k||k>b)return!0}}return!1};h.prototype._clip=function(a,b){var c;this._tileClipper.reset(3);for(var e=0,d=a.rings;e<d.length;e++){var f=d[e],k=f.length;if(!(3>k)){a=f[0][0];c=f[0][1];this._tileClipper.moveTo(a,c);for(var h=1;h<k;++h)a+=f[h][0],c+=f[h][1],this._tileClipper.lineTo(a,c);this._tileClipper.close()}}return this._tileClipper.result(b)};h.prototype._writeMeshLibtess=function(a,b,c,e,d,f,k){if(e&&e.length){var h=[],l=b.indexVector;b=b.getVector("geometry");
var g=new n(c,this.geometryType,this._materialKey),m=b.vertexCount;g.vertexFrom=m;g.indexFrom=l.length;this._tesselator.beginPolygon(r,h);for(var p=0;p<e.length;p++){var q=e[p];if(!(3>q.length)){this._tesselator.beginContour();var u=void 0,t=void 0;d?(u=q[0].x,t=q[0].y):(u=q[0][0],t=q[0][1]);var z=[u,t,0];this._tesselator.addVertex(z,z);for(z=1;z<q.length-1;z++){var B=void 0,y=void 0;d?(u=q[z].x,t=q[z].y):(B=q[z][0],y=q[z][1],u+=B,t+=y);B=[u,t,0];this._tesselator.addVertex(B,B)}this._tesselator.endContour()}}this._tesselator.endPolygon();
this._writeVerticesLibTess(g,b,c,r,f,k);this._writeIndicesLibTess(g,l,m,h);0<g.indexCount&&a.push(g)}};h.prototype._writeMeshEarcut=function(a,b,c,e,d,f,k){if(e&&e.length){var h=b.indexVector;b=b.getVector("geometry");var l=new n(c,this.geometryType,this._materialKey),g=h.length,m=b.data.length;l.vertexFrom=b.vertexCount;l.indexFrom=h.length;for(var p=0,q=0,u=0;u<e.length;u++){var t=e[u],B=q,y=void 0,A=void 0;d?(y=t[0].x,A=t[0].y):(y=t[0][0],A=t[0][1]);r[q++]=y;r[q++]=A;for(var x=0,C=1;C<t.length;++C){var E=
void 0,D=void 0;d?(E=y,D=A,y=t[C].x,A=t[C].y,E=y-E,D=A-D):(E=t[C][0],D=t[C][1],y+=E,A+=D);x-=E*(A+A-D);r[q++]=y;r[q++]=A}if(0<x){if(0<B-p){if(!this._write(l,h,b,c,r,z,p,B,f,k))return h.seek(g),b.data.seek(m),r.length=z.length=0,!1;p=B}z.length=0}else 0>x?0<B-p?z.push(.5*(B-p)):q=B:q=B}if(0<q-p&&!this._write(l,h,b,c,r,z,p,q,f,k))return h.seek(g),b.data.seek(m),r.length=z.length=0,!1;r.length=z.length=0;a.push(l);return!0}};h.prototype._write=function(a,b,c,e,d,f,k,h,l,g){d=d.slice(k,h);k=m(d,f,2);
if(m.deviation(d,f,2,k))return!1;if(k.length)return f=c.vertexCount,this._writeVertices(a,c,e,d,l,g),this._writeIndices(a,b,f,k),!0};h.prototype._writeVertices=function(a,b,c,e,d,f){for(var k=0;k<e.length;k+=2){var h=t.i1616to32(e[k],e[k+1]);b.data.push(h);b.data.push(c);d.dotDensity?b.data.writeF32(1/f):(b.data.push(this.fillColor),b.data.push(this.tl),b.data.push(this.br),b.data.push(this.aux1),b.data.push(this.aux2),b.data.push(this.aux3));a.vertexCount++}};h.prototype._writeIndices=function(a,
b,c,e){for(var d=0;d<e.length;d+=3)b.push(c+e[d]),b.push(c+e[d+1]),b.push(c+e[d+2]),a.indexCount+=3};h.prototype._writeVerticesLibTess=function(a,b,c,e,d,f){for(var k=0;k<e.length;k+=2){var h=t.i1616to32(e[k],e[k+1]);b.data.push(h);b.data.push(c);d.dotDensity?b.data.writeF32(1/f):(b.data.push(this.fillColor),b.data.push(this.tl),b.data.push(this.br),b.data.push(this.aux1),b.data.push(this.aux2),b.data.push(this.aux3));a.vertexCount++}};h.prototype._writeIndicesLibTess=function(a,b,c,e){for(var d=
0;d<e.length;d++)b.push(c+e[d]),a.indexCount++};return h}(u.default);a.default=g})},"esri/views/2d/engine/webgl/mesh/Tesselator":function(){define(["require","exports","../../../../../core/Logger","../../../../../core/libs/libtess/libtess"],function(g,a,d,h){Object.defineProperty(a,"__esModule",{value:!0});var b=d.getLogger("esri.views.2d.engine.webgl.mesh.templates.Tesselator");g=function(){function a(){this._indexCounter=this._currentVertexIndex=0;this._triangleIndices=[-1,-1,-1];this.glu=new h.GluTesselator;
this.glu.gluTessCallback(h.gluEnum.GLU_TESS_BEGIN,this._begincallback.bind(this));this.glu.gluTessCallback(h.gluEnum.GLU_TESS_VERTEX_DATA,this._vertexCallback.bind(this));this.glu.gluTessCallback(h.gluEnum.GLU_TESS_END,this._endcallback.bind(this));this.glu.gluTessCallback(h.gluEnum.GLU_TESS_COMBINE,this._combinecallback.bind(this));this.glu.gluTessCallback(h.gluEnum.GLU_TESS_ERROR,this._errorcallback.bind(this));this.glu.gluTessCallback(h.gluEnum.GLU_TESS_EDGE_FLAG,this._edgeCallback.bind(this));
this.glu.gluTessProperty(h.gluEnum.GLU_TESS_WINDING_RULE,h.windingRule.GLU_TESS_WINDING_ODD)}a.prototype.beginPolygon=function(a,b){this._triangleIndices[0]=-1;this._triangleIndices[1]=-1;this._triangleIndices[2]=-1;this._indexCounter=this._currentVertexIndex=0;this.glu.gluTessBeginPolygon(a);this._indices=b};a.prototype.endPolygon=function(){this.glu.gluTessEndPolygon()};a.prototype.beginContour=function(){this.glu.gluTessBeginContour()};a.prototype.endContour=function(){this.glu.gluTessEndContour()};
a.prototype.addVertex=function(a,b){this.glu.gluTessVertex(a,b)};a.prototype._vertexCallback=function(a,b){b[b.length]=a[0];b[b.length]=a[1];this._triangleIndices[this._currentVertexIndex]=-1;if(2<=this._currentVertexIndex){for(a=0;3>a;a++)-1===this._triangleIndices[a]&&(this._triangleIndices[a]=this._indexCounter++),this._indices[this._indices.length]=this._triangleIndices[a];this._currentVertexIndex=0}else this._currentVertexIndex++};a.prototype._begincallback=function(){this._triangleIndices[0]=
-1;this._triangleIndices[1]=-1;this._triangleIndices[2]=-1;this._currentVertexIndex=0};a.prototype._endcallback=function(){this._currentVertexIndex=0};a.prototype._errorcallback=function(a){b.error("Encountered error during tesselation: "+a)};a.prototype._combinecallback=function(a){return[a[0],a[1],a[2]]};a.prototype._edgeCallback=function(){};return a}();a.default=g})},"esri/core/libs/libtess/libtess":function(){define([],function(){var g={DEBUG:!1,assert:function(a,d){if(g.DEBUG&&!a)throw Error("Assertion failed"+
(d?": "+d:""));},GLU_TESS_MAX_COORD:1E150,TRUE_PROJECT:!1,GLU_TESS_DEFAULT_TOLERANCE:0,windingRule:{GLU_TESS_WINDING_ODD:100130,GLU_TESS_WINDING_NONZERO:100131,GLU_TESS_WINDING_POSITIVE:100132,GLU_TESS_WINDING_NEGATIVE:100133,GLU_TESS_WINDING_ABS_GEQ_TWO:100134},primitiveType:{GL_LINE_LOOP:2,GL_TRIANGLES:4,GL_TRIANGLE_STRIP:5,GL_TRIANGLE_FAN:6},errorType:{GLU_TESS_MISSING_BEGIN_POLYGON:100151,GLU_TESS_MISSING_END_POLYGON:100153,GLU_TESS_MISSING_BEGIN_CONTOUR:100152,GLU_TESS_MISSING_END_CONTOUR:100154,
GLU_TESS_COORD_TOO_LARGE:100155,GLU_TESS_NEED_COMBINE_CALLBACK:100156},gluEnum:{GLU_TESS_BEGIN:100100,GLU_TESS_VERTEX:100101,GLU_TESS_END:100102,GLU_TESS_ERROR:100103,GLU_TESS_EDGE_FLAG:100104,GLU_TESS_COMBINE:100105,GLU_TESS_BEGIN_DATA:100106,GLU_TESS_VERTEX_DATA:100107,GLU_TESS_END_DATA:100108,GLU_TESS_ERROR_DATA:100109,GLU_TESS_EDGE_FLAG_DATA:100110,GLU_TESS_COMBINE_DATA:100111,GLU_TESS_MESH:100112,GLU_TESS_TOLERANCE:100142,GLU_TESS_WINDING_RULE:100140,GLU_TESS_BOUNDARY_ONLY:100141,GLU_INVALID_ENUM:100900,
GLU_INVALID_VALUE:100901},geom:{}};g.geom.vertEq=function(a,d){return a.s===d.s&&a.t===d.t};g.geom.vertLeq=function(a,d){return a.s<d.s||a.s===d.s&&a.t<=d.t};g.geom.edgeEval=function(a,d,h){g.assert(g.geom.vertLeq(a,d)&&g.geom.vertLeq(d,h));var b=d.s-a.s,e=h.s-d.s;return 0<b+e?b<e?d.t-a.t+b/(b+e)*(a.t-h.t):d.t-h.t+e/(b+e)*(h.t-a.t):0};g.geom.edgeSign=function(a,d,h){g.assert(g.geom.vertLeq(a,d)&&g.geom.vertLeq(d,h));var b=d.s-a.s,e=h.s-d.s;return 0<b+e?(d.t-h.t)*b+(d.t-a.t)*e:0};g.geom.transLeq=function(a,
d){return a.t<d.t||a.t===d.t&&a.s<=d.s};g.geom.transEval=function(a,d,h){g.assert(g.geom.transLeq(a,d)&&g.geom.transLeq(d,h));var b=d.t-a.t,e=h.t-d.t;return 0<b+e?b<e?d.s-a.s+b/(b+e)*(a.s-h.s):d.s-h.s+e/(b+e)*(h.s-a.s):0};g.geom.transSign=function(a,d,h){g.assert(g.geom.transLeq(a,d)&&g.geom.transLeq(d,h));var b=d.t-a.t,e=h.t-d.t;return 0<b+e?(d.s-h.s)*b+(d.s-a.s)*e:0};g.geom.edgeGoesLeft=function(a){return g.geom.vertLeq(a.dst(),a.org)};g.geom.edgeGoesRight=function(a){return g.geom.vertLeq(a.org,
a.dst())};g.geom.vertL1dist=function(a,d){return Math.abs(a.s-d.s)+Math.abs(a.t-d.t)};g.geom.vertCCW=function(a,d,h){return 0<=a.s*(d.t-h.t)+d.s*(h.t-a.t)+h.s*(a.t-d.t)};g.geom.interpolate_=function(a,d,h,b){a=0>a?0:a;h=0>h?0:h;return a<=h?0===h?(d+b)/2:d+a/(a+h)*(b-d):b+h/(a+h)*(d-b)};g.geom.edgeIntersect=function(a,d,h,b,e){var m,c;g.geom.vertLeq(a,d)||(m=a,a=d,d=m);g.geom.vertLeq(h,b)||(m=h,h=b,b=m);g.geom.vertLeq(a,h)||(m=a,a=h,h=m,m=d,d=b,b=m);g.geom.vertLeq(h,d)?g.geom.vertLeq(d,b)?(m=g.geom.edgeEval(a,
h,d),c=g.geom.edgeEval(h,d,b),0>m+c&&(m=-m,c=-c),e.s=g.geom.interpolate_(m,h.s,c,d.s)):(m=g.geom.edgeSign(a,h,d),c=-g.geom.edgeSign(a,b,d),0>m+c&&(m=-m,c=-c),e.s=g.geom.interpolate_(m,h.s,c,b.s)):e.s=(h.s+d.s)/2;g.geom.transLeq(a,d)||(m=a,a=d,d=m);g.geom.transLeq(h,b)||(m=h,h=b,b=m);g.geom.transLeq(a,h)||(m=a,a=h,h=m,m=d,d=b,b=m);g.geom.transLeq(h,d)?g.geom.transLeq(d,b)?(m=g.geom.transEval(a,h,d),c=g.geom.transEval(h,d,b),0>m+c&&(m=-m,c=-c),e.t=g.geom.interpolate_(m,h.t,c,d.t)):(m=g.geom.transSign(a,
h,d),c=-g.geom.transSign(a,b,d),0>m+c&&(m=-m,c=-c),e.t=g.geom.interpolate_(m,h.t,c,b.t)):e.t=(h.t+d.t)/2};g.mesh={};g.mesh.makeEdge=function(a){var d=g.mesh.makeEdgePair_(a.eHead);g.mesh.makeVertex_(d,a.vHead);g.mesh.makeVertex_(d.sym,a.vHead);g.mesh.makeFace_(d,a.fHead);return d};g.mesh.meshSplice=function(a,d){var h=!1,b=!1;a!==d&&(d.org!==a.org&&(b=!0,g.mesh.killVertex_(d.org,a.org)),d.lFace!==a.lFace&&(h=!0,g.mesh.killFace_(d.lFace,a.lFace)),g.mesh.splice_(d,a),b||(g.mesh.makeVertex_(d,a.org),
a.org.anEdge=a),h||(g.mesh.makeFace_(d,a.lFace),a.lFace.anEdge=a))};g.mesh.deleteEdge=function(a){var d=a.sym,h=!1;a.lFace!==a.rFace()&&(h=!0,g.mesh.killFace_(a.lFace,a.rFace()));a.oNext===a?g.mesh.killVertex_(a.org,null):(a.rFace().anEdge=a.oPrev(),a.org.anEdge=a.oNext,g.mesh.splice_(a,a.oPrev()),h||g.mesh.makeFace_(a,a.lFace));d.oNext===d?(g.mesh.killVertex_(d.org,null),g.mesh.killFace_(d.lFace,null)):(a.lFace.anEdge=d.oPrev(),d.org.anEdge=d.oNext,g.mesh.splice_(d,d.oPrev()));g.mesh.killEdge_(a)};
g.mesh.addEdgeVertex=function(a){var d=g.mesh.makeEdgePair_(a),h=d.sym;g.mesh.splice_(d,a.lNext);d.org=a.dst();g.mesh.makeVertex_(h,d.org);d.lFace=h.lFace=a.lFace;return d};g.mesh.splitEdge=function(a){var d=g.mesh.addEdgeVertex(a).sym;g.mesh.splice_(a.sym,a.sym.oPrev());g.mesh.splice_(a.sym,d);a.sym.org=d.org;d.dst().anEdge=d.sym;d.sym.lFace=a.rFace();d.winding=a.winding;d.sym.winding=a.sym.winding;return d};g.mesh.connect=function(a,d){var h=!1,b=g.mesh.makeEdgePair_(a),e=b.sym;d.lFace!==a.lFace&&
(h=!0,g.mesh.killFace_(d.lFace,a.lFace));g.mesh.splice_(b,a.lNext);g.mesh.splice_(e,d);b.org=a.dst();e.org=d.org;b.lFace=e.lFace=a.lFace;a.lFace.anEdge=e;h||g.mesh.makeFace_(b,a.lFace);return b};g.mesh.zapFace=function(a){var d=a.anEdge,h=d.lNext,b;do if(b=h,h=b.lNext,b.lFace=null,null===b.rFace()){b.oNext===b?g.mesh.killVertex_(b.org,null):(b.org.anEdge=b.oNext,g.mesh.splice_(b,b.oPrev()));var e=b.sym;e.oNext===e?g.mesh.killVertex_(e.org,null):(e.org.anEdge=e.oNext,g.mesh.splice_(e,e.oPrev()));g.mesh.killEdge_(b)}while(b!==
d);d=a.prev;a=a.next;a.prev=d;d.next=a};g.mesh.meshUnion=function(a,d){var h=a.fHead,b=a.vHead,e=a.eHead,g=d.fHead,c=d.vHead;d=d.eHead;g.next!==g&&(h.prev.next=g.next,g.next.prev=h.prev,g.prev.next=h,h.prev=g.prev);c.next!==c&&(b.prev.next=c.next,c.next.prev=b.prev,c.prev.next=b,b.prev=c.prev);d.next!==d&&(e.sym.next.sym.next=d.next,d.next.sym.next=e.sym.next,d.sym.next.sym.next=e,e.sym.next=d.sym.next);return a};g.mesh.deleteMesh=function(a){};g.mesh.makeEdgePair_=function(a){var d=new g.GluHalfEdge,
h=new g.GluHalfEdge,b=a.sym.next;h.next=b;b.sym.next=d;d.next=a;a.sym.next=h;d.sym=h;d.oNext=d;d.lNext=h;h.sym=d;h.oNext=h;return h.lNext=d};g.mesh.splice_=function(a,d){var h=a.oNext,b=d.oNext;h.sym.lNext=d;b.sym.lNext=a;a.oNext=b;d.oNext=h};g.mesh.makeVertex_=function(a,d){var h=d.prev,b=new g.GluVertex(d,h);h.next=b;d.prev=b;d=b.anEdge=a;do d.org=b,d=d.oNext;while(d!==a)};g.mesh.makeFace_=function(a,d){var h=d.prev,b=new g.GluFace(d,h);h.next=b;d.prev=b;b.anEdge=a;b.inside=d.inside;d=a;do d.lFace=
b,d=d.lNext;while(d!==a)};g.mesh.killEdge_=function(a){var d=a.next;a=a.sym.next;d.sym.next=a;a.sym.next=d};g.mesh.killVertex_=function(a,d){var h=a.anEdge,b=h;do b.org=d,b=b.oNext;while(b!==h);d=a.prev;a=a.next;a.prev=d;d.next=a};g.mesh.killFace_=function(a,d){var h=a.anEdge,b=h;do b.lFace=d,b=b.lNext;while(b!==h);d=a.prev;a=a.next;a.prev=d;d.next=a};g.normal={};g.normal.S_UNIT_X_=1;g.normal.S_UNIT_Y_=0;g.normal.projectPolygon=function(a,d,h,b){var e=!1,m=[d,h,b];0===d&&0===h&&0===b&&(g.normal.computeNormal_(a,
m),e=!0);h=g.normal.longAxis_(m);d=a.mesh.vHead;if(g.TRUE_PROJECT){g.normal.normalize_(m);b=[0,0,0];var c=[0,0,0];b[h]=0;b[(h+1)%3]=g.normal.S_UNIT_X_;b[(h+2)%3]=g.normal.S_UNIT_Y_;h=g.normal.dot_(b,m);b[0]-=h*m[0];b[1]-=h*m[1];b[2]-=h*m[2];g.normal.normalize_(b);c[0]=m[1]*b[2]-m[2]*b[1];c[1]=m[2]*b[0]-m[0]*b[2];c[2]=m[0]*b[1]-m[1]*b[0];g.normal.normalize_(c);for(m=d.next;m!==d;m=m.next)m.s=g.normal.dot_(m.coords,b),m.t=g.normal.dot_(m.coords,c)}else for(b=(h+1)%3,c=(h+2)%3,h=0<m[h]?1:-1,m=d.next;m!==
d;m=m.next)m.s=m.coords[b],m.t=h*m.coords[c];e&&g.normal.checkOrientation_(a)};g.normal.dot_=function(a,d){return a[0]*d[0]+a[1]*d[1]+a[2]*d[2]};g.normal.normalize_=function(a){var d=a[0]*a[0]+a[1]*a[1]+a[2]*a[2];g.assert(0<d);d=Math.sqrt(d);a[0]/=d;a[1]/=d;a[2]/=d};g.normal.longAxis_=function(a){var d=0;Math.abs(a[1])>Math.abs(a[0])&&(d=1);Math.abs(a[2])>Math.abs(a[d])&&(d=2);return d};g.normal.computeNormal_=function(a,d){var h=[-2*g.GLU_TESS_MAX_COORD,-2*g.GLU_TESS_MAX_COORD,-2*g.GLU_TESS_MAX_COORD],
b=[2*g.GLU_TESS_MAX_COORD,2*g.GLU_TESS_MAX_COORD,2*g.GLU_TESS_MAX_COORD],e=[],m=[],c;a=a.mesh.vHead;for(c=a.next;c!==a;c=c.next)for(var l=0;3>l;++l){var f=c.coords[l];f<b[l]&&(b[l]=f,m[l]=c);f>h[l]&&(h[l]=f,e[l]=c)}c=0;h[1]-b[1]>h[0]-b[0]&&(c=1);h[2]-b[2]>h[c]-b[c]&&(c=2);if(b[c]>=h[c])d[0]=0,d[1]=0,d[2]=1;else{h=0;b=m[c];e=e[c];m=[0,0,0];b=[b.coords[0]-e.coords[0],b.coords[1]-e.coords[1],b.coords[2]-e.coords[2]];l=[0,0,0];for(c=a.next;c!==a;c=c.next)l[0]=c.coords[0]-e.coords[0],l[1]=c.coords[1]-
e.coords[1],l[2]=c.coords[2]-e.coords[2],m[0]=b[1]*l[2]-b[2]*l[1],m[1]=b[2]*l[0]-b[0]*l[2],m[2]=b[0]*l[1]-b[1]*l[0],f=m[0]*m[0]+m[1]*m[1]+m[2]*m[2],f>h&&(h=f,d[0]=m[0],d[1]=m[1],d[2]=m[2]);0>=h&&(d[0]=d[1]=d[2]=0,d[g.normal.longAxis_(b)]=1)}};g.normal.checkOrientation_=function(a){for(var d=0,h=a.mesh.fHead,b=h.next;b!==h;b=b.next){var e=b.anEdge;if(!(0>=e.winding)){do d+=(e.org.s-e.dst().s)*(e.org.t+e.dst().t),e=e.lNext;while(e!==b.anEdge)}}if(0>d)for(a=a.mesh.vHead,d=a.next;d!==a;d=d.next)d.t=-d.t};
g.render={};g.render.renderMesh=function(a,d,h){for(var b=!1,e=-1,m=d.fHead.prev;m!==d.fHead;m=m.prev)if(m.inside){b||(a.callBeginCallback(g.primitiveType.GL_TRIANGLES),b=!0);var c=m.anEdge;g.assert(c.lNext.lNext.lNext===c,"renderMesh called with non-triangulated mesh");do{if(h){var l=c.rFace().inside?0:1;e!==l&&(e=l,a.callEdgeFlagCallback(!!e))}a.callVertexCallback(c.org.data);c=c.lNext}while(c!==m.anEdge)}b&&a.callEndCallback()};g.render.renderBoundary=function(a,d){for(var h=d.fHead.next;h!==d.fHead;h=
h.next)if(h.inside){a.callBeginCallback(g.primitiveType.GL_LINE_LOOP);var b=h.anEdge;do a.callVertexCallback(b.org.data),b=b.lNext;while(b!==h.anEdge);a.callEndCallback()}};g.sweep={};g.sweep.SENTINEL_COORD_=4*g.GLU_TESS_MAX_COORD;g.sweep.TOLERANCE_NONZERO_=!1;g.sweep.computeInterior=function(a){a.fatalError=!1;g.sweep.removeDegenerateEdges_(a);g.sweep.initPriorityQ_(a);g.sweep.initEdgeDict_(a);for(var d;null!==(d=a.pq.extractMin());){for(;;){var h=a.pq.minimum();if(null===h||!g.geom.vertEq(h,d))break;
h=a.pq.extractMin();g.sweep.spliceMergeVertices_(a,d.anEdge,h.anEdge)}g.sweep.sweepEvent_(a,d)}d=a.dict.getMin().getKey();a.event=d.eUp.org;g.sweep.doneEdgeDict_(a);g.sweep.donePriorityQ_(a);g.sweep.removeDegenerateFaces_(a.mesh);a.mesh.checkMesh()};g.sweep.addWinding_=function(a,d){a.winding+=d.winding;a.sym.winding+=d.sym.winding};g.sweep.edgeLeq_=function(a,d,h){a=a.event;d=d.eUp;h=h.eUp;if(d.dst()===a)return h.dst()===a?g.geom.vertLeq(d.org,h.org)?0>=g.geom.edgeSign(h.dst(),d.org,h.org):0<=g.geom.edgeSign(d.dst(),
h.org,d.org):0>=g.geom.edgeSign(h.dst(),a,h.org);if(h.dst()===a)return 0<=g.geom.edgeSign(d.dst(),a,d.org);d=g.geom.edgeEval(d.dst(),a,d.org);a=g.geom.edgeEval(h.dst(),a,h.org);return d>=a};g.sweep.deleteRegion_=function(a,d){d.fixUpperEdge&&g.assert(0===d.eUp.winding);d.eUp.activeRegion=null;a.dict.deleteNode(d.nodeUp);d.nodeUp=null};g.sweep.fixUpperEdge_=function(a,d){g.assert(a.fixUpperEdge);g.mesh.deleteEdge(a.eUp);a.fixUpperEdge=!1;a.eUp=d;d.activeRegion=a};g.sweep.topLeftRegion_=function(a){var d=
a.eUp.org;do a=a.regionAbove();while(a.eUp.org===d);a.fixUpperEdge&&(d=g.mesh.connect(a.regionBelow().eUp.sym,a.eUp.lNext),g.sweep.fixUpperEdge_(a,d),a=a.regionAbove());return a};g.sweep.topRightRegion_=function(a){var d=a.eUp.dst();do a=a.regionAbove();while(a.eUp.dst()===d);return a};g.sweep.addRegionBelow_=function(a,d,h){var b=new g.ActiveRegion;b.eUp=h;b.nodeUp=a.dict.insertBefore(d.nodeUp,b);return h.activeRegion=b};g.sweep.isWindingInside_=function(a,d){switch(a.windingRule){case g.windingRule.GLU_TESS_WINDING_ODD:return 0!==
(d&1);case g.windingRule.GLU_TESS_WINDING_NONZERO:return 0!==d;case g.windingRule.GLU_TESS_WINDING_POSITIVE:return 0<d;case g.windingRule.GLU_TESS_WINDING_NEGATIVE:return 0>d;case g.windingRule.GLU_TESS_WINDING_ABS_GEQ_TWO:return 2<=d||-2>=d}g.assert(!1);return!1};g.sweep.computeWinding_=function(a,d){d.windingNumber=d.regionAbove().windingNumber+d.eUp.winding;d.inside=g.sweep.isWindingInside_(a,d.windingNumber)};g.sweep.finishRegion_=function(a,d){var h=d.eUp,b=h.lFace;b.inside=d.inside;b.anEdge=
h;g.sweep.deleteRegion_(a,d)};g.sweep.finishLeftRegions_=function(a,d,h){var b=d;for(d=d.eUp;b!==h;){b.fixUpperEdge=!1;var e=b.regionBelow(),m=e.eUp;if(m.org!==d.org){if(!e.fixUpperEdge){g.sweep.finishRegion_(a,b);break}m=g.mesh.connect(d.lPrev(),m.sym);g.sweep.fixUpperEdge_(e,m)}d.oNext!==m&&(g.mesh.meshSplice(m.oPrev(),m),g.mesh.meshSplice(d,m));g.sweep.finishRegion_(a,b);d=e.eUp;b=e}return d};g.sweep.addRightEdges_=function(a,d,h,b,e,m){var c=!0;do g.assert(g.geom.vertLeq(h.org,h.dst())),g.sweep.addRegionBelow_(a,
d,h.sym),h=h.oNext;while(h!==b);for(null===e&&(e=d.regionBelow().eUp.rPrev());;){b=d.regionBelow();h=b.eUp.sym;if(h.org!==e.org)break;h.oNext!==e&&(g.mesh.meshSplice(h.oPrev(),h),g.mesh.meshSplice(e.oPrev(),h));b.windingNumber=d.windingNumber-h.winding;b.inside=g.sweep.isWindingInside_(a,b.windingNumber);d.dirty=!0;!c&&g.sweep.checkForRightSplice_(a,d)&&(g.sweep.addWinding_(h,e),g.sweep.deleteRegion_(a,d),g.mesh.deleteEdge(e));c=!1;d=b;e=h}d.dirty=!0;g.assert(d.windingNumber-h.winding===b.windingNumber);
m&&g.sweep.walkDirtyRegions_(a,d)};g.sweep.callCombine_=function(a,d,h,b,e){var m=[d.coords[0],d.coords[1],d.coords[2]];d.data=null;d.data=a.callCombineCallback(m,h,b);null===d.data&&(e?a.fatalError||(a.callErrorCallback(g.errorType.GLU_TESS_NEED_COMBINE_CALLBACK),a.fatalError=!0):d.data=h[0])};g.sweep.spliceMergeVertices_=function(a,d,h){var b=[null,null,null,null];b[0]=d.org.data;b[1]=h.org.data;g.sweep.callCombine_(a,d.org,b,[.5,.5,0,0],!1);g.mesh.meshSplice(d,h)};g.sweep.vertexWeights_=function(a,
d,h,b,e){var m=g.geom.vertL1dist(d,a),c=g.geom.vertL1dist(h,a),l=e+1;b[e]=.5*c/(m+c);b[l]=.5*m/(m+c);a.coords[0]+=b[e]*d.coords[0]+b[l]*h.coords[0];a.coords[1]+=b[e]*d.coords[1]+b[l]*h.coords[1];a.coords[2]+=b[e]*d.coords[2]+b[l]*h.coords[2]};g.sweep.getIntersectData_=function(a,d,h,b,e,m){var c=[0,0,0,0],l=[h.data,b.data,e.data,m.data];d.coords[0]=d.coords[1]=d.coords[2]=0;g.sweep.vertexWeights_(d,h,b,c,0);g.sweep.vertexWeights_(d,e,m,c,2);g.sweep.callCombine_(a,d,l,c,!0)};g.sweep.checkForRightSplice_=
function(a,d){var h=d.regionBelow(),b=d.eUp,e=h.eUp;if(g.geom.vertLeq(b.org,e.org)){if(0<g.geom.edgeSign(e.dst(),b.org,e.org))return!1;g.geom.vertEq(b.org,e.org)?b.org!==e.org&&(a.pq.remove(b.org.pqHandle),g.sweep.spliceMergeVertices_(a,e.oPrev(),b)):(g.mesh.splitEdge(e.sym),g.mesh.meshSplice(b,e.oPrev()),d.dirty=h.dirty=!0)}else{if(0>g.geom.edgeSign(b.dst(),e.org,b.org))return!1;d.regionAbove().dirty=d.dirty=!0;g.mesh.splitEdge(b.sym);g.mesh.meshSplice(e.oPrev(),b)}return!0};g.sweep.checkForLeftSplice_=
function(a,d){var h=d.regionBelow();a=d.eUp;var b=h.eUp;g.assert(!g.geom.vertEq(a.dst(),b.dst()));if(g.geom.vertLeq(a.dst(),b.dst())){if(0>g.geom.edgeSign(a.dst(),b.dst(),a.org))return!1;d.regionAbove().dirty=d.dirty=!0;h=g.mesh.splitEdge(a);g.mesh.meshSplice(b.sym,h);h.lFace.inside=d.inside}else{if(0<g.geom.edgeSign(b.dst(),a.dst(),b.org))return!1;d.dirty=h.dirty=!0;h=g.mesh.splitEdge(b);g.mesh.meshSplice(a.lNext,b.sym);h.rFace().inside=d.inside}return!0};g.sweep.checkForIntersect_=function(a,d){var h=
d.regionBelow(),b=d.eUp,e=h.eUp,m=b.org,c=e.org,l=b.dst(),f=e.dst(),t=new g.GluVertex;g.assert(!g.geom.vertEq(f,l));g.assert(0>=g.geom.edgeSign(l,a.event,m));g.assert(0<=g.geom.edgeSign(f,a.event,c));g.assert(m!==a.event&&c!==a.event);g.assert(!d.fixUpperEdge&&!h.fixUpperEdge);if(m===c||Math.min(m.t,l.t)>Math.max(c.t,f.t))return!1;if(g.geom.vertLeq(m,c)){if(0<g.geom.edgeSign(f,m,c))return!1}else if(0>g.geom.edgeSign(l,c,m))return!1;g.geom.edgeIntersect(l,m,f,c,t);g.assert(Math.min(m.t,l.t)<=t.t);
g.assert(t.t<=Math.max(c.t,f.t));g.assert(Math.min(f.s,l.s)<=t.s);g.assert(t.s<=Math.max(c.s,m.s));g.geom.vertLeq(t,a.event)&&(t.s=a.event.s,t.t=a.event.t);var x=g.geom.vertLeq(m,c)?m:c;g.geom.vertLeq(x,t)&&(t.s=x.s,t.t=x.t);if(g.geom.vertEq(t,m)||g.geom.vertEq(t,c))return g.sweep.checkForRightSplice_(a,d),!1;if(!g.geom.vertEq(l,a.event)&&0<=g.geom.edgeSign(l,a.event,t)||!g.geom.vertEq(f,a.event)&&0>=g.geom.edgeSign(f,a.event,t)){if(f===a.event)return g.mesh.splitEdge(b.sym),g.mesh.meshSplice(e.sym,
b),d=g.sweep.topLeftRegion_(d),b=d.regionBelow().eUp,g.sweep.finishLeftRegions_(a,d.regionBelow(),h),g.sweep.addRightEdges_(a,d,b.oPrev(),b,b,!0),!0;if(l===a.event)return g.mesh.splitEdge(e.sym),g.mesh.meshSplice(b.lNext,e.oPrev()),h=d,d=g.sweep.topRightRegion_(d),m=d.regionBelow().eUp.rPrev(),h.eUp=e.oPrev(),e=g.sweep.finishLeftRegions_(a,h,null),g.sweep.addRightEdges_(a,d,e.oNext,b.rPrev(),m,!0),!0;0<=g.geom.edgeSign(l,a.event,t)&&(d.regionAbove().dirty=d.dirty=!0,g.mesh.splitEdge(b.sym),b.org.s=
a.event.s,b.org.t=a.event.t);0>=g.geom.edgeSign(f,a.event,t)&&(d.dirty=h.dirty=!0,g.mesh.splitEdge(e.sym),e.org.s=a.event.s,e.org.t=a.event.t);return!1}g.mesh.splitEdge(b.sym);g.mesh.splitEdge(e.sym);g.mesh.meshSplice(e.oPrev(),b);b.org.s=t.s;b.org.t=t.t;b.org.pqHandle=a.pq.insert(b.org);g.sweep.getIntersectData_(a,b.org,m,l,c,f);d.regionAbove().dirty=d.dirty=h.dirty=!0;return!1};g.sweep.walkDirtyRegions_=function(a,d){for(var h=d.regionBelow();;){for(;h.dirty;)d=h,h=h.regionBelow();if(!d.dirty&&
(h=d,d=d.regionAbove(),null===d||!d.dirty))break;d.dirty=!1;var b=d.eUp,e=h.eUp;b.dst()!==e.dst()&&g.sweep.checkForLeftSplice_(a,d)&&(h.fixUpperEdge?(g.sweep.deleteRegion_(a,h),g.mesh.deleteEdge(e),h=d.regionBelow(),e=h.eUp):d.fixUpperEdge&&(g.sweep.deleteRegion_(a,d),g.mesh.deleteEdge(b),d=h.regionAbove(),b=d.eUp));if(b.org!==e.org)if(b.dst()===e.dst()||d.fixUpperEdge||h.fixUpperEdge||b.dst()!==a.event&&e.dst()!==a.event)g.sweep.checkForRightSplice_(a,d);else if(g.sweep.checkForIntersect_(a,d))break;
b.org===e.org&&b.dst()===e.dst()&&(g.sweep.addWinding_(e,b),g.sweep.deleteRegion_(a,d),g.mesh.deleteEdge(b),d=h.regionAbove())}};g.sweep.connectRightVertex_=function(a,d,h){var b=h.oNext,e=d.regionBelow(),m=d.eUp,c=e.eUp,l=!1;m.dst()!==c.dst()&&g.sweep.checkForIntersect_(a,d);g.geom.vertEq(m.org,a.event)&&(g.mesh.meshSplice(b.oPrev(),m),d=g.sweep.topLeftRegion_(d),b=d.regionBelow().eUp,g.sweep.finishLeftRegions_(a,d.regionBelow(),e),l=!0);g.geom.vertEq(c.org,a.event)&&(g.mesh.meshSplice(h,c.oPrev()),
h=g.sweep.finishLeftRegions_(a,e,null),l=!0);l?g.sweep.addRightEdges_(a,d,h.oNext,b,b,!0):(b=g.geom.vertLeq(c.org,m.org)?c.oPrev():m,b=g.mesh.connect(h.lPrev(),b),g.sweep.addRightEdges_(a,d,b,b.oNext,b.oNext,!1),b.sym.activeRegion.fixUpperEdge=!0,g.sweep.walkDirtyRegions_(a,d))};g.sweep.connectLeftDegenerate_=function(a,d,h){var b=d.eUp;if(g.geom.vertEq(b.org,h))g.assert(g.sweep.TOLERANCE_NONZERO_),g.sweep.TOLERANCE_NONZERO_&&g.sweep.spliceMergeVertices_(a,b,h.anEdge);else if(g.geom.vertEq(b.dst(),
h)){if(g.assert(g.sweep.TOLERANCE_NONZERO_),g.sweep.TOLERANCE_NONZERO_){d=g.sweep.topRightRegion_(d);var b=d.regionBelow(),e=b.eUp.sym,m=e.oNext,c=m;b.fixUpperEdge&&(g.assert(m!==e),g.sweep.deleteRegion_(a,b),g.mesh.deleteEdge(e),e=m.oPrev());g.mesh.meshSplice(h.anEdge,e);g.geom.edgeGoesLeft(m)||(m=null);g.sweep.addRightEdges_(a,d,e.oNext,c,m,!0)}}else g.mesh.splitEdge(b.sym),d.fixUpperEdge&&(g.mesh.deleteEdge(b.oNext),d.fixUpperEdge=!1),g.mesh.meshSplice(h.anEdge,b),g.sweep.sweepEvent_(a,h)};g.sweep.connectLeftVertex_=
function(a,d){var h=new g.ActiveRegion;h.eUp=d.anEdge.sym;var h=a.dict.search(h).getKey(),b=h.regionBelow(),e=h.eUp,m=b.eUp;0===g.geom.edgeSign(e.dst(),d,e.org)?g.sweep.connectLeftDegenerate_(a,h,d):(b=g.geom.vertLeq(m.dst(),e.dst())?h:b,h.inside||b.fixUpperEdge?(e=b===h?g.mesh.connect(d.anEdge.sym,e.lNext):g.mesh.connect(m.dNext(),d.anEdge).sym,b.fixUpperEdge?g.sweep.fixUpperEdge_(b,e):g.sweep.computeWinding_(a,g.sweep.addRegionBelow_(a,h,e)),g.sweep.sweepEvent_(a,d)):g.sweep.addRightEdges_(a,h,
d.anEdge,d.anEdge,null,!0))};g.sweep.sweepEvent_=function(a,d){a.event=d;for(var h=d.anEdge;null===h.activeRegion;)if(h=h.oNext,h===d.anEdge){g.sweep.connectLeftVertex_(a,d);return}d=g.sweep.topLeftRegion_(h.activeRegion);var b=d.regionBelow(),h=b.eUp,b=g.sweep.finishLeftRegions_(a,b,null);b.oNext===h?g.sweep.connectRightVertex_(a,d,b):g.sweep.addRightEdges_(a,d,b.oNext,h,h,!0)};g.sweep.addSentinel_=function(a,d){var h=new g.ActiveRegion,b=g.mesh.makeEdge(a.mesh);b.org.s=g.sweep.SENTINEL_COORD_;b.org.t=
d;b.dst().s=-g.sweep.SENTINEL_COORD_;b.dst().t=d;a.event=b.dst();h.eUp=b;h.windingNumber=0;h.inside=!1;h.fixUpperEdge=!1;h.sentinel=!0;h.dirty=!1;h.nodeUp=a.dict.insert(h)};g.sweep.initEdgeDict_=function(a){a.dict=new g.Dict(a,g.sweep.edgeLeq_);g.sweep.addSentinel_(a,-g.sweep.SENTINEL_COORD_);g.sweep.addSentinel_(a,g.sweep.SENTINEL_COORD_)};g.sweep.doneEdgeDict_=function(a){for(var d=0,h;null!==(h=a.dict.getMin().getKey());)h.sentinel||(g.assert(h.fixUpperEdge),g.assert(1===++d)),g.assert(0===h.windingNumber),
g.sweep.deleteRegion_(a,h);a.dict=null};g.sweep.removeDegenerateEdges_=function(a){for(var d=a.mesh.eHead,h,b=d.next;b!==d;b=h){h=b.next;var e=b.lNext;g.geom.vertEq(b.org,b.dst())&&b.lNext.lNext!==b&&(g.sweep.spliceMergeVertices_(a,e,b),g.mesh.deleteEdge(b),b=e,e=b.lNext);if(e.lNext===b){if(e!==b){if(e===h||e===h.sym)h=h.next;g.mesh.deleteEdge(e)}if(b===h||b===h.sym)h=h.next;g.mesh.deleteEdge(b)}}};g.sweep.initPriorityQ_=function(a){var d=new g.PriorityQ;a.pq=d;a=a.mesh.vHead;var h;for(h=a.next;h!==
a;h=h.next)h.pqHandle=d.insert(h);d.init()};g.sweep.donePriorityQ_=function(a){a.pq.deleteQ();a.pq=null};g.sweep.removeDegenerateFaces_=function(a){for(var d,h=a.fHead.next;h!==a.fHead;h=d)d=h.next,h=h.anEdge,g.assert(h.lNext!==h),h.lNext.lNext===h&&(g.sweep.addWinding_(h.oNext,h),g.mesh.deleteEdge(h))};g.tessmono={};g.tessmono.tessellateMonoRegion_=function(a){a=a.anEdge;for(g.assert(a.lNext!==a&&a.lNext.lNext!==a);g.geom.vertLeq(a.dst(),a.org);a=a.lPrev());for(;g.geom.vertLeq(a.org,a.dst());a=a.lNext);
for(var d=a.lPrev(),h;a.lNext!==d;)if(g.geom.vertLeq(a.dst(),d.org)){for(;d.lNext!==a&&(g.geom.edgeGoesLeft(d.lNext)||0>=g.geom.edgeSign(d.org,d.dst(),d.lNext.dst()));)h=g.mesh.connect(d.lNext,d),d=h.sym;d=d.lPrev()}else{for(;d.lNext!==a&&(g.geom.edgeGoesRight(a.lPrev())||0<=g.geom.edgeSign(a.dst(),a.org,a.lPrev().org));)h=g.mesh.connect(a,a.lPrev()),a=h.sym;a=a.lNext}for(g.assert(d.lNext!==a);d.lNext.lNext!==a;)h=g.mesh.connect(d.lNext,d),d=h.sym};g.tessmono.tessellateInterior=function(a){for(var d,
h=a.fHead.next;h!==a.fHead;h=d)d=h.next,h.inside&&g.tessmono.tessellateMonoRegion_(h)};g.tessmono.discardExterior=function(a){for(var d,h=a.fHead.next;h!==a.fHead;h=d)d=h.next,h.inside||g.mesh.zapFace(h)};g.tessmono.setWindingNumber=function(a,d,h){for(var b,e=a.eHead.next;e!==a.eHead;e=b)b=e.next,e.rFace().inside!==e.lFace.inside?e.winding=e.lFace.inside?d:-d:h?g.mesh.deleteEdge(e):e.winding=0};g.Dict=function(a,d){this.head_=new g.DictNode;this.frame_=a;this.leq_=d};g.Dict.prototype.deleteDict_=
function(){};g.Dict.prototype.insertBefore=function(a,d){do a=a.prev;while(null!==a.key&&!this.leq_(this.frame_,a.key,d));d=new g.DictNode(d,a.next,a);a.next.prev=d;return a.next=d};g.Dict.prototype.insert=function(a){return this.insertBefore(this.head_,a)};g.Dict.prototype.deleteNode=function(a){a.next.prev=a.prev;a.prev.next=a.next};g.Dict.prototype.search=function(a){var d=this.head_;do d=d.next;while(null!==d.key&&!this.leq_(this.frame_,a,d.key));return d};g.Dict.prototype.getMin=function(){return this.head_.next};
g.Dict.prototype.getMax=function(){return this.head_.prev};g.DictNode=function(a,d,h){this.key=a||null;this.next=d||this;this.prev=h||this};g.DictNode.prototype.getKey=function(){return this.key};g.DictNode.prototype.getSuccessor=function(){return this.next};g.DictNode.prototype.getPredecessor=function(){return this.prev};g.GluTesselator=function(){this.state_=g.GluTesselator.tessState_.T_DORMANT;this.errorCallback_=this.mesh=this.lastEdge_=null;this.normal_=[0,0,0];this.windingRule=g.windingRule.GLU_TESS_WINDING_ODD;
this.fatalError=!1;this.combineCallback_=this.event=this.pq=this.dict=null;this.boundaryOnly_=!1;this.polygonData_=this.meshCallback_=this.endCallback_=this.vertexCallback_=this.edgeFlagCallback_=this.beginCallback_=null};g.GluTesselator.tessState_={T_DORMANT:0,T_IN_POLYGON:1,T_IN_CONTOUR:2};g.GluTesselator.prototype.gluDeleteTess=function(){this.requireState_(g.GluTesselator.tessState_.T_DORMANT)};g.GluTesselator.prototype.gluTessProperty=function(a,d){switch(a){case g.gluEnum.GLU_TESS_TOLERANCE:return;
case g.gluEnum.GLU_TESS_WINDING_RULE:switch(d){case g.windingRule.GLU_TESS_WINDING_ODD:case g.windingRule.GLU_TESS_WINDING_NONZERO:case g.windingRule.GLU_TESS_WINDING_POSITIVE:case g.windingRule.GLU_TESS_WINDING_NEGATIVE:case g.windingRule.GLU_TESS_WINDING_ABS_GEQ_TWO:this.windingRule=d;return}break;case g.gluEnum.GLU_TESS_BOUNDARY_ONLY:this.boundaryOnly_=!!d;return;default:this.callErrorCallback(g.gluEnum.GLU_INVALID_ENUM);return}this.callErrorCallback(g.gluEnum.GLU_INVALID_VALUE)};g.GluTesselator.prototype.gluGetTessProperty=
function(a){switch(a){case g.gluEnum.GLU_TESS_TOLERANCE:return 0;case g.gluEnum.GLU_TESS_WINDING_RULE:return a=this.windingRule,g.assert(a===g.windingRule.GLU_TESS_WINDING_ODD||a===g.windingRule.GLU_TESS_WINDING_NONZERO||a===g.windingRule.GLU_TESS_WINDING_POSITIVE||a===g.windingRule.GLU_TESS_WINDING_NEGATIVE||a===g.windingRule.GLU_TESS_WINDING_ABS_GEQ_TWO),a;case g.gluEnum.GLU_TESS_BOUNDARY_ONLY:return g.assert(!0===this.boundaryOnly_||!1===this.boundaryOnly_),this.boundaryOnly_;default:this.callErrorCallback(g.gluEnum.GLU_INVALID_ENUM)}return!1};
g.GluTesselator.prototype.gluTessNormal=function(a,d,h){this.normal_[0]=a;this.normal_[1]=d;this.normal_[2]=h};g.GluTesselator.prototype.gluTessCallback=function(a,d){d=d?d:null;switch(a){case g.gluEnum.GLU_TESS_BEGIN:case g.gluEnum.GLU_TESS_BEGIN_DATA:this.beginCallback_=d;break;case g.gluEnum.GLU_TESS_EDGE_FLAG:case g.gluEnum.GLU_TESS_EDGE_FLAG_DATA:this.edgeFlagCallback_=d;break;case g.gluEnum.GLU_TESS_VERTEX:case g.gluEnum.GLU_TESS_VERTEX_DATA:this.vertexCallback_=d;break;case g.gluEnum.GLU_TESS_END:case g.gluEnum.GLU_TESS_END_DATA:this.endCallback_=
d;break;case g.gluEnum.GLU_TESS_ERROR:case g.gluEnum.GLU_TESS_ERROR_DATA:this.errorCallback_=d;break;case g.gluEnum.GLU_TESS_COMBINE:case g.gluEnum.GLU_TESS_COMBINE_DATA:this.combineCallback_=d;break;case g.gluEnum.GLU_TESS_MESH:this.meshCallback_=d;break;default:this.callErrorCallback(g.gluEnum.GLU_INVALID_ENUM)}};g.GluTesselator.prototype.gluTessVertex=function(a,d){var h=!1,b=[0,0,0];this.requireState_(g.GluTesselator.tessState_.T_IN_CONTOUR);for(var e=0;3>e;++e){var m=a[e];m<-g.GLU_TESS_MAX_COORD&&
(m=-g.GLU_TESS_MAX_COORD,h=!0);m>g.GLU_TESS_MAX_COORD&&(m=g.GLU_TESS_MAX_COORD,h=!0);b[e]=m}h&&this.callErrorCallback(g.errorType.GLU_TESS_COORD_TOO_LARGE);this.addVertex_(b,d)};g.GluTesselator.prototype.gluTessBeginPolygon=function(a){this.requireState_(g.GluTesselator.tessState_.T_DORMANT);this.state_=g.GluTesselator.tessState_.T_IN_POLYGON;this.mesh=new g.GluMesh;this.polygonData_=a};g.GluTesselator.prototype.gluTessBeginContour=function(){this.requireState_(g.GluTesselator.tessState_.T_IN_POLYGON);
this.state_=g.GluTesselator.tessState_.T_IN_CONTOUR;this.lastEdge_=null};g.GluTesselator.prototype.gluTessEndContour=function(){this.requireState_(g.GluTesselator.tessState_.T_IN_CONTOUR);this.state_=g.GluTesselator.tessState_.T_IN_POLYGON};g.GluTesselator.prototype.gluTessEndPolygon=function(){this.requireState_(g.GluTesselator.tessState_.T_IN_POLYGON);this.state_=g.GluTesselator.tessState_.T_DORMANT;g.normal.projectPolygon(this,this.normal_[0],this.normal_[1],this.normal_[2]);g.sweep.computeInterior(this);
if(!this.fatalError){var a=this.mesh;this.boundaryOnly_?g.tessmono.setWindingNumber(a,1,!0):g.tessmono.tessellateInterior(a);this.mesh.checkMesh();if(this.beginCallback_||this.endCallback_||this.vertexCallback_||this.edgeFlagCallback_)this.boundaryOnly_?g.render.renderBoundary(this,this.mesh):g.render.renderMesh(this,this.mesh,!!this.edgeFlagCallback_);if(this.meshCallback_){g.tessmono.discardExterior(this.mesh);this.meshCallback_(this.mesh);this.polygonData_=this.mesh=null;return}}g.mesh.deleteMesh(this.mesh);
this.mesh=this.polygonData_=null};g.GluTesselator.prototype.requireState_=function(a){this.state_!==a&&this.gotoState_(a)};g.GluTesselator.prototype.gotoState_=function(a){for(;this.state_!==a;)if(this.state_<a)switch(this.state_){case g.GluTesselator.tessState_.T_DORMANT:this.callErrorCallback(g.errorType.GLU_TESS_MISSING_BEGIN_POLYGON);this.gluTessBeginPolygon(null);break;case g.GluTesselator.tessState_.T_IN_POLYGON:this.callErrorCallback(g.errorType.GLU_TESS_MISSING_BEGIN_CONTOUR),this.gluTessBeginContour()}else switch(this.state_){case g.GluTesselator.tessState_.T_IN_CONTOUR:this.callErrorCallback(g.errorType.GLU_TESS_MISSING_END_CONTOUR);
this.gluTessEndContour();break;case g.GluTesselator.tessState_.T_IN_POLYGON:this.callErrorCallback(g.errorType.GLU_TESS_MISSING_END_POLYGON),this.gluTessEndPolygon()}};g.GluTesselator.prototype.addVertex_=function(a,d){var h=this.lastEdge_;null===h?(h=g.mesh.makeEdge(this.mesh),g.mesh.meshSplice(h,h.sym)):(g.mesh.splitEdge(h),h=h.lNext);h.org.data=d;h.org.coords[0]=a[0];h.org.coords[1]=a[1];h.org.coords[2]=a[2];h.winding=1;h.sym.winding=-1;this.lastEdge_=h};g.GluTesselator.prototype.callBeginCallback=
function(a){this.beginCallback_&&this.beginCallback_(a,this.polygonData_)};g.GluTesselator.prototype.callVertexCallback=function(a){this.vertexCallback_&&this.vertexCallback_(a,this.polygonData_)};g.GluTesselator.prototype.callEdgeFlagCallback=function(a){this.edgeFlagCallback_&&this.edgeFlagCallback_(a,this.polygonData_)};g.GluTesselator.prototype.callEndCallback=function(){this.endCallback_&&this.endCallback_(this.polygonData_)};g.GluTesselator.prototype.callCombineCallback=function(a,d,h){return this.combineCallback_?
this.combineCallback_(a,d,h,this.polygonData_)||null:null};g.GluTesselator.prototype.callErrorCallback=function(a){this.errorCallback_&&this.errorCallback_(a,this.polygonData_)};g.GluFace=function(a,d){this.next=a||this;this.prev=d||this;this.anEdge=null;this.inside=!1};g.GluHalfEdge=function(a){this.next=a||this;this.activeRegion=this.lFace=this.org=this.lNext=this.oNext=this.sym=null;this.winding=0};g.GluHalfEdge.prototype.rFace=function(){return this.sym.lFace};g.GluHalfEdge.prototype.dst=function(){return this.sym.org};
g.GluHalfEdge.prototype.oPrev=function(){return this.sym.lNext};g.GluHalfEdge.prototype.lPrev=function(){return this.oNext.sym};g.GluHalfEdge.prototype.dPrev=function(){return this.lNext.sym};g.GluHalfEdge.prototype.rPrev=function(){return this.sym.oNext};g.GluHalfEdge.prototype.dNext=function(){return this.rPrev().sym};g.GluHalfEdge.prototype.rNext=function(){return this.oPrev().sym};g.GluMesh=function(){this.vHead=new g.GluVertex;this.fHead=new g.GluFace;this.eHead=new g.GluHalfEdge;this.eHeadSym=
new g.GluHalfEdge;this.eHead.sym=this.eHeadSym;this.eHeadSym.sym=this.eHead};g.GluMesh.prototype.checkMesh=function(){if(g.DEBUG){var a=this.fHead,d=this.vHead,h=this.eHead,b,e;for(b=b=a;(e=b.next)!==a;b=e){g.assert(e.prev===b);b=e.anEdge;do g.assert(b.sym!==b),g.assert(b.sym.sym===b),g.assert(b.lNext.oNext.sym===b),g.assert(b.oNext.sym.lNext===b),g.assert(b.lFace===e),b=b.lNext;while(b!==e.anEdge)}g.assert(e.prev===b&&null===e.anEdge);for(b=b=d;(a=b.next)!==d;b=a){g.assert(a.prev===b);b=a.anEdge;
do g.assert(b.sym!==b),g.assert(b.sym.sym===b),g.assert(b.lNext.oNext.sym===b),g.assert(b.oNext.sym.lNext===b),g.assert(b.org===a),b=b.oNext;while(b!==a.anEdge)}g.assert(a.prev===b&&null===a.anEdge&&null===a.data);for(d=d=h;(b=d.next)!==h;d=b)g.assert(b.sym.next===d.sym),g.assert(b.sym!==b),g.assert(b.sym.sym===b),g.assert(null!==b.org),g.assert(null!==b.dst()),g.assert(b.lNext.oNext.sym===b),g.assert(b.oNext.sym.lNext===b);g.assert(b.sym.next===d.sym&&b.sym===this.eHeadSym&&b.sym.sym===b&&null===
b.org&&null===b.dst()&&null===b.lFace&&null===b.rFace())}};g.GluVertex=function(a,d){this.next=a||this;this.prev=d||this;this.data=this.anEdge=null;this.coords=[0,0,0];this.pqHandle=this.t=this.s=0};g.PriorityQ=function(){this.verts_=[];this.order_=null;this.size_=0;this.initialized_=!1;this.heap_=new g.PriorityQHeap};g.PriorityQ.prototype.deleteQ=function(){this.verts_=this.order_=this.heap_=null};g.PriorityQ.prototype.init=function(){this.order_=[];for(var a=0;a<this.size_;a++)this.order_[a]=a;
a=function(a){return function(b,e){return g.geom.vertLeq(a[b],a[e])?1:-1}}(this.verts_);this.order_.sort(a);this.initialized_=!0;this.heap_.init();if(g.DEBUG)for(var d=0+this.size_-1,a=0;a<d;++a)g.assert(g.geom.vertLeq(this.verts_[this.order_[a+1]],this.verts_[this.order_[a]]))};g.PriorityQ.prototype.insert=function(a){if(this.initialized_)return this.heap_.insert(a);var d=this.size_++;this.verts_[d]=a;return-(d+1)};g.PriorityQ.prototype.extractMin=function(){if(0===this.size_)return this.heap_.extractMin();
var a=this.verts_[this.order_[this.size_-1]];if(!this.heap_.isEmpty()){var d=this.heap_.minimum();if(g.geom.vertLeq(d,a))return this.heap_.extractMin()}do--this.size_;while(0<this.size_&&null===this.verts_[this.order_[this.size_-1]]);return a};g.PriorityQ.prototype.minimum=function(){if(0===this.size_)return this.heap_.minimum();var a=this.verts_[this.order_[this.size_-1]];if(!this.heap_.isEmpty()){var d=this.heap_.minimum();if(g.geom.vertLeq(d,a))return d}return a};g.PriorityQ.prototype.remove=function(a){if(0<=
a)this.heap_.remove(a);else for(a=-(a+1),g.assert(a<this.verts_.length&&null!==this.verts_[a]),this.verts_[a]=null;0<this.size_&&null===this.verts_[this.order_[this.size_-1]];)--this.size_};g.PriorityQHeap=function(){this.heap_=g.PriorityQHeap.reallocNumeric_([0],g.PriorityQHeap.INIT_SIZE_+1);this.verts_=[null,null];this.handles_=[0,0];this.size_=0;this.max_=g.PriorityQHeap.INIT_SIZE_;this.freeList_=0;this.initialized_=!1;this.heap_[1]=1};g.PriorityQHeap.INIT_SIZE_=32;g.PriorityQHeap.reallocNumeric_=
function(a,d){for(var h=Array(d),b=0;b<a.length;b++)h[b]=a[b];for(;b<d;b++)h[b]=0;return h};g.PriorityQHeap.prototype.init=function(){for(var a=this.size_;1<=a;--a)this.floatDown_(a);this.initialized_=!0};g.PriorityQHeap.prototype.insert=function(a){var d=++this.size_;2*d>this.max_&&(this.max_*=2,this.handles_=g.PriorityQHeap.reallocNumeric_(this.handles_,this.max_+1));var h;0===this.freeList_?h=d:(h=this.freeList_,this.freeList_=this.handles_[this.freeList_]);this.verts_[h]=a;this.handles_[h]=d;
this.heap_[d]=h;this.initialized_&&this.floatUp_(d);return h};g.PriorityQHeap.prototype.isEmpty=function(){return 0===this.size_};g.PriorityQHeap.prototype.minimum=function(){return this.verts_[this.heap_[1]]};g.PriorityQHeap.prototype.extractMin=function(){var a=this.heap_,d=this.verts_,h=this.handles_,b=a[1],e=d[b];0<this.size_&&(a[1]=a[this.size_],h[a[1]]=1,d[b]=null,h[b]=this.freeList_,this.freeList_=b,0<--this.size_&&this.floatDown_(1));return e};g.PriorityQHeap.prototype.remove=function(a){var d=
this.heap_,h=this.verts_,b=this.handles_;g.assert(1<=a&&a<=this.max_&&null!==h[a]);var e=b[a];d[e]=d[this.size_];b[d[e]]=e;e<=--this.size_&&(1>=e?this.floatDown_(e):g.geom.vertLeq(h[d[e>>1]],h[d[e]])?this.floatDown_(e):this.floatUp_(e));h[a]=null;b[a]=this.freeList_;this.freeList_=a};g.PriorityQHeap.prototype.floatDown_=function(a){for(var d=this.heap_,h=this.verts_,b=this.handles_,e=d[a];;){var m=a<<1;m<this.size_&&g.geom.vertLeq(h[d[m+1]],h[d[m]])&&(m+=1);g.assert(m<=this.max_);var c=d[m];if(m>
this.size_||g.geom.vertLeq(h[e],h[c])){d[a]=e;b[e]=a;break}d[a]=c;b[c]=a;a=m}};g.PriorityQHeap.prototype.floatUp_=function(a){for(var d=this.heap_,h=this.verts_,b=this.handles_,e=d[a];;){var m=a>>1,c=d[m];if(0===m||g.geom.vertLeq(h[c],h[e])){d[a]=e;b[e]=a;break}d[a]=c;b[c]=a;a=m}};g.ActiveRegion=function(){this.nodeUp=this.eUp=null;this.windingNumber=0;this.fixUpperEdge=this.dirty=this.sentinel=this.inside=!1};g.ActiveRegion.prototype.regionBelow=function(){return this.nodeUp.getPredecessor().getKey()};
g.ActiveRegion.prototype.regionAbove=function(){return this.nodeUp.getSuccessor().getKey()};return g})},"esri/views/2d/engine/webgl/util/Lock":function(){define(["require","exports","../../../../../core/promiseUtils"],function(g,a,d){Object.defineProperty(a,"__esModule",{value:!0});g=function(){function a(){this._resolver=null}a.prototype.isHeld=function(){return!!this._resolver};a.prototype.acquire=function(){var a=this;return this._resolver?this._resolver.promise.then(function(){return a.acquire()}):
(this._resolver=d.createResolver(),d.resolve())};a.prototype.release=function(){var a=this._resolver;this._resolver=null;a.resolve()};return a}();a.default=g;a.withLock=function(a,b,e){return a.acquire().then(function(){return b(e)}).then(function(){return a.release()}).catch(function(b){a.release();throw b;})}})},"esri/views/2d/engine/webgl/TileData":function(){define("require exports ./MemoryRequirements ./TileBufferData ./TileDisplayData ./Utils ./Utils ./WGLDisplayObject ./WGLDisplayRecord ./mesh/VertexBuffer ./util/Reader ./util/serializationUtils ./util/Writer".split(" "),
function(g,a,d,h,b,e,m,c,l,f,t,x,n){Object.defineProperty(a,"__esModule",{value:!0});var p=new d.default,y=new d.default;g=function(){function a(){this.tileBufferData=this.tileDisplayData=null}a.prototype.reshuffle=function(){p.reset();for(var c=b.groupRecordsByGeometryType(this.tileDisplayData.displayObjects),d=0;d<c.length;d++)for(var f=c[d],l=0,g=f;l<g.length;l++){var n=g[l];n&&p.needMore(n.geometryType,n.meshData?n.meshData.vertexCount:n.vertexCount,n.meshData?n.meshData.indexData.length:n.indexCount)}l=
c.length;d=new h;for(g=0;g<l;++g){d.geometries[g].indexBuffer=new Uint32Array(Math.round(1.15*p.indicesFor(g)));var n=[],t;for(t in this.tileBufferData.geometries[g].vertexBuffer)n.push(this.tileBufferData.geometries[g].vertexBuffer[t].stride);var n=a._computeVertexAlignment(n),f=Math.round(1.15*p.verticesFor(g)),n=a._align(f,n),u;for(u in this.tileBufferData.geometries[g].vertexBuffer)f=this.tileBufferData.geometries[g].vertexBuffer[u].stride,d.geometries[g].vertexBuffer[u]={stride:f,data:m.allocateTypedArrayBuffer(n,
f)}}y.reset();this.tileDisplayData.displayList.clear();for(g=0;g<l;++g){f=c[g];t=0;for(u=f;t<u.length;t++){n=u[t];if(n.meshData)n.writeMeshDataToBuffers(y.verticesFor(g),d.geometries[g].vertexBuffer,y.indicesFor(g),d.geometries[g].indexBuffer),n.meshData=null;else{var x=this.tileBufferData.geometries[g].vertexBuffer,I=this.tileBufferData.geometries[g].indexBuffer,L=d.geometries[g].vertexBuffer,H=d.geometries[g].indexBuffer,G=y.verticesFor(g),M=y.indicesFor(g);e.copyMeshData(G,M,L,H,n,x,I);n.vertexFrom=
G;n.indexFrom=M}y.needMore(g,n.vertexCount,n.indexCount)}this.tileDisplayData.displayList.unified||this.tileDisplayData.displayList.addToList(f)}if(this.tileDisplayData.displayList.unified)for(c=0,l=this.tileDisplayData.displayObjects;c<l.length;c++)this.tileDisplayData.displayList.addToList(l[c].displayRecords);this.tileBufferData=d};a.prototype.getStrides=function(){for(var a=[],b=0;b<this.tileBufferData.geometries.length;++b){var c=this.tileBufferData.geometries[b];a[b]={};for(var e in c.vertexBuffer)a[b][e]=
c.vertexBuffer[e].stride}return a};a.prototype.clone=function(){var b=new a;b.tileBufferData=this.tileBufferData.clone();b.tileDisplayData=this.tileDisplayData.clone();return b};a.prototype._guessSize=function(){for(var a=this.tileDisplayData.displayObjects,b=Math.min(a.length,4),c=0,e=0;e<b;e++)c=Math.max(c,a[e].displayRecords.length);return 2*(12*a.length+a.length*c*40)};a.prototype.serialize=function(){var a=this.tileBufferData.serialize(),b=this.tileBufferData.getBuffers(),c=this.tileDisplayData.serialize(new n.default(Int32Array,
this._guessSize())).buffer();b.push(c);return{result:{displayData:c,bufferData:a},transferList:b}};a.decode=function(b){var e=x.deserializeList(new t.default(b.displayObjects),c),d={},k;for(k in b.vertexBuffersMap)d[k]=f.VertexBuffers.decode(b.vertexBuffersMap[k]);return a.fromMeshData({displayObjects:e,vertexBuffersMap:d})};a.fromMeshData=function(c){var e=new a,d=new b.default,f=new h;d.displayObjects=c.displayObjects;for(var k in c.vertexBuffersMap){var g=c.vertexBuffersMap[k];f.geometries[k].indexBuffer=
g.indexBuffer;f.geometries[k].vertexBuffer=g.namedBuffers}e.tileDisplayData=d;e.tileBufferData=f;return e};a.bind=function(b,c){var e=new a;e.tileDisplayData=b;e.tileBufferData=c;return e};a.create=function(c,e){var d=new a;d.tileDisplayData=new b.default;d.tileDisplayData.displayObjects=c;for(var f=[0,0,0,0,0],k=[0,0,0,0,0],g=[[],[],[],[],[]],n=0;n<c.length;n++)for(var p=0,r=c[n].displayRecords;p<r.length;p++){var t=r[p];g[t.geometryType].push(t);f[t.geometryType]+=t.meshData.vertexCount;k[t.geometryType]+=
t.meshData.indexData.length}c=new h;e=[e.fill||{},e.line||{},e.icon||{},e.text||{},e.label||{}];for(n=0;5>n;n++){var p=new Uint32Array(k[n]),r=e[n],t=f[n],u={},y=void 0;for(y in r){var x={data:m.allocateTypedArrayBuffer(t,r[y]),stride:r[y]};u[y]=x}r=u;l.writeAllMeshDataToBuffers(g[n],r,p);c.geometries[n]={indexBuffer:p,vertexBuffer:r}}d.tileBufferData=c;return d};a._align=function(a,b){var c=a%b;return 0===c?a:a+(b-c)};a._computeVertexAlignment=function(a){for(var b=!1,c=!1,e=0;e<a.length;e++){var d=
a[e];2===d%4?b=!0:0!==d%4&&(c=!0)}return c?4:b?2:1};return a}();a.TileData=g})},"esri/views/2d/engine/webgl/MemoryRequirements":function(){define(["require","exports"],function(g,a){Object.defineProperty(a,"__esModule",{value:!0});g=function(){function a(){this._byGeometryType=null}Object.defineProperty(a.prototype,"satisfied",{get:function(){return!this._byGeometryType},enumerable:!0,configurable:!0});a.prototype.reset=function(){this._byGeometryType=null};a.prototype.verticesFor=function(a){return this._byGeometryType?
this._byGeometryType[a].vertices:0};a.prototype.indicesFor=function(a){return this._byGeometryType?this._byGeometryType[a].indices:0};a.prototype.needMore=function(a,b,e){if(b||e)this._byGeometryType||(this._byGeometryType=[{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0}]),a=this._byGeometryType[a],a.vertices+=b,a.indices+=e};return a}();a.default=g})},"esri/views/2d/engine/webgl/TileBufferData":function(){define(["require","exports",
"./Utils"],function(g,a,d){return function(){function a(){this.geometries=[{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}}]}a.prototype.clone=function(){for(var b=new a,e=0;e<this.geometries.length;e++){var d=this.geometries[e],c=b.geometries[e];c.indexBuffer=d.indexBuffer.slice();c.vertexBuffer={};for(var h in d.vertexBuffer){var f=d.vertexBuffer[h],g=f.stride;
c.vertexBuffer[h]={data:f.data.slice(),stride:g}}}return b};a.deserialize=function(b){for(var e=new a,h=0;5>h;++h){e.geometries[h].indexBuffer=new Uint32Array(b.geometries[h].indexBuffer);e.geometries[h].vertexBuffer={};for(var c in b.geometries[h].vertexBuffer)e.geometries[h].vertexBuffer[c]={data:d.allocateTypedArrayBufferwithData(b.geometries[h].vertexBuffer[c].data,b.geometries[h].vertexBuffer[c].stride),stride:b.geometries[h].vertexBuffer[c].stride}}return e};a.prototype.serialize=function(){for(var a=
{geometries:[{indexBuffer:this.geometries[0].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[1].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[2].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[3].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[4].indexBuffer.buffer,vertexBuffer:{}}]},e=0;5>e;++e)for(var d in this.geometries[e].vertexBuffer)a.geometries[e].vertexBuffer[d]={data:this.geometries[e].vertexBuffer[d].data.buffer,stride:this.geometries[e].vertexBuffer[d].stride};
return a};a.prototype.getBuffers=function(){for(var a=[],e=0;5>e;++e){a.push(this.geometries[e].indexBuffer.buffer);for(var d in this.geometries[e].vertexBuffer)a.push(this.geometries[e].vertexBuffer[d].data.buffer)}return a};return a}()})},"esri/views/2d/engine/webgl/TileDisplayData":function(){define(["require","exports","./WGLDisplayList","./WGLDisplayObject","./util/serializationUtils"],function(g,a,d,h,b){function e(a){for(var b=[[],[],[],[],[]],e=0;e<a.length;e++)for(var d=0,h=a[e].displayRecords;d<
h.length;d++){var g=h[d];b[g.geometryType].push(g)}return b}Object.defineProperty(a,"__esModule",{value:!0});a.groupRecordsByGeometryType=e;g=function(){function a(){}Object.defineProperty(a.prototype,"displayObjectRegistry",{get:function(){if(!this._displayObjectRegistry){this._displayObjectRegistry=new Map;for(var a=0,b=this.displayObjects;a<b.length;a++){var e=b[a];this._displayObjectRegistry.set(e.id,e)}}return this._displayObjectRegistry},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"displayList",{get:function(){return this._displayList},enumerable:!0,configurable:!0});a.prototype.computeDisplayList=function(a){this._displayList=new d(a);if(a){a=0;for(var b=this.displayObjects;a<b.length;a++)for(var c=0,h=b[a].displayRecords;c<h.length;c++)this._displayList.addToList(h[c])}else for(a=e(this.displayObjects),b=a.length,c=0;c<b;++c)this._displayList.addToList(a[c])};a.prototype.clone=function(){var b=new a;this.displayObjects&&(b.displayObjects=this.displayObjects.map(function(a){return a.clone()}));
return b};a.prototype.serialize=function(a){b.serializeList(a,this.displayObjects);return a};a.prototype._deserializeObjects=function(a){for(var b=a.readInt32(),b=Array(b),c=new Map,e=0;e<b.length;++e){var d=h.deserialize(a);b[e]=d;c.set(d.id,d)}this.displayObjects=b;this._displayList=null;this._displayObjectRegistry=c};a.deserialize=function(b){var c=new a;c._deserializeObjects(b);return c};return a}();a.default=g})},"esri/views/2d/engine/webgl/WGLDisplayList":function(){define(["require","exports",
"../../../../core/tsSupport/generatorHelper","../../../../core/Logger","./enums"],function(g,a,d,h,b){function e(a,b,c){for(var e=[],d=3;d<arguments.length;d++)e[d-3]=arguments[d];b<a.length?a.splice.apply(a,[b,c].concat(e)):a.push.apply(a,e)}var m=h.getLogger("esri.views.2d.engine.webgl.WGLDisplayList");g=new Map;g.set(b.WGLDrawPhase.MAP,[b.WGLGeometryType.FILL,b.WGLGeometryType.LINE,b.WGLGeometryType.MARKER,b.WGLGeometryType.TEXT]);g.set(b.WGLDrawPhase.LABEL,[b.WGLGeometryType.LABEL]);g.set(b.WGLDrawPhase.LABEL_ALPHA,
[b.WGLGeometryType.LABEL]);g=function(){function a(a){void 0===a&&(a=!1);this.symbolLevels=[];this.unified=a}a.prototype.replay=function(a,b,c){if(this.unified)for(var e=0,d=this.symbolLevels;e<d.length;e++)for(var f=0,h=d[e].zLevels;f<h.length;f++){var g=h[f].geometryDPInfo,l;for(l in g)if(g[l])for(var m=0,n=g[l];m<n.length;m++){var p=n[m],t=a.painter.getGeometryBrush(p.geometryType),y=b.getGeometry(p.geometryType);t.prepareState(a,b);t.drawGeometry(a,b,p,y,c)}}};Object.defineProperty(a.prototype,
"empty",{get:function(){return!this.symbolLevels||0===this.symbolLevels.length},enumerable:!0,configurable:!0});a.prototype.clear=function(){this.symbolLevels.length=0};a.prototype.addToList=function(a,b){if(Array.isArray(a))for(var c=0;c<a.length;c++)this._addToList(a[c],b);else this._addToList(a,b)};a.prototype.removeFromList=function(a){Array.isArray(a)||(a=[a]);for(var b=null,c=0;c<a.length;c++)b=this._removeFromList(a[c]);return b};a.prototype.byType=function(a,b){for(var c=0,e=this.symbolLevels;c<
e.length;c++)for(var d=0,f=e[c].zLevels;d<f.length;d++){var h=f[d].geometryDPInfo,g=this.getDPInfoType(a);if(h[g])for(var l=0,h=h[g];l<h.length;l++)b(h[l])}};a.prototype.clone=function(){for(var b=new a(this.unified),c=0,e=this.symbolLevels;c<e.length;c++)b.symbolLevels.push(e[c].clone());return b};a.prototype.splitAfter=function(a){for(var b=this._getDisplayList(a.symbolLevel,a.zOrder,a.geometryType),e=b.length,d=a.indexFrom+a.indexCount,f=0;f<e;++f){var h=b[f];if(h.geometryType===a.geometryType&&
d>h.indexFrom&&d<=h.indexFrom+h.indexCount)return d<h.indexFrom+h.indexCount&&(a=new c,a.geometryType=h.geometryType,a.materialKey=h.materialKey,a.indexFrom=d,a.indexCount=h.indexFrom+h.indexCount-d,b.splice(f+1,0,a),h.indexCount=d-h.indexFrom),f}};a.prototype._addToList=function(a,b){var d=this._getDisplayList(a.symbolLevel,a.zOrder,a.geometryType);b=null!=b?b:d.length-1;var f=0<=b&&b<d.length?d[b]:null;null===f||f.materialKey!==a.materialKey||f.indexFrom+f.indexCount!==a.indexFrom||this.unified&&
f.geometryType!==a.geometryType?(f=new c,f.indexFrom=a.indexFrom,f.indexCount=a.indexCount,f.materialKey=a.materialKey,f.geometryType=a.geometryType,e(d,b+1,0,f)):f.indexCount+=a.indexCount};a.prototype._removeFromList=function(a){for(var b=this._getDisplayList(a.symbolLevel,a.zOrder,a.geometryType),d=b.length,f=void 0,k=0;k<d;++k){var h=b[k];if(a.indexFrom+a.indexCount>h.indexFrom&&a.indexFrom<h.indexFrom+h.indexCount&&(!this.unified||h.geometryType===a.geometryType)){f=k;break}}if(void 0!==f){h=
b[f];if(a.indexFrom===h.indexFrom)return h.indexCount-=a.indexCount,h.indexFrom+=a.indexCount,0===h.indexCount&&e(b,f,1),f-1;if(a.indexFrom+a.indexCount===h.indexFrom+h.indexCount)return h.indexCount-=a.indexCount,0===h.indexCount?(e(b,f,1),f-1):f;var d=h.indexFrom,k=a.indexFrom-h.indexFrom,g=a.indexCount;a=h.indexFrom+h.indexCount-(a.indexFrom+a.indexCount);h.indexCount=k;var l=new c;l.geometryType=h.geometryType;l.materialKey=h.materialKey;l.indexFrom=d+k+g;l.indexCount=a;e(b,f+1,0,l);return f}return null};
a.prototype._getDisplayList=function(a,c,e){for(var d,k=this.symbolLevels.length,h=0;h<k;h++)if(this.symbolLevels[h].symbolLevel===a){d=this.symbolLevels[h];break}d||(d=new t,d.symbolLevel=a,this.symbolLevels.push(d));var g;a=d.zLevels.length;for(k=0;k<a;k++)if(d.zLevels[k].zLevel===c){g=d.zLevels[k];break}g||(g=new f,g.geometryDPInfo=new l,g.zLevel=c,d.zLevels.push(g));var m;if(this.unified)g.geometryDPInfo.unified||(g.geometryDPInfo.unified=[]),m=g.geometryDPInfo.unified;else switch(e){case b.WGLGeometryType.FILL:g.geometryDPInfo.fill||
(g.geometryDPInfo.fill=[]);m=g.geometryDPInfo.fill;break;case b.WGLGeometryType.LINE:g.geometryDPInfo.line||(g.geometryDPInfo.line=[]);m=g.geometryDPInfo.line;break;case b.WGLGeometryType.MARKER:g.geometryDPInfo.marker||(g.geometryDPInfo.marker=[]);m=g.geometryDPInfo.marker;break;case b.WGLGeometryType.TEXT:g.geometryDPInfo.text||(g.geometryDPInfo.text=[]);m=g.geometryDPInfo.text;break;case b.WGLGeometryType.LABEL:g.geometryDPInfo.label||(g.geometryDPInfo.label=[]);m=g.geometryDPInfo.label;break;
default:console.error("Trying to add a record with geometry type '"+e+"'.")}return m};a.prototype.getDPInfoType=function(a){if(this.unified)return"unified";switch(a){case b.WGLGeometryType.FILL:return"fill";case b.WGLGeometryType.LINE:return"line";case b.WGLGeometryType.MARKER:return"marker";case b.WGLGeometryType.TEXT:return"text";case b.WGLGeometryType.LABEL:return"label";default:m.error("DisplayList: Tried to convert unknown geometryType: "+a)}};return a}();var c=function(){function a(){this.materialKey=
null;this.indexCount=this.indexFrom=0}a.prototype.clone=function(){var b=new a;b.geometryType=this.geometryType;b.materialKey=this.materialKey;b.indexFrom=this.indexFrom;b.indexCount=this.indexCount;return b};return a}(),l=function(){function a(){this.unified=this.label=this.text=this.marker=this.line=this.fill=null}a.prototype.clone=function(){var b=new a;b.fill=this.fill&&this.fill.map(function(a){return a.clone()});b.line=this.line&&this.line.map(function(a){return a.clone()});b.marker=this.marker&&
this.marker.map(function(a){return a.clone()});b.text=this.text&&this.text.map(function(a){return a.clone()});b.label=this.label&&this.label.map(function(a){return a.clone()});b.unified=this.unified&&this.unified.map(function(a){return a.clone()});return b};return a}(),f=function(){function a(){this.geometryDPInfo=new l}a.prototype.clone=function(){var b=new a;b.zLevel=this.zLevel;b.geometryDPInfo=this.geometryDPInfo.clone();return b};return a}(),t=function(){function a(){this.zLevels=[]}a.prototype.clone=
function(){var b=new a;b.symbolLevel=this.symbolLevel;for(var c=0,e=this.zLevels;c<e.length;c++)b.zLevels.push(e[c].clone());return b};return a}();return g})},"esri/views/2d/engine/webgl/util/Reader":function(){define(["require","exports"],function(g,a){Object.defineProperty(a,"__esModule",{value:!0});g=function(){function a(a){this._pos=0;this._buffer=a;this._i32View=new Int32Array(this._buffer);this._f32View=new Float32Array(this._buffer)}a.prototype.readInt32=function(){return this._i32View[this._pos++]};
a.prototype.readF32=function(){return this._f32View[this._pos++]};return a}();a.default=g})},"esri/views/2d/engine/webgl/WGLRendererInfo":function(){define("require exports ../../../../core/tsSupport/assignHelper ../../../../Color ../../../../core/has ../../../../core/maybe ../../../../core/screenUtils ../../../../core/unitUtils ../../../../core/libs/gl-matrix-2/mat4f32 ../../../../renderers/support/utils ./definitions ./Utils".split(" "),function(g,a,d,h,b,e,m,c,l,f,t,x){function n(a,b){var c=b.length;
if(a<b[0].value||1===c)return b[0].size;for(var e=1;e<c;e++)if(a<b[e].value)return b[e-1].size+(a-b[e-1].value)/(b[e].value-b[e-1].value)*(b[e].size-b[e-1].size);return b[c-1].size}function p(a,b,c){void 0===c&&(c=0);if(e.isNone(b))a[c+0]=0,a[c+1]=0,a[c+2]=0,a[c+3]=0;else{var d=b.g,f=b.b,k=b.a;a[c+0]=b.r*k/255;a[c+1]=d*k/255;a[c+2]=f*k/255;a[c+3]=k}}Object.defineProperty(a,"__esModule",{value:!0});var y=function(a,b,c){for(var e=c*=16,d=0;e<Math.min(c+16,a.length);e++,d++)a[e]=b[d]},u=l.mat4f32.create();
g=function(){function a(){this.symbolLevels=[];this.vvColorValues=new Float32Array(8);this.vvColors=new Float32Array(32);this.vvOpacityValues=new Float32Array(8);this.vvOpacities=new Float32Array(8);this.vvSizeMinMaxValue=new Float32Array(4);this.ddColors=new Float32Array(32);this.ddBackgroundColor=new Float32Array(4);this.ddActiveDots=new Float32Array(8);this.insideEffect=new Float32Array(16*t.MAX_FILTERS);this.insideOpacity=1;this.outsideEffect=new Float32Array(16*t.MAX_FILTERS);this.outsideOpacity=
1;this.effectCount=0;this._vvMaterialParameters={vvSizeEnabled:!1,vvColorEnabled:!1,vvRotationEnabled:!1,vvRotationType:"geographic",vvOpacityEnabled:!1};this._buf0=new Float32Array(2);this._buf1=new Float32Array(2);this.symbolLevels.push(0);for(var a=0;a<t.MAX_FILTERS;a++)y(this.insideEffect,u,a),y(this.outsideEffect,u,a)}Object.defineProperty(a.prototype,"insideOpacities",{get:function(){this._buf0[0]=1;this._buf0[1]=this.insideOpacity;return this._buf0},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"outsideOpacities",{get:function(){this._buf1[0]=0;this._buf1[1]=this.outsideOpacity;return this._buf1},enumerable:!0,configurable:!0});a.prototype.getSizeVVFieldStops=function(a){var b=this._vvSizeFieldStops;switch(b.type){case "static":return b;case "level-dependent":return e.unwrapOr(b.levels[a],function(){var c=Infinity,d=0,f;for(f in b.levels){var k=parseFloat(f),h=Math.abs(a-k);h<c&&(c=h,d=k)}if(Infinity===c)return{sizes:new Float32Array([0,0,0,0,0,0]),values:new Float32Array([0,0,0,0,0,0])};
c=Math.pow(2,(a-d)/2);d=e.expect(b.levels[d]);f=new Float32Array(d.values);f[2]*=c;f[3]*=c;return{sizes:e.unwrap(d.sizes),values:f}})}};Object.defineProperty(a.prototype,"vvMaterialParameters",{get:function(){return this._vvMaterialParameters},enumerable:!0,configurable:!0});a.prototype.update=function(a){e.isSome(this._vvInfo)&&this._updateVisualVariables(this._vvInfo.vvRanges,a)};a.prototype.setInfo=function(a,b,c){var d=this;e.isSome(c)?(c.forEach(function(a,b){return d._updateEffects(b,a)}),this.effectCount=
c.length):this.effectCount=0;this._vvInfo=b;switch(a.type){case "dot-density":this._updateDotDensityInfo(a)}};a.prototype.getVariation=function(){return{ddDotBlending:this.ddDotBlending,outsideLabelsVisible:this.outsideLabelsVisible,effectCount:this.effectCount,oesTextureFloat:b("esri-webgl-texture-float")}};a.prototype.getVariationHash=function(){return(this.ddDotBlending?1:0)|(this.outsideLabelsVisible?1:0)<<1|this.effectCount<<2};a.prototype._updateEffects=function(a,b){a+=1;if(e.isSome(b)&&b.filter&&
b.filter.enabled){this.outsideLabelsVisible=b.excludedLabelsVisible;var c=b.parsedIncludedEffect;b=b.parsedExcludedEffect;e.isSome(c)?(y(this.insideEffect,c.getColorMatrix(),a),this.insideOpacity=c.getOpacity()):(y(this.insideEffect,u,a),this.insideOpacity=1);e.isSome(b)?(y(this.outsideEffect,b.getColorMatrix(),a),this.outsideOpacity=b.getOpacity()):(y(this.outsideEffect,u,a),this.outsideOpacity=1)}else y(this.insideEffect,u,a),y(this.outsideEffect,u,a),this.outsideOpacity=this.insideOpacity=1};a.prototype._updateVisualVariables=
function(a,b){var e=this._vvMaterialParameters;e.vvOpacityEnabled=!1;e.vvSizeEnabled=!1;e.vvColorEnabled=!1;e.vvRotationEnabled=!1;if(a){var d=a.size;if(d){e.vvSizeEnabled=!0;if(d.minMaxValue){var k=d.minMaxValue,h=void 0,g=void 0;x.isDefined(k.minSize)&&x.isDefined(k.maxSize)&&(x.isNumber(k.minSize)&&x.isNumber(k.maxSize)?(h=m.pt2px(k.minSize),g=m.pt2px(k.maxSize)):(g=b.scale,h=m.pt2px(n(g,k.minSize.stops)),g=m.pt2px(n(g,k.maxSize.stops))));this.vvSizeMinMaxValue.set([k.minDataValue,k.maxDataValue,
h,g])}d.scaleStops&&(this.vvSizeScaleStopsValue=m.pt2px(n(b.scale,d.scaleStops.stops)));d.unitValue&&(this.vvSizeUnitValueToPixelsRatio=c.getMetersPerUnitForSR(b.spatialReference)/f.meterIn[d.unitValue.unit]/b.resolution);d.fieldStops&&(this._vvSizeFieldStops=d.fieldStops)}if(b=a.color)e.vvColorEnabled=!0,this.vvColorValues.set(b.values),this.vvColors.set(b.colors);if(b=a.opacity)e.vvOpacityEnabled=!0,this.vvOpacityValues.set(b.values),this.vvOpacities.set(b.opacities);if(a=a.rotation)e.vvRotationEnabled=
!0,e.vvRotationType=a.type}};a.prototype._updateDotDensityInfo=function(a){var b=a.attributes;this.ddDotValue=a.dotValue;this.ddDotScale=a.referenceScale;this.ddDotSize=a.dotSize;this.ddDotBlending=a.dotBlendingEnabled;this.ddSeed=a.seed;for(var c=0;c<t.DOT_DENSITY_MAX_FIELDS;c++){var e=c>=b.length?new h([0,0,0,0]):b[c].color;p(this.ddColors,e,4*c)}for(c=0;8>c;c++)this.ddActiveDots[c]=c<a.attributes.length?1:0;p(this.ddBackgroundColor,a.backgroundColor)};return a}();a.WGLRendererInfo=g})},"esri/views/2d/engine/webgl/WGLTile":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/libs/gl-matrix-2/mat2d ../../../../core/libs/gl-matrix-2/mat2df32 ../../../../core/libs/gl-matrix-2/vec2 ../../../../core/libs/gl-matrix-2/vec2f32 ./definitions ./DirtyMap ./DisplayRecordStore ./Fader ./TiledDisplayObject ./WGLBuffers".split(" "),
function(g,a,d,h,b,e,m,c,l,f,t,x,n){Object.defineProperty(a,"__esModule",{value:!0});var p=new Set;g=function(a){function g(e,d,f){void 0===f&&(f=!1);e=a.call(this,e,d,[c.TILE_SIZE,c.TILE_SIZE])||this;e._data=null;e._displayList=null;e._wglBuffers=null;e._dirtyMap=new l.default;e._labelIndex=null;e._dirty=!0;e.fader=new t.default;e._ensureCorrectZOrder=f;e.transforms.labelMat2d=b.mat2df32.create();return e}d(g,a);g.prototype.destroy=function(){this.clear()};Object.defineProperty(g.prototype,"displayObjects",
{get:function(){return this._data.tileDisplayData.displayObjects},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"canDisplay",{get:function(){return!!this.attached},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"isDirty",{get:function(){return this._dirty},set:function(a){(this._dirty=a)||this.isReady||this.ready();this.requestRender()},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"hasData",{get:function(){return!!this._data},enumerable:!0,
configurable:!0});Object.defineProperty(g.prototype,"labelIndex",{get:function(){return this._labelIndex},enumerable:!0,configurable:!0});g.prototype.getGeometry=function(a){return this._wglBuffers&&this._wglBuffers.has(a)?this._wglBuffers.get(a):null};g.prototype.getDisplayList=function(){return this._data&&this._displayList};Object.defineProperty(g.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0});g.prototype.setTransform=function(b,c){a.prototype.setTransform.call(this,
b,c);var d=this.transforms.labelMat2d;c=b.getScreenTransform(d,c);var f=m.vec2f32.create();e.vec2.transformMat2d(f,this.coords,c);h.mat2d.identity(d);h.mat2d.translate(d,d,f);h.mat2d.multiply(d,b.viewMat2d,d)};g.prototype.setData=function(a,b,c){var e=a.addOrUpdate,d=a.remove;!a.clear&&this.hasData||a.addOrUpdate?!a.clear&&this.hasData||!a.addOrUpdate?this.hasData&&this._doPatchData({addOrUpdate:e,remove:d},b,c):(e.tileDisplayData.computeDisplayList(this._ensureCorrectZOrder),this._dirtyMap=new l.default,
this._dispRecStore=f.default.fromTileData(e,this._dirtyMap),this._data=e,this._readyTileIfNoLabels(b,c),this._dirtyMap.markAllDirty(),this._displayList||(this._displayList=e.tileDisplayData.displayList.clone())):(this.clear(),this.ready());this.emit("change")};g.prototype.commitChanges=function(){this.fader.step()||this.requestRender();this._wglBuffers||(this._wglBuffers=new n.default(this.stage.context));this._wglBuffers.upload(this._data.tileBufferData,this._dirtyMap);this._displayList=this._data.tileDisplayData.displayList.clone();
this._dirtyMap.markAllClean()};g.prototype.clear=function(){this._dispRecStore=this._displayList=this._data=null;this._wglBuffers&&(this._wglBuffers.dispose(),this._wglBuffers=null)};g.prototype.attach=function(){return!0};g.prototype._readyTileIfNoLabels=function(a,b){a&&this._rebuildLabelIndex();this.isDirty=a&&b?!0:!1};g.prototype._doPatchData=function(a,b,c){this._patchData(a)||(this._dirtyMap.markAllDirty(),this._data.reshuffle(),this._dispRecStore=f.default.fromTileData(this._data,this._dirtyMap));
this._readyTileIfNoLabels(b,c);this.requestRender()};g.prototype._rebuildLabelIndex=function(){this._labelIndex=this._initLabelIndex();for(var a=0,b=this.displayObjects;a<b.length;a++)for(var c=0,e=b[a].metrics;c<e.length;c++)this._insertIntoLabelIndex(e[c])};g.prototype._insertIntoLabelIndex=function(a){-1!==a.xBucket&&this.labelIndex[a.yBucket][a.xBucket].push(a)};g.prototype._initLabelIndex=function(){for(var a=[],b=0;b<c.TILE_SIZE/c.COLLISION_BUCKET_SIZE;b++){a.push([]);for(var e=0;e<c.TILE_SIZE/
c.COLLISION_BUCKET_SIZE;e++)a[b].push([])}return a};g.prototype._patchData=function(a){for(var b=!0,c=a.addOrUpdate&&a.addOrUpdate.tileDisplayData&&a.addOrUpdate.tileDisplayData.displayObjects||[],e=(a.remove||[]).slice(),d=0;d<c.length;d++){var f=c[d];null!=f.insertAfter&&e.push(f.id)}for(f=0;f<e.length;f++){var h=e[f];if(d=this._data.tileDisplayData.displayObjectRegistry.get(h)){this._data.tileDisplayData.displayList.removeFromList(d.displayRecords);for(var k=0,g=d.displayRecords;k<g.length;k++)this._dispRecStore.delete(g[k]);
this._data.tileDisplayData.displayObjectRegistry.delete(h);d=this._data.tileDisplayData.displayObjects.indexOf(d);this._data.tileDisplayData.displayObjects.splice(d,1)}}for(e=0;e<c.length;e++){f=c[e];d=this._data.tileDisplayData.displayObjectRegistry.get(f.id);h=void 0;if(d){k=d.displayRecords;d.set(f);d.displayRecords=k;k=d.displayRecords.length;for(g=0;g<k;++g){var l=d.displayRecords[g],m=f.displayRecords[g];if(g>=f.displayRecords.length||l.geometryType!==m.geometryType||l.symbolLevel!==m.symbolLevel||
l.zOrder!==m.zOrder||l.materialKey!==m.materialKey)this._dispRecStore.delete(d.displayRecords[g]),g<f.displayRecords.length&&(d.displayRecords[g]=void 0)}d.displayRecords.length=f.displayRecords.length;d.metrics=f.metrics}else if(d=f.copy(),d.displayRecords=[],this._data.tileDisplayData.displayObjectRegistry.set(f.id,d),g=void 0,l=this._data.tileDisplayData.displayObjects,null!=d.insertAfter?(h={},0<=d.insertAfter?(k=this._data.tileDisplayData.displayObjectRegistry.get(d.insertAfter))?(g=l.indexOf(k)+
1,g<l.length?l.splice(g,0,d):(l.push(d),g=l.length)):(l.push(d),g=l.length):(l.unshift(d),g=0)):(l.push(d),g=l.length),h){m=void 0;if(this._data.tileDisplayData.displayList.unified)m=0<f.displayRecords.length?1:0;else{p.clear();for(var m=0,n=f.displayRecords;m<n.length;m++)k=this._data.tileDisplayData.displayList.getDPInfoType(n[m].geometryType),p.add(k);m=p.size}n=0;for(--g;0<=g&&n<m;--g)for(var t=l[g].displayRecords.length-1;0<=t&&n<m;--t){var u=l[g].displayRecords[t],k=this._data.tileDisplayData.displayList.getDPInfoType(u.geometryType);
h[k]||(h[k]=u,++n)}}n=f.displayRecords.length;for(g=0;g<n;++g){m=f.displayRecords[g];(l=d.displayRecords[g])?(l.meshData=m.meshData,l.materialKey=m.materialKey):(l=m.copy(),l.vertexFrom=void 0,l.indexFrom=void 0,d.displayRecords[g]=l);var t=m.geometryType,k=this._data.tileDisplayData.displayList.getDPInfoType(t),u=a.addOrUpdate.tileBufferData.geometries[t],t=u.vertexBuffer,u=u.indexBuffer,y=void 0;h&&(y=h[k]?this._data.tileDisplayData.displayList.splitAfter(h[k]):-1);b=this._dispRecStore.setMeshData(l,
m,t,u,y)&&b;h&&null!=l.indexFrom&&null!=l.indexFrom&&(h[k]=l)}}return b};return g}(x.TiledDisplayObject);a.WGLTile=g})},"esri/views/2d/engine/webgl/DirtyMap":function(){define(["require","exports","./Utils"],function(g,a,d){function h(a,e,d){if(!a.allDirty)if(null!=a.from&&null!=a.count){var b=Math.min(a.from,e);e=Math.max(a.from+a.count,e+d)-b;a.from=b;a.count=e}else a.from=e,a.count=d}Object.defineProperty(a,"__esModule",{value:!0});g=function(){function a(){this._dirties=d.createGeometryData(function(){return{indices:{from:null,
count:null,allDirty:!1}}},function(){return{vertices:{from:null,count:null,allDirty:!1}}})}a.prototype.hasDirty=function(){for(var a=0,b=this._dirties;a<b.length;a++){var c=b[a];if(null!==c.data.indices.count||c.data.indices.allDirty)return!0}return!1};a.prototype.markAllClean=function(){for(var a=0,b=this._dirties;a<b.length;a++){var c=b[a];c.data.indices.from=null;c.data.indices.count=null;c.data.indices.allDirty=!1;for(var d in c.buffers)c.buffers[d].data.vertices.from=null,c.buffers[d].data.vertices.count=
null,c.buffers[d].data.vertices.allDirty=!1}};a.prototype.markAllDirty=function(){for(var a=0,b=this._dirties;a<b.length;a++){var c=b[a];c.data.indices.allDirty=!0;for(var d in c.buffers)c.buffers[d].data.vertices.allDirty=!0}};a.prototype.forEach=function(a){for(var b=0;b<this._dirties.length;++b){var c=this._dirties[b],e={},d;for(d in c.buffers){var h=c.buffers[d].data.vertices;if(h.allDirty||null!=h.from&&null!=h.count&&0<h.count)e[d]=h}c=c.data.indices;h=void 0;h=c.allDirty||null!=c.from&&null!=
c.count&&0<c.count?{indices:c,vertices:e}:{indices:null,vertices:e};(h.indices||0<Object.keys(h).length)&&a(h,b)}};a.prototype.markDirtyIndices=function(a,b,c){h(this._dirties[a].data.indices,b,c)};a.prototype.markDirtyVertices=function(a,b,c,d){h(this._dirties[a].buffers[b].data.vertices,c,d)};return a}();a.default=g})},"esri/views/2d/engine/webgl/DisplayRecordStore":function(){define(["require","exports","../../../../core/has","./FreeList","./Utils"],function(g,a,d,h,b){function e(a){a=a.getStrides();
for(var b={},c=0;c<a.length;c++)b[m[c]]=a[c];return b}Object.defineProperty(a,"__esModule",{value:!0});var m=["FILL","LINE","MARKER","TEXT","LABEL"];g=function(){function a(a,c,e,d){this._strides=a;this._displayList=c;this._freeListsAndStorage={};this._dirtyMap=null;this._dirtyMap=e;for(var f in a){this._freeListsAndStorage[f]={vtxFreeList:d?new h.FreeList(d):null,idxFreeList:d?new h.FreeList(d):null,vertexBuffers:{},indexBuffer:d?new Uint32Array(d):null};for(var g in a[f])this._freeListsAndStorage[f].vertexBuffers[g]=
{data:d?b.allocateTypedArrayBuffer(d,a[f][g]):null,stride:a[f][g]}}}a.fromTileData=function(c,d){var f=e(c),g=[0,0,0,0,0],l=[0,0,0,0,0],p=[];c.tileDisplayData.displayObjectRegistry.forEach(function(a){p.push(a)});for(var y=0;y<p.length;y++)for(var u=0,k=p[y].displayRecords;u<k.length;u++){var r=k[u];g[r.geometryType]=Math.max(g[r.geometryType],r.vertexFrom+r.vertexCount);l[r.geometryType]=Math.max(l[r.geometryType],r.indexFrom+r.indexCount)}d=new a(f,c.tileDisplayData.displayList,d,null);for(f=0;f<
c.tileBufferData.geometries.length;++f){var y=g[f],k=l[f],r=c.tileBufferData.geometries[f],u=d._storageFor(m[f]),z=c.tileBufferData.geometries[f].indexBuffer;u.indexBuffer=z;u.idxFreeList=new h.FreeList(z.length);u.idxFreeList.allocate(k);var k=void 0,q;for(q in r.vertexBuffer)r=c.tileBufferData.geometries[f].vertexBuffer[q],u.vertexBuffers[q].data=r.data,u.vertexBuffers[q].stride=r.stride,z=b.strideToPackingFactor(r.stride),r=r.data.length*z/r.stride,k||(k=r);u.vtxFreeList=new h.FreeList(k);u.vtxFreeList.allocate(y)}return d};
a.prototype.delete=function(a){var b=m[a.geometryType];this._freeVertices(b,a.vertexFrom,a.vertexCount);this._freeIndices(b,a.indexFrom,a.indexCount);this._displayList.removeFromList(a);a.vertexFrom=void 0;a.indexFrom=void 0};a.prototype.setMeshData=function(a,c,e,d,h){var f=m[a.geometryType];a.meshData=null;var g=void 0,l=void 0;void 0===a.vertexFrom?(l=c.vertexCount,g=this._allocateVertices(f,l)):c.vertexCount>a.vertexCount?(this._freeVertices(f,a.vertexFrom,a.vertexCount),l=c.vertexCount,g=this._allocateVertices(f,
l)):c.vertexCount===a.vertexCount?(g=a.vertexFrom,l=a.vertexCount):(this._freeVertices(f,a.vertexFrom+c.vertexCount,a.vertexCount-c.vertexCount),g=a.vertexFrom,l=c.vertexCount);var k=!0,n=void 0,t=void 0,q=void 0;void 0===a.indexFrom?(n=h,q=c.indexCount,t=this._allocateIndices(f,q)):c.indexCount>a.indexCount?(n=this._displayList.removeFromList(a),this._freeIndices(f,a.indexFrom,a.indexCount),q=c.indexCount,t=this._allocateIndices(f,q)):c.indexCount===a.indexCount?(k=!1,t=a.indexFrom,q=a.indexCount):
(n=this._displayList.removeFromList(a),this._freeIndices(f,a.indexFrom+c.indexCount,a.indexCount-c.indexCount),t=a.indexFrom,q=c.indexCount);if(-1!==g&&-1!==t){h=this._storageFor(f);b.copyMeshData(g,t,h.vertexBuffers,h.indexBuffer,c,e,d);a.vertexFrom=g;a.indexFrom=t;a.vertexCount=c.vertexCount;a.indexCount=c.indexCount;if(this._dirtyMap){this._dirtyMap.markDirtyIndices(a.geometryType,a.indexFrom,a.indexCount);for(var x in e)this._dirtyMap.markDirtyVertices(a.geometryType,x,a.vertexFrom,a.vertexCount)}k&&
this._displayList.addToList(a,n);return!0}-1!==g&&this._freeVertices(f,g,l);-1!==t&&this._freeIndices(f,t,q);a.setMeshDataFromBuffers(c,e,d);a.vertexFrom=void 0;a.vertexCount=0;a.indexFrom=void 0;a.indexCount=0;return!1};a.prototype._allocateVertices=function(a,b){a=this._storageFor(a);b=a.vtxFreeList.allocate(b);return-1===b||.5<a.vtxFreeList.fragmentation?-1:b};a.prototype._freeVertices=function(a,b,c){this._storageFor(a).vtxFreeList.free(b,c)};a.prototype._freeIndices=function(a,b,c){this._storageFor(a).idxFreeList.free(b,
c)};a.prototype._allocateIndices=function(a,b){a=this._storageFor(a);b=a.idxFreeList.allocate(b);return-1===b||.5<a.idxFreeList.fragmentation?-1:b};a.prototype._storageFor=function(a){return this._freeListsAndStorage[a]};a.prototype._stridesFor=function(a,b){return this._strides[a][b]};return a}();a.default=g})},"esri/views/2d/engine/webgl/FreeList":function(){define(["require","exports"],function(g,a){Object.defineProperty(a,"__esModule",{value:!0});var d=function(){function a(a){this._largestRange=
null;this._parent=a;this._updateLargestRange()}Object.defineProperty(a.prototype,"largestRange",{get:function(){return this._largestRange},enumerable:!0,configurable:!0});a.prototype.rangeCreated=function(a){if(!this._largestRange||a.count>this._largestRange.count)this._largestRange=a};a.prototype.rangeResized=function(a,e){if(a===this._largestRange)a.count<e&&this._updateLargestRange();else if(!this._largestRange||a.count>this._largestRange.count)this._largestRange=a};a.prototype.findBestRange=function(a){for(var b=
this._parent._freeHead,d=null;null!==b;)b.count>=a&&(!d||b.count-a<d.count-a)&&(d=b),b=b.next;return d};a.prototype.findAdjacentRanges=function(a,e){for(var b=!0,c=!1,d=null,f=this._parent._freeHead;b&&!c;){var h=null!==f?f.from:this._parent._size;a>=(null!==d?d.from+d.count:0)&&a+e<=h?(b=!1,c=!0):null!==f?(d=f,f=f.next):b=!1}return[d,f]};a.prototype._updateLargestRange=function(){for(var a=null,e=this._parent._freeHead;null!==e;){if(!a||e.count>a.count)a=e;e=e.next}this._largestRange=a};return a}();
g=function(){function a(a,e){this._allocated=0;this._size=a;this._freeHead=0<a?{from:0,count:a,prev:null,next:null}:null;this._bookKeeper=e||new d(this);this._freeHead&&this._bookKeeper.rangeCreated(this._freeHead)}a.prototype.allocate=function(b){var e=this._bookKeeper.findBestRange(b);if(null===e)return-1;var d=e.from,c=e.count;e.from+=b;e.count-=b;this._bookKeeper.rangeResized(e,d,c);this._allocated+=b;0===e.count&&(b=null!==e.prev?this._freeHead:e.next,a._removeRange(e),this._freeHead=b);return d};
a.prototype.free=function(b,e){var d=this._bookKeeper.findAdjacentRanges(b,e),c=d[0],d=d[1];b={from:b,count:e,prev:c,next:d};null!==c&&(c.next=b);null!==d&&(d.prev=b);this._bookKeeper.rangeCreated(b);this._allocated-=e;if(null!==d&&b.from+b.count===d.from){e=b.from;var g=b.count;a._fuse(b,d);a._removeRange(d);this._bookKeeper.rangeResized(b,e,g);this._bookKeeper.rangeResized(d,void 0,0)}null!==c&&c.from+c.count===b.from&&(e=c.from,g=c.count,a._fuse(c,b),a._removeRange(b),this._bookKeeper.rangeResized(c,
e,g),this._bookKeeper.rangeResized(b,void 0,0));this._freeHead=null!==b.prev?this._freeHead:b};Object.defineProperty(a.prototype,"fragmentation",{get:function(){var a=this._size-this._allocated;return 0===a?0:1-this._bookKeeper.largestRange.count/a},enumerable:!0,configurable:!0});a._removeRange=function(a){null!==a.prev?null!==a.next?(a.prev.next=a.next,a.next.prev=a.prev):a.prev.next=null:null!==a.next&&(a.next.prev=null)};a._fuse=function(a,e){a.count+=e.count;a.next=e.next;e.from+=e.count;e.count=
0;null!==e.next&&(e.next.prev=a)};return a}();a.FreeList=g})},"esri/views/2d/engine/webgl/Fader":function(){define(["require","exports"],function(g,a){Object.defineProperty(a,"__esModule",{value:!0});g=function(){function a(a){void 0===a&&(a=400);this.duration=a;this._value=this._elapsed=this._lastTime=0;this._finished=!1}Object.defineProperty(a.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0});a.prototype.reset=function(){this._value=this._elapsed=this._lastTime=
0};a.prototype.step=function(){var a=performance.now();if(0===this._lastTime)return this._lastTime=a,this._value=0,!0;if(this._elapsed>=this.duration)return!0;this._elapsed+=a-this._lastTime;this._lastTime=a;this._value=Math.min(this._elapsed/this.duration,1);return!1};return a}();a.default=g})},"esri/views/2d/engine/webgl/WGLBuffers":function(){define(["require","exports","../../../webgl","./Utils"],function(g,a,d,h){Object.defineProperty(a,"__esModule",{value:!0});g=function(){function a(a){this.geometryMap=
h.createGeometryData(function(){return{indexBuffer:d.BufferObject.createIndex(a,35044),vao:null}},function(b,c){return{vertexBuffer:d.BufferObject.createVertex(a,h.C_VBO_INFO[c])}})}a.prototype.dispose=function(){for(var a=0;5>a;a++){var b=this.geometryMap[a];if(b){b.data.vao&&b.data.vao.dispose(!1);b.data.indexBuffer&&b.data.indexBuffer.dispose();for(var c in b.buffers)b.buffers[c]&&b.buffers[c].data.vertexBuffer.dispose()}}};a.prototype.get=function(a){var b=this.geometryMap[a];a={};for(var c in b.buffers)a[c]=
b.buffers[c].data.vertexBuffer;return{indexBuffer:b.data.indexBuffer,get vao(){return b.data.vao},set vao(a){b.data.vao=a},vertexBufferMap:a}};a.prototype.has=function(a){return null!=this.geometryMap[a]};a.prototype.upload=function(a,b){var c=this;b.forEach(function(b,e){c._upload(b,e,a)})};a.prototype._upload=function(a,b,c){a.indices&&(a.indices.allDirty?this._uploadIndices(c,b):null!=a.indices.from&&null!=a.indices.count&&this._uploadIndices(c,b,a.indices.from,a.indices.count));if(a.vertices){a=
a.vertices;for(var e in a){var d=a[e];d.allDirty?this._uploadVertices(c,b,e):null!=d.from&&null!=d.count&&this._uploadVertices(c,b,e,d.from,d.count)}}};a.prototype._uploadVertices=function(a,b,c,d,f){var e=this.geometryMap[b];e&&(b=a.geometries[b].vertexBuffer[c])&&(a=b.stride,b=b.data.buffer,e.buffers[c]&&0<b.byteLength&&(null!=d&&null!=f?e.buffers[c].data.vertexBuffer.setSubData(b,d*a,d*a,(d+f)*a):e.buffers[c].data.vertexBuffer.setData(b)))};a.prototype._uploadIndices=function(a,b,c,d){var e=this.geometryMap[b];
e&&(a=a.geometries[b].indexBuffer.buffer,e.data.indexBuffer&&0<a.byteLength&&(null!=c&&null!=d?e.data.indexBuffer.setSubData(a,4*c,4*c,4*(c+d)):e.data.indexBuffer.setData(a)))};return a}();a.default=g})},"esri/views/2d/engine/webgl/shaders/MagnifierPrograms":function(){define(["require","exports","../../../../webgl","./sources/resolver"],function(g,a,d,h){Object.defineProperty(a,"__esModule",{value:!0});a.magnifier={name:"magnifier",shaders:{vertexShader:h.resolveIncludes("magnifier/magnifier.vert"),
fragmentShader:h.resolveIncludes("magnifier/magnifier.frag")},attributes:{a_pos:0}};a.createMagnifierProgram=function(b){return d.createProgram(b,a.magnifier)}})},"esri/views/2d/engine/BitmapTileContainer":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/decorateHelper ../../../geometry/support/aaBoundingRect ../engine ./BitmapTile ./webgl/enums ./webgl/TileContainer".split(" "),function(g,a,d,h,b,e,m,c,l){Object.defineProperty(a,"__esModule",{value:!0});
g=function(a){function f(){return null!==a&&a.apply(this,arguments)||this}d(f,a);f.prototype.createTile=function(a){var c=this._tileInfoView.getTileBounds(b.create(),a);return new m.BitmapTile(a,c,this._tileInfoView.tileInfo.size)};f.prototype.destroyTile=function(){};f.prototype.prepareRenderPasses=function(b){var d=this,f=b.registerRenderPass({name:"bitmap (tile)",brushes:[e.brushes.Bitmap],target:function(){return d.children.map(function(a){return a.bitmap})},drawPhase:c.WGLDrawPhase.MAP});return a.prototype.prepareRenderPasses.call(this,
b).concat([f])};f.prototype.doRender=function(b){this.visible&&b.drawPhase===c.WGLDrawPhase.MAP&&a.prototype.doRender.call(this,b)};return f}(l.default);a.BitmapTileContainer=g})},"esri/views/2d/engine/LevelDependentSizeVariable":function(){define("require exports ../../../core/tsSupport/decorateHelper ../../../core/tsSupport/declareExtendsHelper ../../../core/lang ../../../core/accessorSupport/decorators ../../../renderers/visualVariables/SizeVariable ../../../renderers/visualVariables/support/sizeVariableUtils".split(" "),
function(g,a,d,h,b,e,m,c){Object.defineProperty(a,"__esModule",{value:!0});g=function(a){function f(){return null!==a&&a.apply(this,arguments)||this}h(f,a);g=f;f.prototype.writeLevels=function(a,b,c){for(var e in a){b.stops=this.levels[e];break}};f.prototype.clone=function(){return new g({axis:this.axis,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,maxDataValue:this.maxDataValue,maxSize:c.isSizeVariable(this.maxSize)?this.maxSize.clone():this.maxSize,
minDataValue:this.minDataValue,minSize:c.isSizeVariable(this.minSize)?this.minSize.clone():this.minSize,normalizationField:this.normalizationField,stops:this.stops&&this.stops.map(function(a){return a.clone()}),target:this.target,useSymbolValue:this.useSymbolValue,valueRepresentation:this.valueRepresentation,valueUnit:this.valueUnit,legendOptions:this.legendOptions&&this.legendOptions.clone(),levels:b.clone(this.levels)})};var g;d([e.property()],f.prototype,"levels",void 0);d([e.writer("levels")],
f.prototype,"writeLevels",null);return f=g=d([e.subclass("esri.views.2d.engine.LevelDependentSizeVariable")],f)}(e.declared(m));a.LevelDependentSizeVariable=g})},"esri/widgets/Legend/support/ActiveLayerInfo":function(){define("require exports ../../../core/tsSupport/assignHelper ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/tsSupport/awaiterHelper ../../../core/tsSupport/generatorHelper ../../../Color ../../../request ../../../symbols ../../../core/Accessor ../../../core/arrayUtils ../../../core/Collection ../../../core/Handles ../../../core/Logger ../../../core/maybe ../../../core/promiseUtils ../../../core/urlUtils ../../../core/watchUtils ../../../core/accessorSupport/decorators ../../../layers/support/ExportImageParameters ../../../layers/support/fieldUtils ../../../renderers/support/jsonUtils ../../../renderers/visualVariables/SizeVariable ../../../symbols/support/symbolUtils ../../../symbols/support/utils ../../../views/2d/layers/support/clusterUtils ./colorRampUtils ./heatmapRampUtils ./relationshipRampUtils ./sizeRampUtils ./utils @dojo/framework/shim/Promise".split(" "),
function(g,a,d,h,b,e,m,c,l,f,t,x,n,p,y,u,k,r,z,q,E,A,B,C,D,I,L,H,G,M,O,K){function Q(a){return"esri.renderers.SimpleRenderer"===a.declaredClass}function P(a){return"esri.renderers.ClassBreaksRenderer"===a.declaredClass}function N(a){return"esri.renderers.UniqueValueRenderer"===a.declaredClass}function J(a){return"esri.renderers.HeatmapRenderer"===a.declaredClass}function R(a){return"esri.renderers.PointCloudClassBreaksRenderer"===a.declaredClass}function Y(a){return"esri.renderers.PointCloudStretchRenderer"===
a.declaredClass}function W(a){return"esri.renderers.PointCloudUniqueValueRenderer"===a.declaredClass}var X=y.getLogger("esri.widgets.Legend.support.ActiveLayerInfo"),Z=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i,aa=new f.SimpleMarkerSymbol({size:6,outline:{color:[128,128,128,.5],width:.5}}),V=new f.SimpleFillSymbol({style:"solid"}),ca=new f.SimpleMarkerSymbol({style:"path",path:"M10,5 L5,0 0,5 M5,0 L5,15",size:15,outline:{width:1,color:[85,85,85,1]}});return function(a){function f(b){b=a.call(this,
b)||this;b._handles=new p;b._hasColorRamp=!1;b._hasOpacityRamp=!1;b._hasSizeRamp=!1;b._legendResponse={};b._webStyleSymbolCache=new Map;b._dotDensityUrlCache=new Map;b.children=new n;b.layer=null;b.legendElements=[];b.parent=null;b.scale=null;b.title=null;b.view=null;return b}h(f,a);f.prototype.initialize=function(){var a=this,b=function(){return a.notifyChange("ready")};this._handles.add([z.on(this,"children","change",function(c){var e=c.removed,d=a._handles;c.added.map(function(a){var c="activeLayerInfo-ready-watcher-"+
a.layer.uid;d.add(z.init(a,"ready",b),c)});e.forEach(function(a){return d.remove(a.layer.uid)});b()})])};f.prototype.destroy=function(){this._handles.destroy();this._dotDensityUrlCache=this._webStyleSymbolCache=this._legendResponse=this._handles=null};Object.defineProperty(f.prototype,"ready",{get:function(){return null===this.layer?!0:0<this.children.length?this._isGroupActive():0<this.legendElements.length},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"isScaleDriven",{get:function(){var a=
this,b=this.layer;if(null===b)return!1;if("featureReduction"in b&&b.featureReduction&&"cluster"===b.featureReduction.type)return!0;if("renderer"in b&&b.renderer){if("dot-density"===b.renderer.type)return!0;var c=b.get("renderer.valueExpression");return Z.test(c)?!0:(b=b.get("renderer.visualVariables"))&&b.some(function(b){return a._isScaleDrivenSizeVariable(b)})}return!0},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"version",{get:function(){return this._get("version")+1},enumerable:!0,
configurable:!0});f.prototype.buildLegendElementsForFeatureCollections=function(a){return e(this,void 0,void 0,function(){var b,c=this;return m(this,function(e){this.legendElements=[];b=a.map(function(a){if("esri.layers.FeatureLayer"===a.declaredClass)return c._buildRendererLegendElements(a.renderer,a.title,"append");if(a.featureSet&&a.featureSet.features.length){var b=a.layerDefinition,b=(b=b&&b.drawingInfo)&&B.fromJSON(b.renderer);return b?c._buildRendererLegendElements(b,a.name,"append"):(X.warn("drawingInfo not available!"),
null)}return null});return[2,k.eachAlways(b).then(function(){})]})})};f.prototype.buildLegendElementsForRenderer=function(a){return e(this,void 0,void 0,function(){return m(this,function(b){return[2,this._buildRendererLegendElements(a,null,"replace")]})})};f.prototype.buildLegendElementsForTools=function(){return e(this,void 0,void 0,function(){var a,b=this;return m(this,function(c){switch(c.label){case 0:a=this.layer;if("esri.layers.WMTSLayer"!==a.declaredClass)return[3,1];this._constructLegendElementsForWMTSlayer();
return[3,6];case 1:if("esri.layers.WMSLayer"!==a.declaredClass)return[3,2];this._constructLegendElementsForWMSSublayers();return[3,6];case 2:return"esri.layers.MapImageLayer"!==a.declaredClass?[3,4]:[4,this._constructLegendElementsForSublayers()];case 3:return c.sent(),[3,6];case 4:return this._handles.remove("imageryLayers-watcher"),[4,this._getLegendLayers().then(function(c){b.legendElements=[];c.forEach(function(c){if("esri.layers.ImageryLayer"===a.declaredClass){var e=a.watch("renderingRule, bandIds",
function(){b._legendResponse["default"]=null;b.buildLegendElementsForTools()});b._handles.add(e,"imageryLayers-watcher")}(c=b._generateSymbolTableElementForLegendLayer(c))&&c.infos.length&&("esri.layers.ImageryLayer"===a.declaredClass&&(c.title=a.title),b.legendElements.push(c));b.notifyChange("ready")});b.notifyChange("ready")}).catch(function(a){X.warn("Request to server for legend has failed!",a)})];case 5:c.sent(),c.label=6;case 6:return[2]}})})};f.prototype._isGroupActive=function(){var a=this.children;
return a.length?a.some(function(a){return a.ready}):!1};f.prototype._isScaleDrivenSizeVariable=function(a){if(a&&"size"!==a.type)return!1;var b=a.minSize,c=a.maxSize;return"object"===typeof b&&b?this._isScaleDrivenSizeVariable(b):"object"===typeof c&&c?this._isScaleDrivenSizeVariable(c):!!a.expression||Z.test(a.valueExpression)};f.prototype._buildRendererLegendElements=function(a,b,c){return e(this,void 0,void 0,function(){var e,d;return m(this,function(f){switch(f.label){case 0:return f.trys.push([0,
2,,3]),[4,this._getRendererLegendElements(a,b)];case 1:return e=f.sent(),"append"===c?Array.prototype.push.apply(this.legendElements,e):this.legendElements=e,this.notifyChange("ready"),[3,3];case 2:return d=f.sent(),X.warn("error while building legend for layer!",d),[3,3];case 3:return[2]}})})};f.prototype._constructLegendElementsForWMTSlayer=function(){this.legendElements=[];this._handles.remove("wmts-activeLayer-watcher");var a=this.layer,b=a.activeLayer;this._handles.add(z.watch(this.layer,"activeLayer",
this._constructLegendElementsForWMTSlayer.bind(this)),"wmts-activeLayer-watcher");if(b.styleId&&b.styles){var c=null;b.styles.some(function(a){return b.styleId===a.id?(c=a.legendUrl,!0):!1});c&&(this.legendElements=[{type:"symbol-table",title:b.title,infos:[{src:c,opacity:a.opacity}]}])}this.notifyChange("ready")};f.prototype._constructLegendElementsForWMSSublayers=function(){this.legendElements=[];this._handles.remove("wms-sublayers-watcher");var a=this.layer,b=null;if(a.customParameters||a.customLayerParameters)b=
d({},a.customParameters,a.customLayerParameters);this._handles.add(z.watch(this.layer,"sublayers",this._constructLegendElementsForWMSSublayers.bind(this)),"wms-sublayers-watcher");this.legendElements=this._generateLegendElementsForWMSSublayers(a.sublayers,b);this.notifyChange("ready")};f.prototype._generateLegendElementsForWMSSublayers=function(a,b){var c=this,e=[];this._handles.add(a.on("change",this._constructLegendElementsForWMSSublayers.bind(this)),"wms-sublayers-watcher");a.forEach(function(a){var d=
a.watch("title, visible, legendEnabled",function(){return c._constructLegendElementsForWMSSublayers()});c._handles.add(d,"wms-sublayers-watcher");a.visible&&a.legendEnabled&&(a=c._generateSymbolTableElementForWMSSublayer(a,b))&&a.infos.length&&e.unshift(a)});return e};f.prototype._generateSymbolTableElementForWMSSublayer=function(a,b){return!a.legendUrl&&a.sublayers?(b=this._generateLegendElementsForWMSSublayers(a.sublayers,b).filter(function(a){return a}),{type:"symbol-table",title:a.title,infos:b}):
this._generateSymbolTableElementForLegendUrl(a,b)};f.prototype._generateSymbolTableElementForLegendUrl=function(a,b){var c=a.legendUrl;if(c){var e={type:"symbol-table",title:a.title||a.name||a.id&&a.id+"",infos:[]};b&&(c+="?"+r.objectToQuery(b));e.infos.push({src:c,opacity:a.layer&&a.layer.opacity});return e}};f.prototype._getLegendLayers=function(a){var b=this,c=(a=a&&a.hasDynamicLayers?a.dynamicLayers:null)||"default",e=this._legendResponse&&this._legendResponse[c];return e?k.resolve(e):this._legendRequest(a).then(function(a){a=
a.layers;return b._legendResponse[c]=a})};f.prototype._legendRequest=function(a){var b=this.layer;a={f:"json",dynamicLayers:a};"esri.layers.ImageryLayer"===b.declaredClass&&(b.renderingRule&&(a.renderingRule=JSON.stringify(b.renderingRule.toJSON())),b.bandIds&&(a.bandIds=b.bandIds.join()),b.raster||b.viewId)&&(a=d({raster:b.raster,viewId:b.viewId},a));var c=b.url.replace(/(\/)+$/,"");"version"in b&&10.01<=b.version?(b=c.indexOf("?"),c=-1<b?c.substring(0,b)+"/legend"+c.substring(b):c+"/legend"):(b=
c.toLowerCase().indexOf("/rest/"),c=c.substring(0,b)+c.substring(b+5,c.length),c="https://utility.arcgis.com/sharing/tools/legend?soapUrl\x3d"+encodeURI(c)+"\x26returnbytes\x3dtrue");return l(c,{query:a}).then(function(a){return a.data})};f.prototype._constructLegendElementsForSublayers=function(){var a=this;this.legendElements=[];this._handles.remove("sublayers-watcher");var b=this.layer,c=new E.ExportImageParameters({layer:b});return this._getLegendLayers(c).then(function(c){var e={};c.forEach(function(a){e[a.layerId]=
a});a._handles.add(z.watch(b,"sublayers",a._constructLegendElementsForSublayers.bind(a)),"sublayers-watcher");a.legendElements=a._generateLegendElementsForSublayers(b.sublayers,e,b.opacity);a.notifyChange("ready")}).catch(function(a){X.warn("Request to server for legend has failed!",a)}).then(function(){return c.destroy()})};f.prototype._generateLegendElementsForSublayers=function(a,b,c){var e=this,d=[];this._handles.add(a.on("change",this._constructLegendElementsForSublayers.bind(this)),"sublayers-watcher");
a.forEach(function(a){var f=a.watch("renderer, opacity, title, visible",function(){return e._constructLegendElementsForSublayers()});e._handles.add(f,"sublayers-watcher");a.visible&&a.legendEnabled&&(f=a&&null!=a.opacity?a.opacity:null,(a=e._generateSymbolTableElementForSublayer(a,b,null!=f?f*c:c))&&a.infos.length&&d.unshift(a))});return d};f.prototype._generateSymbolTableElementForSublayer=function(a,b,c){var e=b[a.id];return!e&&a.sublayers?(b=this._generateLegendElementsForSublayers(a.sublayers,
b,c).filter(function(a){return a}),{type:"symbol-table",title:a.title,infos:b}):this._generateSymbolTableElementForLegendLayer(e,a,c)};f.prototype._generateSymbolTableElementForLegendLayer=function(a,b,c){var e=this;if(a){var d=b&&b.renderer,f=b&&b.title||a.layerName;d&&(d=b&&b.title||this._getRendererTitle(d,b))&&(f&&(d.title=f),f=d);f={type:"symbol-table",title:f,infos:[]};a.legendType&&(f.legendType=a.legendType);a.legend&&this._isLegendLayerInScale(a,b)&&(b=b?this._sanitizeLegendForSublayer(a.legend.slice(),
b):a.legend,f.infos=b.map(function(b){var d=b.url;if(b.imageData&&0<b.imageData.length)d="data:image/png;base64,"+b.imageData;else if(0!==d.indexOf("http"))d=r.addTokenParameter(e.layer.url+"/"+a.layerId+"/images/"+d);else return null;return{label:b.label,src:d,opacity:c,width:b.width,height:b.height}}).filter(function(a){return!!a}));return f.infos.length?f:null}};f.prototype._isLegendLayerInScale=function(a,b){b=b||this.layer;var c=null,e=null,d=!0;!b.minScale&&0!==b.minScale||!b.maxScale&&0!==
b.maxScale?(0===a.minScale&&b.tileInfo&&(c=b.tileInfo.lods[0].scale),0===a.maxScale&&b.tileInfo&&(e=b.tileInfo.lods[b.tileInfo.lods.length-1].scale)):(c=Math.min(b.minScale,a.minScale)||b.minScale||a.minScale,e=Math.max(b.maxScale,a.maxScale));if(0<c&&c<this.scale||e>this.scale)d=!1;return d};f.prototype._sanitizeLegendForSublayer=function(a,b){if("version"in this.layer&&10.1>this.layer.version||0===a.length)return a;b=b.renderer;var c=null,e=null;a.some(function(a){return a.values})&&a.some(function(a,
b){a.values||(c=b,e=a,e.label||(e.label="others"));return null!=e});b?"unique-value"===b.type?e&&(a.splice(c,1),a.push(e)):"class-breaks"===b.type&&(e&&a.splice(c,1),a.reverse(),e&&a.push(e)):e&&(a.splice(c,1),a.push(e));return a};f.prototype._getRendererLegendElements=function(a,b){return e(this,void 0,void 0,function(){return m(this,function(c){return Q(a)||P(a)||N(a)||"raster-stretch"===a.type||"raster-colormap"===a.type||J(a)||R(a)||Y(a)||W(a)||"esri.renderers.DotDensityRenderer"===a.declaredClass?
R(a)||Y(a)||W(a)||"esri.renderers.PointCloudRGBRenderer"===a.declaredClass?[2,this._constructPointCloudRendererLegendElements(a,b)]:"dot-density"===a.type?[2,this._constructDotDensityRendererLegendElements(a)]:[2,this._constructRendererLegendElements(a,b)]:(X.warn("Renderer not supported!"),[2,[]])})})};f.prototype._getPointCloudRendererTitle=function(a){return a.legendOptions&&a.legendOptions.title||a.field};f.prototype._constructPointCloudRendererLegendElements=function(a,b){var c=this,e=[],d=null,
f=null;if(R(a))d={type:"symbol-table",title:b||this._getPointCloudRendererTitle(a),infos:[]},a.colorClassBreakInfos.forEach(function(a){d.infos.unshift({label:a.label||a.minValue+" - "+a.maxValue,value:[a.minValue,a.maxValue],symbol:c._getAppliedCloneSymbol(aa,a.color)})});else if(Y(a)){var f=a.stops,g=null;if(f.length&&(1===f.length&&(g=f[0].color),!g)){var h=f[0].value,l=f[f.length-1].value;null!=h&&null!=l&&(g=H.getColorFromPointCloudStops(h+(l-h)/2,f))}d={type:"symbol-table",title:null,infos:[{label:null,
value:null,symbol:this._getAppliedCloneSymbol(aa,g||aa.color)}]};f=H.getRampStopsForPointCloud(a.stops);f={type:"color-ramp",title:b||this._getPointCloudRendererTitle(a),infos:f,preview:D.renderColorRampPreviewHTML(f.map(function(a){return a.color}))}}else W(a)&&(d={type:"symbol-table",title:b||this._getPointCloudRendererTitle(a),infos:[]},a.colorUniqueValueInfos.forEach(function(a){d.infos.push({label:a.label||a.values.join(", "),value:a.values.join(", "),symbol:c._getAppliedCloneSymbol(aa,a.color)})}));
d&&d.infos.length&&e.push(d);f&&f.infos.length&&e.push(f);a=e.reduce(function(a,b){return a.concat(b.infos)},[]).filter(function(a){return!!a.symbol}).map(function(a){return c._getSymbolPreview(a)});return k.eachAlways(a).then(function(){return e})};f.prototype._getElementInfoForDotDensity=function(a,b){var c=a.outline,c=a.dotSize+"-"+b+"-"+a.backgroundColor+"-"+(c&&JSON.stringify(c.toJSON())),e=this._dotDensityUrlCache;a=e.has(c)?e.get(c):D.renderDotDensityPreviewHTML(a,b);e.set(c,a);return{opacity:1,
src:a.src,preview:a,width:a.width,height:a.height}};f.prototype._constructDotDensityRendererLegendElements=function(a){var b=this,c=a.calculateDotValue(this.view.scale),e={type:"symbol-table",title:{value:c&&Math.round(c),unit:a.legendOptions&&a.legendOptions.unit||""},infos:[]};a.attributes.forEach(function(c){var d=b._getElementInfoForDotDensity(a,c.color);d.label=c.label||c.valueExpressionTitle||c.field;e.infos.push(d)});return k.resolve([e])};f.prototype._constructRendererLegendElements=function(a,
b){return e(this,void 0,void 0,function(){var c,e,d,f,g,h,l,n,p,q,r,t,B,y,z,A,x,C,E,O,S,K,I,da,L,ba,H,ea,R,W,X,Y,Z,aa,ra,qa=this;return m(this,function(m){switch(m.label){case 0:return[4,this._loadRenderer(a)];case 1:return c=m.sent(),this._hasSizeRamp=this._hasOpacityRamp=this._hasColorRamp=!1,[4,this._getVisualVariableLegendElements(c)];case 2:e=m.sent()||[];d={type:"symbol-table",title:b||this._getRendererTitle(c),infos:[]};f=null;g=!1;if(!J(c))return[3,3];h=G.getHeatmapRampStops(c);e.push({type:"heatmap-ramp",
title:b,infos:h,preview:D.renderColorRampPreviewHTML(h.map(function(a){return a.color}))});return[3,10];case 3:if(!N(c))return[3,4];if(n=(l=c&&c.authoringInfo)&&"relationship"===l.type){if(p=l.focus,q=l.numClasses,r=l.field1,t=l.field2,q&&r&&t){B=this.layer;y=[r,t];z=M.getRotationAngleForFocus(p)||0;A=0;for(x=y;A<x.length;A++)C=x[A],E=C.field,O=C.normalizationField,S={field:this._getFieldAlias(E,B),normField:O&&this._getFieldAlias(O,B)},K=ca.clone(),K.angle=z,d.infos.push({label:S,symbol:K}),z+=90;
I=M.getRelationshipRampElement({focus:p,numClasses:q,infos:c.uniqueValueInfos});e.unshift(I)}}else da=c.field,c.uniqueValueInfos.forEach(function(a){a.symbol&&d.infos.push({label:a.label||qa._getDomainName(da,a.value)||a.value,value:a.value,symbol:a.symbol})});c.defaultSymbol&&(d.infos.push({label:c.defaultLabel||"others",symbol:c.defaultSymbol}),g=!0);return[3,10];case 4:if(!P(c))return[3,5];f=this._isUnclassedRenderer(c);if(L=!f||!this._hasSizeRamp)c.classBreakInfos.forEach(function(a){a.symbol&&
d.infos.unshift({label:a.label||(f?null:a.minValue+" - "+a.maxValue),value:[a.minValue,a.maxValue],symbol:a.symbol})}),f&&(d.title=null),this._updateInfosforClassedSizeRenderer(c,d.infos);c.defaultSymbol&&!f&&(d.infos.push({label:c.defaultLabel||"others",symbol:c.defaultSymbol}),g=!0);return[3,10];case 5:if("raster-stretch"!==c.type)return[3,9];B=this.layer;H=ba=void 0;c.statistics&&(ba=c.statistics[0].min||c.statistics[0][0],H=c.statistics[0].max||c.statistics[0][1]);ea=[];W=u.unwrap;return B.renderingRule?
[4,B.generateRasterInfo(B.renderingRule)]:[3,7];case 6:return X=m.sent(),[3,8];case 7:X=B.serviceRasterInfo,m.label=8;case 8:return R=W.apply(void 0,[X]),Y=R.keyProperties.BandProperties,1===R.bandCount?(ba=ba||R.statistics&&R.statistics[0].min,H=H||R.statistics&&R.statistics[0].max,ba&&H?e.push(this._getStretchLegendElements(c,{min:ba,max:H})):this.buildLegendElementsForTools()):B.bandIds&&1===B.bandIds.length?(ba=ba||R.statistics&&R.statistics[B.bandIds[0]].min,H=H||R.statistics&&R.statistics[B.bandIds[0]].max,
ba&&H?e.push(this._getStretchLegendElements(c,{min:ba,max:H})):this.buildLegendElementsForTools()):3<=R.bandCount?Y&&Y.length>=R.bandCount?B.bandIds&&3===B.bandIds.length?(ea=B.bandIds.map(function(a){return Y[a].BandName}),d.infos=this._createSymbolTableElementMultiBand(ea)):"lerc"===B.format?(ea=[0,1,2].map(function(a){return Y[a].BandName}),d.infos=this._createSymbolTableElementMultiBand(ea)):this.buildLegendElementsForTools():"lerc"===B.format?(ea=["band0","band1","band2"],d.infos=this._createSymbolTableElementMultiBand(ea)):
this.buildLegendElementsForTools():this.buildLegendElementsForTools(),[3,10];case 9:"raster-colormap"===c.type?c.colormapInfos.forEach(function(a){d.infos.push({label:a.label,value:a.value,symbol:qa._getAppliedCloneSymbol(V,a.color)})}):Q(c)&&c.symbol&&!this._hasSizeRamp&&d.infos.push({label:c.label,symbol:c.symbol}),m.label=10;case 10:return Z=c.defaultSymbol,!Z||g||Q(c)||f&&!this._hasColorRamp&&!this._hasSizeRamp&&!this._hasOpacityRamp||e.push({type:"symbol-table",infos:[{label:c.defaultLabel||
"others",symbol:Z}]}),d.infos.length&&e.unshift(d),aa=this._getSymbolConfig("visualVariables"in c&&c.visualVariables),ra=e.reduce(function(a,b){return a.concat(b.infos)},[]).filter(function(a){return!(!a||!a.symbol)}).map(function(a){return qa._getSymbolPreview(a,aa)}),c=null,[4,k.eachAlways(ra)];case 11:return m.sent(),[2,e]}})})};f.prototype._getStretchLegendElements=function(a,b){a=H.getStrectchRampStops(a.colorRamp,b);return{type:"stretch-ramp",title:"",infos:a,preview:D.renderColorRampPreviewHTML(a.map(function(a){return a.color}))}};
f.prototype._createSymbolTableElementMultiBand=function(a){var b=[],c=["red","green","blue"];a.forEach(function(a,e){b.push({label:{colorName:c[e],bandName:a},src:K.RGB_IMG_SOURCE[e],opacity:1})});return b};f.prototype._updateInfosforClassedSizeRenderer=function(a,b){var c=a.authoringInfo&&"class-breaks-size"===a.authoringInfo.type,e=a.classBreakInfos.some(function(a){return I.isVolumetricSymbol(a.symbol)});if(c&&e){var d=O.REAL_WORLD_MAX_SIZE;a=a.classBreakInfos.length;var f=(d-O.REAL_WORLD_MIN_SIZE)/
(1<a?a-1:a);b.forEach(function(a,b){a.size=d-f*b})}};f.prototype._getSymbolConfig=function(a){var b=!1,c=!1;if(a)for(var e=0;e<a.length&&(!b||!c);e++){var d=a[e];"size"===d.type&&("height"===d.axis&&(b=!0),"width-and-depth"===d.axis&&(c=!0))}return b&&c?"tall":null};f.prototype._getSymbolPreview=function(a,b){return D.renderPreviewHTML(a.symbol,{size:a.size,opacity:this.layer.opacity,symbolConfig:b,rotation:a.symbol.angle}).then(function(b){a.preview=b;return a}).catch(function(){a.preview=null;return a})};
f.prototype._loadRenderer=function(a){return e(this,void 0,void 0,function(){var b,c,e,d,f=this;return m(this,function(g){switch(g.label){case 0:return b=[],a=a.clone(),[4,this._getMedianColor(a)];case 1:c=g.sent();if(P(a)||N(a))e=a.classBreakInfos||a.uniqueValueInfos,d=e.map(function(a){return f._fetchSymbol(a.symbol,c).then(function(b){a.symbol=b}).catch(function(){a.symbol=null})}),Array.prototype.push.apply(b,d);b.push(this._fetchSymbol(a.symbol||a.defaultSymbol,a.defaultSymbol?null:c).then(function(b){f._applySymbolToRenderer(a,
b,Q(a))}).catch(function(){f._applySymbolToRenderer(a,null,Q(a))}));return[2,k.eachAlways(b).then(function(){return a})]}})})};f.prototype._applySymbolToRenderer=function(a,b,c){c?a.symbol=b:a.defaultSymbol=b};f.prototype._getMedianColor=function(a){return e(this,void 0,void 0,function(){var b,c,e,d,f;return m(this,function(h){switch(h.label){case 0:if(!("visualVariables"in a&&a.visualVariables))return[2,null];b=x.find(a.visualVariables,function(a){return"color"===a.type});if(!b)return[2,null];e=
c=null;if(b.stops){if(1===b.stops.length)return[2,b.stops[0].color];c=b.stops[0].value;e=b.stops[b.stops.length-1].value}d=c+(e-c)/2;return[4,new Promise(function(a,b){g(["../../../renderers/visualVariables/support/visualVariableUtils"],a,b)})];case 1:return f=h.sent().getColor,[2,f(b,d)]}})})};f.prototype._fetchSymbol=function(a,b){var c=this;if(!a)return k.reject();if("web-style"===a.type){var e=a.portal,e=a.name+"-"+a.styleName+"-"+a.styleUrl+"-"+(e&&e.url)+"-"+(e&&e.user&&e.user.username),d=this._webStyleSymbolCache;
d.has(e)||d.set(e,a.fetchSymbol());return d.get(e).then(function(a){return c._getAppliedCloneSymbol(a,b)}).catch(function(){X.warn("Fetching web-style failed!");return k.reject()})}return k.resolve(this._getAppliedCloneSymbol(a,b))};f.prototype._getAppliedCloneSymbol=function(a,b){if(!a)return a;a=a.clone();var e=-1<a.type.indexOf("3d");b=b&&b.toRgba();e?this._applyColorTo3dSymbol(a,b):a.color&&(a.color=new c(b||a.color));return a};f.prototype._applyColorTo3dSymbol=function(a,b){b&&a.symbolLayers.forEach(function(a){a&&
(a.material||(a.material={}),a.material.color=new c(b))})};f.prototype._createClusterSizeVariable=function(a){var b=L.getActiveSizeStops(this.view,a);return new C({field:a.field,legendOptions:{title:"Number of features"},minSize:b[2].size,minDataValue:b[2].value,maxSize:b[3].size,maxDataValue:b[3].value})};f.prototype._getVisualVariableLegendElements=function(a){return e(this,void 0,void 0,function(){var b,c,d,f,g,h,l,n,p,q,r=this;return m(this,function(t){switch(t.label){case 0:if(!("visualVariables"in
a&&a.visualVariables))return[2,null];b=a.visualVariables;c=[];d=[];f=[];g=this.layer;b.forEach(function(a){"color"===a.type?c.push(a):"size"===a.type?("levels"in a&&a.levels&&(a=r._createClusterSizeVariable(a)),d.push(a)):"opacity"===a.type&&f.push(a)});h=c.concat(d,f);0===c.length&&P(a)&&a.classBreakInfos&&1===a.classBreakInfos.length&&(l=(p=a.classBreakInfos[0])&&p.symbol);0===c.length&&Q(a)&&(l=a.symbol);l&&(-1<l.type.indexOf("3d")?(q=l.symbolLayers.getItemAt(0),"water"===q.type?u.isSome(q.color)&&
(n=q.color):u.isSome(q.material)&&u.isSome(q.material.color)&&(n=q.material.color)):l.url||(n=l.color));return[4,k.all(h.map(function(b){return e(r,void 0,void 0,function(){var c,e,d,f,h,k,l,p;return m(this,function(m){switch(m.label){case 0:if(b.legendOptions&&!1===b.legendOptions.showLegend)return[3,8];c=this._getRampTitle(b,g);e=null;f=(d="getField"in g&&g.getField&&g.getField(b.field))&&A.isDateField(d);return"color"!==b.type?[3,2]:[4,H.getRampStops(b,null,f)];case 1:return h=m.sent(),e={type:"color-ramp",
title:c,infos:h,preview:D.renderColorRampPreviewHTML(h.map(function(a){return a.color}))},this._hasColorRamp||(this._hasColorRamp=!(null==e.infos||!e.infos.length)),[3,7];case 2:if("size"!==b.type||"$view.scale"===b.valueExpression)return[3,5];k={type:"size-ramp",title:c};l=O.getRampStops;p=[a,b];return[4,this._getMedianColor(a)];case 3:return[4,l.apply(void 0,p.concat([m.sent(),this.scale,this.view,f]))];case 4:return e=(k.infos=m.sent(),k),this._hasSizeRamp||(this._hasSizeRamp=!(null==e.infos||
!e.infos.length)),[3,7];case 5:return"opacity"!==b.type?[3,7]:[4,H.getRampStops(b,n,f)];case 6:h=m.sent(),e={type:"opacity-ramp",title:c,infos:h,preview:D.renderColorRampPreviewHTML(h.map(function(a){return a.color}))},this._hasOpacityRamp||(this._hasOpacityRamp=!(null==e.infos||!e.infos.length)),m.label=7;case 7:return[2,e&&e.infos?e:null];case 8:return[2,void 0]}})})}))];case 1:return[2,t.sent().filter(function(a){return!!a})]}})})};f.prototype._getDomainName=function(a,b){if(a&&"function"!==typeof a){var c=
this.layer;return(c=(a=c.getField&&c.getField(a))&&c.getFieldDomain?c.getFieldDomain(a.name):null)&&c.codedValues?c.getName(b):null}return null};f.prototype._getRampTitle=function(a,b){var c=a.field,e=a.normalizationField,d=!1,f=!1,g=!1,h=null,c="function"===typeof c?null:c,e="function"===typeof e?null:e;if(null!=(a.legendOptions&&a.legendOptions.title))h=a.legendOptions.title;else if(a.valueExpressionTitle)h=a.valueExpressionTitle;else{if("renderer"in b&&b.renderer&&"authoringInfo"in b.renderer&&
b.renderer.authoringInfo&&b.renderer.authoringInfo.visualVariables)for(a=b.renderer.authoringInfo.visualVariables,h=0;h<a.length;h++){var k=a[h];if("color"===k.type){if("ratio"===k.style){d=!0;break}if("percent"===k.style){f=!0;break}if("percent-of-total"===k.style){g=!0;break}}}h={field:c&&this._getFieldAlias(c,b),normField:e&&this._getFieldAlias(e,b),ratio:d,ratioPercent:f,ratioPercentTotal:g}}return h};f.prototype._getRendererTitle=function(a,b){if(a.legendOptions&&a.legendOptions.title)return a.legendOptions.title;
if(a.valueExpressionTitle)return a.valueExpressionTitle;var c=this.layer,e=a.field,d=null,f=null;P(a)&&(d=a.normalizationField,f="percent-of-total"===a.normalizationType);e="function"===typeof e?null:e;d="function"===typeof d?null:d;a=null;if(e||d)a={field:b?e:e&&this._getFieldAlias(e,c),normField:b?d:d&&this._getFieldAlias(d,c),normByPct:f};return a};f.prototype._getFieldAlias=function(a,b){var c="popupTemplate"in b&&b.popupTemplate,c=c&&c.fieldInfos;b="function"===typeof a?null:"getField"in b&&
b.getField&&b.getField(a);var e=null;c&&c.some(function(b){return a===b.fieldName?(e=b,!0):!1});var c=e||b,d=null;c&&(d=e&&e.label||b&&b.alias||"name"in c&&c.name||"fieldName"in c&&c.fieldName);return d};f.prototype._isUnclassedRenderer=function(a){var b=a.visualVariables,c=!1;P(a)&&a.classBreakInfos&&1===a.classBreakInfos.length&&b&&(c=a.field?b.some(function(b){return!(!b||a.field!==b.field||(a.normalizationField||b.normalizationField)&&a.normalizationField!==b.normalizationField)}):!!b.length);
return c};b([q.property()],f.prototype,"children",void 0);b([q.property()],f.prototype,"layer",void 0);b([q.property()],f.prototype,"legendElements",void 0);b([q.property()],f.prototype,"parent",void 0);b([q.property({readOnly:!0})],f.prototype,"ready",null);b([q.property()],f.prototype,"scale",void 0);b([q.property({dependsOn:["layer.renderer?.valueExpression?","layer.renderer?.visualVariables?","layer.featureReduction?"],readOnly:!0})],f.prototype,"isScaleDriven",null);b([q.property()],f.prototype,
"title",void 0);b([q.property({dependsOn:["ready"],readOnly:!0,value:0})],f.prototype,"version",null);b([q.property()],f.prototype,"view",void 0);return f=b([q.subclass("esri.widgets.Legend.support.ActiveLayerInfo")],f)}(q.declared(t))})},"esri/layers/support/ExportImageParameters":function(){define("require exports ../../core/tsSupport/assignHelper ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/accessorSupport/decorators ./sublayerUtils ./timeUtils ../../views/View".split(" "),
function(g,a,d,h,b,e,m,c,l,f){Object.defineProperty(a,"__esModule",{value:!0});var t={visible:"visibleSublayers",definitionExpression:"layerDefs",labelingInfo:"hasDynamicLayers",labelsVisible:"hasDynamicLayers",opacity:"hasDynamicLayers",minScale:"visibleSublayers",maxScale:"visibleSublayers",renderer:"hasDynamicLayers",source:"hasDynamicLayers"};g=function(a){function e(){var b=null!==a&&a.apply(this,arguments)||this;b._scale=null;b.view=null;return b}h(e,a);Object.defineProperty(e.prototype,"dynamicLayers",
{get:function(){if(!this.hasDynamicLayers)return null;var a=this.visibleSublayers.map(function(a){return a.toExportImageJSON()});return a.length?JSON.stringify(a):null},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"hasDynamicLayers",{get:function(){return this.layer&&c.isExportDynamic(this.visibleSublayers,this.layer.serviceSublayers,this.layer)},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"layer",{set:function(a){var b=this;this._get("layer")!==a&&(this._set("layer",
a),this._layerHandles&&(this._layerHandles.forEach(function(a){return a.remove()}),this._layerHandles.length=0),a&&(this._layerHandles=[a.allSublayers.on("change",function(){return b.notifyChange("visibleSublayers")}),a.on("sublayer-update",function(a){return b.notifyChange(t[a.propertyName])})]))},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"layers",{get:function(){var a=this.visibleSublayers;return a?a.length?"show:"+a.map(function(a){return a.id}).join(","):"show:-1":null},
enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"layerDefs",{get:function(){var a=this.visibleSublayers.filter(function(a){return null!=a.definitionExpression});return a.length?JSON.stringify(a.reduce(function(a,b){a[b.id]=b.definitionExpression;return a},{})):null},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"scale",{get:function(){return null!=this._scale?this._scale:this.view&&this.view.scale||0},set:function(a){this.view||(this._scale=a,this.notifyChange("scale"))},
enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"version",{get:function(){this.layers;this.layerDefs;this.dynamicLayers;this.timeExtent;var a=this.layer;a&&(a.dpi,a.imageFormat,a.imageTransparency,a.gdbVersion);return(this._get("version")||0)+1},set:function(a){this._set("version",a)},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"visibleSublayers",{get:function(){var a=this,b=[];if(!this.layer)return b;var c=this.layer.sublayers,e=function(c){var d=a.scale,f=
0===c.minScale||d<=c.minScale,g=0===c.maxScale||d>=c.maxScale;c.visible&&(0===d||f&&g)&&(c.sublayers?c.sublayers.forEach(e):b.unshift(c))};c&&c.forEach(e);c=this._get("visibleSublayers");return!c||c.length!==b.length||c.some(function(a,c){return b[c]!==a})?b:c},enumerable:!0,configurable:!0});e.prototype.toJSON=function(){var a=this.layer,a={dpi:a.dpi,format:a.imageFormat,transparent:a.imageTransparency,gdbVersion:a.gdbVersion||null};this.hasDynamicLayers&&this.dynamicLayers?a.dynamicLayers=this.dynamicLayers:
a=d({},a,{layers:this.layers,layerDefs:this.layerDefs});return a};b([m.property({readOnly:!0,dependsOn:["hasDynamicLayers","visibleSublayers"]})],e.prototype,"dynamicLayers",null);b([m.property({readOnly:!0,dependsOn:["visibleSublayers","layer.serviceSublayers","layer.capabilities"]})],e.prototype,"hasDynamicLayers",null);b([m.property()],e.prototype,"layer",null);b([m.property({readOnly:!0,dependsOn:["visibleSublayers"]})],e.prototype,"layers",null);b([m.property({readOnly:!0,dependsOn:["visibleSublayers"]})],
e.prototype,"layerDefs",null);b([m.property({type:Number,dependsOn:["view.scale"]})],e.prototype,"scale",null);b([m.property(l.combinedViewLayerTimeExtentProperty)],e.prototype,"timeExtent",void 0);b([m.property({dependsOn:"layers layerDefs dynamicLayers layer.dpi layer.imageFormat layer.imageTransparency layer.gdbVersion timeExtent".split(" ")})],e.prototype,"version",null);b([m.property({type:f})],e.prototype,"view",void 0);b([m.property({readOnly:!0,dependsOn:["layer.sublayers","scale"]})],e.prototype,
"visibleSublayers",null);return e=b([m.subclass("esri.layers.mixins.ExportImageParameters")],e)}(m.declared(e));a.ExportImageParameters=g})},"esri/layers/support/sublayerUtils":function(){define(["require","exports","./layerSourceUtils"],function(g,a,d){function h(a,g,c){return a.some(function(a){var b=a.source;return!(!b||b.type===d.MAPLAYER&&b.mapLayerId===a.id&&(!b.gdbVersion||b.gdbVersion===c.gdbVersion))||2<a.originIdOf("renderer")||2<a.originIdOf("labelingInfo")||2<a.originIdOf("opacity")||
2<a.originIdOf("labelsVisible")})?!0:!b(a,g)}function b(a,b){if(!a||!a.length)return!0;b=b.slice().reverse().flatten(function(a){return(a=a.sublayers)&&a.toArray().reverse()}).map(function(a){return a.id}).toArray();if(a.length>b.length)return!1;for(var c=0,e=b.length,d=0;d<a.length;d++){for(var g=a[d].id;c<e&&b[c]!==g;)c++;if(c>=e)return!1}return!0}Object.defineProperty(a,"__esModule",{value:!0});a.shouldWriteSublayerStructure=function(a,b,c){var e=b.flatten(function(a){return a.sublayers}).length,
d=a.some(function(a){return 2<a.originIdOf("minScale")||2<a.originIdOf("maxScale")});return e!==a.length||d||h(a,b,c)};a.isExportDynamic=h;a.isSublayerOverhaul=function(a){return!!a&&a.some(function(a){return null!=a.minScale||a.layerDefinition&&null!=a.layerDefinition.minScale})}})},"esri/symbols/support/symbolUtils":function(){define("require exports ../../core/tsSupport/generatorHelper ../../core/tsSupport/awaiterHelper ../../core/tsSupport/assignHelper ../../core/compilerUtils ../../core/maybe ../../core/promiseUtils ../../support/arcadeOnDemand ./previewCIMSymbol ./previewSymbol2D ./previewSymbol3D ./previewWebStyleSymbol ./utils".split(" "),
function(g,a,d,h,b,e,m,c,l,f,t,x,n,p){function y(a,b){switch(a.type){case "web-style":return n.previewWebStyleSymbol(a,y,b);case "label-3d":case "line-3d":case "mesh-3d":case "point-3d":case "polygon-3d":return x.previewSymbol3D(a,b);case "simple-marker":case "simple-line":case "simple-fill":case "picture-marker":case "picture-fill":case "text":return t.previewSymbol2D(a,b);case "cim":return f.previewCIMSymbol(a,b);default:e.neverReached(a)}}function u(a){return a&&"opacity"in a?a.opacity*u(a.parent):
1}Object.defineProperty(a,"__esModule",{value:!0});var k=null;a.renderDotDensityPreviewHTML=function(a,b,c){var e=a.backgroundColor,d=a.outline;a=a.dotSize;var f=c&&c.swatchSize||22,g=Math.round(f*f/Math.pow(a,2)*.8),h=window.devicePixelRatio;c=document.createElement("canvas");var l=f*h;c.width=l;c.height=l;c.style.width=c.width/h+"px";c.style.height=c.height/h+"px";var m=c.getContext("2d");e&&(m.fillStyle=e.toCss(!0),m.fillRect(0,0,l,l),m.fill());m.fillStyle=b.toCss(!0);if(k&&k.length/2===g)for(b=
0;b<2*g;b+=2){var e=k[b],n=k[b+1];m.fillRect(e,n,a*h,a*h);m.fill()}else for(k=[],b=0;b<2*g;b+=2)e=Math.floor(Math.random()*(l-0+1)+0),n=Math.floor(Math.random()*(l-0+1)+0),k.push(e,n),m.fillRect(e,n,a*h,a*h),m.fill();d&&(d.color&&(m.strokeStyle=d.color.toCss(!0)),m.lineWidth=d.width,m.strokeRect(0,0,l,l));d=new Image(f,f);d.src=c.toDataURL();return d};a.renderColorRampPreviewHTML=function(a,b){void 0===b&&(b={});var c="horizontal"===b.align,e=b.width,e=void 0===e?c?75:24:e,d=b.height,d=void 0===d?
c?24:75:d;b=b.gradient;var f=void 0===b?!0:b;b=window.devicePixelRatio;var g=e*b,h=d*b;b=document.createElement("canvas");b.width=g;b.height=h;b.style.width=e+"px";b.style.height=d+"px";var k=b.getContext("2d"),l=c?g:0,m=c?0:h;if(f){var n=k.createLinearGradient(0,0,l,m),p=1/(a.length-1);a.forEach(function(a,b){return n.addColorStop(b*p,a.toString())});k.fillStyle=n;k.fillRect(0,0,g,h)}else for(f=c?g/a.length:g,g=c?h:h/a.length,m=l=h=0;m<a.length;m++)k.fillStyle=a[m].toString(),k.fillRect(h,l,f,g),
h=c?h+f:0,l=c?0:l+g;a=document.createElement("div");a.style.width=e+"px";a.style.height=d+"px";a.appendChild(b);return a};a.renderPreviewHTML=y;a.getDisplayedSymbol=function(a,e){return h(this,void 0,void 0,function(){var f,h,k,n,r,t,y,z,x,G,M,O,K,Q,P,N,J,R;return d(this,function(d){switch(d.label){case 0:if(!a)return[2,void 0];f=u(a.layer||a.sourceLayer);if(m.isSome(a.symbol))return h=a.symbol.clone(),p.applyColorToSymbol(h,null,f),[2,h];k=a.get("layer.renderer")||a.get("sourceLayer.renderer");return[4,
k.getSymbolAsync(a)];case 1:n=d.sent();if(!n)return[2,void 0];n=n.clone();if(!("visualVariables"in k)||"visualVariables"in k&&!k.visualVariables||"visualVariables"in k&&k.visualVariables&&!k.visualVariables.length)return[2,n];if(!k.arcadeRequiredForVisualVariables||!m.isNone(e)&&!m.isNone(e.arcade))return[3,3];t=r=b({},m.unwrap(e));return[4,l.loadArcade()];case 2:t.arcade=d.sent(),e=r,d.label=3;case 3:return[4,c.create(function(a){return g(["../../renderers/visualVariables/support/visualVariableUtils"],
a)})];case 4:y=d.sent();z=[];x=[];G=[];M=[];O=0;for(K=k.visualVariables;O<K.length;O++)switch(Q=K[O],Q.type){case "color":z.push(Q);break;case "opacity":x.push(Q);break;case "rotation":M.push(Q);break;case "size":G.push(Q)}N=(P=!!z.length&&z[z.length-1])?y.getColor(P,a,e):null;R=(J=!!x.length&&x[x.length-1])?y.getOpacity(J,a,e):null;null!=f&&(R=null!=R?R*f:f);p.applyColorToSymbol(n,N,R);G.forEach(function(b){return p.applySizeToSymbol(n,y.getSize(b,a,e),b.axis)});M.forEach(function(b){return p.applyRotationToSymbol(n,
y.getRotationAngle(b,a,e),b.axis)});return[2,n]}})})}})},"esri/symbols/support/previewCIMSymbol":function(){define(["require","exports","../../core/tsSupport/generatorHelper","../../core/tsSupport/awaiterHelper","../cim/CIMSymbolRasterizer"],function(g,a,d,h,b){Object.defineProperty(a,"__esModule",{value:!0});var e=new b(null,!0);a.previewCIMSymbol=function(a,b){return h(this,void 0,void 0,function(){var c,f,g,h,m,p,y,u;return d(this,function(d){switch(d.label){case 0:return c=b&&b.size?b.size:null,
f=b&&b.maxSize?b.maxSize:null,g=Math.min(c||22,f||120),h=3,[4,e.rasterizeCIMSymbolAsync(a,null,null,{targetSize:g*h})];case 1:return m=d.sent(),p=document.createElement("canvas"),p.width=m.imageData.width,p.height=m.imageData.height,y=p.getContext("2d"),y.putImageData(m.imageData,0,0),u=new Image(p.width/h,p.height/h),u.src=p.toDataURL(),[2,u]}})})}})},"esri/symbols/cim/CIMSymbolRasterizer":function(){define("require exports ../../core/tsSupport/generatorHelper ../../core/tsSupport/awaiterHelper ../../request ../../core/promiseUtils ../../core/screenUtils ../../geometry/support/jsonUtils ./cimAnalyzer ./Rasterizer ./TextRasterizer ./utils ../support/cimSymbolUtils ../support/Symbol3DAnchorPosition2D".split(" "),
function(g,a,d,h,b,e,m,c,l,f,t,x,n,p){function y(a,b,c){var e=(a?Object.keys(a):[]).map(function(b){return{name:b,alias:b,type:"string"===typeof a[b]?"esriFieldTypeString":"esriFieldTypeDouble"}});return{geometryType:b,spatialReference:c,fields:e}}return function(){function a(a,b){this._spatialReference=a;this._avoidSDF=b;this._resourceCache=new Map;this._rasterizer=new f.default;this._textRasterizer=new t.default;this._pictureMarkerCache=new Map}a.prototype.rasterizeCIMSymbolAsync=function(a,b,f,
g,m,p){return h(this,void 0,void 0,function(){var h,k,q,r,t,u,z,A,x,E;return d(this,function(d){switch(d.label){case 0:return[4,n.expandSymbol(a)];case 1:return h=d.sent(),k=[],b?(r=null!==b.centroid?"esriGeometryPolygon":c.getJsonType(b.geometry),q=y(b.attributes,r,this._spatialReference)):(h=h.clone(),h.data.primitiveOverrides=[],q=null),t=[],t.push(l.analyzeCIMSymbol(h.data,f,q,k,this._avoidSDF)),[4,e.all(t)];case 2:d.sent(),u=[],z=0,A=k,d.label=3;case 3:if(!(z<A.length))return[3,7];x=A[z];return"CIMPictureMarker"!==
x.cim.type?[3,5]:[4,this.fetchPictureMarkerResource(x)];case 4:d.sent(),d.label=5;case 5:E=this._getRasterizedResource(x,b,g,m,p),null!=E&&u.push({cimLayer:x,rasterizedResource:E}),d.label=6;case 6:return z++,[3,3];case 7:return[2,this.getSymbolImage(u,b,g,m,p)]}})})};a.prototype.analyzeCIMSymbol=function(a,b,c,f,g){return h(this,void 0,void 0,function(){var h,k,m,p,q,r;return d(this,function(d){switch(d.label){case 0:return[4,n.expandSymbol(a,g)];case 1:return h=d.sent(),k=[],b?m=y(b,f,this._spatialReference):
(h=h.clone(),h.data.primitiveOverrides=[],m=null),p=[],p.push(l.analyzeCIMSymbol(h.data,c,m,k,this._avoidSDF)),[4,e.all(p)];case 2:d.sent(),e.throwIfAborted(g),q=0,d.label=3;case 3:if(!(q<k.length))return[3,6];r=k[q];return"CIMPictureMarker"!==r.cim.type?[3,5]:[4,this.fetchPictureMarkerResource(r,g)];case 4:d.sent(),d.label=5;case 5:return q++,[3,3];case 6:return[2,k]}})})};a.prototype.fetchPictureMarkerResource=function(a,c){return h(this,void 0,void 0,function(){var e,f,g;return d(this,function(d){switch(d.label){case 0:return e=
a.materialHash,this._pictureMarkerCache.get(e)?[3,2]:[4,b(a.cim.url,{responseType:"image",signal:c.signal})];case 1:f=d.sent(),g=f.data,this._pictureMarkerCache.set(e,g),d.label=2;case 2:return[2]}})})};a.prototype.rasterizeCIMSymbol=function(a,b,c,e,d){for(var f=[],g=0;g<a.length;g++){var h=a[g];!c||"function"!==typeof c.scaleFactor||"marker"!==h.type&&"text"!==h.type||(c.scaleFactor=c.scaleFactor(b,e,d));var k=this._getRasterizedResource(h,b,c,e,d);null!=k&&f.push({cimLayer:h,rasterizedResource:k})}return this.getSymbolImage(f,
b,c,e,d)};a.prototype.getSymbolImage=function(a,b,c,e,d){for(var f=document.createElement("canvas"),g=f.getContext("2d"),h=0,k=0,l=0,n=0,q=[],r=0;r<a.length;r++){var t=a[r],u=t.rasterizedResource;if(u){var y=t.cimLayer;if("line"!==y.type&&"fill"!==y.type){var z=c.targetSize?c.targetSize/y.referenceSize:c.scaleFactor?c.scaleFactor:1,E=u.size,N=x.evaluateValueOrFunction(y.offsetX,b,e,d)*z,z=x.evaluateValueOrFunction(y.offsetY,b,e,d)*z,N=N?N:0,z=z?z:0,J=t.rasterizedResource.anchorX,t=t.rasterizedResource.anchorY,
R=!1,Y=y.type,W=void 0;"marker"===y.type&&(W=x.evaluateValueOrFunction(y.rotation,b,e,d),R=y.rotateClockwise?y.rotateClockwise:!1);if("text"===y.type){W=x.evaluateValueOrFunction(y.angle,b,e,d);if(void 0!==y.horizontalAlignment)switch(y.horizontalAlignment){case "left":J=-.5;break;case "right":J=.5;break;default:J=0}if(void 0!==y.verticalAlignment)switch(y.verticalAlignment){case "top":t=.5;break;case "bottom":t=-.5;break;case "baseline":t=-.25;break;default:t=0}}var y=m.pt2px(N)-E[0]*(.5+J),X=m.pt2px(z)-
E[1]*(.5+t),Z=y+E[0],aa=X+E[1];if(W){R&&(W=-W);var V=Math.sin(W*Math.PI/180),ca=Math.cos(W*Math.PI/180),E=y*ca-X*V,da=y*V+X*ca,ba=y*ca-aa*V,S=y*V+aa*ca,ea=Z*ca-aa*V,aa=Z*V+aa*ca,fa=Z*ca-X*V,V=Z*V+X*ca,y=Math.min(E,ba,ea,fa),X=Math.min(da,S,aa,V),Z=Math.max(E,ba,ea,fa),aa=Math.max(da,S,aa,V)}h=y<h?y:h;k=X<k?X:k;l=Z>l?Z:l;n=aa>n?aa:n;y=g.createImageData(u.size[0],u.size[1]);y.data.set(new Uint8ClampedArray(u.image.buffer));u={offsetX:N,offsetY:z,rotateClockwise:R,type:Y,angle:W,rasterizedImage:y,anchorX:J,
anchorY:t};q.push(u)}}}f.width=l-h;f.height=n-k;a=-h;for(r=0;r<q.length;r++)u=q[r],b=this._imageDataToCanvas(u.rasterizedImage),c=a-u.rasterizedImage.width*(.5+u.anchorX),e=n-u.rasterizedImage.height*(.5-u.anchorY),u.angle?(d=(360-u.angle)*Math.PI/180,g.save(),g.translate(m.pt2px(u.offsetX),-m.pt2px(u.offsetY)),g.translate(a,n),g.rotate(d),g.translate(-a,-n),g.drawImage(b,c,e),g.restore()):g.drawImage(b,c+m.pt2px(u.offsetX),e-m.pt2px(u.offsetY));q=new p.default({x:a/f.width-.5,y:n/f.height-.5});return{imageData:g.getImageData(0,
0,f.width,f.height),anchorPosition:q}};a.prototype._imageDataToCanvas=function(a){this._imageDataCanvas||(this._imageDataCanvas=document.createElement("canvas"));var b=this._imageDataCanvas,c=b.getContext("2d");b.width=a.width;b.height=a.height;c.putImageData(a,0,0);return b};a.prototype._imageTo32Array=function(a,b,c){this._imageDataCanvas||(this._imageDataCanvas=document.createElement("canvas"));var e=this._imageDataCanvas,d=e.getContext("2d");e.width=b;e.height=c;d.drawImage(a,0,0,b,c);return new Uint32Array(d.getImageData(0,
0,b,c).data.buffer)};a.prototype._getRasterizedResource=function(a,b,c,e,d){var f;if("text"===a.type)f=a.cim,a=this._rasterizeTextResource(a,b,c,e,d);else{var g=this._resourceCache,h=void 0;"function"===typeof a.materialHash?(h=a.materialHash,h=h(b,e,d),f=l.analyzeCIMResource(a.cim,a.materialOverrides)):(h=a.materialHash,c&&(h+=JSON.stringify(c)),f=a.cim);if(g.has(h))return g.get(h);c=c.targetSize?c.targetSize/a.referenceSize:c.scaleFactor?c.scaleFactor:1;f.size*=c;if("CIMPictureMarker"===a.cim.type){d=
x.evaluateValueOrFunction(a.cim.size,b,e,d)*c;b=this._pictureMarkerCache.get(a.materialHash);if(!b)return null;c=b.height/b.width;e=1<c?m.pt2px(d):m.pt2px(d)/c;d=1<c?m.pt2px(d)*c:m.pt2px(d);a={image:this._imageTo32Array(b,e,d),size:[e,d],sdf:!1,simplePattern:!1,anchorX:a.anchorPoint?a.anchorPoint.x:0,anchorY:a.anchorPoint?a.anchorPoint.y:0}}else a=this._rasterizer.rasterizeJSONResource(f,this._avoidSDF);g.set(h,a)}return a};a.prototype._rasterizeTextResource=function(a,b,c,e,d){var f=c.targetSize?
c.targetSize/a.referenceSize:c.scaleFactor?c.scaleFactor:1;c=x.evaluateValueOrFunction(a.text,b,e,d);if(!c||0===c.length)return null;var g=x.evaluateValueOrFunction(a.fontName,b,e,d),h=x.evaluateValueOrFunction(a.style,b,e,d),k=x.evaluateValueOrFunction(a.weight,b,e,d),l=x.evaluateValueOrFunction(a.decoration,b,e,d),f=x.evaluateValueOrFunction(a.size,b,e,d)*f,m=x.evaluateValueOrFunction(a.horizontalAlignment,b,e,d),n=x.evaluateValueOrFunction(a.verticalAlignment,b,e,d),p=x.colorToArray(x.evaluateValueOrFunction(a.color,
b,e,d)),q=x.colorToArray(x.evaluateValueOrFunction(a.outlineColor,b,e,d));a=x.evaluateValueOrFunction(a.outlineSize,b,e,d);return this._textRasterizer.rasterizeText(c,{color:p,size:f,horizontalAlignment:m,verticalAlignment:n,font:{family:g,style:h,weight:k,decoration:l},halo:{size:a||0,color:q,style:h},pixelRatio:1,premultiplyColors:!this._avoidSDF})};return a}()})},"esri/views/2d/arcade/utils":function(){define("require exports ../../../core/tsSupport/assignHelper @dojo/framework/shim/WeakMap ../../../core/Error ../../../core/Logger ../../../geometry/support/quantizationUtils ../../../layers/graphics/featureConversionUtils".split(" "),
function(g,a,d,h,b,e,m,c){function l(a,b,c,e){var g=e.transform,h=e.hasZ;e=e.hasM;x.has(a)||x.set(a,f(c));a=x.get(a)(b.geometry,g,h,e);return d({},b,{geometry:a})}function f(a){var c={};switch(a){case "esriGeometryPoint":return function(a,b,e,d){return m.hydratePoint(b,c,a,e,d)};case "esriGeometryPolygon":return function(a,b,e,d){return m.hydratePolygon(b,c,a,e,d)};case "esriGeometryPolyline":return function(a,b,e,d){return m.hydratePolyline(b,c,a,e,d)};case "esriGeometryMultipoint":return function(a,
b,e,d){return m.hydrateMultipoint(b,c,a,e,d)};default:return t.error(new b("mapview-arcade","Unable to handle geometryType: "+a)),function(a){return a}}}Object.defineProperty(a,"__esModule",{value:!0});var t=e.getLogger("esri.views.2d.support.arcadeOnDemand");a.callWithOptimizedFeature=function(a,b,e,f,g){var h=f.geometryType,k=f.hasZ;f=f.hasM;b=a.referencesGeometry()?g?l(a,c.convertToFeature(b,h,k,f),h,g):c.convertToFeature(b,h,k,f):b;b=a.repurposeFeature(b);try{return a.evaluate(d({},e,{$feature:b}))}catch(q){return t.warn("Feature arcade evaluation failed:",
q),null}};a.callWithFeature=function(a,b,c,e,f){b=a.referencesGeometry()&&f?l(a,b,e,f):b;b=a.repurposeFeature(b);try{return a.evaluate(d({},c,{$feature:b}))}catch(r){return t.warn("Feature arcade evaluation failed:",r),null}};var x=new h.default;a.createHydrateFactory=f})},"esri/layers/graphics/featureConversionUtils":function(){define("require exports ../../core/Error ../../core/Logger ../../geometry/support/jsonUtils ./OptimizedFeature ./OptimizedFeatureSet ./OptimizedGeometry".split(" "),function(g,
a,d,h,b,e,m,c){function l(a,b){return a?b?4:3:b?3:2}function f(a,b,c,e){if(a){if(c)return b&&e?Z:W;if(b&&e)return X}else if(b&&e)return W;return Y}function t(a,b){return Math.round((b-a.translate[0])/a.scale[0])}function x(a,b){return Math.round((a.translate[1]-b)/a.scale[1])}function n(a,b){return b*a.scale[0]+a.translate[0]}function p(a,b){return a.translate[1]-b*a.scale[1]}function y(a){a=a.coords;return{x:a[0],y:a[1]}}function u(a,b){a.coords[0]=b.x;a.coords[1]=b.y;return a}function k(a){a=a.coords;
return{x:a[0],y:a[1],z:a[2]}}function r(a,b){a.coords[0]=b.x;a.coords[1]=b.y;a.coords[2]=b.z;return a}function z(a){a=a.coords;return{x:a[0],y:a[1],m:a[2]}}function q(a,b){a.coords[0]=b.x;a.coords[1]=b.y;a.coords[2]=b.m;return a}function E(a){a=a.coords;return{x:a[0],y:a[1],z:a[2],m:a[3]}}function A(a,b){a.coords[0]=b.x;a.coords[1]=b.y;a.coords[2]=b.z;a.coords[3]=b.m;return a}function B(a,b){return a&&b?A:a?r:b?q:u}function C(a,b,c){if(!a)return null;for(var e=l(b,c),d=[],f=0;f<a.coords.length;f+=
e){for(var g=[],h=0;h<e;h++)g.push(a.coords[f+h]);d.push(g)}return b?c?{points:d,hasZ:b,hasM:c}:{points:d,hasZ:b}:c?{points:d,hasM:c}:{points:d}}function D(a,b,c){void 0===c&&(c=l(b.hasZ,b.hasM));a.lengths[0]=b.points.length;var e=a.coords,d=0,f=0;for(b=b.points;f<b.length;f++)for(var g=b[f],h=0;h<c;h++)e[d++]=g[h];return a}function I(a,b,c){if(!a)return null;var e=l(b,c),d=a.coords,f=[],g=0,h=0;for(a=a.lengths;h<a.length;h++){for(var k=a[h],m=[],n=0;n<k;n++){for(var p=[],q=0;q<e;q++)p.push(d[g++]);
m.push(p)}f.push(m)}return b?c?{paths:f,hasZ:b,hasM:c}:{paths:f,hasZ:b}:c?{paths:f,hasM:c}:{paths:f}}function L(a,b,c){void 0===c&&(c=l(b.hasZ,b.hasM));var e=a.lengths,d=a.coords,f=0,g=0;for(b=b.paths;g<b.length;g++){for(var h=b[g],k=0,m=h;k<m.length;k++)for(var n=m[k],p=0;p<c;p++)d[f++]=n[p];e.push(h.length)}return a}function H(a,b,c){if(!a)return null;var e=l(b,c),d=a.coords,f=[],g=0,h=0;for(a=a.lengths;h<a.length;h++){for(var k=a[h],m=[],n=0;n<k;n++){for(var p=[],q=0;q<e;q++)p.push(d[g++]);m.push(p)}f.push(m)}return b?
c?{rings:f,hasZ:b,hasM:c}:{rings:f,hasZ:b}:c?{rings:f,hasM:c}:{rings:f}}function G(a,b,c,e){void 0===c&&(c=b.hasZ);void 0===e&&(e=b.hasM);M(a,b.rings,c,e);return a}function M(a,b,c,e){c=l(c,e);e=a.lengths;for(var d=a.coords,f=0,g=e.length=d.length=0;g<b.length;g++){for(var h=b[g],k=0,m=h;k<m.length;k++)for(var n=m[k],p=0;p<c;p++)d[f++]=n[p];e.push(h.length)}return a}function O(a,b,f,g,h,k){a.length=0;if(!f){for(g=0;g<b.length;g++)h=b[g],a.push(new e.default(null,h.attributes,null,h.attributes[k]));
return a}switch(f){case "esriGeometryPoint":g=B(g,h);for(h=0;h<b.length;h++){var m=b[h];f=m.geometry;var m=m.attributes,n=void 0;f&&(n=g(new c.default,f));a.push(new e.default(n,m,null,m[k]))}break;case "esriGeometryMultipoint":g=l(g,h);for(h=0;h<b.length;h++)m=b[h],f=m.geometry,m=m.attributes,n=void 0,f&&(n=D(new c.default,f,g)),a.push(new e.default(n,m,null,m[k]));break;case "esriGeometryPolyline":g=l(g,h);for(h=0;h<b.length;h++)m=b[h],f=m.geometry,m=m.attributes,n=void 0,f&&(n=L(new c.default,
f,g)),a.push(new e.default(n,m,null,m[k]));break;case "esriGeometryPolygon":for(f=0;f<b.length;f++){var p=b[f],m=p.geometry,n=p.centroid,p=p.attributes,q=void 0;m&&(q=G(new c.default,m,g,h));n?a.push(new e.default(q,p,u(new c.default,n),p[k])):a.push(new e.default(q,p,null,p[k]))}break;default:J.error("convertToFeatureSet:unknown-geometry",new d("Unable to parse unknown geometry type '"+f+"'")),a.length=0}return a}function K(a,b,c,e,f){a.length=0;switch(c){case "esriGeometryPoint":c=y;e&&f?c=E:e?
c=k:f&&(c=z);for(e=0;e<b.length;e++){var h=b[e];f=h.geometry;h=h.attributes;f=f?c(f):null;a.push({attributes:h,geometry:f})}break;case "esriGeometryMultipoint":for(c=0;c<b.length;c++){var g=b[c],h=g.geometry,g=g.attributes,l=void 0;h&&(l=C(h,e,f));a.push({attributes:g,geometry:l})}break;case "esriGeometryPolyline":for(c=0;c<b.length;c++)g=b[c],h=g.geometry,g=g.attributes,l=void 0,h&&(l=I(h,e,f)),a.push({attributes:g,geometry:l});break;case "esriGeometryPolygon":for(c=0;c<b.length;c++){var l=b[c],
g=l.geometry,h=l.attributes,m=l.centroid,l=void 0;g&&(l=H(g,e,f));m?(g=y(m),a.push({attributes:h,centroid:g,geometry:l})):a.push({attributes:h,geometry:l})}break;default:J.error("convertToFeatureSet:unknown-geometry",new d("Unable to parse unknown geometry type '"+c+"'"))}return a}function Q(a,b,c,e,d,h,g,k){void 0===g&&(g=c);void 0===k&&(k=e);a.lengths.length&&(a.lengths.length=0);a.coords.length&&(a.coords.length=0);if(!b||!b.coords.length)return null;d=R[d];var m=b.coords;b=b.lengths;var n=l(c,
e),p=l(c&&g,e&&k);c=f(c,e,g,k);if(!b.length)return c(a.coords,m,0,0,t(h,m[0]),x(h,m[1])),a.lengths.length&&(a.lengths.length=0),a.coords.length=n,a;for(var q,r=0,u,B=0,y=0;y<b.length;y++){var z=b[y];if(!(z<d)){var w=0;u=B;k=e=t(h,m[r]);q=g=x(h,m[r+1]);c(a.coords,m,u,r,k,q);w++;r+=n;u+=p;for(var A=1;A<z;A++,r+=n)if(k=t(h,m[r]),q=x(h,m[r+1]),k!==e||q!==g)c(a.coords,m,u,r,k-e,q-g),u+=p,w++,e=k,g=q;w>=d&&(a.lengths.push(w),B=u)}}a.coords.length=B;return a.coords.length?a:null}function P(a,b,c,e,d,f,g){for(var h=
e,k=0,l,m=f+c;m<g;m+=c){l=b[m];var n=b[m+1],p=b[g],q=b[g+1],r=b[f],t=b[f+1],u=p-r,B=q-t;if(0!==u||0!==B){var y=((l-r)*u+(n-t)*B)/(u*u+B*B);1<y?(r=p,t=q):0<y&&(r+=u*y,t+=B*y)}u=l-r;B=n-t;l=u*u+B*B;l>h&&(k=m,h=l)}h>e&&(k-f>c&&P(a,b,c,e,d,f,k),d(a,b,a.length,k,b[k],b[k+1]),g-k>c&&P(a,b,c,e,d,k,g))}function N(a,b,c,e,d){var f=b.coords,g=b.lengths,h=c?e?Z:W:e?W:Y;c=l(c,e);if(!f.length)return a!==b&&(a.lengths.length=0,a.coords.length=0),a;if(!g.length)return h(a.coords,f,0,0,n(d,f[0]),p(d,f[1])),a!==b&&
(a.lengths.length=0,a.coords.length=c),a;var k=d.scale;e=k[0];for(var k=k[1],m=0,q=0;q<g.length;q++){var r=g[q];a.lengths[q]=r;var t=n(d,f[m]),u=p(d,f[m+1]);h(a.coords,f,m,m,t,u);for(var m=m+c,B=1;B<r;B++,m+=c)t+=f[m]*e,u-=f[m+1]*k,h(a.coords,f,m,m,t,u)}a!==b&&(a.lengths.length=g.length,a.coords.length=f.length);return a}Object.defineProperty(a,"__esModule",{value:!0});var J=h.getLogger("esri.tasks.support.optimizedFeatureSet"),R={esriGeometryPoint:0,esriGeometryPolyline:2,esriGeometryPolygon:3,esriGeometryMultipoint:0},
Y=function(a,b,c,e,d,f){a[c]=d;a[c+1]=f},W=function(a,b,c,e,d,f){a[c]=d;a[c+1]=f;a[c+2]=b[e+2]},X=function(a,b,c,e,d,f){a[c]=d;a[c+1]=f;a[c+2]=b[e+3]},Z=function(a,b,c,e,d,f){a[c]=d;a[c+1]=f;a[c+2]=b[e+2];a[c+3]=b[e+3]};a.quantizeX=t;a.quantizeY=x;a.hydrateX=n;a.hydrateY=p;a.convertToPoint=function(a,b,c){return a?b?c?E(a):k(a):c?z(a):y(a):null};a.convertFromPoint=function(a,b,c){void 0===c&&(c=B(null!=b.z,null!=b.m));return c(a,b)};a.convertToMultipoint=C;a.convertFromMultipoint=D;a.convertToPolyline=
I;a.convertFromPolyline=L;a.convertToPolygon=H;a.convertFromPolygon=G;a.convertFromNestedArray=M;var aa=[],V=[];a.convertFromFeature=function(a,b,c,e,d){aa[0]=a;a=O(V,aa,b,c,e,d)[0];aa.length=V.length=0;return a};a.convertFromFeatures=O;a.convertToFeature=function(a,b,c,e){V[0]=a;K(aa,V,b,c,e);a=aa[0];aa.length=V.length=0;return a};a.convertFromGeometry=function(a,e,f){if(!a)return null;var g=new c.default;"hasZ"in a&&null==e&&(e=a.hasZ);"hasM"in a&&null==f&&(f=a.hasM);if(b.isPoint(a))return B(null!=
e?e:null!=a.z,null!=f?f:null!=a.m)(g,a);if(b.isPolygon(a))return G(g,a,e,f);if(b.isPolyline(a))return L(g,a,l(e,f));if(b.isMultipoint(a))return D(g,a,l(e,f));J.error("convertFromGeometry:unknown-geometry",new d("Unable to parse unknown geometry type '"+a+"'"))};a.convertToGeometry=function(a,b,c,e){a=a&&("coords"in a?a:a.geometry);if(!a)return null;switch(b){case "esriGeometryPoint":return b=y,c&&e?b=E:c?b=k:e&&(b=z),b(a);case "esriGeometryMultipoint":return C(a,c,e);case "esriGeometryPolyline":return I(a,
c,e);case "esriGeometryPolygon":return H(a,c,e);default:J.error("convertToGeometry:unknown-geometry",new d("Unable to parse unknown geometry type '"+b+"'"))}};a.convertToFeatures=K;a.convertToFeatureSet=function(a){var b=a.objectIdFieldName,c=a.spatialReference,e=a.transform,d=a.fields,f=a.hasM,g=a.hasZ,h=a.geometryType,k=a.exceededTransferLimit;a={features:K([],a.features,h,g,f),fields:d,geometryType:h,objectIdFieldName:b,spatialReference:c};e&&(a.transform=e);k&&(a.exceededTransferLimit=k);f&&(a.hasM=
f);g&&(a.hasZ=g);return a};a.convertFromFeatureSet=function(a,b){var c=new m.default,e=a.hasM,f=a.hasZ,g=a.features,h=a.objectIdFieldName,k=a.spatialReference,l=a.geometryType,n=a.exceededTransferLimit,p=a.transform;c.fields=a.fields;c.geometryType=l;c.objectIdFieldName=h||b;c.spatialReference=k;if(!c.objectIdFieldName)return J.error(new d("optimized-features:invalid-objectIdFieldName","objectIdFieldName is missing")),c;g&&O(c.features,g,l,f,e,c.objectIdFieldName);n&&(c.exceededTransferLimit=n);e&&
(c.hasM=e);f&&(c.hasZ=f);p&&(c.transform=p);return c};a.hydrateOptimizedFeatureSet=function(a){var b=a.transform,c=a.hasM,e=a.hasZ;if(!b)return a;for(var d=0,f=a.features;d<f.length;d++){var g=f[d];g.geometry&&N(g.geometry,g.geometry,c,e,b);g.centroid&&N(g.centroid,g.centroid,c,e,b)}a.transform=null;return a};a.quantizeOptimizedFeatureSet=function(a,b){var d=b.geometryType,f=b.features,g=b.hasM,h=b.hasZ;if(!a)return b;for(var k=0;k<f.length;k++){var l=f[k],m=new e.default(new c.default,l.attributes);
Q(m.geometry,l.geometry,g,h,d,a);l.centroid&&(m.centroid=new c.default,Q(m.centroid,l.centroid,g,h,"esriGeometryPoint",a));f[k]=m}b.transform=a;return b};a.quantizeOptimizedGeometry=Q;a.generalizeOptimizedGeometry=function(a,b,c,e,d,g,h,k){void 0===h&&(h=c);void 0===k&&(k=e);a.lengths.length&&(a.lengths.length=0);a.coords.length&&(a.coords.length=0);if(!b||!b.coords.length)return null;d=R[d];var m=b.coords;b=b.lengths;var n=l(c,e),p=l(c&&h,e&&k);c=f(c,e,h,k);if(!b.length)return c(a.coords,m,0,0,m[0],
m[1]),a.lengths.length&&(a.lengths.length=0),a.coords.length=n,a;e=0;g*=g;for(h=0;h<b.length;h++){k=b[h];if(!(k<d)){var q=a.coords.length/p,r=e,t=e+(k-1)*n;c(a.coords,m,a.coords.length,r,m[r],m[r+1]);P(a.coords,m,n,g,c,r,t);c(a.coords,m,a.coords.length,t,m[t],m[t+1]);r=a.coords.length/p-q;r>=d?a.lengths.push(r):a.coords.length=q*p}e+=k*n}return a.coords.length?a:null};a.getBoundsOptimizedGeometry=function(a,b,c,e){c=l(c,e);var d=e=Number.POSITIVE_INFINITY,f=Number.NEGATIVE_INFINITY,g=Number.NEGATIVE_INFINITY;
if(b&&b.coords){b=b.coords;for(var h=0;h<b.length;h+=c){var k=b[h],m=b[h+1];e=Math.min(e,k);f=Math.max(f,k);d=Math.min(d,m);g=Math.max(g,m)}}a[0]=e;a[1]=d;a[2]=f;a[3]=g;return a};a.getQuantizedBoundsOptimizedGeometry=function(a,b,c,e){c=l(c,e);e=b.coords;var d=Number.POSITIVE_INFINITY,f=Number.POSITIVE_INFINITY,g=Number.NEGATIVE_INFINITY,h=Number.NEGATIVE_INFINITY,k=0,m=0;for(b=b.lengths;m<b.length;m++)for(var n=b[m],p=e[k],q=e[k+1],d=Math.min(p,d),f=Math.min(q,f),g=Math.max(p,g),h=Math.max(q,h),
k=k+c,r=1;r<n;r++,k+=c){var t=e[k],u=e[k+1],p=p+t,q=q+u;0>t&&(d=Math.min(d,p));0<t&&(g=Math.max(g,p));0>u?f=Math.min(f,q):0<u&&(h=Math.max(h,q))}a[0]=d;a[1]=f;a[2]=g;a[3]=h;return a};a.hydrateOptimizedGeometry=N;a.removeZMValues=function(a,b,c,e,d,g){var h,k=l(c,e);c=f(c,e,d,g);e=b.coords;a.coords.length=0;a.lengths.length=0;(h=a.lengths).push.apply(h,b.lengths);for(b=0;b<e.length;b+=k)c(a.coords,e,a.coords.length,b,e[b],e[b+1]);return a};a.removeCollinearVectices=function(a,b,c,e,d){if(!b||!b.coords||
!b.coords.length)return null;c=R[c];var g=b.coords;b=b.lengths;var h=f(e,d,e,d);e=l(e,d);for(var k=d=0,m=0,n=0,p=0;p<b.length;p++){var q=b[p],k=n;h(a.coords,g,k,d,g[d],g[d+1]);d+=e;var r=g[d],t=g[d+1],u=r,B=t,y=t/r,k=k+e;h(a.coords,g,k,d,u,B);d+=e;for(var z=2;z<q;z++){var r=g[d],t=g[d+1],A=t/r,x=y===A||!isFinite(y)&&!isFinite(A),y=x&&isFinite(A)?0<=y&&0<=A||0>=y&&0>=A:0<=B&&0<=t||0>=B&&0>=t;x&&y?(u+=r,B+=t):(u=r,B=t,k+=e);h(a.coords,g,k,d,u,B);d+=e;y=A}k+=e;q=(k-n)/e;q>=c&&(a.lengths[m]=q,n=k,m++)}a.coords.length>
k&&(a.coords.length=k);a.lengths.length>m&&(a.lengths.length=m);return a.coords.length?a:null}})},"esri/symbols/cim/TextRasterizer":function(){define(["require","exports","../../core/screenUtils"],function(g,a,d){Object.defineProperty(a,"__esModule",{value:!0});g=function(){function a(){}a.prototype.rasterizeText=function(a,b){this._textRasterizationCanvas||(this._textRasterizationCanvas=document.createElement("canvas"));var c=this._textRasterizationCanvas,e=c.getContext("2d");this.setFontProperties(e,
b);this.parameters=b;this.textLines=a.split(/\r?\n/);this.lineHeight=this.computeLineHeight();a=this.computeTextWidth(e,b);var d=this.lineHeight*this.textLines.length;c.width=a;c.height=d;this.renderedLineHeight=Math.round(this.lineHeight*b.pixelRatio);this.renderedHaloSize=b.halo.size*b.pixelRatio;this.renderedWidth=a*b.pixelRatio;this.renderedHeight=d*b.pixelRatio;c=b.color;this.fillStyle="rgba("+c.slice(0,3).toString()+","+c[3]+")";this.haloStyle="rgb("+b.halo.color.slice(0,3).toString()+")";var c=
this.renderedLineHeight,g=this.renderedHaloSize;this.setFontProperties(e,b);a=e.textAlign;var d=this.renderedWidth,h=("center"===a?.5*d:"right"===a?d:0)+g,d=a=0;0<g&&this.renderHalo(e,h,g,a,d,b);d+=g;a+=h;g=0;for(h=this.textLines;g<h.length;g++){var m=h[g];e.globalCompositeOperation="destination-out";e.fillStyle="rgb(0, 0, 0)";e.fillText(m,a,d);e.globalCompositeOperation="source-over";e.fillStyle=this.fillStyle;e.fillText(m,a,d);d+=c}e=e.getImageData(0,0,this.renderedWidth,this.renderedHeight);e=
new Uint8Array(e.data);if(b.premultiplyColors)for(b=void 0,c=0;c<e.length;c+=4)b=e[c+3]/255,e[c]*=b,e[c+1]*=b,e[c+2]*=b;return{size:[this.renderedWidth,this.renderedHeight],image:new Uint32Array(e.buffer),sdf:!1,simplePattern:!1,anchorX:0,anchorY:0}};a.prototype.renderHalo=function(a,b,e,d,g,h){var c=this.renderedWidth,f=this.renderedHeight;this._haloRasterizationCanvas||(this._haloRasterizationCanvas=document.createElement("canvas"));this._haloRasterizationCanvas.width=c;this._haloRasterizationCanvas.height=
f;var l=this._haloRasterizationCanvas,m=l.getContext("2d");m.clearRect(0,0,c,f);this.setFontProperties(m,h);m.fillStyle=this.haloStyle;m.strokeStyle=this.haloStyle;h=3>this.renderedHaloSize;m.lineJoin=h?"miter":"round";h?this.renderHaloEmulated(m,b,e):this.renderHaloNative(m,b,e);a.globalAlpha=this.parameters.halo.color[3];a.drawImage(l,0,0,c,f,d,g,c,f);a.globalAlpha=1};a.prototype.renderHaloEmulated=function(a,b,e){for(var c=this.renderedLineHeight,d=this.renderedHaloSize,g=0,l=this.textLines;g<
l.length;g++){for(var m=l[g],y=0,u=h;y<u.length;y++){var k=u[y];a.fillText(m,b+d*k[0],e+d*k[1])}e+=c}};a.prototype.renderHaloNative=function(a,b,e){for(var c=this.renderedLineHeight,d=this.renderedHaloSize,g=0,h=this.textLines;g<h.length;g++){for(var l=h[g],m=2*d,u=0;5>u;u++)a.lineWidth=(.6+.1*u)*m,a.strokeText(l,b,e);e+=c}};a.prototype.setFontProperties=function(a,b){var c=b.font;b=c.style+" "+c.weight+" "+d.pt2px(b.size*b.pixelRatio)+"px "+c.family+", sans-serif";a.font=b;a.textAlign="left";a.textBaseline=
"top"};a.prototype.computeTextWidth=function(a,b){for(var c=0,e=0,d=this.textLines;e<d.length;e++)c=Math.max(c,a.measureText(d[e]).width);b=b.font;if("italic"===b.style||"oblique"===b.style||"string"===typeof b.weight&&("bold"===b.weight||"bolder"===b.weight)||"number"===typeof b.weight&&600<b.weight)c+=.3*a.measureText("A").width;c+=2*this.parameters.halo.size;return Math.round(c)};a.prototype.computeLineHeight=function(){return Math.round(1.275*this.parameters.size+2*this.parameters.halo.size)};
return a}();a.TextRasterizer=g;for(var h=[],b=0;360>b;b+=22.5)h.push([Math.cos(Math.PI*b/180),Math.sin(Math.PI*b/180)]);a.default=g})},"esri/symbols/support/previewSymbol2D":function(){define("require exports ../../core/Error ../../core/promiseUtils ../../core/screenUtils ./gfxUtils ./previewUtils ./renderUtils".split(" "),function(g,a,d,h,b,e,m,c){function l(a,b){var c=t.getContext("2d"),e=[];b&&(b.weight&&e.push(b.weight),b.size&&e.push(b.size+"px"),b.family&&e.push(b.family));c.font=e.join(" ");
return c.measureText(a).width}function f(a){if(0===a.length)return 0;if(2<a.length){var c=b.px2pt(1),e=parseFloat(a);switch(a.slice(-2)){case "px":return e;case "pt":return e*c;case "in":return 72*e*c;case "pc":return 12*e*c;case "mm":return e*x*c;case "cm":return e*n*c}}return parseFloat(a)}Object.defineProperty(a,"__esModule",{value:!0});var t=document.createElement("canvas"),x=7.2/2.54,n=72/2.54;a.previewSymbol2D=function(a,g){var n=g&&g.size?b.pt2px(g.size):null,k=g&&g.maxSize?b.pt2px(g.maxSize):
null,p=g&&null!=g.opacity?g.opacity:null,t=g&&null!=g.rotation?g.rotation:null,q=e.getStroke(a),y={shape:null,fill:null,stroke:q};q&&q.width&&(q.width=Math.min(q.width,80));var A=0,B=0;switch(a.type){case "simple-marker":var q=a.style,x=b.pt2px(a.size),A=Math.min(n||x||22,k||120),B=Math.min(n||x||22,k||120);switch(q){case "circle":y.shape={type:"circle",cx:.5*x,cy:.5*x,r:.5*x};break;case "cross":y.shape={type:"path",path:[{command:"M",values:[0,.5*B]},{command:"L",values:[A,.5*B]},{command:"M",values:[.5*
A,0]},{command:"L",values:[.5*A,B]}]};break;case "diamond":y.shape={type:"path",path:[{command:"M",values:[0,.5*B]},{command:"L",values:[.5*A,0]},{command:"L",values:[A,.5*B]},{command:"L",values:[.5*A,B]},{command:"Z",values:[]}]};break;case "square":y.shape={type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[A,0]},{command:"L",values:[A,B]},{command:"L",values:[0,B]},{command:"Z",values:[]}]};break;case "triangle":y.shape={type:"path",path:[{command:"M",values:[.5*A,0]},{command:"L",
values:[A,B]},{command:"L",values:[0,B]},{command:"Z",values:[]}]};break;case "x":y.shape={type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[A,B]},{command:"M",values:[A,0]},{command:"L",values:[0,B]}]};break;case "path":y.shape={type:"path",path:a.path||""}}break;case "simple-line":n=Math.min(n||q&&q.width||22,k||80);q.width=n;A=22<n?2*n:40;B=n;y.shape={type:"path",path:[{command:"M",values:[0,B]},{command:"L",values:[A,B]}]};break;case "picture-fill":case "simple-fill":A=Math.min(n||
22,k||120);B=Math.min(n||22,k||120);y.shape=m.shapes.fill[0];break;case "picture-marker":var q=b.pt2px(a.width),D=b.pt2px(a.height),x=Math.max(q,D),D=q/D,q=1>=D?Math.ceil(x*D):x,D=1>=D?x:Math.ceil(x/D),A=Math.min(n||q||22,k||120),B=Math.min(n||D||22,k||120);y.shape={type:"image",x:-Math.round(A/2),y:-Math.round(B/2),width:A,height:B,src:a.url||""};break;case "text":q=a.text||"Aa",x=a.font,n=Math.min(n||b.pt2px(x.size),k||120),D=l(q,{weight:x.weight,size:n,family:x.family}),A=(k=/[\uE600-\uE6FF]/.test(q))?
n:D,B=n,D=.25*f((x?n:0).toString()),k&&(D+=5),y.shape={type:"text",text:q,x:0,y:D,align:"middle",decoration:x&&x.decoration,rotated:a.rotated,kerning:a.kerning},y.font=x&&{size:n,style:x.style,decoration:x.decoration,weight:x.weight,family:x.family}}if(!y.shape)return h.reject(new d("symbolPreview: renderPreviewHTML2D","symbol not supported."));var I=e.getFill(a),n=a.color,k=null;I&&"pattern"===I.type&&n&&"picture-fill"!==a.type?k=e.getPatternUrlWithColor(I.src,n.toCss(!0)).then(function(a){I.src=
a;y.fill=I;return y}):(y.fill=I,k=h.resolve(y));return k.then(function(a){return c.renderSymbol([[a]],[A,B],{node:g&&g.node,scale:!0,opacity:p,rotation:t})})}})},"esri/symbols/support/gfxUtils":function(){define("require exports ../../core/tsSupport/assignHelper ../../Color ../../request ../../core/ItemCache ../../core/promiseUtils ../../core/screenUtils".split(" "),function(g,a,d,h,b,e,m,c){function l(a){if(!a)return null;var b;switch(a.type){case "simple-fill":case "picture-fill":case "simple-marker":b=
l(a.outline);break;case "simple-line":var e=c.pt2px(a.width);"none"!==a.style&&0!==e&&(b={color:a.color,style:p(a.style),width:e,cap:a.cap,join:"miter"===a.join?c.pt2px(a.miterLimit):a.join});break;default:b=null}return b}Object.defineProperty(a,"__esModule",{value:!0});var f=g.toUrl("../../symbols/patterns/"),t={left:"start",center:"middle",right:"end",justify:"start"},x={top:"text-before-edge",middle:"central",baseline:"alphabetic",bottom:"text-after-edge"},n=new e(1E3);a.getSVGAlign=function(a){return a=
(a=a.horizontalAlignment)&&t[a.toLowerCase()]||"middle"};a.getSVGBaseline=function(a){return(a=a.verticalAlignment)&&x[a.toLowerCase()]||"alphabetic"};a.getSVGBaselineShift=function(a){return"bottom"===a.verticalAlignment?"super":null};a.getFill=function(a){var b=a.style,e=null;if(a)switch(a.type){case "simple-marker":"cross"!==b&&"x"!==b&&(e=a.color);break;case "simple-fill":"solid"===b?e=a.color:"none"!==b&&(e={type:"pattern",x:0,y:0,src:f+b+".png",width:8,height:8});break;case "picture-fill":e=
{type:"pattern",src:a.url,width:c.pt2px(a.width)*a.xscale,height:c.pt2px(a.height)*a.yscale,x:c.pt2px(a.xoffset),y:c.pt2px(a.yoffset)};break;case "text":e=a.color}return e};a.getPatternUrlWithColor=function(a,c){var e=a+"-"+c;return void 0!==n.get(e)?m.resolve(n.get(e)):b(a,{responseType:"image"}).then(function(a){a=a.data;var b=a.naturalWidth,d=a.naturalHeight,f=document.createElement("canvas");f.width=b;f.height=d;var g=f.getContext("2d");g.fillStyle=c;g.fillRect(0,0,b,d);g.globalCompositeOperation=
"destination-in";g.drawImage(a,0,0);a=f.toDataURL();n.put(e,a);return a})};a.getStroke=l;var p=function(){var a={};return function(b){if(a[b])return a[b];var c=b.replace(/-/g,"");return a[b]=c}}();a.defaultThematicColor=new h([128,128,128])})},"esri/core/ItemCache":function(){define(["require","exports","./MemCache"],function(g,a,d){return function(){function a(a,e){this._storage=new d.MemCacheStorage;this._storage.maxSize=a;e&&this._storage.registerRemoveFunc("",e)}a.prototype.put=function(a,e){this._storage.put(a,
e,1,1)};a.prototype.pop=function(a){return this._storage.pop(a)};a.prototype.get=function(a){return this._storage.get(a)};a.prototype.clear=function(){this._storage.clearAll()};a.prototype.destroy=function(){this._storage.clearAll()};return a}()})},"esri/symbols/support/previewUtils":function(){define(["require","exports"],function(g,a){Object.defineProperty(a,"__esModule",{value:!0});a.shapes={fill:[{type:"path",path:"M -10,-10 L 10,0 L 10,10 L -10,10 L -10,-10 Z"}],pathSymbol3DLayer:[{type:"path",
path:"M 3,12 L 12,0 L 11,-2 L -4,5 L -1,5 L 1,7 L 3,10 L 3,12 Z"},{type:"circle",cx:-2,cy:10,r:5}],extrudeSymbol3DLayer:[{type:"path",path:"M -7,-5 L -2,0 L -2,7 L -7,3 L -7,-5 Z"},{type:"path",path:"M -2,0 L -2,7 L 10,-3 L 10,-10 L -2,0 Z"},{type:"path",path:"M -7,-5 L -2,0 L 10,-10 L -2,-10 L -7,-5 Z"}],cone:[{type:"path",path:"M 0,-10 L -8,5 L -4,6.5 L 0,7 L 4,6.5 L 8,5 Z"}],tallCone:[{type:"path",path:"M 0,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 0,-9 Z"}],invertedCone:[{type:"path",path:"M 0,7 L -8,-8 L 8,-8 Z"},
{type:"path",path:"M -8,-8 L -4,-9.5 L 0,-10 L 4,-9.5 L 8,-8 L 4,-6.5 L 0,-6 L -4,-6.5 Z"}],cube:[{type:"path",path:"M -10,-7 L 0,-12 L 10,-7 L 0,-2 L -10,-7 Z"},{type:"path",path:"M -10,-7 L 0,-2 L 0,12 L -10,7 L -10,-7 Z"},{type:"path",path:"M 0,-2 L 10,-7 L 10,7 L 0,12 L 0,-2 Z"}],tallCube:[{type:"path",path:"M -3.5,-8.5 L 0,-9.5 L 3.5,-8.5 L 0,-7.5 L -3.5,-8.5 Z"},{type:"path",path:"M -3.5,-8.5 L 0,-7.5 L 0,9 L -3.5,8 L -3.5,-8.5 Z"},{type:"path",path:"M 0,-7.5 L 3.5,-8.5 L 3.5,8 L 0,9 L 0,-7.5 Z"}],
cylinder:[{type:"path",path:"M -8,-9 L -8,7 L -4,8.5 L 0,9 L 4,8.5 L 8,7 L 8,-9 Z"},{type:"ellipse",cx:0,cy:-9,rx:8,ry:2}],tallCylinder:[{type:"path",path:"M -3.5,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 3.5,-9 Z"},{type:"ellipse",cx:0,cy:-9,rx:3.5,ry:1}],diamond:[{type:"path",path:"M 0,-10 L 10,-1 L -1,1 L 0,-10 Z"},{type:"path",path:"M 0,-10 L -1,1 L -8,-1 L 0,-10 Z"},{type:"path",path:"M -1,1 L 0,10 L -8,-1 L -1,1 Z"},{type:"path",path:"M -1,0 L 0,10 L 10,-1 L -1,1 Z"}],tetrahedron:[{type:"path",
path:"M 0,-10 L 10,7 L 0,0 L 0,-10 Z"},{type:"path",path:"M 0,-10 L 0,0 L -8,7 L 0,-10 Z"},{type:"path",path:"M 10,7 L 0,0 L -8,7 L 10,7 Z"}]};a.getPathSymbolShapes=function(a){var d=22,b=22;1>a?d*=.75:1<a&&(b*=1.25);return[{type:"path",path:[{command:"M",values:[22,0]},{command:"L",values:[19.25,0]},{command:"L",values:[0,b-11]},{command:"L",values:[d-11,b-11]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[22,0]},{command:"L",values:[22,2.75]},{command:"L",values:[d-11,22]},{command:"L",
values:[d-11,b-11]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[d-11,b-11]},{command:"L",values:[0,b-11]},{command:"L",values:[0,22]},{command:"L",values:[d-11,22]},{command:"Z",values:[]}]}]};a.getExtrudeSymbolShapes=function(a){a*=.5;return[{type:"path",path:[{command:"M",values:[0,.7*11]},{command:"L",values:[6.6,22*.7]},{command:"L",values:[6.6,22*.7+a]},{command:"L",values:[0,22*.7+a-.7*11]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[6.6,22*.7]},{command:"L",
values:[6.6,22*.7+a]},{command:"L",values:[22,a]},{command:"L",values:[22,0]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[6.6,0]},{command:"L",values:[22,0]},{command:"L",values:[6.6,22*.7]},{command:"L",values:[0,.7*11]},{command:"Z",values:[]}]}]};a.getWaterSymbolShapes=function(){return[{type:"path",path:"M80,80.2v-27c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4C8.3,59.3,5.7,58,3.9,56c-1.1-1.2-2.4-2.1-3.9-2.8v27"},
{type:"path",path:"M11,59.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8v-24c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-1.1-1.2-2.4-2.1-3.9-2.8v24c1.5,0.7,2.8,1.6,3.9,2.8C5.7,58,8.3,59.3,11,59.4z"},
{type:"path",path:"M11,35.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8V3.6c-1.5,0.7-2.8,1.6-3.9,2.8c-2.2,2.1-4.6,3.4-7.1,3.4s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6S42.5,9.9,40,9.9s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.5,0-5-1.3-7.1-3.4C2.8,5.3,1.4,4.3,0,3.6v25.6c1.5,0.7,2.8,1.6,3.9,2.8C5.7,34.1,8.3,35.3,11,35.4z"}]};
a.getCubeShapes=function(a,g){var b=g?20:a,e=g?4:6,e=b=22>=b?b-.5*e:b-e;g=g?.35*b:.5*b;return[{type:"path",path:[{command:"M",values:[.5*e,0]},{command:"L",values:[e,.5*g]},{command:"L",values:[.5*e,g]},{command:"L",values:[0,.5*g]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,.5*g]},{command:"L",values:[.5*e,g]},{command:"L",values:[.5*e,a]},{command:"L",values:[0,a-.5*g]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.5*e,g]},{command:"L",values:[.5*e,
a]},{command:"L",values:[e,a-.5*g]},{command:"L",values:[e,.5*g]},{command:"Z",values:[]}]}]};a.getCylinderShapes=function(a,g){var b=g?20:a;g=g?4:6;b=22>=b?b-.5*g:b-g;g=.5*b;var e=.15*b;a-=e;return[{type:"ellipse",cx:.5*b,cy:a,rx:g,ry:e},{type:"path",path:[{command:"M",values:[0,e]},{command:"L",values:[0,a]},{command:"L",values:[b,a]},{command:"L",values:[b,e]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*b,cy:e,rx:g,ry:e}]};a.getConeShapes=function(a,g){var b=g?20:a;g=g?4:6;b=22>=b?b-.5*g:b-
g;g=.15*b;var e=b;a-=g;return[{type:"ellipse",cx:.5*b,cy:a,rx:.5*b,ry:g},{type:"path",path:[{command:"M",values:[.5*e,0]},{command:"L",values:[e,a]},{command:"L",values:[0,a]},{command:"Z",values:[]}]}]};a.getInvertedConeShapes=function(a){var d=a,d=22>d?d-3:d-6,b=.15*d,e=d;return[{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[e,0]},{command:"L",values:[.5*e,a-b]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*d,cy:0,rx:.5*d,ry:b}]};a.getDiamondShapes=function(a){var d=a,d=22>
d?d-2:d-4,b=Math.floor(a/10)-1||1;return[{type:"path",path:[{command:"M",values:[.45*d,0]},{command:"L",values:[d,.5*a-b]},{command:"L",values:[.45*d-b,.5*a+b]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*d,0]},{command:"L",values:[.45*d-b,.5*a+b]},{command:"L",values:[0,.5*a-b]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,.5*a-b]},{command:"L",values:[.45*d-b,.5*a+b]},{command:"L",values:[.45*d,a]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",
values:[.45*d,a]},{command:"L",values:[d,.5*a-b]},{command:"L",values:[.45*d-b,.5*a+b]},{command:"Z",values:[]}]}]};a.getTetrahedronShapes=function(a){var d=a,d=22>d?d-1:d-2;return[{type:"path",path:[{command:"M",values:[.45*a,0]},{command:"L",values:[a,d]},{command:"L",values:[.45*a,.6*d]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*a,0]},{command:"L",values:[.45*a,.6*d]},{command:"L",values:[0,d]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,d]},
{command:"L",values:[.45*a,.6*d]},{command:"L",values:[a,d]},{command:"Z",values:[]}]}]}})},"esri/symbols/support/renderUtils":function(){define("require exports ../../kernel ../../request ../../core/colorUtils ../../core/Error ../../core/has ../../core/promiseUtils ../../libs/maquette/index ./svgUtils".split(" "),function(g,a,d,h,b,e,m,c,l,f){function t(a,b,d){return a?h(a,{responseType:"image"}).then(function(a){a=a.data;var c=a.width,e=a.height,f=c/e,g=b;d&&(g=Math.min(g,Math.max(c,e)));return{image:a,
width:1>=f?Math.ceil(g*f):g,height:1>=f?g:Math.ceil(g/f)}}):c.reject(new e("renderUtils: imageDataSize","href not provided."))}Object.defineProperty(a,"__esModule",{value:!0});var x=l.createProjector();a.renderSymbol=function(a,b,c){var e=Math.ceil(b[0]);b=Math.ceil(b[1]);if(!a.some(function(a){return!!a.length}))return null;var d=c&&c.node||document.createElement("div");null!=c.opacity&&(d.style.opacity=c.opacity.toString());x.append(d,f.renderSVG.bind(null,a,e,b,c));return d};a.tintImageWithColor=
function(a,c,e,f,g){return t(a,c,g).then(function(g){var h=g.width?g.width:c,k=g.height?g.height:c,l;if(l=g.image)l=e&&"ignore"!==f?"multiply"===f&&255===e.r&&255===e.g&&255===e.b&&1===e.a?!1:!0:!1;if(l){var n=g.image.width,p=g.image.height;(m("edge")||m("ie"))&&/\.svg$/i.test(a)&&(--n,--p);var r,t;r=Math.ceil(h);t=Math.ceil(k);l=document.createElement("canvas");l.width=r;l.height=t;l.style.width=r+"px";l.style.height=t+"px";l=l.getContext("2d");l.clearRect(0,0,r,t);l.drawImage(g.image,0,0,n,p,0,
0,h,k);g=l.getImageData(0,0,h,k);n=[e.r/255,e.g/255,e.b/255,e.a];p=b.toHSV(e);for(r=0;r<g.data.length;r+=4){t=g.data;var u=r,y=n,x=p;switch(f){case "multiply":t[u+0]*=y[0];t[u+1]*=y[1];t[u+2]*=y[2];t[u+3]*=y[3];break;default:var G=b.toHSV({r:t[u+0],g:t[u+1],b:t[u+2]});G.h=x.h;G.s=x.s;G.v=G.v/100*x.v;x=b.toRGB(G);t[u+0]=x.r;t[u+1]=x.g;t[u+2]=x.b;t[u+3]*=y[3]}}l.putImageData(g,0,0);a=l.canvas.toDataURL("image/png")}else(l=d.id&&d.id.findCredential(a))&&l.token&&(g=-1===a.indexOf("?")?"?":"\x26",a=""+
a+g+"token\x3d"+l.token);return{url:a,width:h,height:k}}).catch(function(){return{url:a,width:c,height:c}})}})},"esri/core/colorUtils":function(){define(["require","exports"],function(g,a){function d(a,b){var c=[],e,d;if(a[0].length!==b.length)throw"dimensions do not match";var f=a.length,g=a[0].length,h=0;for(e=0;e<f;e++){for(d=h=0;d<g;d++)h+=a[e][d]*b[d];c.push(h)}return c}function h(a){a=[a.r/255,a.g/255,a.b/255].map(function(a){return.04045>=a?a/12.92:Math.pow((a+.055)/1.055,2.4)});a=d(l,a);return{x:100*
a[0],y:100*a[1],z:100*a[2]}}function b(a){a=d(f,[a.x/100,a.y/100,a.z/100]).map(function(a){return Math.min(1,Math.max(.0031308>=a?12.92*a:1.055*Math.pow(a,1/2.4)-.055,0))});return{r:Math.round(255*a[0]),g:Math.round(255*a[1]),b:Math.round(255*a[2])}}function e(a){a=[a.x/95.047,a.y/100,a.z/108.883].map(function(a){return a>Math.pow(6/29,3)?Math.pow(a,1/3):1/3*Math.pow(29/6,2)*a+4/29});return{l:116*a[1]-16,a:500*(a[0]-a[1]),b:200*(a[1]-a[2])}}function m(a){var b=a.l;a=[(b+16)/116+a.a/500,(b+16)/116,
(b+16)/116-a.b/200].map(function(a){return a>6/29?Math.pow(a,3):3*Math.pow(6/29,2)*(a-4/29)});return{x:95.047*a[0],y:100*a[1],z:108.883*a[2]}}function c(a){if("r"in a&&"g"in a&&"b"in a)return a;if("l"in a&&"c"in a&&"h"in a){var c=a.c,e=a.h;return b(m({l:a.l,a:c*Math.cos(e),b:c*Math.sin(e)}))}if("l"in a&&"a"in a&&"b"in a)return b(m(a));if("x"in a&&"y"in a&&"z"in a)return b(a);if("h"in a&&"s"in a&&"v"in a){e=(a.h+360)%360/60;c=a.v/100*255;a=a.s/100*c;var d=a*(1-Math.abs(e%2-1));switch(Math.floor(e)){case 0:e=
{r:a,g:d,b:0};break;case 1:e={r:d,g:a,b:0};break;case 2:e={r:0,g:a,b:d};break;case 3:e={r:0,g:d,b:a};break;case 4:e={r:d,g:0,b:a};break;case 5:case 6:e={r:a,g:0,b:d};break;default:e={r:0,g:0,b:0}}e.r=Math.round(e.r+c-a);e.g=Math.round(e.g+c-a);e.b=Math.round(e.b+c-a);return e}}Object.defineProperty(a,"__esModule",{value:!0});var l=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],f=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]];a.toRGB=c;a.toHSV=function(a){if("h"in
a&&"s"in a&&"v"in a)return a;var b=c(a);a=b.r;var e=b.g,b=b.b,d=Math.max(a,e,b),f=d-Math.min(a,e,b),g;0===f?g=0:d===a?g=(e-b)/f%6:d===e?g=(b-a)/f+2:d===b&&(g=(a-e)/f+4);0>g&&(g+=6);return{h:60*g,s:100*(0===f?0:f/d),v:100/255*d}};a.toLAB=function(a){return"l"in a&&"a"in a&&"b"in a?a:e(h(c(a)))};a.toLCH=function(a){if(!("l"in a&&"c"in a&&"h"in a)){var b=e(h(c(a)));a=b.l;var d=b.a,f=b.b,b=Math.sqrt(d*d+f*f),d=Math.atan2(f,d),d=0<d?d:d+2*Math.PI;a={l:a,c:b,h:d}}return a};a.toXYZ=function(a){return"x"in
a&&"y"in a&&"z"in a?a:h(c(a))}})},"esri/symbols/support/svgUtils":function(){define("require exports ../../Color ../../core/has ../../core/libs/gl-matrix-2/mat2df32 ../../core/libs/gl-matrix-2/math/mat2d ../../widgets/support/widget".split(" "),function(g,a,d,h,b,e,m){function c(a){return a.map(function(a){return a.command+" "+a.values.join(" ")}).join(" ").trim()}function l(a,b,e,d){if(a){if("circle"===a.type)return m.tsx("circle",{fill:b,"fill-rule":"evenodd",stroke:e.color,"stroke-width":e.width,
"stroke-linecap":e.cap,"stroke-linejoin":e.join,"stroke-dasharray":e.dashArray,"stroke-miterlimit":"4",cx:a.cx,cy:a.cy,r:a.r});if("ellipse"===a.type)return m.tsx("ellipse",{fill:b,"fill-rule":"evenodd",stroke:e.color,"stroke-width":e.width,"stroke-linecap":e.cap,"stroke-linejoin":e.join,"stroke-dasharray":e.dashArray,"stroke-miterlimit":"4",cx:a.cx,cy:a.cy,rx:a.rx,ry:a.ry});if("rect"===a.type)return m.tsx("rect",{fill:b,"fill-rule":"evenodd",stroke:e.color,"stroke-width":e.width,"stroke-linecap":e.cap,
"stroke-linejoin":e.join,"stroke-dasharray":e.dashArray,"stroke-miterlimit":"4",x:a.x,y:a.y,width:a.width,height:a.height});if("image"===a.type)return m.tsx("image",{href:a.src,x:a.x,y:a.y,width:a.width,height:a.height,preserveAspectRatio:"none"});if("path"===a.type)return a="string"!==typeof a.path?c(a.path):a.path,m.tsx("path",{fill:b,"fill-rule":"evenodd",stroke:e.color,"stroke-width":e.width,"stroke-linecap":e.cap,"stroke-linejoin":e.join,"stroke-dasharray":e.dashArray,"stroke-miterlimit":"4",
d:a});if("text"===a.type)return m.tsx("text",{fill:b,"fill-rule":"evenodd",stroke:e.color,"stroke-width":e.width,"stroke-linecap":e.cap,"stroke-linejoin":e.join,"stroke-dasharray":e.dashArray,"stroke-miterlimit":"4","text-anchor":d.align,"text-decoration":d.decoration,kerning:d.kerning,rotate:d.rotate,"text-rendering":D,"font-style":d.font.style,"font-variant":d.font.variant,"font-weight":d.font.weight,"font-size":d.font.size,"font-family":d.font.family,x:a.x,y:a.y},a.text)}return null}function f(a){var b=
{fill:"none",pattern:null,linearGradient:null};if(a)if("type"in a&&"pattern"===a.type){var c="patternId-"+ ++B;b.fill="url(#"+c+")";b.pattern={id:c,x:a.x,y:a.y,width:a.width,height:a.height,image:{x:0,y:0,width:a.width,height:a.height,href:a.src}}}else"type"in a&&"linear"===a.type?(c="linearGradientId-"+ ++C,b.fill="url(#"+c+")",b.linearGradient={id:c,x1:a.x1,y1:a.y1,x2:a.x2,y2:a.y2,stops:a.colors.map(function(a){return{offset:a.offset,color:a.color&&(new d(a.color)).toString()}})}):a&&(a=new d(a),
b.fill=a.toString());return b}function t(a){var b={color:"none",width:1,cap:"butt",join:"4",dashArray:"none"};if(a&&(null!=a.width&&(b.width=a.width),a.cap&&(b.cap=a.cap),a.join&&(b.join=a.join.toString()),a.color&&(b.color=(new d(a.color)).toString()),a.style)){var c=null;a.style in M&&(c=M[a.style]);if(Array.isArray(c)){for(var c=c.slice(0),e=0;e<c.length;++e)c[e]*=a.width;if("butt"!==a.cap){for(e=0;e<c.length;e+=2)c[e]-=a.width,1>c[e]&&(c[e]=1);for(e=1;e<c.length;e+=2)c[e]+=a.width}c=c.join(",")}b.dashArray=
c}return b}function x(a,b){var c={align:null,decoration:null,kerning:null,rotate:null,font:{style:null,variant:null,weight:null,size:null,family:null}};a&&(c.align=a.align,c.decoration=a.decoration,c.kerning=a.kerning?"auto":"0",c.rotate=a.rotated?"90":"0",c.font.style=b.style||"normal",c.font.variant=b.variant||"normal",c.font.weight=b.weight||"normal",c.font.size=b.size&&b.size.toString()||"10pt",c.font.family=b.family||"serif");return c}function n(a){var b=a.pattern;a=a.linearGradient;return b?
m.tsx("pattern",{id:b.id,patternUnits:"userSpaceOnUse",x:b.x,y:b.y,width:b.width,height:b.height},m.tsx("image",{x:b.image.x,y:b.image.y,width:b.image.width,height:b.image.height,href:b.image.href})):a?(b=a.stops.map(function(a,b){return m.tsx("stop",{key:b+"-stop",offset:a.offset,"stop-color":a.color})}),m.tsx("linearGradient",{id:a.id,gradientUnits:"userSpaceOnUse",x1:a.x1,y1:a.y1,x2:a.x2,y2:a.y2},b)):null}function p(a,b,c){return e.translate(a,e.identity(a),[b,c])}function y(a,b,c,d,f){e.scale(a,
e.identity(a),[b,c]);a[4]=a[4]*b-d*b+d;a[5]=a[5]*c-f*c+f;return a}function u(a,b,c,d){var f=b%360*Math.PI/180;e.rotate(a,e.identity(a),f);b=Math.cos(f);var f=Math.sin(f),g=a[4],h=a[5];a[4]=g*b-h*f+d*f-c*b+c;a[5]=h*b+g*f-c*f-d*b+d;return a}function k(a,b){H&&"left"in H?(H.left>a&&(H.left=a),H.right<a&&(H.right=a),H.top>b&&(H.top=b),H.bottom<b&&(H.bottom=b)):H={left:a,bottom:b,right:a,top:b}}function r(a){var b=a.args,c=b.length;switch(a.action){case "M":case "L":case "C":case "S":case "Q":case "T":for(a=
0;a<c;a+=2)k(b[a],b[a+1]);G.x=b[c-2];G.y=b[c-1];break;case "H":for(a=0;a<c;++a)k(b[a],G.y);G.x=b[c-1];break;case "V":for(a=0;a<c;++a)k(G.x,b[a]);G.y=b[c-1];break;case "m":a=0;"x"in G||(k(G.x=b[0],G.y=b[1]),a=2);for(;a<c;a+=2)k(G.x+=b[a],G.y+=b[a+1]);break;case "l":case "t":for(a=0;a<c;a+=2)k(G.x+=b[a],G.y+=b[a+1]);break;case "h":for(a=0;a<c;++a)k(G.x+=b[a],G.y);break;case "v":for(a=0;a<c;++a)k(G.x,G.y+=b[a]);break;case "c":for(a=0;a<c;a+=6)k(G.x+b[a],G.y+b[a+1]),k(G.x+b[a+2],G.y+b[a+3]),k(G.x+=b[a+
4],G.y+=b[a+5]);break;case "s":case "q":for(a=0;a<c;a+=4)k(G.x+b[a],G.y+b[a+1]),k(G.x+=b[a+2],G.y+=b[a+3]);break;case "A":for(a=0;a<c;a+=7)k(b[a+5],b[a+6]);G.x=b[c-2];G.y=b[c-1];break;case "a":for(a=0;a<c;a+=7)k(G.x+=b[a+5],G.y+=b[a+6])}}function z(a,b,c){var e=I[a.toLowerCase()];"number"===typeof e&&(e?b.length>=e&&(a={action:a,args:b.slice(0,b.length-b.length%e)},c.push(a),r(a)):(a={action:a,args:[]},c.push(a),r(a)))}function q(a){var b={x:0,y:0,width:0,height:0};if("circle"===a.type)b.x=a.cx-a.r,
b.y=a.cy-a.r,b.width=2*a.r,b.height=2*a.r;else if("ellipse"===a.type)b.x=a.cx-a.rx,b.y=a.cy-a.ry,b.width=2*a.rx,b.height=2*a.ry;else if("image"===a.type||"rect"===a.type)b.x=a.x,b.y=a.y,b.width=a.width,b.height=a.height;else if("path"===a.type){a=("string"!==typeof a.path?c(a.path):a.path).match(L);var e=[];H={};G={};if(a){for(var d="",f=[],g=a.length,h=0;h<g;++h){var k=a[h],l=parseFloat(k);isNaN(l)?(d&&z(d,f,e),f=[],d=k):f.push(l)}z(d,f,e);a={x:0,y:0,width:0,height:0};H&&"left"in H&&(a.x=H.left,
a.y=H.top,a.width=H.right-H.left,a.height=H.bottom-H.top)}else a=null;b.x=a.x;b.y=a.y;b.width=a.width;b.height=a.height}return b}function E(a){for(var b={x:0,y:0,width:0,height:0},c=null,e=Number.NEGATIVE_INFINITY,d=Number.NEGATIVE_INFINITY,f=0;f<a.length;f++){var g=a[f];c?(c.x=Math.min(c.x,g.x),c.y=Math.min(c.y,g.y),e=Math.max(e,g.x+g.width),d=Math.max(d,g.y+g.height)):(c=b,c.x=g.x,c.y=g.y,e=g.x+g.width,d=g.y+g.height)}c&&(c.width=e-c.x,c.height=d-c.y);return c}function A(a,c,d,f,g,h){var k=c/2,
l=d/2,m=a.width+f,n=a.height+f,q=b.mat2df32.create(),r=b.mat2df32.create(),t=!1;if(g&&0!==m&&0!==n){g=m/n;var t=c>d?c:d,B=1,z=1;isNaN(t)||(1<g?(B=t/m,z=t/g/n):(z=t/n,B=t*g/m));e.multiply(r,r,y(q,B,z,k,l));t=!0}g=a.x+(m-f)/2;a=a.y+(n-f)/2;e.multiply(r,r,p(q,k-g,l-a));!t&&(m>c||n>d)&&(k=m/c>n/d,c=(k?c:d)/(k?m:n),e.multiply(r,r,y(q,c,c,g,a)));h&&e.multiply(r,r,u(q,h,g,a));return"matrix("+r[0]+","+r[1]+","+r[2]+","+r[3]+","+r[4]+","+r[5]+")"}Object.defineProperty(a,"__esModule",{value:!0});var B=0,C=
0,D=h("chrome")?"auto":"optimizeLegibility",I={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},L=/([A-DF-Za-df-z])|([-+]?\d*[.]?\d+(?:[eE][-+]?\d+)?)/g,H={},G={},M={solid:"none",shortdash:[4,1],shortdot:[1,1],shortdashdot:[4,1,1,1],shortdashdotdot:[4,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]};a.renderShape=l;a.generateFillAttributes=f;a.generateStrokeAttributes=t;a.generateTextAttributes=x;a.renderDef=n;a.getBoundingBox=q;a.computeBBox=
E;a.getTransformMatrix=A;a.renderSVG=function(a,b,c,e){for(var d=[],g=[],h=0;h<a.length;h++){for(var k=[],p=[],r=0,u=0,B=a[h];u<B.length;u++){var y=B[u],z=y.shape,C=y.fill,D=y.stroke,y=y.font,r=r+(D&&D.width||0),C=f(C),D=t(D),y="text"===z.type?x(z,y):null;d.push(n(C));k.push(l(z,C.fill,D,y));p.push(q(z))}p=A(E(p),b,c,r,e&&e.scale,e&&e.rotation);g.push(m.tsx("g",{transform:p},k))}return m.tsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:b,height:c},m.tsx("defs",null,d),g)}})},"esri/core/libs/gl-matrix-2/mat2df32":function(){define(["require",
"exports","./factories/mat2df32"],function(g,a,d){Object.defineProperty(a,"__esModule",{value:!0});a.mat2df32=d})},"esri/core/libs/gl-matrix-2/factories/mat2df32":function(){define(["require","exports"],function(g,a){Object.defineProperty(a,"__esModule",{value:!0});a.create=function(){var a=new Float32Array(6);a[0]=1;a[3]=1;return a};a.clone=function(a){var d=new Float32Array(6);d[0]=a[0];d[1]=a[1];d[2]=a[2];d[3]=a[3];d[4]=a[4];d[5]=a[5];return d};a.fromValues=function(a,g,b,e,m,c){var d=new Float32Array(6);
d[0]=a;d[1]=g;d[2]=b;d[3]=e;d[4]=m;d[5]=c;return d};a.createView=function(a,g){return new Float32Array(a,g,6)}})},"esri/core/libs/gl-matrix-2/math/mat2d":function(){define(["require","exports","./common"],function(g,a,d){function h(a,b,c){var e=b[0],d=b[1],g=b[2],h=b[3],m=b[4];b=b[5];var p=c[0],y=c[1],u=c[2],k=c[3],r=c[4];c=c[5];a[0]=e*p+g*y;a[1]=d*p+h*y;a[2]=e*u+g*k;a[3]=d*u+h*k;a[4]=e*r+g*c+m;a[5]=d*r+h*c+b;return a}function b(a,b,c){a[0]=b[0]-c[0];a[1]=b[1]-c[1];a[2]=b[2]-c[2];a[3]=b[3]-c[3];a[4]=
b[4]-c[4];a[5]=b[5]-c[5];return a}Object.defineProperty(a,"__esModule",{value:!0});a.copy=function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];return a};a.identity=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=1;a[4]=0;a[5]=0;return a};a.set=function(a,b,c,d,f,g,h){a[0]=b;a[1]=c;a[2]=d;a[3]=f;a[4]=g;a[5]=h;return a};a.invert=function(a,b){var c=b[0],e=b[1],d=b[2],g=b[3],h=b[4];b=b[5];var m=c*g-e*d;if(!m)return null;m=1/m;a[0]=g*m;a[1]=-e*m;a[2]=-d*m;a[3]=c*m;a[4]=(d*b-g*h)*m;a[5]=(e*
h-c*b)*m;return a};a.determinant=function(a){return a[0]*a[3]-a[1]*a[2]};a.multiply=h;a.rotate=function(a,b,c){var e=b[0],d=b[1],g=b[2],h=b[3],m=b[4];b=b[5];var p=Math.sin(c);c=Math.cos(c);a[0]=e*c+g*p;a[1]=d*c+h*p;a[2]=e*-p+g*c;a[3]=d*-p+h*c;a[4]=m;a[5]=b;return a};a.scale=function(a,b,c){var e=b[1],d=b[2],g=b[3],h=b[4],m=b[5],p=c[0];c=c[1];a[0]=b[0]*p;a[1]=e*p;a[2]=d*c;a[3]=g*c;a[4]=h;a[5]=m;return a};a.translate=function(a,b,c){var e=b[0],d=b[1],g=b[2],h=b[3],m=b[4];b=b[5];var p=c[0];c=c[1];a[0]=
e;a[1]=d;a[2]=g;a[3]=h;a[4]=e*p+g*c+m;a[5]=d*p+h*c+b;return a};a.fromRotation=function(a,b){var c=Math.sin(b);b=Math.cos(b);a[0]=b;a[1]=c;a[2]=-c;a[3]=b;a[4]=0;a[5]=0;return a};a.fromScaling=function(a,b){a[0]=b[0];a[1]=0;a[2]=0;a[3]=b[1];a[4]=0;a[5]=0;return a};a.fromTranslation=function(a,b){a[0]=1;a[1]=0;a[2]=0;a[3]=1;a[4]=b[0];a[5]=b[1];return a};a.str=function(a){return"mat2d("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+")"};a.frob=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],
2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+1)};a.add=function(a,b,c){a[0]=b[0]+c[0];a[1]=b[1]+c[1];a[2]=b[2]+c[2];a[3]=b[3]+c[3];a[4]=b[4]+c[4];a[5]=b[5]+c[5];return a};a.subtract=b;a.multiplyScalar=function(a,b,c){a[0]=b[0]*c;a[1]=b[1]*c;a[2]=b[2]*c;a[3]=b[3]*c;a[4]=b[4]*c;a[5]=b[5]*c;return a};a.multiplyScalarAndAdd=function(a,b,c,d){a[0]=b[0]+c[0]*d;a[1]=b[1]+c[1]*d;a[2]=b[2]+c[2]*d;a[3]=b[3]+c[3]*d;a[4]=b[4]+c[4]*d;a[5]=b[5]+c[5]*d;return a};a.exactEquals=function(a,
b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]&&a[3]===b[3]&&a[4]===b[4]&&a[5]===b[5]};a.equals=function(a,b){var c=a[0],e=a[1],f=a[2],g=a[3],h=a[4];a=a[5];var m=b[0],p=b[1],y=b[2],u=b[3],k=b[4];b=b[5];return Math.abs(c-m)<=d.EPSILON*Math.max(1,Math.abs(c),Math.abs(m))&&Math.abs(e-p)<=d.EPSILON*Math.max(1,Math.abs(e),Math.abs(p))&&Math.abs(f-y)<=d.EPSILON*Math.max(1,Math.abs(f),Math.abs(y))&&Math.abs(g-u)<=d.EPSILON*Math.max(1,Math.abs(g),Math.abs(u))&&Math.abs(h-k)<=d.EPSILON*Math.max(1,Math.abs(h),
Math.abs(k))&&Math.abs(a-b)<=d.EPSILON*Math.max(1,Math.abs(a),Math.abs(b))};a.mul=h;a.sub=b})},"esri/symbols/support/previewSymbol3D":function(){define("require exports ../../core/tsSupport/assignHelper ../../core/colorUtils ../../core/compilerUtils ../../core/Error ../../core/Logger ../../core/maybe ../../core/promiseUtils ../../core/screenUtils ./gfxUtils ./IconSymbol3DLayerResource ./ObjectSymbol3DLayerResource ./previewUtils ./renderUtils ./styleUtils ./utils".split(" "),function(g,a,d,h,b,e,
m,c,l,f,t,x,n,p,y,u,k){function r(a){var b=a.outline,e=c.isSome(a.material)?a.material.color:null,e=c.isSome(e)?e.toRgba().toString():null;if(c.isNone(b))return"fill"===a.type&&"255,255,255,1"===e?{color:"#bdc3c7",width:.75}:null;a=f.pt2px(b.size)||0;return{color:"rgba("+(c.isSome(b.color)?b.color.toRgba():"255,255,255,1")+")",width:Math.min(a,80)}}function z(a,b){var c=b&&b.resource,c=c&&c.href;return a.thumbnail&&a.thumbnail.url?l.resolve(a.thumbnail.url):c&&"object"!==b.type?l.resolve(k.getIconHref(a,
b)):a.styleOrigin&&(a.styleOrigin.styleName||a.styleOrigin.styleUrl)?u.resolveWebStyleSymbol(a.styleOrigin,{portal:a.styleOrigin.portal},"webRef").catch(function(a){return a}).then(function(a){return a&&a.thumbnail&&a.thumbnail.url||K}):l.resolve(K)}function q(a,b){void 0===b&&(b=1);var c=a.a;a=h.toHSV(a);b=h.toRGB({h:a.h,s:a.s/b,v:100-(100-a.v)/b});return[b.r,b.g,b.b,c]}function E(a,b){return Math.round(Math.min(Math.max(a+191.25*b,0),255))}function A(a){return"water"===a.type?c.isNone(a.color)?
null:a.color:c.isNone(a.material)||c.isNone(a.material.color)?null:a.material.color}function B(a,b){void 0===b&&(b=0);a=A(a);if(!a)return b=E(t.defaultThematicColor.r,b),[b,b,b,100];a=a.toRgba();for(var c=0;3>c;c++)a[c]=E(a[c],b);return a}function C(a){return a.outline?r(a):{color:"rgba(0, 0, 0, 1)",width:1.5}}function D(a,b){a=A(a);if(!a)return null;var c;c="rgba("+(E(a.r,b)+",");c+=E(a.g,b)+",";c+=E(a.b,b)+",";return c+a.a+");"}function I(a,b){b=D(a,b);if(!b)return{};a=Math.min(a.size?f.pt2px(a.size):
.75,80);return{color:b,width:a}}function L(a,b,c){c*=.75;return{type:"linear",x1:c?.25*c:0,y1:c?.5*c:0,x2:c||4,y2:c?.5*c:4,colors:[{color:a,offset:0},{color:b,offset:1}]}}function H(a){var b=a.depth,c=a.height;return(a=a.width)&&b&&c&&a===b&&a<c}function G(a,c,e){var d=[];if(!a)return d;switch(a.type){case "icon":var f=a.resource&&a.resource.primitive||x.defaultPrimitive;switch(f){case "circle":d.push({shape:{type:"circle",cx:0,cy:0,r:.5*c},fill:B(a,0),stroke:r(a)});break;case "square":d.push({shape:{type:"path",
path:[{command:"M",values:[0,c]},{command:"L",values:[0,0]},{command:"L",values:[c,0]},{command:"L",values:[c,c]},{command:"Z",values:[]}]},fill:B(a,0),stroke:r(a)});break;case "triangle":d.push({shape:{type:"path",path:[{command:"M",values:[0,c]},{command:"L",values:[.5*c,0]},{command:"L",values:[c,c]},{command:"Z",values:[]}]},fill:B(a,0),stroke:r(a)});break;case "cross":d.push({shape:{type:"path",path:[{command:"M",values:[.5*c,0]},{command:"L",values:[.5*c,c]},{command:"M",values:[0,.5*c]},{command:"L",
values:[c,.5*c]}]},stroke:C(a)});break;case "x":d.push({shape:{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[c,c]},{command:"M",values:[c,0]},{command:"L",values:[0,c]}]},stroke:C(a)});break;case "kite":d.push({shape:{type:"path",path:[{command:"M",values:[0,.5*c]},{command:"L",values:[.5*c,0]},{command:"L",values:[c,.5*c]},{command:"L",values:[.5*c,c]},{command:"Z",values:[]}]},fill:B(a,0),stroke:r(a)});break;default:b.neverReached(f)}break;case "object":switch(f=a.resource&&
a.resource.primitive||n.defaultPrimitive,f){case "cone":f=B(a,0);a=B(a,-.6);a=L(f,a,e?20:c);c=p.getConeShapes(c,e);d.push({shape:c[0],fill:a});d.push({shape:c[1],fill:a});break;case "inverted-cone":e=B(a,0);a=B(a,-.6);a=L(e,a,c);c=p.getInvertedConeShapes(c);d.push({shape:c[0],fill:a});d.push({shape:c[1],fill:e});break;case "cube":c=p.getCubeShapes(c,e);d.push({shape:c[0],fill:B(a,0)});d.push({shape:c[1],fill:B(a,-.3)});d.push({shape:c[2],fill:B(a,-.5)});break;case "cylinder":var f=B(a,0),g=B(a,-.6),
f=L(f,g,e?20:c);c=p.getCylinderShapes(c,e);d.push({shape:c[0],fill:f});d.push({shape:c[1],fill:f});d.push({shape:c[2],fill:B(a,0)});break;case "diamond":c=p.getDiamondShapes(c);d.push({shape:c[0],fill:B(a,-.3)});d.push({shape:c[1],fill:B(a,0)});d.push({shape:c[2],fill:B(a,-.3)});d.push({shape:c[3],fill:B(a,-.7)});break;case "sphere":e=B(a,0);a=B(a,-.6);a=L(e,a);a.x1=0;a.y1=0;a.x2=.25*c;a.y2=.25*c;d.push({shape:{type:"circle",cx:0,cy:0,r:.5*c},fill:a});break;case "tetrahedron":c=p.getTetrahedronShapes(c);
d.push({shape:c[0],fill:B(a,-.3)});d.push({shape:c[1],fill:B(a,0)});d.push({shape:c[2],fill:B(a,-.6)});break;default:b.neverReached(f)}}return d}function M(a,b){var c=b&&b.size?f.pt2px(b.size):null,e=b&&b.maxSize?f.pt2px(b.maxSize):null,d=b&&b.disableUpsampling,g=a.symbolLayers,h=[],k=0,m=0,n=g.getItemAt(g.length-1),p;n&&"icon"===n.type&&(p=n.size&&f.pt2px(n.size));g.forEach(function(g){if("icon"===g.type||"object"===g.type){var n="icon"===g.type?g.size&&f.pt2px(g.size):0,q=c||n?Math.ceil(Math.min(c||
n,e||120)):22;if(g&&g.resource&&g.resource.href){var r=z(a,g).then(function(a){var b=g.get("material.color"),c;c="icon"===g.type?"multiply":"tint";return y.tintImageWithColor(a,q,b,c,d)}).then(function(a){var b=a.width,c=a.height;k=Math.max(k,b);m=Math.max(m,c);return[{shape:{type:"image",x:0,y:0,width:b,height:c,src:a.url},fill:null,stroke:null}]});h.unshift(r)}else r=q,"icon"===g.type&&p&&c&&(r=n/p*q),n=b&&"tall"===b.symbolConfig||("object"===g.type?H(g):!1),k=Math.max(k,n?20:r),m=Math.max(m,r),
h.unshift(l.resolve(G(g,r,n)))}});return l.eachAlways(h).then(function(a){var c=[];a.forEach(function(a){a.value?c.push(a.value):a.error&&Q.warn("error while building swatchInfo!",a.error)});return y.renderSymbol(c,[k,m],{node:b&&b.node,scale:!1,opacity:b&&b.opacity})})}function O(a,b){var c=a.symbolLayers,e=[];a=k.isVolumetricSymbol(a);var g=b&&b.size?f.pt2px(b.size):null,h=(b&&b.maxSize?f.pt2px(b.maxSize):null)||80,m=0,n=0,q;c.forEach(function(a,b){if(a&&("line"===a.type||"path"===a.type)){var c=
[];switch(a.type){case "line":var f=I(a,0),k=f&&f.width||0;0===b&&(q=k);var l=Math.min(g||k,h);b=0===b?l:g?k/q*l:l;n=Math.max(n,b);m=Math.max(m,20<b?2*b:40);f.width=b;c.push({shape:{type:"path",path:[{command:"M",values:[0,.5*n]},{command:"L",values:[m,.5*n]}]},stroke:f});break;case "path":b=Math.min(g||22,h);k=B(a,0);l=B(a,-.2);f=(f=D(a,-.4))?{color:f,width:1}:{};if("quad"===a.profile){var r=a.width||a.size;a=a.height||a.size;a=p.getPathSymbolShapes(r&&a?r/a:1);f=d({},f,{join:"bevel"});c.push({shape:a[0],
fill:l,stroke:f});c.push({shape:a[1],fill:l,stroke:f});c.push({shape:a[2],fill:k,stroke:f})}else c.push({shape:p.shapes.pathSymbol3DLayer[0],fill:l,stroke:f}),c.push({shape:p.shapes.pathSymbol3DLayer[1],fill:k,stroke:f});m=n=Math.max(n,b)}e.push(c)}});return l.resolve(y.renderSymbol(e,[m,n],{node:b&&b.node,scale:a,opacity:b&&b.opacity}))}Object.defineProperty(a,"__esModule",{value:!0});var K=g.toUrl("../../images/Legend/legend3dsymboldefault.png"),Q=m.getLogger("esri.symbols.support.previewSymbol3D");
a.getSymbolLayerFill=B;a.previewSymbol3D=function(a,b){if(0===a.symbolLayers.length)return l.reject(new e("symbolPreview: renderPreviewHTML3D","No symbolLayers in the symbol."));var c=null;switch(a.type){case "point-3d":c=M(a,b);break;case "line-3d":c=O(a,b);break;case "polygon-3d":case "mesh-3d":c="mesh-3d"===a.type;a=a.symbolLayers;for(var g=b&&b.size?f.pt2px(b.size):null,h=b&&b.maxSize?f.pt2px(b.maxSize):null,g=g||22,k=[],m=0,n=0,t=!1,u=0;u<a.length;u++){var z=a.getItemAt(u),x=[];if(!c||"fill"===
z.type){var C=p.shapes.fill[0];switch(z.type){case "fill":var E=r(z),D=Math.min(g,h||120),m=Math.max(m,D),n=Math.max(n,D),t=!0;x.push({shape:C,fill:B(z,0),stroke:E});break;case "line":C={stroke:I(z,0),shape:C};m=Math.max(m,22);n=Math.max(n,22);x.push(C);break;case "extrude":var E=d({join:"round"},I(z,-.4)),C=B(z,0),z=B(z,-.2),D=Math.min(g,h||120),H=p.getExtrudeSymbolShapes(D);E.width=1;x.push({shape:H[0],fill:z,stroke:E});x.push({shape:H[1],fill:z,stroke:E});x.push({shape:H[2],fill:C,stroke:E});C=
22*.7+.5*D;m=Math.max(m,22);n=Math.max(n,C);break;case "water":t=A(z),C=q(t),z=q(t,2),E=q(t,3),D=p.getWaterSymbolShapes(),t=!0,x.push({shape:D[0],fill:C}),x.push({shape:D[1],fill:z}),x.push({shape:D[2],fill:E}),D=Math.min(g,h||120),m=Math.max(m,D),n=Math.max(n,D)}k.push(x)}}c=l.resolve(y.renderSymbol(k,[m,n],{node:b&&b.node,scale:t,opacity:b&&b.opacity}))}return c?c:l.reject(new e("symbolPreview: swatchInfo3D","symbol not supported."))}})},"esri/symbols/support/utils":function(){define("require exports ../../Color ../../symbols ../../core/compilerUtils ../../core/has ../../core/Logger ../../core/maybe ../../core/screenUtils ./gfxUtils ./Symbol3DMaterial".split(" "),
function(g,a,d,h,b,e,m,c,l,f,t){function x(a,b){if(null==b)return a;a=a.toRgba();a[3]*=b;return new d(a)}function n(a,b,e){if(a=a.symbolLayers){var d=function(a){a=c.isSome(a)?a:null;b=b||a||null!=e&&k;return x(b,e)};a.forEach(function(a){if("water"===a.type)a.color=d(a.color);else{var b=c.isSome(a.material)?a.material.color:null,b=d(b);c.isNone(a.material)?a.material=new t.default({color:b}):a.material.color=b;null!=e&&"outline"in a&&c.isSome(a.outline)&&c.isSome(a.outline.color)&&(a.outline.color=
x(a.outline.color,e))}})}}function p(a,b,c){(a=a.symbolLayers)&&a.forEach(function(a){if(a)switch(a.type){case "icon":case "line":case "path":case "extrude":case "text":a.size=b;break;case "object":switch(c){case "width":a.width=b;break;case "depth":a.depth=b;break;case "height":a.height=b;break;case "width-and-depth":a.width=b;a.depth=b;break;default:a.width=b,a.depth=b,a.height=b}break;default:y.warn("symbolUtils: applySizeToSymbol","symbolLayer not supported")}})}Object.defineProperty(a,"__esModule",
{value:!0});var y=m.getLogger("esri.symbols.support.utils"),u=/\/resource\/(.*?)\.svg$/,k=new d("white");a.getSymbolOutlineSize=function(a){if(!a)return 0;if(h.isSymbol3D(a)){var b=a.symbolLayers&&a.symbolLayers.length;b?(a=a.symbolLayers.getItemAt(b-1),a="outline"in a?c.get(a,"outline","size"):void 0):a=void 0;return c.isSome(a)?a:0}return(a=f.getStroke(a))&&l.px2pt(a.width)||0};a.isVolumetricSymbol=function(a){if(!a||!a.symbolLayers)return!1;switch(a.type){case "point-3d":return a.symbolLayers.some(function(a){return"object"===
a.type});case "line-3d":return a.symbolLayers.some(function(a){return"path"===a.type});case "polygon-3d":return a.symbolLayers.some(function(a){return"object"===a.type||"extrude"===a.type});default:return!1}};a.getIconHref=function(a,b){b=b.resource.href;return!e("esri-canvas-svg-support")&&a.styleOrigin&&u.test(b)?b.replace(u,"/resource/png/$1.png"):b};a.applyOpacityToColor=x;a.applyColorToSymbol=function(a,b,c){if(a&&(b||null!=c))if(b&&(b=new d(b)),h.isSymbol3D(a))n(a,b,c);else if(h.isSymbol2D(a)){if(b=
b||a.color)a.color=x(b,c);null!=c&&"outline"in a&&a.outline&&a.outline.color&&(a.outline.color=x(a.outline.color,c))}};a.applySizeToSymbol=function(a,c,e){if(a&&null!=c)if(h.isSymbol3D(a))p(a,c,e);else if(h.isSymbol2D(a))switch(a.type){case "simple-marker":a.size=c;break;case "picture-marker":e=a.width/a.height;1<e?(a.width=c,a.height=c*e):(a.width=c*e,a.height=c);break;case "simple-line":a.width=c;break;case "text":a.font.size=c;break;case "simple-fill":case "picture-fill":break;case "cim":break;
default:b.neverReached(a)}};a.applyRotationToSymbol=function(a,b,c){a&&null!=b&&(h.isSymbol3D(a)?(a=a.symbolLayers)&&a.forEach(function(a){if(a&&"object"===a.type)switch(c){case "tilt":a.tilt=b;break;case "roll":a.roll=b;break;default:a.heading=b}}):!h.isSymbol2D(a)||"simple-marker"!==a.type&&"picture-marker"!==a.type&&"text"!==a.type||(a.angle=b))}})},"esri/symbols/support/previewWebStyleSymbol":function(){define(["require","exports","../../request","../../core/screenUtils"],function(g,a,d,h){Object.defineProperty(a,
"__esModule",{value:!0});a.previewWebStyleSymbol=function(a,e,g){var b=a.thumbnail&&a.thumbnail.url;return b?d(b,{responseType:"image"}).then(function(a){a=a.data;var b=!/\\.svg$/i.test(a.src)&&g&&g.disableUpsampling,c=Math.max(a.width,a.height),e=g&&null!=g.maxSize?h.pt2px(g.maxSize):120;b&&(e=Math.min(c,e));b=Math.min(e,g&&null!=g.size?h.pt2px(g.size):c);b!==c&&(c=0!==a.width&&0!==a.height?a.width/a.height:1,1<=c?(a.width=b,a.height=b/c):(a.width=b*c,a.height=b));return g&&g.node?(g.node.appendChild(a),
g.node):a}):a.fetchSymbol().then(function(a){return e(a,g)})}})},"esri/widgets/Legend/support/colorRampUtils":function(){define("require exports ../../../core/tsSupport/awaiterHelper ../../../core/tsSupport/generatorHelper ../../../Color ../../../core/promiseUtils ./utils @dojo/framework/shim/Promise".split(" "),function(g,a,d,h,b,e,m){function c(a,b){var c=[],e=a.length-1;5===a.length?c.push(0,2,4):c.push(0,e);return a.map(function(a,d){return-1<c.indexOf(d)?m.createStopLabel(a,d,e,b):null})}function l(a,
c,e){void 0===e&&(e=x);return d(this,void 0,void 0,function(){var d,f;return h(this,function(h){switch(h.label){case 0:return d=new b(e),[4,new Promise(function(a,b){g(["../../../renderers/visualVariables/support/visualVariableUtils"],a,b)})];case 1:return f=h.sent().getOpacity(c,a),null!=f&&(d.a=f),[2,d]}})})}function f(a,c){a=t(a,c);var e=a.startIndex,d=a.endIndex;if(e===d)return c[e].color;c=b.blendColors(c[e].color,c[d].color,a.weight);return new b(c)}function t(a,b){var c=0,e=b.length-1;b.some(function(b,
d){if(a<b.value)return e=d,!0;c=d;return!1});return{startIndex:c,endIndex:e,weight:(a-b[c].value)/(b[e].value-b[c].value)}}Object.defineProperty(a,"__esModule",{value:!0});var x=new b([64,64,64]);a.getRampStops=function(a,b,f){return d(this,void 0,void 0,function(){var m,k,n,p,q,t,y,B,x=this;return h(this,function(r){switch(r.label){case 0:m=!1;k=[];n=[];a.stops&&(p=a.stops,k=p.map(function(a){return a.value}),(m=p.some(function(a){return!!a.label}))&&(n=p.map(function(a){return a.label})));q=k[0];
t=k[k.length-1];if(null==q&&null==t)return[2,null];y=m?null:c(k,f);return[4,e.all(k.map(function(c,e){return d(x,void 0,void 0,function(){var d,f,k;return h(this,function(h){switch(h.label){case 0:return"opacity"!==a.type?[3,2]:[4,l(c,a,b)];case 1:return f=h.sent(),[3,4];case 2:return[4,new Promise(function(a,b){g(["../../../renderers/visualVariables/support/visualVariableUtils"],a,b)})];case 3:f=h.sent().getColor(a,c),h.label=4;case 4:return d=f,k=m?n[e]:y[e],[2,{value:c,color:d,label:k}]}})})}))];
case 1:return B=r.sent(),[2,B.reverse()]}})})};a.getRampStopsForPointCloud=function(a){var b=!1,e=[],d=[],e=a.map(function(a){return a.value});(b=a.some(function(a){return!!a.label}))&&(d=a.map(function(a){return a.label}));var g=e[e.length-1];if(null==e[0]&&null==g)return null;var h=b?null:c(e,!1);return e.map(function(c,e){var g=f(c,a);return{value:c,color:g,label:b?d[e]:h[e]}}).reverse()};a.getColorFromPointCloudStops=f;a.getStrectchRampStops=function(a,c){var e=[];if(a&&"multipart"===a.type)a.colorRamps.reverse().forEach(function(d,
f){0===f?e.push({value:c.max,color:new b(d.toColor),label:"high"}):e.push({value:null,color:new b(d.toColor),label:""});f===a.colorRamps.length-1?e.push({value:c.min,color:new b(d.fromColor),label:"low"}):e.push({value:null,color:new b(d.fromColor),label:""})});else{var d=void 0,f=void 0;a&&"algorithmic"===a.type?(d=a.fromColor,f=a.toColor):(d=[0,0,0,1],f=[255,255,255,1]);e=[{value:c.max,color:new b(f),label:"high"},{value:c.min,color:new b(d),label:"low"}]}return e}})},"esri/widgets/Legend/support/utils":function(){define(["require",
"exports","../../../intl/date","../../../renderers/support/numberUtils"],function(g,a,d,h){Object.defineProperty(a,"__esModule",{value:!0});var b=d.convertDateFormatToIntlOptions("short-date");a.createStopLabel=function(a,g,c,l){var e="";0===g?e="\x3c ":g===c&&(e="\x3e ");g=null;g=l?d.formatDate(a,b):h.format(a);return e+g};a.RGB_IMG_SOURCE=["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwcdIkqhiWn5fHwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6JrzFUAAAAASUVORK5CYII\x3d",
"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwaeIkqhiWl5/HwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6sKxboAAAAASUVORK5CYII\x3d","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwadJEqhiWl5fPwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu75+IUcAAAAASUVORK5CYII\x3d"]})},"esri/widgets/Legend/support/heatmapRampUtils":function(){define(["require","exports","../../../renderers/support/HeatmapColorStop"],
function(g,a,d){Object.defineProperty(a,"__esModule",{value:!0});a.getHeatmapRampStops=function(a){a=a.colorStops;var b=a.length-1;if(a&&a[0]){var e=a[b];e&&1!==e.ratio&&(a=a.slice(0),a.push(new d.HeatmapColorStop({ratio:1,color:e.color})),b++)}return a.map(function(a,c){var e="";0===c?e="low":c===b&&(e="high");return{color:a.color,label:e,ratio:a.ratio}}).reverse()}})},"esri/widgets/Legend/support/relationshipRampUtils":function(){define(["require","exports","../../../symbols/support/gfxUtils","../../../symbols/support/previewSymbol3D"],
function(g,a,d,h){function b(a){if(a){var b=a.type;return-1<b.indexOf("3d")?h.getSymbolLayerFill(a.symbolLayers.getItemAt(0)):"simple-line"===b||"simple-marker"===a.type&&("x"===a.style||"cross"===a.style)?(a=d.getStroke(a))&&a.color:d.getFill(a)}}function e(a,b){var c=b.HH.label,e=b.LL.label,d=b.HL.label;b=b.LH.label;switch(a){case "HH":return{top:c,bottom:e,left:d,right:b};case "HL":return{top:d,bottom:b,left:e,right:c};case "LL":return{top:e,bottom:c,left:b,right:d};case "LH":return{top:b,bottom:d,
left:c,right:e};default:return{top:c,bottom:e,left:d,right:b}}}function m(a){var b=c[a];a&&null==b&&(b=c.HH);return b||0}Object.defineProperty(a,"__esModule",{value:!0});var c={HH:315,HL:45,LL:135,LH:225},l={2:[["HL","HH"],["LL","LH"]],3:[["HL","HM","HH"],["ML","MM","MH"],["LL","LM","LH"]],4:[["HL","HM1","HM2","HH"],["M2L","M2M1","M2M2","M2H"],["M1L","M1M1","M1M2","M1H"],["LL","LM1","LM2","LH"]]};a.getRelationshipRampElement=function(a){var c=a.focus,d=a.numClasses,f=l[d],g={};a.infos.forEach(function(a){g[a.value]=
{label:a.label,fill:b(a.symbol)}});a=[];for(var h=0;h<d;h++){for(var u=[],k=0;k<d;k++)u.push(g[f[h][k]].fill);a.push(u)}f=e(c,g);return{type:"relationship-ramp",numClasses:d,focus:c,colors:a,labels:f,rotation:m(c)}};a.getRotationAngleForFocus=m})},"esri/widgets/Legend/support/sizeRampUtils":function(){define("require exports ../../../core/tsSupport/awaiterHelper ../../../core/tsSupport/generatorHelper ../../../symbols ../../../core/promiseUtils ../../../renderers/support/numberUtils ../../../symbols/support/utils ./utils @dojo/framework/shim/Promise".split(" "),
function(g,a,d,h,b,e,m,c,l){function f(a,b){var c=a.length-1;return a.map(function(a,e){return l.createStopLabel(a,e,c,b)})}function t(a,b){var c=null,e=null;"simple"===a.type?c=a.symbol:"class-breaks"===a.type?(c=(a=a.classBreakInfos)&&a[0]&&a[0].symbol,e=1<a.length):"unique-value"===a.type&&(c=(a=a.uniqueValueInfos)&&a[0]&&a[0].symbol,e=1<a.length);if(!c||x(c))return null;c=c.clone();if(b||e)-1<c.type.indexOf("3d")?n(c):(b=c,-1!==b.type.indexOf("line")?b.color=E:(b.color=z,"simple-marker"===b.type&&
(b.outline={color:E,width:1.5})));return c}function x(a){return a?b.isSymbol3D(a)?a.symbolLayers?a.symbolLayers.some(function(a){return a&&"fill"===a.type}):!1:-1!==a.type.indexOf("fill"):!1}function n(a){c.isVolumetricSymbol(a)||("line-3d"===a.type?a.symbolLayers.forEach(function(a){a.material={color:E}}):a.symbolLayers.forEach(function(a){"icon"!==a.type||a.resource&&a.resource.href?a.material={color:q}:(a.material={color:z},a.outline={color:E,size:1.5})}))}function p(a,b,c,e){return d(this,void 0,
void 0,function(){var d,f,k,l,n;return h(this,function(h){switch(h.label){case 0:return[4,new Promise(function(a,b){g(["../../../renderers/visualVariables/support/visualVariableUtils"],a,b)})];case 1:f=(d=h.sent().getSizeRangeAtScale(a,c,e))&&y(d);if(!d&&!f)return[2,void 0];k=f.map(function(b){var c=d.minSize,e=d.maxSize,f=a.minDataValue,g=a.maxDataValue;return b<=c?f:b>=e?g:(b-c)/(e-c)*(g-f)+f});k=m.round(k);l=1;h.label=2;case 2:return l<k.length-1?[4,u(a,b,k[l],k[l-1],c,e)]:[3,5];case 3:if(n=h.sent())k[l]=
n[0],f[l]=n[1];h.label=4;case 4:return l++,[3,2];case 5:return[2,k]}})})}function y(a){var b=a.minSize;a=(a.maxSize-b)/4;for(var c=[],e=0;5>e;e++)c.push(b+a*e);return c}function u(a,b,c,e,f,g){return d(this,void 0,void 0,function(){var d,l,n,p,q,r,t,u,B,y,z,x,A,C,D,E,I,L,ba,S,ea,fa;return h(this,function(h){switch(h.label){case 0:return[4,k(a,b,c,f,g)];case 1:return l=h.sent(),[4,k(a,b,e,f,g)];case 2:n=h.sent(),p=m.numDigits(c),q=p.fractional,r=20,t=p.integer,B=u=null,0<c&&1>c&&(u=Math.pow(10,q),
c*=u,t=m.numDigits(c).integer),y=t-1,h.label=3;case 3:if(!(0<=y))return[3,8];z=Math.pow(10,y);x=Math.floor(c/z)*z;A=Math.ceil(c/z)*z;null!=u&&(x/=u,A/=u);C=(x+A)/2;d=m.round([x,C,A],{indexes:[1]});C=d[1];return[4,k(a,b,x,f,g)];case 4:return D=h.sent(),[4,k(a,b,A,f,g)];case 5:return E=h.sent(),[4,k(a,b,C,f,g)];case 6:I=h.sent();L=m.percentChange(l,D,n,null);ba=m.percentChange(l,E,n,null);S=m.percentChange(l,I,n,null);ea=L.previous<=r;fa=ba.previous<=r;ea&&fa&&(L.previous<=ba.previous?(ea=!0,fa=!1):
(fa=!0,ea=!1));ea?B=[x,D]:fa?B=[A,E]:S.previous<=r&&(B=[C,I]);if(B)return[3,8];h.label=7;case 7:return y--,[3,3];case 8:return[2,B]}})})}function k(a,b,c,e,f){return d(this,void 0,void 0,function(){var d;return h(this,function(h){switch(h.label){case 0:return[4,new Promise(function(a,b){g(["../../../renderers/visualVariables/support/visualVariableUtils"],a,b)})];case 1:return d=h.sent().getSize,[2,d(a,c,{scale:e,view:f,shape:"simple-marker"===b.type?b.style:null})]}})})}function r(a,e){a=a.clone();
if(b.isSymbol3D(a))c.isVolumetricSymbol(a)||a.symbolLayers.forEach(function(a){"fill"!==a.type&&(a.size=e)});else if("esri.symbols.SimpleMarkerSymbol"===a.declaredClass)a.size=e;else if("esri.symbols.PictureMarkerSymbol"===a.declaredClass){var d=a.width,f=a.height;a.height=e;a.width=d/f*e}else"esri.symbols.SimpleLineSymbol"===a.declaredClass?a.width=e:"esri.symbols.TextSymbol"===a.declaredClass&&a.font&&(a.font.size=e);return a}Object.defineProperty(a,"__esModule",{value:!0});a.REAL_WORLD_MAX_SIZE=
30;a.REAL_WORLD_MIN_SIZE=12;var z=[255,255,255],q=[200,200,200],E=[128,128,128];a.getRampStops=function(b,g,l,n,q,u){return d(this,void 0,void 0,function(){var B,y,z,x,A,C,E,D,I,L,Y,W,X,Z,aa,V,ca,da=this;return h(this,function(H){switch(H.label){case 0:y=(B=g.legendOptions)&&B.customValues;z=t(b,l);x=!!z;A=!!y;C=null!=g.minSize&&null!=g.maxSize;E=g.stops&&1<g.stops.length;D=!!g.target;if(!x||!(A||C||E&&!D))return[2,void 0];I=c.isVolumetricSymbol(z);W=Y=L=null;if(!I||E)return[3,1];Y=m.round([g.minDataValue,
g.maxDataValue]);return[3,4];case 1:return(X=y)?[3,3]:[4,p(g,z,n,q)];case 2:X=H.sent(),H.label=3;case 3:Y=X,H.label=4;case 4:!Y&&E&&(Y=g.stops.map(function(a){return a.value}),(L=g.stops.some(function(a){return!!a.label}))&&(W=g.stops.map(function(a){return a.label})));I&&Y&&2<Y.length&&(Y=[Y[0],Y[Y.length-1]]);if(!Y)return[2,null];Z=[a.REAL_WORLD_MIN_SIZE,a.REAL_WORLD_MAX_SIZE];aa=c.getSymbolOutlineSize(z);V=L?null:f(Y,u);return[4,e.all(Y.map(function(a,b){return d(da,void 0,void 0,function(){var c,
e,d,f;return h(this,function(h){switch(h.label){case 0:if(!I)return[3,1];d=Z[b];return[3,3];case 1:return[4,k(g,z,a,n,q)];case 2:d=h.sent(),h.label=3;case 3:return c=d,e=r(z,c),f=L?W[b]:V[b],[2,{value:a,symbol:e,label:f,size:c,outlineSize:aa}]}})})}))];case 5:return ca=H.sent(),[2,ca.reverse()]}})})}})},"esri/widgets/Legend/styles/Card":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/tsSupport/assignHelper dojo/i18n!../../../nls/common dojo/i18n!../../Legend/nls/Legend ../../../intl ../../../core/Handles ../../../core/screenUtils ../../../core/accessorSupport/decorators ../../../symbols/support/svgUtils ../../Widget ./support/utils ../support/styleUtils ../../support/colorUtils ../../support/widget".split(" "),
function(g,a,d,h,b,e,m,c,l,f,t,x,n,p,y,u,k){var r=window.devicePixelRatio;return function(a){function b(b){b=a.call(this,b)||this;b._handles=new l;b._hasIndicators=!1;b._selectedSectionName=null;b._sectionNames=[];b._sectionMap=new Map;b.activeLayerInfos=null;b.layout="stack";b.type="card";b.view=null;return b}d(b,a);b.prototype.postInitialize=function(){var a=this;this.own([this.watch("activeLayerInfos",function(b){a._handles.removeAll();a._watchForSectionChanges(b)})])};b.prototype.destroy=function(){this._handles.destroy();
this._handles=null};b.prototype.render=function(){var a=this,b;this._hasIndicators="auto"===this.layout&&768>=this.view.container.clientWidth||"stack"===this.layout;var d=this.activeLayerInfos,f=d&&d.toArray().map(function(b){return a._renderLegendForLayer(b)}).filter(function(a){return!!a});this._hasIndicators?this._selectedSectionName&&-1!==this._sectionNames.indexOf(this._selectedSectionName)||(this._selectedSectionName=this._sectionNames&&this._sectionNames[0]):this._selectedSectionName=null;
var g=this._sectionNames.length,d=this._sectionNames.map(function(b,d){var f;d=c.substitute(e.pagination.pageText,{index:d+1,total:g});return k.tsx("div",{key:b,"aria-label":d,title:d,tabIndex:0,onclick:a._selectSection,onkeydown:a._selectSection,bind:a,class:a.classes("esri-legend--card__carousel-indicator",(f={},f["esri-legend--card__carousel-indicator--activated"]=a._selectedSectionName===b,f)),"data-section-name":b})}),d=this._hasIndicators&&1<g?k.tsx("div",{class:"esri-legend--card__carousel-indicator-container",
key:"carousel-navigation"},d):null,f=this._hasIndicators?this._sectionMap.get(this._selectedSectionName):f&&f.length?f:null,h=(b={},b["esri-legend--stacked"]=this._hasIndicators,b);return k.tsx("div",{class:this.classes("esri-legend--card esri-widget",h)},d,f?f:k.tsx("div",{class:"esri-legend--card__message"},m.noLegend))};b.prototype._selectSection=function(a){if(a=a.target.getAttribute("data-section-name"))this._selectedSectionName=a};b.prototype._watchForSectionChanges=function(a){var b=this;this._generateSectionNames();
a&&(a.forEach(function(a){var c="activeLayerInfo-"+a.layer.uid+"-version-change";b._handles.remove(c);b._watchForSectionChanges(a.children);b._handles.add(a.watch("version",function(){return b._generateSectionNames()}),c)}),this._handles.remove("activeLayerInfos-collection-change"),this._handles.add(a.on("change",function(){return b._watchForSectionChanges(a)}),"activeLayerInfos-collection-change"))};b.prototype._generateSectionNames=function(){this._sectionNames.length=0;this.activeLayerInfos&&this.activeLayerInfos.forEach(this._generateSectionNamesForActiveLayerInfo,
this)};b.prototype._generateSectionNamesForActiveLayerInfo=function(a){var b=this;a.children.forEach(this._generateSectionNamesForActiveLayerInfo,this);a.legendElements&&a.legendElements.forEach(function(c,e){b._sectionNames.push("esri-legend--card__"+a.layer.uid+"-type-"+c.type+"-"+e)})};b.prototype._renderLegendForLayer=function(a){var b=this,c;if(!a.ready)return null;if(a.children.length)return c=a.children.map(function(a){return b._renderLegendForLayer(a)}).toArray(),k.tsx("div",{key:a.layer.uid,
class:this.classes("esri-legend--card__service","esri-legend--card__group-layer")},k.tsx("div",{class:"esri-legend--card__service-caption-container"},a.title),c);var e=a.legendElements;if(e&&!e.length)return null;var d=e.some(function(a){return"relationship-ramp"===a.type}),e=e.map(function(c,e){return b._renderLegendForElement(c,a,e,d)}).filter(function(a){return!!a});if(!e.length)return null;var f=(c={},c["esri-legend--card__group-layer-child"]=!!a.parent,c);return k.tsx("div",{key:a.layer.uid,
class:this.classes("esri-legend--card__service",f)},k.tsx("div",{class:"esri-legend--card__service-caption-container"},k.tsx("div",{class:"esri-legend--card__service-caption-text"},a.title)),k.tsx("div",{class:"esri-legend--card__service-content"},e))};b.prototype._renderLegendForElement=function(a,b,c,e){var d=this;void 0===e&&(e=!1);var f,g="color-ramp"===a.type,h="opacity-ramp"===a.type,l="size-ramp"===a.type,m=b.layer,n=a.title,q=null;"string"===typeof n?q=n:n&&(q=y.getTitle(n,g||h),q=n.title?
n.title+" ("+q+")":q);c="esri-legend--card__"+m.uid+"-type-"+a.type+"-"+c;n=this._hasIndicators?k.tsx("div",null,k.tsx("h3",{class:this.classes("esri-widget__heading","esri-legend--card__carousel-title")},b.title),k.tsx("h4",{class:this.classes("esri-widget__heading","esri-legend--card__layer-caption")},q)):q?k.tsx("h4",{class:this.classes("esri-widget__heading","esri-legend--card__layer-caption")},q):null;q=null;"symbol-table"===a.type?(l=a.infos.map(function(c,e){return d._renderLegendForElementInfo(c,
b,a.legendType,e)}).filter(function(a){return!!a}),l.length&&(m=l[0].properties.classes&&l[0].properties.classes["esri-legend--card__symbol-row"],e=(f={},f["esri-legend--card__label-container"]=!m&&!e,f["esri-legend--card__relationship-label-container"]=e,f),q=k.tsx("div",{key:c,class:"esri-legend--card__section"},n,k.tsx("div",{class:this.classes(e)},l)))):"color-ramp"===a.type||"opacity-ramp"===a.type||"heatmap-ramp"===a.type?q=k.tsx("div",{key:c,class:"esri-legend--card__section"},n,this._renderLegendForRamp(a,
m.opacity)):l?q=k.tsx("div",{key:c,class:"esri-legend--card__section"},n,this._renderSizeRamps(a,m.opacity)):"relationship-ramp"===a.type&&(q=k.tsx("div",{key:c,class:this.classes("esri-legend--card__section","esri-legend--card__relationship-section")},n,p.renderRelationshipRamp(a,this.id,m.opacity)));if(!q)return null;this._sectionMap.set(c,q);return q};b.prototype._renderLegendForElementInfo=function(a,b,c,e){var d,f,g,h=b.layer;if(a.type)return this._renderLegendForElement(a,b,e);b=y.isImageryStretchedLegend(h,
c);if(a.symbol&&a.preview){if(-1===a.symbol.type.indexOf("simple-fill")){if(!a.label)return k.tsx("div",{key:e,bind:a.preview,afterCreate:y.attachToNode});h=(d={},d["esri-legend--card__symbol-cell"]=this._hasIndicators,d);return k.tsx("div",{key:e,class:this.classes("esri-legend--card__layer-row",(f={},f["esri-legend--card__symbol-row"]=this._hasIndicators,f))},k.tsx("div",{class:this.classes(h),bind:a.preview,afterCreate:y.attachToNode}),k.tsx("div",{class:this.classes("esri-legend--card__image-label",
(g={},g["esri-legend--card__label-cell"]=this._hasIndicators,g))},y.getTitle(a.label,!1)||""))}g=f=d=255;b=0;var l=c=255,m=255,n=0,p=a.symbol.color&&a.symbol.color.a,q=a.symbol.outline&&a.symbol.outline.color&&a.symbol.outline.color.a;p&&(d=a.symbol.color.r,f=a.symbol.color.g,g=a.symbol.color.b,b=a.symbol.color.a*h.opacity);q&&(c=a.symbol.outline.color.r,l=a.symbol.outline.color.g,m=a.symbol.outline.color.b,n=a.symbol.outline.color.a*h.opacity);var r=(h=a.symbol.color?u.isBright(a.symbol.color):!0)?
"rgba(255, 255, 255, .6)":"rgba(0, 0, 0, .6)";return k.tsx("div",{key:e,class:"esri-legend--card__layer-row"},k.tsx("div",{class:"esri-legend--card__label-element",styles:{background:p?"rgba("+d+", "+f+", "+g+", "+b+")":"none",color:h?"black":"white",textShadow:"-1px -1px 0 "+r+",\n                                              1px -1px 0 "+r+",\n                                              -1px 1px 0 "+r+",\n                                              1px 1px 0 "+r,border:q?"1px solid rgba("+c+
", "+l+", "+m+", "+n+")":"none"}}," ",a.label," "))}if(a.src)return h=this._renderImage(a,h,b),k.tsx("div",{key:e,class:"esri-legend--card__layer-row"},h,k.tsx("div",{class:"esri-legend--card__image-label"},a.label||""))};b.prototype._renderImage=function(a,b,c){var e,d=a.label,f=a.src,g=a.opacity;c=(e={},e["esri-legend--card__imagery-layer-image--stretched"]=c,e["esri-legend--card__symbol"]=!c,e);b={opacity:""+(null!=g?g:b.opacity)};return k.tsx("img",{alt:y.getTitle(d,!1),src:f,border:0,width:a.width,
height:a.height,class:this.classes(c),styles:b})};b.prototype._drawImageOnSizeRamp=function(a,b,c){var e=c.x,d=c.y,f=c.width,g=c.height,h=new Image;h.src=b;h.onload=function(){a.drawImage(h,e,d,f,g);URL.revokeObjectURL(b)}};b.prototype._attachSizeRampToNode=function(a){var b=a["data-layer-opacity"];null!=b&&(a.style.opacity=b.toString());var b=a["data-legend-element"].infos,c=b[0],e=b[b.length-1],d=c.symbol,g=e.symbol,h="picture-marker"===d.type;d?-1<d.type.indexOf("3d")?(b=d.symbolLayers&&d.symbolLayers.length)?
(b=d.symbolLayers.getItemAt(b-1).get("resource.primitive"),b="triangle"===b||"cone"===b||"tetrahedron"===b):b=void 0:b="triangle"===d.style:b=void 0;var k;d?-1<d.type.indexOf("3d")?(k=d.symbolLayers&&d.symbolLayers.length)?(k=d.symbolLayers.getItemAt(k-1),k=k.resource&&k.resource.primitive,k="circle"===k||"cross"===k||"kite"===k||"sphere"===k||"cube"===k||"diamond"===k):k=void 0:(k=d.style,k="circle"===k||"diamond"===k||"cross"===k):k=void 0;var l,m;h?(l=d.url,m=g.url):(c.preview&&(l=new Blob([c.preview.innerHTML],
{type:"image/svg+xml"}),l=URL.createObjectURL(l)),e.preview&&(m=new Blob([e.preview.innerHTML],{type:"image/svg+xml"}),m=URL.createObjectURL(m)));var n=f.pt2px(c.size+c.outlineSize)*r,d=f.pt2px(e.size+e.outlineSize)*r,g=this._hasIndicators?n:n+100*r,h=this._hasIndicators?g+50*r:n,c=document.createElement("canvas");c.width=g;c.height=h;c.style.width=c.width/r+"px";c.style.height=c.height/r+"px";e=c.getContext("2d");this._hasIndicators?(this._drawImageOnSizeRamp(e,l,{x:0,y:0,width:n,height:n}),this._drawImageOnSizeRamp(e,
m,{x:g/2-d/2,y:h-d,width:d,height:d}),e.beginPath(),l=g/2-d/2,m=h-(b?0:k?d/2:d),e.moveTo(0,k?g/2:g),e.lineTo(l,m),l=g/2+d/2,b=h-(b?0:k?d/2:d),e.moveTo(g,k?g/2:g),e.lineTo(l,b)):(this._drawImageOnSizeRamp(e,l,{x:g-n,y:0,width:n,height:n}),this._drawImageOnSizeRamp(e,m,{x:0,y:h/2-d/2,width:d,height:d}),e.beginPath(),l=g-(k||b?n/2:n),e.moveTo(d-(k||b?d/2:0),h/2-d/2),e.lineTo(l,0),b=g-(k?n/2:n),e.moveTo(d-(k?d/2:0),h/2+d/2),e.lineTo(b,h));e.strokeStyle="#ddd";e.stroke();a.appendChild(c)};b.prototype._renderSizeRamps=
function(a,b){var c,e=a.infos,d=e[0].label,e=e[e.length-1].label;return k.tsx("div",{class:this.classes("esri-legend--card__layer-row",(c={},c["esri-legend--card__size-ramp-row"]=this._hasIndicators,c))},k.tsx("div",{class:"esri-legend--card__ramp-label"},this._hasIndicators?d:e),k.tsx("div",{class:"esri-legend--card__size-ramp-container"},k.tsx("div",{bind:this,"data-layer-opacity":b,"data-legend-element":a,afterCreate:this._attachSizeRampToNode})),k.tsx("div",{class:"esri-legend--card__ramp-label"},
this._hasIndicators?e:d))};b.prototype._renderLegendForRamp=function(a,b){var c=a.infos,e="heatmap-ramp"===a.type,d=c.length-1;a=2<d&&!e?25*d:100;var f=a+20,g=c.slice(0).reverse();g.forEach(function(a,b){a.offset=e?a.ratio:b/d});var h=g.length-1,l=0!==g.length%2&&g[g.length/2|0],l=l&&k.tsx("div",{class:"esri-legend--card__interval-separators-container"},k.tsx("div",{class:"esri-legend--card__interval-separator"},"|"),k.tsx("div",{class:"esri-legend--card__ramp-label"},l.label)),n=c[c.length-1].label,
c=c[0].label,p=null;null!=b&&(p="opacity: "+b);b=x.renderSVG([[{shape:{type:"path",path:"M0 12.5 L10 0 L10 25 Z"},fill:g[0].color,stroke:{width:0}},{shape:{type:"rect",x:10,y:0,width:a,height:25},fill:{type:"linear",x1:10,y1:0,x2:a+10,y2:0,colors:g},stroke:{width:0}},{shape:{type:"path",path:"M"+(a+10)+" 0 L"+f+" 12.5 L"+(a+10)+" 25 Z"},fill:g[h].color,stroke:{width:0}}]],f,25);return k.tsx("div",{class:"esri-legend--card__layer-row"},k.tsx("div",{class:"esri-legend--card__ramp-label"},e?m[n]:n),
k.tsx("div",{class:"esri-legend--card__symbol-container"},k.tsx("div",{style:p},b),l),k.tsx("div",{class:"esri-legend--card__ramp-label"},e?m[c]:c))};h([k.renderable(),t.property()],b.prototype,"activeLayerInfos",void 0);h([t.property()],b.prototype,"layout",void 0);h([t.property({readOnly:!0})],b.prototype,"type",void 0);h([t.property()],b.prototype,"view",void 0);h([k.accessibleHandler()],b.prototype,"_selectSection",null);return b=h([t.subclass("esri.widgets.Legend.styles.Card")],b)}(t.declared(n))})},
"esri/widgets/Legend/styles/support/utils":function(){define(["require","exports","../../../../symbols/support/svgUtils","../../../support/widget"],function(g,a,d,h){function b(a,b,c){var e=c+"_arrowStart";c+="_arrowEnd";a="left"===a;var d={markerStart:null,markerEnd:null};switch(b){case "HL":a?d.markerStart="url(#"+c+")":d.markerEnd="url(#"+e+")";break;case "LL":d.markerStart="url(#"+c+")";break;case "LH":a?d.markerEnd="url(#"+e+")":d.markerStart="url(#"+c+")";break;default:d.markerEnd="url(#"+e+
")"}return d}Object.defineProperty(a,"__esModule",{value:!0});a.renderRelationshipRamp=function(a,g,c){var e=a.labels,f=!!a.focus,m=void 0;void 0===m&&(m=60);var x=a.focus,n=a.numClasses,p=a.colors,y=a.rotation;a=!!x;var u=Math.sqrt(Math.pow(m,2)+Math.pow(m,2))+(a?0:5),k=null;null!=c&&(k="opacity: "+c);c=[];for(var r=[],z=[],q=(m||75)/n,E=0;E<n;E++)for(var A=E*q,B=0;B<n;B++){var C=B*q,D=d.generateFillAttributes(p[E][B]),I=d.generateStrokeAttributes(null),C={type:"rect",x:C,y:A,width:q,height:q};c.push(d.renderDef(D));
r.push(d.renderShape(C,D.fill,I,null));z.push(d.getBoundingBox(C))}n=null;a||(n="margin: -15px -15px -18px -15px");p=b("left",x,g);x=b("right",x,g);z=d.computeBBox(z);y=d.getTransformMatrix(z,u,u,0,!1,y);z=d.getTransformMatrix(z,u,u,0,!1,a?-45:null);g=h.tsx("div",{style:k,class:a?"esri-relationship-ramp--diamond__middle-column--ramp":"esri-relationship-ramp--square__table-cell"},h.tsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:u,height:u,style:n},h.tsx("defs",null,h.tsx("marker",{id:g+"_arrowStart",
markerWidth:"10",markerHeight:"10",refX:"5",refY:"5",markerUnits:"strokeWidth",orient:"auto"},h.tsx("polyline",{points:"0,0 5,5 0,10",fill:"none",stroke:"#555555","stroke-width":"1"})),h.tsx("marker",{id:g+"_arrowEnd",markerWidth:"10",markerHeight:"10",refX:"0",refY:"5",markerUnits:"strokeWidth",orient:"auto"},h.tsx("polyline",{points:"5,0 0,5 5,10",fill:"none",stroke:"#555555","stroke-width":"1"})),c),h.tsx("g",{transform:y},r),h.tsx("g",{transform:z},h.tsx("line",{fill:"none",stroke:"#555555","stroke-width":"1",
"marker-start":p.markerStart,"marker-end":p.markerEnd,x1:-10,y1:m-15,x2:-10,y2:15}),h.tsx("line",{fill:"none",stroke:"#555555","stroke-width":"1","marker-start":x.markerStart,"marker-end":x.markerEnd,x1:15,y1:m+10,x2:m-15,y2:m+10}))));return f?h.tsx("div",{class:"esri-relationship-ramp--diamond__container"},h.tsx("div",{class:"esri-relationship-ramp--diamond__left-column"},e.left),h.tsx("div",{class:"esri-relationship-ramp--diamond__middle-column"},h.tsx("div",{class:"esri-relationship-ramp--diamond__middle-column--label"},
e.top),g,h.tsx("div",{class:"esri-relationship-ramp--diamond__middle-column--label"},e.bottom)),h.tsx("div",{class:"esri-relationship-ramp--diamond__right-column"},e.right)):h.tsx("div",{class:"esri-relationship-ramp--square__table"},h.tsx("div",{class:"esri-relationship-ramp--square__table-row"},h.tsx("div",{class:h.classes("esri-relationship-ramp--square__table-cell","esri-relationship-ramp--square__table-label","esri-relationship-ramp--square__table-label--right-bottom")},e.left),h.tsx("div",{class:"esri-relationship-ramp--square__table-cell"}),
h.tsx("div",{class:h.classes("esri-relationship-ramp--square__table-cell","esri-relationship-ramp--square__table-label","esri-relationship-ramp--square__table-label--left-bottom")},e.top)),h.tsx("div",{class:"esri-relationship-ramp--square__table-row"},h.tsx("div",{class:"esri-relationship-ramp--square__table-cell"}),g,h.tsx("div",{class:"esri-relationship-ramp--square__table-cell"})),h.tsx("div",{class:"esri-relationship-ramp--square__table-row"},h.tsx("div",{class:h.classes("esri-relationship-ramp--square__table-cell",
"esri-relationship-ramp--square__table-label","esri-relationship-ramp--square__table-label--right-top")},e.bottom),h.tsx("div",{class:"esri-relationship-ramp--square__table-cell"}),h.tsx("div",{class:h.classes("esri-relationship-ramp--square__table-cell","esri-relationship-ramp--square__table-label","esri-relationship-ramp--square__table-label--left-top")},e.right)))}})},"esri/widgets/Legend/support/styleUtils":function(){define(["require","exports","dojo/i18n!../../Legend/nls/Legend","../../../intl"],
function(g,a,d,h){Object.defineProperty(a,"__esModule",{value:!0});a.attachToNode=function(a){a.appendChild(this)};a.getTitle=function(a,e){if(a){if("string"===typeof a)return a;if("value"in a||"unit"in a)return h.substitute(d.dotValue,a);if("colorName"in a||"bandName"in a)return d[a.colorName]+": "+(d[a.bandName]||a.bandName);var b=null;e?b=a.ratioPercentTotal?"showRatioPercentTotal":a.ratioPercent?"showRatioPercent":a.ratio?"showRatio":a.normField?"showNormField":a.field?"showField":null:e||(b=
a.normField?"showNormField":a.normByPct?"showNormPct":a.field?"showField":null);return b?h.substitute("showField"===b?"{field}":d[b],{field:a.field,normField:a.normField}):null}};a.isRendererTitle=function(a,e){return!e};a.isImageryStretchedLegend=function(a,e){return!!(e&&"Stretched"===e&&10.3<=a.version&&"esri.layers.ImageryLayer"===a.declaredClass)}})},"esri/widgets/support/colorUtils":function(){define(["require","exports","../../Color"],function(g,a,d){function h(a){return new d(a)}function b(a){return!!a&&
4===a.length&&t.test(a)}function e(a){return!!a&&7===a.length&&x.test(a)}function m(a){return 127<=.299*a.r+.587*a.g+.114*a.b}function c(a,b){void 0===b&&(b=1);b=Math.pow(.7,b);return new d([Math.round(a.r*b),Math.round(a.g*b),Math.round(a.b*b),a.a])}function l(a,b){void 0===b&&(b=1);b=Math.pow(.7,b);var c=a.r,e=a.g,f=a.b;30>c&&(c=30);30>e&&(e=30);30>f&&(f=30);return new d([Math.min(255,Math.round(c/b)),Math.min(255,Math.round(e/b)),Math.min(255,Math.round(f/b)),a.a])}function f(a,b){var c=a.r,e=
a.g,f=a.b;a=a.a;1>a&&(c=Math.round(a*c+(1-a)*b.r),e=Math.round(a*e+(1-a)*b.g),f=Math.round(a*f+(1-a)*b.b));return new d({r:c,g:e,b:f})}Object.defineProperty(a,"__esModule",{value:!0});var t=/^#[0-9A-F]{3}$/i,x=/^#[0-9A-F]{6}$/i,n=new d({r:255,g:255,b:255});a.equal=function(a,b){return a&&b&&a.r===b.r&&a.g===b.g&&a.b===b.b&&a.a===b.a};a.normalizeHex=function(a){return a?"#"+a.trim().replace(/#/g,"").substr(0,6):""};a.normalizeColor=h;a.isValidHex=function(a){return b(a)||e(a)};a.isShorthandHex=b;a.isLonghandHex=
e;a.toHex=function(a){return h(a).toHex()};a.getContrastingColor=function(a){return m(a)?c(a):l(a,3)};a.isBright=m;a.darker=c;a.brighter=l;a.blendWithBackground=f;a.getColorTheme=function(a,b){void 0===b&&(b=n);a=f(a,b);return m(a)?"light":"dark"}})},"esri/widgets/Legend/styles/Classic":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper dojo/i18n!../../Legend/nls/Legend ../../../intl ../../../core/accessorSupport/decorators ../../Widget ./support/utils ../support/styleUtils ../../support/widget".split(" "),
function(g,a,d,h,b,e,m,c,l,f,t){return function(a){function c(b){b=a.call(this,b)||this;b.activeLayerInfos=null;b.type="classic";return b}d(c,a);c.prototype.render=function(){var a=this,c=this.activeLayerInfos,e=this.classes("esri-legend esri-widget--panel","esri-widget"),c=c&&c.toArray().map(function(b){return a._renderLegendForLayer(b)}).filter(function(a){return!!a});return t.tsx("div",{class:e},c&&c.length?c:t.tsx("div",{class:"esri-legend__message"},b.noLegend))};c.prototype._renderLegendForLayer=
function(a){var b=this,c;if(!a.ready)return null;var e=!!a.children.length,d="esri-legend__"+a.layer.uid+"-version-"+a.version,f=a.title?t.tsx("h3",{class:this.classes("esri-widget__heading","esri-legend__service-label")},a.title):null;if(e)return c=a.children.map(function(a){return b._renderLegendForLayer(a)}).toArray(),t.tsx("div",{key:d,class:this.classes("esri-legend__service","esri-legend__group-layer")},f,c);if((e=a.legendElements)&&!e.length)return null;e=e.map(function(c){return b._renderLegendForElement(c,
a.layer)}).filter(function(a){return!!a});if(!e.length)return null;var g=(c={},c["esri-legend__group-layer-child"]=!!a.parent,c);return t.tsx("div",{key:d,class:this.classes("esri-legend__service",g)},f,t.tsx("div",{class:"esri-legend__layer"},e))};c.prototype._renderLegendForElement=function(a,b,c){var e=this,d,g="color-ramp"===a.type,h="opacity-ramp"===a.type,m="size-ramp"===a.type,n=null;if("symbol-table"===a.type||m){var p=a.infos.map(function(c){return e._renderLegendForElementInfo(c,b,m,a.legendType)}).filter(function(a){return!!a});
p.length&&(n=t.tsx("div",{class:"esri-legend__layer-body"},p))}else"color-ramp"===a.type||"opacity-ramp"===a.type||"heatmap-ramp"===a.type||"stretch-ramp"===a.type?n=this._renderLegendForRamp(a,b.opacity):"relationship-ramp"===a.type&&(n=l.renderRelationshipRamp(a,this.id,b.opacity));if(!n)return null;var p=a.title,u=null;"string"===typeof p?u=p:p&&(u=f.getTitle(p,g||h),u=f.isRendererTitle(p,g||h)&&p.title?p.title+" ("+u+")":u);g=c?"esri-legend__layer-child-table":"esri-legend__layer-table";h=u?t.tsx("div",
{class:"esri-legend__layer-caption"},u):null;c=(d={},d["esri-legend__layer-table--size-ramp"]=m||!c,d);return t.tsx("div",{class:this.classes(g,c)},h,n)};c.prototype._renderLegendForRamp=function(a,c){var e=this,d=a.infos,g="heatmap-ramp"===a.type,h="stretch-ramp"===a.type,l=a.preview;l.className="esri-legend__color-ramp "+("opacity-ramp"===a.type?"esri-legend__opacity-ramp":"");null!=c&&(l.style.opacity=c.toString());a=d.map(function(a){return t.tsx("div",{class:a.label?"esri-legend__ramp-label":
null},g?b[a.label]:h?e._getStretchStopLabel(a):a.label)});c={height:l.style.height};return t.tsx("div",{class:"esri-legend__layer-row"},t.tsx("div",{class:"esri-legend__layer-cell esri-legend__layer-cell--symbols",styles:{width:"24px"}},t.tsx("div",{class:"esri-legend__ramps",bind:l,afterCreate:f.attachToNode})),t.tsx("div",{class:"esri-legend__layer-cell esri-legend__layer-cell--info"},t.tsx("div",{class:"esri-legend__ramp-labels",styles:c},a)))};c.prototype._getStretchStopLabel=function(a){return a.label?
b[a.label]+": "+e.formatNumber(a.value,{style:"decimal"}):""};c.prototype._renderLegendForElementInfo=function(a,b,c,e){var d,g;if(a.type)return this._renderLegendForElement(a,b,!0);var h=null;e=f.isImageryStretchedLegend(b,e);a.symbol&&a.preview?h=t.tsx("div",{class:"esri-legend__symbol",bind:a.preview,afterCreate:f.attachToNode}):a.src&&(h=this._renderImage(a,b,e));if(!h)return null;b=(d={},d["esri-legend__imagery-layer-info--stretched"]=e,d);c=(g={},g["esri-legend__imagery-layer-info--stretched"]=
e,g["esri-legend__size-ramp"]=!e&&c,g);return t.tsx("div",{class:"esri-legend__layer-row"},t.tsx("div",{class:this.classes("esri-legend__layer-cell esri-legend__layer-cell--symbols",c)},h),t.tsx("div",{class:this.classes("esri-legend__layer-cell esri-legend__layer-cell--info",b)},f.getTitle(a.label,!1)||""))};c.prototype._renderImage=function(a,b,c){var e,d=a.label,g=a.src,h=a.opacity;c=(e={},e["esri-legend__imagery-layer-image--stretched"]=c,e["esri-legend__symbol"]=!c,e);b={opacity:""+(null!=h?
h:b.opacity)};return t.tsx("img",{alt:f.getTitle(d,!1),src:g,border:0,width:a.width,height:a.height,class:this.classes(c),styles:b})};h([t.renderable(),m.property()],c.prototype,"activeLayerInfos",void 0);h([m.property({readOnly:!0})],c.prototype,"type",void 0);return c=h([m.subclass("esri.widgets.Legend.styles.Classic")],c)}(m.declared(c))})},"dojox/gfx/svg":function(){define("dojo/_base/lang dojo/_base/sniff dojo/_base/window dojo/dom dojo/_base/declare dojo/_base/array dojo/dom-geometry dojo/dom-attr dojo/_base/Color ./_base ./shape ./path".split(" "),
function(g,a,d,h,b,e,m,c,l,f,t,x){function n(a,b){return d.doc.createElementNS?d.doc.createElementNS(a,b):d.doc.createElement(b)}function p(a,b,c,e){return a.setAttributeNS?a.setAttributeNS(b,c,e):a.setAttribute(c,e)}function y(a){return u.useSvgWeb?d.doc.createTextNode(a,!0):d.doc.createTextNode(a)}var u=f.svg={};u.useSvgWeb="undefined"!=typeof window.svgweb;var k=navigator.userAgent,r=a("ios"),z=a("chrome")?"auto":"optimizeLegibility";u.xmlns={xlink:"http://www.w3.org/1999/xlink",svg:"http://www.w3.org/2000/svg"};
u.getRef=function(a){return a&&"none"!=a?a.match(/^url\(#.+\)$/)?h.byId(a.slice(5,-1)):a.match(/^#dojoUnique\d+$/)?h.byId(a.slice(1)):null:null};u.dasharray={solid:"none",shortdash:[4,1],shortdot:[1,1],shortdashdot:[4,1,1,1],shortdashdotdot:[4,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]};var q=0;u.Shape=b("dojox.gfx.svg.Shape",t.Shape,{destroy:function(){if(this.fillStyle&&"type"in this.fillStyle){var a=this.rawNode.getAttribute("fill");
(a=u.getRef(a))&&a.parentNode.removeChild(a)}this.clip&&(a=this.rawNode.getAttribute("clip-path"))&&(a=h.byId(a.match(/gfx_clip[\d]+/)[0]))&&a.parentNode.removeChild(a);t.Shape.prototype.destroy.apply(this,arguments)},setFill:function(a){if(!a)return this.fillStyle=null,this.rawNode.setAttribute("fill","none"),this.rawNode.setAttribute("fill-opacity",0),this;var b,c=function(a){this.setAttribute(a,b[a].toFixed(8))};if("object"==typeof a&&"type"in a){switch(a.type){case "linear":b=f.makeParameters(f.defaultLinearGradient,
a);a=this._setFillObject(b,"linearGradient");e.forEach(["x1","y1","x2","y2"],c,a);break;case "radial":b=f.makeParameters(f.defaultRadialGradient,a);a=this._setFillObject(b,"radialGradient");e.forEach(["cx","cy","r"],c,a);break;case "pattern":b=f.makeParameters(f.defaultPattern,a),a=this._setFillObject(b,"pattern"),e.forEach(["x","y","width","height"],c,a)}this.fillStyle=b;return this}this.fillStyle=b=f.normalizeColor(a);this.rawNode.setAttribute("fill",b.toCss());this.rawNode.setAttribute("fill-opacity",
b.a);this.rawNode.setAttribute("fill-rule","evenodd");return this},setStroke:function(a){var b=this.rawNode;if(!a)return this.strokeStyle=null,b.setAttribute("stroke","none"),b.setAttribute("stroke-opacity",0),this;if("string"==typeof a||g.isArray(a)||a instanceof l)a={color:a};a=this.strokeStyle=f.makeParameters(f.defaultStroke,a);a.color=f.normalizeColor(a.color);if(a){var c=0>a.width?0:a.width;b.setAttribute("stroke",a.color.toCss());b.setAttribute("stroke-opacity",a.color.a);b.setAttribute("stroke-width",
c);b.setAttribute("stroke-linecap",a.cap);"number"==typeof a.join?(b.setAttribute("stroke-linejoin","miter"),b.setAttribute("stroke-miterlimit",a.join)):b.setAttribute("stroke-linejoin",a.join);var e=a.style.toLowerCase();e in u.dasharray&&(e=u.dasharray[e]);if(e instanceof Array){var e=g._toArray(e),d;for(d=0;d<e.length;++d)e[d]*=c;if("butt"!=a.cap){for(d=0;d<e.length;d+=2)e[d]-=c,1>e[d]&&(e[d]=1);for(d=1;d<e.length;d+=2)e[d]+=c}e=e.join(",")}b.setAttribute("stroke-dasharray",e);b.setAttribute("dojoGfxStrokeStyle",
a.style)}return this},_getParentSurface:function(){for(var a=this.parent;a&&!(a instanceof f.Surface);a=a.parent);return a},_setFillObject:function(a,b){var c=u.xmlns.svg;this.fillStyle=a;var e=this._getParentSurface().defNode,d=this.rawNode.getAttribute("fill");if(d=u.getRef(d))if(d.tagName.toLowerCase()!=b.toLowerCase()){var g=d.id;d.parentNode.removeChild(d);d=n(c,b);d.setAttribute("id",g);e.appendChild(d)}else for(;d.childNodes.length;)d.removeChild(d.lastChild);else d=n(c,b),d.setAttribute("id",
f._base._getUniqueId()),e.appendChild(d);if("pattern"==b)d.setAttribute("patternUnits","userSpaceOnUse"),c=n(c,"image"),c.setAttribute("x",0),c.setAttribute("y",0),c.setAttribute("width",(0>a.width?0:a.width).toFixed(8)),c.setAttribute("height",(0>a.height?0:a.height).toFixed(8)),p(c,u.xmlns.xlink,"xlink:href",a.src),d.appendChild(c);else for(d.setAttribute("gradientUnits","userSpaceOnUse"),b=0;b<a.colors.length;++b){var e=a.colors[b],g=n(c,"stop"),h=e.color=f.normalizeColor(e.color);g.setAttribute("offset",
e.offset.toFixed(8));g.setAttribute("stop-color",h.toCss());g.setAttribute("stop-opacity",h.a);d.appendChild(g)}this.rawNode.setAttribute("fill","url(#"+d.getAttribute("id")+")");this.rawNode.removeAttribute("fill-opacity");this.rawNode.setAttribute("fill-rule","evenodd");return d},_applyTransform:function(){if(this.matrix){var a=this.matrix;this.rawNode.setAttribute("transform","matrix("+a.xx.toFixed(8)+","+a.yx.toFixed(8)+","+a.xy.toFixed(8)+","+a.yy.toFixed(8)+","+a.dx.toFixed(8)+","+a.dy.toFixed(8)+
")")}else this.rawNode.removeAttribute("transform");return this},setRawNode:function(a){a=this.rawNode=a;"image"!=this.shape.type&&a.setAttribute("fill","none");a.setAttribute("fill-opacity",0);a.setAttribute("stroke","none");a.setAttribute("stroke-opacity",0);a.setAttribute("stroke-width",1);a.setAttribute("stroke-linecap","butt");a.setAttribute("stroke-linejoin","miter");a.setAttribute("stroke-miterlimit",4);a.__gfxObject__=this},setShape:function(a){this.shape=f.makeParameters(this.shape,a);for(var b in this.shape)if("type"!=
b){a=this.shape[b];if("width"===b||"height"===b)a=0>a?0:a;this.rawNode.setAttribute(b,a)}this.bbox=null;return this},_moveToFront:function(){this.rawNode.parentNode.appendChild(this.rawNode);return this},_moveToBack:function(){this.rawNode.parentNode.insertBefore(this.rawNode,this.rawNode.parentNode.firstChild);return this},setClip:function(a){this.inherited(arguments);var b=a?"width"in a?"rect":"cx"in a?"ellipse":"points"in a?"polyline":"d"in a?"path":null:null;if(a&&!b)return this;"polyline"===
b&&(a=g.clone(a),a.points=a.points.join(","));var e,d=c.get(this.rawNode,"clip-path");d&&(e=h.byId(d.match(/gfx_clip[\d]+/)[0]))&&e.removeChild(e.childNodes[0]);a?(e?(b=n(u.xmlns.svg,b),e.appendChild(b)):(d="gfx_clip"+ ++q,this.rawNode.setAttribute("clip-path","url(#"+d+")"),e=n(u.xmlns.svg,"clipPath"),b=n(u.xmlns.svg,b),e.appendChild(b),this.rawNode.parentNode.insertBefore(e,this.rawNode),c.set(e,"id",d)),c.set(b,a)):(this.rawNode.removeAttribute("clip-path"),e&&e.parentNode.removeChild(e));return this},
_removeClipNode:function(){var a,b=c.get(this.rawNode,"clip-path");b&&(a=h.byId(b.match(/gfx_clip[\d]+/)[0]))&&a.parentNode.removeChild(a);return a}});u.Group=b("dojox.gfx.svg.Group",u.Shape,{constructor:function(){t.Container._init.call(this)},setRawNode:function(a){this.rawNode=a;this.rawNode.__gfxObject__=this},destroy:function(){this.clear(!0);u.Shape.prototype.destroy.apply(this,arguments)}});u.Group.nodeType="g";u.Rect=b("dojox.gfx.svg.Rect",[u.Shape,t.Rect],{setShape:function(a){this.shape=
f.makeParameters(this.shape,a);this.bbox=null;for(var b in this.shape)if("type"!=b&&"r"!=b){a=this.shape[b];if("width"===b||"height"===b)a=0>a?0:a;this.rawNode.setAttribute(b,a)}null!=this.shape.r&&(this.rawNode.setAttribute("ry",this.shape.r),this.rawNode.setAttribute("rx",this.shape.r));return this}});u.Rect.nodeType="rect";u.Ellipse=b("dojox.gfx.svg.Ellipse",[u.Shape,t.Ellipse],{});u.Ellipse.nodeType="ellipse";u.Circle=b("dojox.gfx.svg.Circle",[u.Shape,t.Circle],{});u.Circle.nodeType="circle";
u.Line=b("dojox.gfx.svg.Line",[u.Shape,t.Line],{});u.Line.nodeType="line";u.Polyline=b("dojox.gfx.svg.Polyline",[u.Shape,t.Polyline],{setShape:function(a,b){a&&a instanceof Array?(this.shape=f.makeParameters(this.shape,{points:a}),b&&this.shape.points.length&&this.shape.points.push(this.shape.points[0])):this.shape=f.makeParameters(this.shape,a);this.bbox=null;this._normalizePoints();a=[];b=this.shape.points;for(var c=0;c<b.length;++c)a.push(b[c].x.toFixed(8),b[c].y.toFixed(8));this.rawNode.setAttribute("points",
a.join(" "));return this}});u.Polyline.nodeType="polyline";u.Image=b("dojox.gfx.svg.Image",[u.Shape,t.Image],{setShape:function(a){this.shape=f.makeParameters(this.shape,a);this.bbox=null;a=this.rawNode;for(var b in this.shape)if("type"!=b&&"src"!=b){var c=this.shape[b];if("width"===b||"height"===b)c=0>c?0:c;a.setAttribute(b,c)}a.setAttribute("preserveAspectRatio","none");p(a,u.xmlns.xlink,"xlink:href",this.shape.src);a.__gfxObject__=this;return this}});u.Image.nodeType="image";u.Text=b("dojox.gfx.svg.Text",
[u.Shape,t.Text],{setShape:function(a){this.shape=f.makeParameters(this.shape,a);this.bbox=null;a=this.rawNode;var b=this.shape;a.setAttribute("x",b.x);a.setAttribute("y",b.y);a.setAttribute("text-anchor",b.align);a.setAttribute("text-decoration",b.decoration);a.setAttribute("rotate",b.rotated?90:0);a.setAttribute("kerning",b.kerning?"auto":0);a.setAttribute("text-rendering",z);a.firstChild?a.firstChild.nodeValue=b.text:a.appendChild(y(b.text));return this},getTextWidth:function(){var a=this.rawNode,
b=a.parentNode,a=a.cloneNode(!0);a.style.visibility="hidden";var c=0,e=a.firstChild.nodeValue;b.appendChild(a);if(""!=e)for(;!c;)c=a.getBBox?parseInt(a.getBBox().width):68;b.removeChild(a);return c},getBoundingBox:function(){var a=null;if(this.getShape().text)try{a=this.rawNode.getBBox()}catch(C){a={x:0,y:0,width:0,height:0}}return a}});u.Text.nodeType="text";u.Path=b("dojox.gfx.svg.Path",[u.Shape,x.Path],{_updateWithSegment:function(a){this.inherited(arguments);"string"==typeof this.shape.path&&
this.rawNode.setAttribute("d",this.shape.path)},setShape:function(a){this.inherited(arguments);this.shape.path?this.rawNode.setAttribute("d",this.shape.path):this.rawNode.removeAttribute("d");return this}});u.Path.nodeType="path";u.TextPath=b("dojox.gfx.svg.TextPath",[u.Shape,x.TextPath],{_updateWithSegment:function(a){this.inherited(arguments);this._setTextPath()},setShape:function(a){this.inherited(arguments);this._setTextPath();return this},_setTextPath:function(){if("string"==typeof this.shape.path){var a=
this.rawNode;if(!a.firstChild){var b=n(u.xmlns.svg,"textPath"),c=y("");b.appendChild(c);a.appendChild(b)}b=(b=a.firstChild.getAttributeNS(u.xmlns.xlink,"href"))&&u.getRef(b);if(!b&&(c=this._getParentSurface())){var c=c.defNode,b=n(u.xmlns.svg,"path"),e=f._base._getUniqueId();b.setAttribute("id",e);c.appendChild(b);p(a.firstChild,u.xmlns.xlink,"xlink:href","#"+e)}b&&b.setAttribute("d",this.shape.path)}},_setText:function(){var a=this.rawNode;if(!a.firstChild){var b=n(u.xmlns.svg,"textPath"),c=y("");
b.appendChild(c);a.appendChild(b)}a=a.firstChild;b=this.text;a.setAttribute("alignment-baseline","middle");switch(b.align){case "middle":a.setAttribute("text-anchor","middle");a.setAttribute("startOffset","50%");break;case "end":a.setAttribute("text-anchor","end");a.setAttribute("startOffset","100%");break;default:a.setAttribute("text-anchor","start"),a.setAttribute("startOffset","0%")}a.setAttribute("baseline-shift","0.5ex");a.setAttribute("text-decoration",b.decoration);a.setAttribute("rotate",
b.rotated?90:0);a.setAttribute("kerning",b.kerning?"auto":0);a.firstChild.data=b.text}});u.TextPath.nodeType="text";var E=534<function(){var a=/WebKit\/(\d*)/.exec(k);return a?a[1]:0}();u.Surface=b("dojox.gfx.svg.Surface",t.Surface,{constructor:function(){t.Container._init.call(this)},destroy:function(){t.Container.clear.call(this,!0);this.defNode=null;this.inherited(arguments)},setDimensions:function(a,b){if(!this.rawNode)return this;a=0>a?0:a;b=0>b?0:b;this.rawNode.setAttribute("width",a);this.rawNode.setAttribute("height",
b);E&&(this.rawNode.style.width=a,this.rawNode.style.height=b);return this},getDimensions:function(){return this.rawNode?{width:f.normalizedLength(this.rawNode.getAttribute("width")),height:f.normalizedLength(this.rawNode.getAttribute("height"))}:null}});u.createSurface=function(a,b,c){var e=new u.Surface;e.rawNode=n(u.xmlns.svg,"svg");e.rawNode.setAttribute("overflow","hidden");b&&e.rawNode.setAttribute("width",0>b?0:b);c&&e.rawNode.setAttribute("height",0>c?0:c);b=n(u.xmlns.svg,"defs");e.rawNode.appendChild(b);
e.defNode=b;e._parent=h.byId(a);e._parent.appendChild(e.rawNode);f._base._fixMsTouchAction(e);return e};a={_setFont:function(){var a=this.fontStyle;this.rawNode.setAttribute("font-style",a.style);this.rawNode.setAttribute("font-variant",a.variant);this.rawNode.setAttribute("font-weight",a.weight);this.rawNode.setAttribute("font-size",a.size);this.rawNode.setAttribute("font-family",a.family)}};var A=t.Container;b=u.Container={openBatch:function(){if(!this._batch){var a;a=u.useSvgWeb?d.doc.createDocumentFragment(!0):
d.doc.createDocumentFragment();this.fragment=a}++this._batch;return this},closeBatch:function(){this._batch=0<this._batch?--this._batch:0;this.fragment&&!this._batch&&(this.rawNode.appendChild(this.fragment),delete this.fragment);return this},add:function(a){this!=a.getParent()&&(this.fragment?this.fragment.appendChild(a.rawNode):this.rawNode.appendChild(a.rawNode),A.add.apply(this,arguments),a.setClip(a.clip));return this},remove:function(a,b){this==a.getParent()&&(this.rawNode==a.rawNode.parentNode&&
this.rawNode.removeChild(a.rawNode),this.fragment&&this.fragment==a.rawNode.parentNode&&this.fragment.removeChild(a.rawNode),a._removeClipNode(),A.remove.apply(this,arguments));return this},clear:function(){for(var a=this.rawNode;a.lastChild;)a.removeChild(a.lastChild);var b=this.defNode;if(b){for(;b.lastChild;)b.removeChild(b.lastChild);a.appendChild(b)}return A.clear.apply(this,arguments)},getBoundingBox:A.getBoundingBox,_moveChildToFront:A._moveChildToFront,_moveChildToBack:A._moveChildToBack};
x=u.Creator={createObject:function(a,b){if(!this.rawNode)return null;var c=new a;a=n(u.xmlns.svg,a.nodeType);c.setRawNode(a);c.setShape(b);this.add(c);return c}};g.extend(u.Text,a);g.extend(u.TextPath,a);g.extend(u.Group,b);g.extend(u.Group,t.Creator);g.extend(u.Group,x);g.extend(u.Surface,b);g.extend(u.Surface,t.Creator);g.extend(u.Surface,x);u.fixTarget=function(a,b){a.gfxTarget||(a.gfxTarget=r&&a.target.wholeText?a.target.parentElement.__gfxObject__:a.target.__gfxObject__);return!0};u.useSvgWeb&&
(u.createSurface=function(a,b,c){var e=new u.Surface;b=0>b?0:b;c=0>c?0:c;if(!b||!c){var d=m.position(a);b=b||d.w;c=c||d.h}a=h.byId(a);var d=a.id?a.id+"_svgweb":f._base._getUniqueId(),g=n(u.xmlns.svg,"svg");g.id=d;g.setAttribute("width",b);g.setAttribute("height",c);svgweb.appendChild(g,a);g.addEventListener("SVGLoad",function(){e.rawNode=this;e.isLoaded=!0;var a=n(u.xmlns.svg,"defs");e.rawNode.appendChild(a);e.defNode=a;if(e.onLoad)e.onLoad(e)},!1);e.isLoaded=!1;return e},u.Surface.extend({destroy:function(){var a=
this.rawNode;svgweb.removeChild(a,a.parentNode)}}),a={connect:function(a,b,c){"on"===a.substring(0,2)&&(a=a.substring(2));c=2==arguments.length?b:g.hitch(b,c);this.getEventSource().addEventListener(a,c,!1);return[this,a,c]},disconnect:function(a){this.getEventSource().removeEventListener(a[1],a[2],!1);delete a[0]}},g.extend(u.Shape,a),g.extend(u.Surface,a));return u})},"dojox/gfx/_base":function(){define("dojo/_base/kernel dojo/_base/lang dojo/_base/Color dojo/_base/sniff dojo/_base/window dojo/_base/array dojo/dom dojo/dom-construct dojo/dom-geometry".split(" "),
function(g,a,d,h,b,e,m,c,l){var f=a.getObject("dojox.gfx",!0),t=f._base={};f._hasClass=function(a,b){return(a=a.getAttribute("className"))&&0<=(" "+a+" ").indexOf(" "+b+" ")};f._addClass=function(a,b){var c=a.getAttribute("className")||"";(!c||0>(" "+c+" ").indexOf(" "+b+" "))&&a.setAttribute("className",c+(c?" ":"")+b)};f._removeClass=function(a,b){var c=a.getAttribute("className");c&&a.setAttribute("className",c.replace(new RegExp("(^|\\s+)"+b+"(\\s+|$)"),"$1$2"))};t._getFontMeasurements=function(){var a=
{"1em":0,"1ex":0,"100%":0,"12pt":0,"16px":0,"xx-small":0,"x-small":0,small:0,medium:0,large:0,"x-large":0,"xx-large":0},e,d;h("ie")&&(d=b.doc.documentElement.style.fontSize||"",d||(b.doc.documentElement.style.fontSize="100%"));var f=c.create("div",{style:{position:"absolute",left:"0",top:"-100px",width:"30px",height:"1000em",borderWidth:"0",margin:"0",padding:"0",outline:"none",lineHeight:"1",overflow:"hidden"}},b.body());for(e in a)f.style.fontSize=e,a[e]=16*Math.round(12*f.offsetHeight/16)/12/1E3;
h("ie")&&(b.doc.documentElement.style.fontSize=d);b.body().removeChild(f);return a};var x=null;t._getCachedFontMeasurements=function(a){if(a||!x)x=t._getFontMeasurements();return x};var n=null,p={};t._getTextBox=function(a,e,d){var f,g,h=arguments.length,k;n||(n=c.create("div",{style:{position:"absolute",top:"-10000px",left:"0",visibility:"hidden"}},b.body()));f=n;f.className="";g=f.style;g.borderWidth="0";g.margin="0";g.padding="0";g.outline="0";if(1<h&&e)for(k in e)k in p||(g[k]=e[k]);2<h&&d&&(f.className=
d);f.innerHTML=a;f.getBoundingClientRect?(g=f.getBoundingClientRect(),g={l:g.left,t:g.top,w:g.width||g.right-g.left,h:g.height||g.bottom-g.top}):g=l.getMarginBox(f);f.innerHTML="";return g};t._computeTextLocation=function(a,b,c,e){var d={};switch(a.align){case "end":d.x=a.x-b;break;case "middle":d.x=a.x-b/2;break;default:d.x=a.x}d.y=a.y-c*(e?.75:1);return d};t._computeTextBoundingBox=function(a){if(!f._base._isRendered(a))return{x:0,y:0,width:0,height:0};var b;b=a.getShape();var c=a.getFont()||f.defaultFont;
a=a.getTextWidth();c=f.normalizedLength(c.size);b=t._computeTextLocation(b,a,c,!0);return{x:b.x,y:b.y,width:a,height:c}};t._isRendered=function(a){for(a=a.parent;a&&a.getParent;)a=a.parent;return null!==a};var y=0;t._getUniqueId=function(){var a;do a=g._scopeName+"xUnique"+ ++y;while(m.byId(a));return a};var u=h("pointer-events")?"touchAction":null;t._fixMsTouchAction=u?function(a){a.rawNode.style[u]="none"}:function(){};a.mixin(f,{defaultPath:{type:"path",path:""},defaultPolyline:{type:"polyline",
points:[]},defaultRect:{type:"rect",x:0,y:0,width:100,height:100,r:0},defaultEllipse:{type:"ellipse",cx:0,cy:0,rx:200,ry:100},defaultCircle:{type:"circle",cx:0,cy:0,r:100},defaultLine:{type:"line",x1:0,y1:0,x2:100,y2:100},defaultImage:{type:"image",x:0,y:0,width:0,height:0,src:""},defaultText:{type:"text",x:0,y:0,text:"",align:"start",decoration:"none",rotated:!1,kerning:!0},defaultTextPath:{type:"textpath",text:"",align:"start",decoration:"none",rotated:!1,kerning:!0},defaultStroke:{type:"stroke",
color:"black",style:"solid",width:1,cap:"butt",join:4},defaultLinearGradient:{type:"linear",x1:0,y1:0,x2:100,y2:100,colors:[{offset:0,color:"black"},{offset:1,color:"white"}]},defaultRadialGradient:{type:"radial",cx:0,cy:0,r:100,colors:[{offset:0,color:"black"},{offset:1,color:"white"}]},defaultPattern:{type:"pattern",x:0,y:0,width:0,height:0,src:""},defaultFont:{type:"font",style:"normal",variant:"normal",weight:"normal",size:"10pt",family:"serif"},getDefault:function(){var a={};return function(b){var c=
a[b];if(c)return new c;c=a[b]=new Function;c.prototype=f["default"+b];return new c}}(),normalizeColor:function(a){return a instanceof d?a:new d(a)},normalizeParameters:function(a,b){var c;if(b){var e={};for(c in a)c in b&&!(c in e)&&(a[c]=b[c])}return a},makeParameters:function(b,c){var e=null;if(!c)return a.delegate(b);var d={};for(e in b)e in d||(d[e]=a.clone(e in c?c[e]:b[e]));return d},formatNumber:function(a,b){var c=a.toString();if(0<=c.indexOf("e"))c=a.toFixed(4);else{var e=c.indexOf(".");
0<=e&&5<c.length-e&&(c=a.toFixed(4))}return 0>a?c:b?" "+c:c},makeFontString:function(a){return a.style+" "+a.variant+" "+a.weight+" "+a.size+" "+a.family},splitFontString:function(a){var b=f.getDefault("Font");a=a.split(/\s+/);if(!(5>a.length)){b.style=a[0];b.variant=a[1];b.weight=a[2];var c=a[3].indexOf("/");b.size=0>c?a[3]:a[3].substring(0,c);var e=4;0>c&&("/"==a[4]?e=6:"/"==a[4].charAt(0)&&(e=5));e<a.length&&(b.family=a.slice(e).join(" "))}return b},cm_in_pt:72/2.54,mm_in_pt:7.2/2.54,px_in_pt:function(){return f._base._getCachedFontMeasurements()["12pt"]/
12},pt2px:function(a){return a*f.px_in_pt()},px2pt:function(a){return a/f.px_in_pt()},normalizedLength:function(a){if(0===a.length)return 0;if(2<a.length){var b=f.px_in_pt(),c=parseFloat(a);switch(a.slice(-2)){case "px":return c;case "pt":return c*b;case "in":return 72*c*b;case "pc":return 12*c*b;case "mm":return c*f.mm_in_pt*b;case "cm":return c*f.cm_in_pt*b}}return parseFloat(a)},pathVmlRegExp:/([A-Za-z]+)|(\d+(\.\d+)?)|(\.\d+)|(-\d+(\.\d+)?)|(-\.\d+)/g,pathSvgRegExp:/([A-DF-Za-df-z])|([-+]?\d*[.]?\d+(?:[eE][-+]?\d+)?)/g,
equalSources:function(a,b){return a&&b&&a===b},switchTo:function(a){var b="string"==typeof a?f[a]:a;b&&(e.forEach("Group Rect Ellipse Circle Line Polyline Image Text Path TextPath Surface createSurface fixTarget".split(" "),function(a){f[a]=b[a]}),"string"==typeof a?f.renderer=a:e.some(["svg","vml","canvas","canvasWithEvents","silverlight"],function(a){return f.renderer=f[a]&&f[a].Surface===f.Surface?a:null}))}});return f})},"dojox/gfx/shape":function(){define("./_base dojo/_base/lang dojo/_base/declare dojo/_base/kernel dojo/_base/sniff dojo/on dojo/_base/array dojo/dom-construct dojo/_base/Color ./matrix".split(" "),
function(g,a,d,h,b,e,m,c,l,f){function t(a,b){for(var c=a.length-1;b<c;)a[b]=a[++b];a.length=c}var x=g.shape={};x.Shape=d("dojox.gfx.shape.Shape",null,{constructor:function(){this.parentMatrix=this.parent=this.bbox=this.strokeStyle=this.fillStyle=this.matrix=this.shape=this.rawNode=null;if(b("gfxRegistry")){var a=x.register(this);this.getUID=function(){return a}}},destroy:function(){b("gfxRegistry")&&x.dispose(this);this.rawNode&&"__gfxObject__"in this.rawNode&&(this.rawNode.__gfxObject__=null);this.rawNode=
null},getNode:function(){return this.rawNode},getShape:function(){return this.shape},getTransform:function(){return this.matrix},getFill:function(){return this.fillStyle},getStroke:function(){return this.strokeStyle},getParent:function(){return this.parent},getBoundingBox:function(){return this.bbox},getTransformedBoundingBox:function(){var a=this.getBoundingBox();if(!a)return null;var b=this._getRealMatrix();return[f.multiplyPoint(b,a.x,a.y),f.multiplyPoint(b,a.x+a.width,a.y),f.multiplyPoint(b,a.x+
a.width,a.y+a.height),f.multiplyPoint(b,a.x,a.y+a.height)]},getEventSource:function(){return this.rawNode},setClip:function(a){this.clip=a},getClip:function(){return this.clip},setShape:function(a){this.shape=g.makeParameters(this.shape,a);this.bbox=null;return this},setFill:function(a){if(!a)return this.fillStyle=null,this;var b=null;if("object"==typeof a&&"type"in a)switch(a.type){case "linear":b=g.makeParameters(g.defaultLinearGradient,a);break;case "radial":b=g.makeParameters(g.defaultRadialGradient,
a);break;case "pattern":b=g.makeParameters(g.defaultPattern,a)}else b=g.normalizeColor(a);this.fillStyle=b;return this},setStroke:function(b){if(!b)return this.strokeStyle=null,this;if("string"==typeof b||a.isArray(b)||b instanceof l)b={color:b};b=this.strokeStyle=g.makeParameters(g.defaultStroke,b);b.color=g.normalizeColor(b.color);return this},setTransform:function(a){this.matrix=f.clone(a?f.normalize(a):f.identity);return this._applyTransform()},_applyTransform:function(){return this},moveToFront:function(){var a=
this.getParent();a&&(a._moveChildToFront(this),this._moveToFront());return this},moveToBack:function(){var a=this.getParent();a&&(a._moveChildToBack(this),this._moveToBack());return this},_moveToFront:function(){},_moveToBack:function(){},applyRightTransform:function(a){return a?this.setTransform([this.matrix,a]):this},applyLeftTransform:function(a){return a?this.setTransform([a,this.matrix]):this},applyTransform:function(a){return a?this.setTransform([this.matrix,a]):this},removeShape:function(a){this.parent&&
this.parent.remove(this,a);return this},_setParent:function(a,b){this.parent=a;return this._updateParentMatrix(b)},_updateParentMatrix:function(a){this.parentMatrix=a?f.clone(a):null;return this._applyTransform()},_getRealMatrix:function(){for(var a=this.matrix,b=this.parent;b;)b.matrix&&(a=f.multiply(b.matrix,a)),b=b.parent;return a}});x._eventsProcessing={on:function(a,b){return e(this.getEventSource(),a,x.fixCallback(this,g.fixTarget,b))},connect:function(b,c,e){"on"==b.substring(0,2)&&(b=b.substring(2));
return this.on(b,e?a.hitch(c,e):c)},disconnect:function(a){return a.remove()}};x.fixCallback=function(b,c,e,d){d||(d=e,e=null);if(a.isString(d)){e=e||h.global;if(!e[d])throw['dojox.gfx.shape.fixCallback: scope["',d,'"] is null (scope\x3d"',e,'")'].join("");return function(a){return c(a,b)?e[d].apply(e,arguments||[]):void 0}}return e?function(a){return c(a,b)?d.apply(e,arguments||[]):void 0}:function(a){return c(a,b)?d.apply(e,arguments):void 0}};a.extend(x.Shape,x._eventsProcessing);x.Container={_init:function(){this.children=
[];this._batch=0},openBatch:function(){return this},closeBatch:function(){return this},add:function(a){var b=a.getParent();b&&b.remove(a,!0);this.children.push(a);return a._setParent(this,this._getRealMatrix())},remove:function(a,b){for(var c=0;c<this.children.length;++c)if(this.children[c]==a){b||(a.parent=null,a.parentMatrix=null);t(this.children,c);break}return this},clear:function(a){for(var b,c=0;c<this.children.length;++c)b=this.children[c],b.parent=null,b.parentMatrix=null,a&&b.destroy();this.children=
[];return this},getBoundingBox:function(){if(this.children){var a=null;m.forEach(this.children,function(b){var c=b.getBoundingBox();c&&((b=b.getTransform())&&(c=f.multiplyRectangle(b,c)),a?(a.x=Math.min(a.x,c.x),a.y=Math.min(a.y,c.y),a.endX=Math.max(a.endX,c.x+c.width),a.endY=Math.max(a.endY,c.y+c.height)):a={x:c.x,y:c.y,endX:c.x+c.width,endY:c.y+c.height})});a&&(a.width=a.endX-a.x,a.height=a.endY-a.y);return a}return null},_moveChildToFront:function(a){for(var b=0;b<this.children.length;++b)if(this.children[b]==
a){t(this.children,b);this.children.push(a);break}return this},_moveChildToBack:function(a){for(var b=0;b<this.children.length;++b)if(this.children[b]==a){t(this.children,b);this.children.unshift(a);break}return this}};x.Surface=d("dojox.gfx.shape.Surface",null,{constructor:function(){this._parent=this.rawNode=null;this._nodes=[];this._events=[]},destroy:function(){m.forEach(this._nodes,c.destroy);this._nodes=[];m.forEach(this._events,function(a){a&&a.remove()});this._events=[];this.rawNode=null;
if(b("ie"))for(;this._parent.lastChild;)c.destroy(this._parent.lastChild);else this._parent.innerHTML="";this._parent=null},getEventSource:function(){return this.rawNode},_getRealMatrix:function(){return null},isLoaded:!0,onLoad:function(a){},whenLoaded:function(b,c){var d=a.hitch(b,c);if(this.isLoaded)d(this);else e.once(this,"load",function(a){d(a)})}});a.extend(x.Surface,x._eventsProcessing);x.Rect=d("dojox.gfx.shape.Rect",x.Shape,{constructor:function(a){this.shape=g.getDefault("Rect");this.rawNode=
a},getBoundingBox:function(){return this.shape}});x.Ellipse=d("dojox.gfx.shape.Ellipse",x.Shape,{constructor:function(a){this.shape=g.getDefault("Ellipse");this.rawNode=a},getBoundingBox:function(){if(!this.bbox){var a=this.shape;this.bbox={x:a.cx-a.rx,y:a.cy-a.ry,width:2*a.rx,height:2*a.ry}}return this.bbox}});x.Circle=d("dojox.gfx.shape.Circle",x.Shape,{constructor:function(a){this.shape=g.getDefault("Circle");this.rawNode=a},getBoundingBox:function(){if(!this.bbox){var a=this.shape;this.bbox={x:a.cx-
a.r,y:a.cy-a.r,width:2*a.r,height:2*a.r}}return this.bbox}});x.Line=d("dojox.gfx.shape.Line",x.Shape,{constructor:function(a){this.shape=g.getDefault("Line");this.rawNode=a},getBoundingBox:function(){if(!this.bbox){var a=this.shape;this.bbox={x:Math.min(a.x1,a.x2),y:Math.min(a.y1,a.y2),width:Math.abs(a.x2-a.x1),height:Math.abs(a.y2-a.y1)}}return this.bbox}});x.Polyline=d("dojox.gfx.shape.Polyline",x.Shape,{constructor:function(a){this.shape=g.getDefault("Polyline");this.rawNode=a},setShape:function(a,
b){a&&a instanceof Array?(this.inherited(arguments,[{points:a}]),b&&this.shape.points.length&&this.shape.points.push(this.shape.points[0])):this.inherited(arguments,[a]);return this},_normalizePoints:function(){var a=this.shape.points,b=a&&a.length;if(b&&"number"==typeof a[0]){for(var c=[],e=0;e<b;e+=2)c.push({x:a[e],y:a[e+1]});this.shape.points=c}},getBoundingBox:function(){if(!this.bbox&&this.shape.points.length){for(var a=this.shape.points,b=a.length,c=a[0],e=c.x,d=c.y,f=c.x,g=c.y,h=1;h<b;++h)c=
a[h],e>c.x&&(e=c.x),f<c.x&&(f=c.x),d>c.y&&(d=c.y),g<c.y&&(g=c.y);this.bbox={x:e,y:d,width:f-e,height:g-d}}return this.bbox}});x.Image=d("dojox.gfx.shape.Image",x.Shape,{constructor:function(a){this.shape=g.getDefault("Image");this.rawNode=a},getBoundingBox:function(){return this.shape},setStroke:function(){return this},setFill:function(){return this}});x.Text=d(x.Shape,{constructor:function(a){this.fontStyle=null;this.shape=g.getDefault("Text");this.rawNode=a},getFont:function(){return this.fontStyle},
setFont:function(a){this.fontStyle="string"==typeof a?g.splitFontString(a):g.makeParameters(g.defaultFont,a);this._setFont();return this},getBoundingBox:function(){var a=null;this.getShape().text&&(a=g._base._computeTextBoundingBox(this));return a}});x.Creator={createShape:function(a){switch(a.type){case g.defaultPath.type:return this.createPath(a);case g.defaultRect.type:return this.createRect(a);case g.defaultCircle.type:return this.createCircle(a);case g.defaultEllipse.type:return this.createEllipse(a);
case g.defaultLine.type:return this.createLine(a);case g.defaultPolyline.type:return this.createPolyline(a);case g.defaultImage.type:return this.createImage(a);case g.defaultText.type:return this.createText(a);case g.defaultTextPath.type:return this.createTextPath(a)}return null},createGroup:function(){return this.createObject(g.Group)},createRect:function(a){return this.createObject(g.Rect,a)},createEllipse:function(a){return this.createObject(g.Ellipse,a)},createCircle:function(a){return this.createObject(g.Circle,
a)},createLine:function(a){return this.createObject(g.Line,a)},createPolyline:function(a){return this.createObject(g.Polyline,a)},createImage:function(a){return this.createObject(g.Image,a)},createText:function(a){return this.createObject(g.Text,a)},createPath:function(a){return this.createObject(g.Path,a)},createTextPath:function(a){return this.createObject(g.TextPath,{}).setText(a)},createObject:function(a,b){return null}};return x})},"dojox/gfx/matrix":function(){define(["./_base","dojo/_base/lang"],
function(g,a){var d=g.matrix={},h={};d._degToRad=function(a){return h[a]||(h[a]=Math.PI*a/180)};d._radToDeg=function(a){return a/Math.PI*180};d.Matrix2D=function(b){if(b)if("number"==typeof b)this.xx=this.yy=b;else if(b instanceof Array){if(0<b.length){for(var e=d.normalize(b[0]),g=1;g<b.length;++g){var c=e,h=d.normalize(b[g]),e=new d.Matrix2D;e.xx=c.xx*h.xx+c.xy*h.yx;e.xy=c.xx*h.xy+c.xy*h.yy;e.yx=c.yx*h.xx+c.yy*h.yx;e.yy=c.yx*h.xy+c.yy*h.yy;e.dx=c.xx*h.dx+c.xy*h.dy+c.dx;e.dy=c.yx*h.dx+c.yy*h.dy+
c.dy}a.mixin(this,e)}}else a.mixin(this,b)};a.extend(d.Matrix2D,{xx:1,xy:0,yx:0,yy:1,dx:0,dy:0});a.mixin(d,{identity:new d.Matrix2D,flipX:new d.Matrix2D({xx:-1}),flipY:new d.Matrix2D({yy:-1}),flipXY:new d.Matrix2D({xx:-1,yy:-1}),translate:function(a,e){return 1<arguments.length?new d.Matrix2D({dx:a,dy:e}):new d.Matrix2D({dx:a.x,dy:a.y})},scale:function(a,e){return 1<arguments.length?new d.Matrix2D({xx:a,yy:e}):"number"==typeof a?new d.Matrix2D({xx:a,yy:a}):new d.Matrix2D({xx:a.x,yy:a.y})},rotate:function(a){var b=
Math.cos(a);a=Math.sin(a);return new d.Matrix2D({xx:b,xy:-a,yx:a,yy:b})},rotateg:function(a){return d.rotate(d._degToRad(a))},skewX:function(a){return new d.Matrix2D({xy:Math.tan(a)})},skewXg:function(a){return d.skewX(d._degToRad(a))},skewY:function(a){return new d.Matrix2D({yx:Math.tan(a)})},skewYg:function(a){return d.skewY(d._degToRad(a))},reflect:function(a,e){1==arguments.length&&(e=a.y,a=a.x);var b=a*a,c=e*e,g=b+c,f=2*a*e/g;return new d.Matrix2D({xx:2*b/g-1,xy:f,yx:f,yy:2*c/g-1})},project:function(a,
e){1==arguments.length&&(e=a.y,a=a.x);var b=a*a,c=e*e,g=b+c,f=a*e/g;return new d.Matrix2D({xx:b/g,xy:f,yx:f,yy:c/g})},normalize:function(a){return a instanceof d.Matrix2D?a:new d.Matrix2D(a)},isIdentity:function(a){return 1==a.xx&&0==a.xy&&0==a.yx&&1==a.yy&&0==a.dx&&0==a.dy},clone:function(a){var b=new d.Matrix2D,g;for(g in a)"number"==typeof a[g]&&"number"==typeof b[g]&&b[g]!=a[g]&&(b[g]=a[g]);return b},invert:function(a){a=d.normalize(a);var b=a.xx*a.yy-a.xy*a.yx;return a=new d.Matrix2D({xx:a.yy/
b,xy:-a.xy/b,yx:-a.yx/b,yy:a.xx/b,dx:(a.xy*a.dy-a.yy*a.dx)/b,dy:(a.yx*a.dx-a.xx*a.dy)/b})},_multiplyPoint:function(a,e,d){return{x:a.xx*e+a.xy*d+a.dx,y:a.yx*e+a.yy*d+a.dy}},multiplyPoint:function(a,e,g){a=d.normalize(a);return"number"==typeof e&&"number"==typeof g?d._multiplyPoint(a,e,g):d._multiplyPoint(a,e.x,e.y)},multiplyRectangle:function(a,e){var b=d.normalize(a);e=e||{x:0,y:0,width:0,height:0};if(d.isIdentity(b))return{x:e.x,y:e.y,width:e.width,height:e.height};a=d.multiplyPoint(b,e.x,e.y);
var c=d.multiplyPoint(b,e.x,e.y+e.height),g=d.multiplyPoint(b,e.x+e.width,e.y);e=d.multiplyPoint(b,e.x+e.width,e.y+e.height);var b=Math.min(a.x,c.x,g.x,e.x),f=Math.min(a.y,c.y,g.y,e.y);return{x:b,y:f,width:Math.max(a.x,c.x,g.x,e.x)-b,height:Math.max(a.y,c.y,g.y,e.y)-f}},multiply:function(a){for(var b=d.normalize(a),g=1;g<arguments.length;++g){var c=b,h=d.normalize(arguments[g]),b=new d.Matrix2D;b.xx=c.xx*h.xx+c.xy*h.yx;b.xy=c.xx*h.xy+c.xy*h.yy;b.yx=c.yx*h.xx+c.yy*h.yx;b.yy=c.yx*h.xy+c.yy*h.yy;b.dx=
c.xx*h.dx+c.xy*h.dy+c.dx;b.dy=c.yx*h.dx+c.yy*h.dy+c.dy}return b},_sandwich:function(a,e,g){return d.multiply(d.translate(e,g),a,d.translate(-e,-g))},scaleAt:function(a,e,g,c){switch(arguments.length){case 4:return d._sandwich(d.scale(a,e),g,c);case 3:return"number"==typeof g?d._sandwich(d.scale(a),e,g):d._sandwich(d.scale(a,e),g.x,g.y)}return d._sandwich(d.scale(a),e.x,e.y)},rotateAt:function(a,e,g){return 2<arguments.length?d._sandwich(d.rotate(a),e,g):d._sandwich(d.rotate(a),e.x,e.y)},rotategAt:function(a,
e,g){return 2<arguments.length?d._sandwich(d.rotateg(a),e,g):d._sandwich(d.rotateg(a),e.x,e.y)},skewXAt:function(a,e,g){return 2<arguments.length?d._sandwich(d.skewX(a),e,g):d._sandwich(d.skewX(a),e.x,e.y)},skewXgAt:function(a,e,g){return 2<arguments.length?d._sandwich(d.skewXg(a),e,g):d._sandwich(d.skewXg(a),e.x,e.y)},skewYAt:function(a,e,g){return 2<arguments.length?d._sandwich(d.skewY(a),e,g):d._sandwich(d.skewY(a),e.x,e.y)},skewYgAt:function(a,e,g){return 2<arguments.length?d._sandwich(d.skewYg(a),
e,g):d._sandwich(d.skewYg(a),e.x,e.y)}});g.Matrix2D=d.Matrix2D;return d})},"dojox/gfx/path":function(){define(["./_base","dojo/_base/lang","dojo/_base/declare","./matrix","./shape"],function(g,a,d,h,b){b=d("dojox.gfx.path.Path",b.Shape,{constructor:function(b){this.shape=a.clone(g.defaultPath);this.segments=[];this.tbbox=null;this.absolute=!0;this.last={};this.rawNode=b;this.segmented=!1},setAbsoluteMode:function(a){this._confirmSegmented();this.absolute="string"==typeof a?"absolute"==a:a;return this},
getAbsoluteMode:function(){this._confirmSegmented();return this.absolute},getBoundingBox:function(){this._confirmSegmented();return this.bbox&&"l"in this.bbox?{x:this.bbox.l,y:this.bbox.t,width:this.bbox.r-this.bbox.l,height:this.bbox.b-this.bbox.t}:null},_getRealBBox:function(){this._confirmSegmented();if(this.tbbox)return this.tbbox;var a=this.bbox,b=this._getRealMatrix();this.bbox=null;for(var c=0,d=this.segments.length;c<d;++c)this._updateWithSegment(this.segments[c],b);b=this.bbox;this.bbox=
a;return this.tbbox=b?[{x:b.l,y:b.t},{x:b.r,y:b.t},{x:b.r,y:b.b},{x:b.l,y:b.b}]:null},getLastPosition:function(){this._confirmSegmented();return"x"in this.last?this.last:null},_applyTransform:function(){this.tbbox=null;return this.inherited(arguments)},_updateBBox:function(a,b,c){c&&(b=h.multiplyPoint(c,a,b),a=b.x,b=b.y);this.bbox&&"l"in this.bbox?(this.bbox.l>a&&(this.bbox.l=a),this.bbox.r<a&&(this.bbox.r=a),this.bbox.t>b&&(this.bbox.t=b),this.bbox.b<b&&(this.bbox.b=b)):this.bbox={l:a,b:b,r:a,t:b}},
_updateWithSegment:function(a,b){var c=a.args,e=c.length,d;switch(a.action){case "M":case "L":case "C":case "S":case "Q":case "T":for(d=0;d<e;d+=2)this._updateBBox(c[d],c[d+1],b);this.last.x=c[e-2];this.last.y=c[e-1];this.absolute=!0;break;case "H":for(d=0;d<e;++d)this._updateBBox(c[d],this.last.y,b);this.last.x=c[e-1];this.absolute=!0;break;case "V":for(d=0;d<e;++d)this._updateBBox(this.last.x,c[d],b);this.last.y=c[e-1];this.absolute=!0;break;case "m":d=0;"x"in this.last||(this._updateBBox(this.last.x=
c[0],this.last.y=c[1],b),d=2);for(;d<e;d+=2)this._updateBBox(this.last.x+=c[d],this.last.y+=c[d+1],b);this.absolute=!1;break;case "l":case "t":for(d=0;d<e;d+=2)this._updateBBox(this.last.x+=c[d],this.last.y+=c[d+1],b);this.absolute=!1;break;case "h":for(d=0;d<e;++d)this._updateBBox(this.last.x+=c[d],this.last.y,b);this.absolute=!1;break;case "v":for(d=0;d<e;++d)this._updateBBox(this.last.x,this.last.y+=c[d],b);this.absolute=!1;break;case "c":for(d=0;d<e;d+=6)this._updateBBox(this.last.x+c[d],this.last.y+
c[d+1],b),this._updateBBox(this.last.x+c[d+2],this.last.y+c[d+3],b),this._updateBBox(this.last.x+=c[d+4],this.last.y+=c[d+5],b);this.absolute=!1;break;case "s":case "q":for(d=0;d<e;d+=4)this._updateBBox(this.last.x+c[d],this.last.y+c[d+1],b),this._updateBBox(this.last.x+=c[d+2],this.last.y+=c[d+3],b);this.absolute=!1;break;case "A":for(d=0;d<e;d+=7)this._updateBBox(c[d+5],c[d+6],b);this.last.x=c[e-2];this.last.y=c[e-1];this.absolute=!0;break;case "a":for(d=0;d<e;d+=7)this._updateBBox(this.last.x+=
c[d+5],this.last.y+=c[d+6],b);this.absolute=!1}a=[a.action];for(d=0;d<e;++d)a.push(g.formatNumber(c[d],!0));if("string"==typeof this.shape.path)this.shape.path+=a.join("");else for(d=0,e=a.length;d<e;++d)this.shape.path.push(a[d])},_validSegments:{m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},_pushSegment:function(a,b){this.tbbox=null;var c=this._validSegments[a.toLowerCase()];"number"==typeof c&&(c?b.length>=c&&(a={action:a,args:b.slice(0,b.length-b.length%c)},this.segments.push(a),this._updateWithSegment(a)):
(a={action:a,args:[]},this.segments.push(a),this._updateWithSegment(a)))},_collectArgs:function(a,b){for(var c=0;c<b.length;++c){var e=b[c];"boolean"==typeof e?a.push(e?1:0):"number"==typeof e?a.push(e):e instanceof Array?this._collectArgs(a,e):"x"in e&&"y"in e&&a.push(e.x,e.y)}},moveTo:function(){this._confirmSegmented();var a=[];this._collectArgs(a,arguments);this._pushSegment(this.absolute?"M":"m",a);return this},lineTo:function(){this._confirmSegmented();var a=[];this._collectArgs(a,arguments);
this._pushSegment(this.absolute?"L":"l",a);return this},hLineTo:function(){this._confirmSegmented();var a=[];this._collectArgs(a,arguments);this._pushSegment(this.absolute?"H":"h",a);return this},vLineTo:function(){this._confirmSegmented();var a=[];this._collectArgs(a,arguments);this._pushSegment(this.absolute?"V":"v",a);return this},curveTo:function(){this._confirmSegmented();var a=[];this._collectArgs(a,arguments);this._pushSegment(this.absolute?"C":"c",a);return this},smoothCurveTo:function(){this._confirmSegmented();
var a=[];this._collectArgs(a,arguments);this._pushSegment(this.absolute?"S":"s",a);return this},qCurveTo:function(){this._confirmSegmented();var a=[];this._collectArgs(a,arguments);this._pushSegment(this.absolute?"Q":"q",a);return this},qSmoothCurveTo:function(){this._confirmSegmented();var a=[];this._collectArgs(a,arguments);this._pushSegment(this.absolute?"T":"t",a);return this},arcTo:function(){this._confirmSegmented();var a=[];this._collectArgs(a,arguments);this._pushSegment(this.absolute?"A":
"a",a);return this},closePath:function(){this._confirmSegmented();this._pushSegment("Z",[]);return this},_confirmSegmented:function(){if(!this.segmented){var a=this.shape.path;this.shape.path=[];this._setPath(a);this.shape.path=this.shape.path.join("");this.segmented=!0}},_setPath:function(b){b=a.isArray(b)?b:b.match(g.pathSvgRegExp);this.segments=[];this.absolute=!0;this.bbox={};this.last={};if(b){for(var e="",c=[],d=b.length,f=0;f<d;++f){var h=b[f],x=parseFloat(h);isNaN(x)?(e&&this._pushSegment(e,
c),c=[],e=h):c.push(x)}this._pushSegment(e,c)}},setShape:function(a){this.inherited(arguments,["string"==typeof a?{path:a}:a]);this.segmented=!1;this.segments=[];g.lazyPathSegmentation||this._confirmSegmented();return this},_2PI:2*Math.PI});d=d("dojox.gfx.path.TextPath",b,{constructor:function(b){"text"in this||(this.text=a.clone(g.defaultTextPath));"fontStyle"in this||(this.fontStyle=a.clone(g.defaultFont))},getText:function(){return this.text},setText:function(a){this.text=g.makeParameters(this.text,
"string"==typeof a?{text:a}:a);this._setText();return this},getFont:function(){return this.fontStyle},setFont:function(a){this.fontStyle="string"==typeof a?g.splitFontString(a):g.makeParameters(g.defaultFont,a);this._setFont();return this}});return g.path={Path:b,TextPath:d}})},"*now":function(g){g(['dojo/i18n!*preload*esri/widgets/nls/Legend*["ar","bs","ca","cs","da","de","el","en-au","en-ca","en-gb","en-us","es","es-mx","et","fi","fr","he","hr","hu","id","it","ja","ko","lt","lv","nl","nb","pl","pt","pt-br","pt-pt","ro","ru","sl","sr","sv","th","tr","uk","vi","zh-cn","zh-hk","zh-tw","ROOT"]'])},
"*noref":1}});
define("require exports ../core/tsSupport/assignHelper ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper dojo/i18n!./Legend/nls/Legend ../core/Handles ../core/watchUtils ../core/accessorSupport/decorators ../core/accessorSupport/decorators/cast ./Widget ./Legend/LegendViewModel ./Legend/styles/Card ./Legend/styles/Classic ./support/widget".split(" "),function(g,a,d,h,b,e,m,c,l,f,t,x,n,p,y){return function(a){function g(b){b=a.call(this,b)||this;b._handles=new m;b.activeLayerInfos=
null;b.basemapLegendVisible=!1;b.groundLegendVisible=!1;b.respectLayerVisibility=!0;b.iconClass="esri-icon-layer-list";b.label=e.widgetLabel;b.layerInfos=null;b.style=new p;b.view=null;b.viewModel=new x;return b}h(g,a);g.prototype.postInitialize=function(){var a=this;this.own(c.on(this,"activeLayerInfos","change",function(){return a._refreshActiveLayerInfos(a.activeLayerInfos)}),c.init(this,"style",function(b,c){c&&b!==c&&c.destroy();b&&(b.activeLayerInfos=a.activeLayerInfos,"card"===b.type&&(b.view=
a.view))}))};g.prototype.destroy=function(){this._handles.destroy();this._handles=null};g.prototype.castStyle=function(a){if(a instanceof n||a instanceof p)return a;if("string"===typeof a)return"card"===a?new n:new p;if(a&&"string"===typeof a.type){var b=d({},a);delete b.type;return new ("card"===a.type?n:p)(b)}return new p};g.prototype.render=function(){return this.style.render()};g.prototype._refreshActiveLayerInfos=function(a){var b=this;this._handles.removeAll();a.forEach(function(a){return b._renderOnActiveLayerInfoChange(a)});
this.scheduleRender()};g.prototype._renderOnActiveLayerInfoChange=function(a){var b=this,d=c.init(a,"version",function(){return b.scheduleRender()});this._handles.add(d,"version_"+a.layer.uid);a.children.forEach(function(a){return b._renderOnActiveLayerInfoChange(a)})};b([l.aliasOf("viewModel.activeLayerInfos"),y.renderable()],g.prototype,"activeLayerInfos",void 0);b([l.aliasOf("viewModel.basemapLegendVisible"),y.renderable()],g.prototype,"basemapLegendVisible",void 0);b([l.aliasOf("viewModel.groundLegendVisible"),
y.renderable()],g.prototype,"groundLegendVisible",void 0);b([l.aliasOf("viewModel.respectLayerVisibility"),y.renderable()],g.prototype,"respectLayerVisibility",void 0);b([l.property()],g.prototype,"iconClass",void 0);b([l.property()],g.prototype,"label",void 0);b([l.aliasOf("viewModel.layerInfos"),y.renderable()],g.prototype,"layerInfos",void 0);b([l.property(),y.renderable()],g.prototype,"style",void 0);b([f.cast("style")],g.prototype,"castStyle",null);b([l.aliasOf("viewModel.view"),y.renderable()],
g.prototype,"view",void 0);b([l.property(),y.renderable(["view.size"])],g.prototype,"viewModel",void 0);return g=b([l.subclass("esri.widgets.Legend")],g)}(l.declared(t))});