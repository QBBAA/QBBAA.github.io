// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.15/esri/copyright.txt for details.
//>>built
define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/tsSupport/assignHelper ../lib/GLMaterial ./WaterTechnique ./internal/MaterialUtil ./internal/waterMaterialUtils".split(" "),function(d,e,f,l,g,h,k,c){Object.defineProperty(e,"__esModule",{value:!0});d=function(d){function b(a){a=d.call(this,a)||this;a.updateParameters();return a}f(b,d);b.prototype.updateParameters=function(){this.params=k.copyParameters(this.material.getParameters());this.technique=this.techniqueRep.acquireAndReleaseExisting(h.WaterTechnique,
this.material.getTechniqueConfig(this.output),this.technique)};b.prototype.beginSlot=function(a){if(2===this.output)return 19===a;if(5===this.output)return null==a;var b=4;this.params.transparent&&(b=this.params.writeDepth?6:9);return a===b};b.prototype.setElapsedTimeUniform=function(a){a.setUniform1f("timeElapsed",.001*this.material.animation.time*this.params.animationSpeed)};b.prototype._updateShadowState=function(a){a.shadowMappingEnabled!==this.params.receiveShadows&&(this.material.setParameterValues({receiveShadows:a.shadowMappingEnabled}),
this.updateParameters())};b.prototype.ensureResources=function(a){c.waterTextureRepo.ready()||c.waterTextureRepo.loading()||(this.texturePaths=[this.params.waveTexture,this.params.perturbationTexture],c.waterTextureRepo.initialize(a,this.texturePaths));return c.waterTextureRepo.ready()?2:1};b.prototype.bind=function(a,b){c.waterTextureRepo.ready()&&(0===this.output&&this._updateShadowState(b),a.bindProgram(this.technique.program),a.setPipelineState(this.technique.pipeline),this.technique.bindPass(a,
this.params),2===this.output||0===this.output)&&(c.waterTextureRepo.bindRepo(a),this.setElapsedTimeUniform(this.technique.program))};return b}(g.GLMaterial);e.WaterGLMaterial=d});