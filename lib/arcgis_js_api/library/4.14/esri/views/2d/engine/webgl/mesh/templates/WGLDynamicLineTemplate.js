// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.15/esri/copyright.txt for details.
//>>built
define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/screenUtils ../../color ../../number ../../materialKey/MaterialKey ./util ./WGLBaseLineTemplate ./WGLDynamicMeshTemplate ../../util/Result".split(" "),function(g,k,q,l,m,n,p,e,r,t,u){Object.defineProperty(k,"__esModule",{value:!0});g=function(g){function h(v,c,f){var a=g.call(this,c)||this;a._cimLineLayer=c;var d=0;e.isFunction(c.width)||(d=.5*l.pt2px(c.width));a._dynamicPropertyMap.set("_halfWidth",function(a,
b,f){return e.isFunction(c.width)?.5*l.pt2px(c.width(a,b,f)):d});e.isFunction(c.cap)?a._dynamicPropertyMap.set("_capType",c.cap):a._capType=c.cap;e.isFunction(c.join)?a._dynamicPropertyMap.set("_joinType",c.join):a._joinType=c.join;if(e.isFunction(c.color))a._dynamicPropertyMap.set("_fillColor",function(a,b,d){return(a=c.color(a,b,d))&&m.premultiplyAlphaRGBA(a)||0});else{var b=c.color;a._fillColor=b&&m.premultiplyAlphaRGBA(b)||0}e.isFunction(c.miterLimit)?a._dynamicPropertyMap.set("_miterLimitCosine",
function(a,b,d){return e.getLimitCosine(c.miterLimit(a,b,d))}):a._miterLimitCosine=e.getLimitCosine(c.miterLimit);e.isFunction(f)?a._dynamicPropertyMap.set("_scaleFactor",f):a._scaleFactor=f;a._isDashed=c.isDashed;a.tessellationProperties._bitset=c.colorLocked?1:0;a._materialKey=p.createMaterialKey(a.geometryType,v,c.isOutline);a._initializeTessellator(!0);return a}q(h,g);h.fromCIMLine=function(e,c,f){return new h(e,c,f)};h.prototype.bindFeature=function(e,c,f){var a=this;this._dynamicPropertyMap.forEach(function(b,
d){a[d]=b(e,c,f)});this._halfWidth*=this._scaleFactor;var d=this._materialCache,b=this._cimLineLayer.materialHash,b=b(e,c,f),b=d.get(b),d=null;b&&u.ok(b.spriteMosaicItem)&&(d=b.spriteMosaicItem);if(d){this._hasPattern=!0;var b=d.rect,g=b.x+1+d.width,h=b.y+1+d.height;this.tessellationProperties._tl=n.i1616to32(b.x+1,b.y+1);this.tessellationProperties._br=n.i1616to32(g,h)}else this._hasPattern=!1,this.tessellationProperties._tl=0,this.tessellationProperties._br=0;this.tessellationProperties._fillColor=
this._fillColor;this.tessellationProperties._halfWidth=this._halfWidth;this.tessellationProperties._halfReferenceWidth=this.tessellationProperties._halfWidth;b=p.LineMaterialKey.load(this._materialKey);d&&(b.sdf=d.sdf,b.pattern=!0,b.textureBinding=d.textureBinding);this._materialKey=b.data};return h}(r.default(t.default));k.default=g});