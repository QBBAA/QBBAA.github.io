// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.15/esri/copyright.txt for details.
//>>built
/*

 Copyright 2000, Silicon Graphics, Inc. All Rights Reserved.
 Copyright 2015, Google Inc. All Rights Reserved.

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to
 deal in the Software without restriction, including without limitation the
 rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 sell copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:

 The above copyright notice including the dates of first publication and
 either this permission notice or a reference to http://oss.sgi.com/projects/FreeB/
 shall be included in all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL
 SILICON GRAPHICS, INC. BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR
 IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

 Original Code. The Original Code is: OpenGL Sample Implementation,
 Version 1.2.1, released January 26, 2000, developed by Silicon Graphics,
 Inc. The Original Code is Copyright (c) 1991-2000 Silicon Graphics, Inc.
 Copyright in any portions created by third parties is as indicated
 elsewhere herein. All Rights Reserved.
*/
require({cache:{"esri/views/2d/engine/Bitmap":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/libs/gl-matrix-2/mat3 ../../../core/libs/gl-matrix-2/mat3f32 ../../../core/libs/gl-matrix-2/vec2f32 ../../webgl ./DisplayObject ./ImageryBitmapSource".split(" "),function(e,a,c,h,b,g,m,f,d){function l(a){var d=document.createElement("canvas");d.width=a.width;d.height=a.height;a.render(d.getContext("2d"));return d}function z(a,d,f){var n={target:3553,pixelFormat:6408,
internalFormat:6408,dataType:5121,wrapMode:33071};d&&f&&(n.width=d,n.height=f);return new m.Texture(a,n)}function v(a){x.has(a)&&(A.splice(A.indexOf(a),1),x.delete(a))}Object.defineProperty(a,"__esModule",{value:!0});var A=[],x=new Set;e=function(a){function f(d,f){void 0===d&&(d=null);void 0===f&&(f=function(){return null});var n=a.call(this)||this;n.stencilRef=0;n.coordScale=[1,1];n._height=void 0;n.pixelRatio=1;n.resolution=0;n.rotation=0;n._source=null;n._width=void 0;n.x=0;n.y=0;n.transforms=
{dvs:b.mat3f32.create()};n.source=d;n.requestRender=f;return n}c(f,a);Object.defineProperty(f.prototype,"isSourceScaled",{get:function(){return this.width!==this.sourceWidth||this.height!==this.sourceHeight},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"height",{get:function(){return void 0!==this._height?this._height:this.sourceHeight},set:function(a){this._height=a},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"source",{get:function(){return this._source},
set:function(a){this._source=a;this.invalidateTexture()},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"sourceHeight",{get:function(){return this._source instanceof HTMLImageElement?this._source.naturalHeight:this._source.height},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"sourceWidth",{get:function(){return this._source instanceof HTMLImageElement?this._source.naturalWidth:this._source.width},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,
"width",{get:function(){return void 0!==this._width?this._width:this.sourceWidth},set:function(a){this._width=a},enumerable:!0,configurable:!0});f.prototype.attach=function(){this.updateTexture();return!0};f.prototype.detach=function(){this._texture.dispose();this._texture=null;v(this)};f.prototype.invalidateTexture=function(){this.attached?this.updateTexture():v(this)};f.prototype.setTransform=function(a){var d=h.mat3.identity(this.transforms.dvs),f=a.toScreenNoRotation([0,0],this.x,this.y),k=this.resolution/
this.pixelRatio/a.resolution,n=k*this.width,k=k*this.height,b=Math.PI*this.rotation/180;h.mat3.translate(d,d,g.vec2f32.fromValues(f[0],f[1]));h.mat3.translate(d,d,g.vec2f32.fromValues(n/2,k/2));h.mat3.rotate(d,d,-b);h.mat3.translate(d,d,g.vec2f32.fromValues(-n/2,-k/2));h.mat3.scaleByVec2(d,d,g.vec2f32.fromValues(n,k));h.mat3.multiply(this.transforms.dvs,a.displayViewMat3,d)};f.prototype.updateTexture=function(){this._texture||(this._texture=this.source?z(this.stage.context,this.sourceWidth,this.sourceHeight):
z(this.stage.context));var a=this.source;a?(this._texture.resize(this.sourceWidth,this.sourceHeight),a&&"render"in a?a instanceof d.default?(a=a.getRenderedRasterPixels(),this._texture.setData(a.renderedRasterPixels)):this._texture.setData(l(a)):!a||"render"in a||this._texture.setData(a),this.ready(),this.requestRender()):this._texture.setData(null)};f.prototype.setSamplingProfile=function(a){this._texture&&(a.mips&&!this._texture.descriptor.hasMipmap&&this._texture.generateMipmap(),this._texture.setSamplingMode(a.samplingMode))};
f.prototype.bind=function(a){this._texture&&this.stage.context.bindTexture(this._texture,a)};return f}(f.DisplayObject);a.Bitmap=e})},"esri/views/2d/engine/DisplayObject":function(){define(["require","exports","../../../core/tsSupport/extendsHelper","../../../core/Evented"],function(e,a,c,h){Object.defineProperty(a,"__esModule",{value:!0});e=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;b._renderRequestedCalled=!1;b._attached=!1;b._isReady=!1;b._opacity=1;b.renderRequested=
!1;b._visible=!0;return b}c(b,a);Object.defineProperty(b.prototype,"attached",{get:function(){return this._attached},set:function(a){this._attached!==a&&((this._attached=a)?this.hasEventListener("attach")&&this.emit("attach"):this.hasEventListener("detach")&&this.emit("detach"))},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"isReady",{get:function(){return this._attached&&this._isReady},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"opacity",{get:function(){return this._opacity},
set:function(a){this._opacity!==a&&(this._opacity=a,this.requestRender())},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"visible",{get:function(){return this._visible},set:function(a){this._visible!==a&&(this._visible=a,this.requestRender())},enumerable:!0,configurable:!0});b.prototype.attach=function(){this.ready();return!0};b.prototype.setTransform=function(a){};b.prototype.detach=function(){};b.prototype.processRender=function(a){this.visible&&this.attached&&(this._renderRequestedCalled=
!1,this.doRender(a),this._renderRequestedCalled||(this.renderRequested=!1),this.hasEventListener("post-render")&&this.emit("post-render"))};b.prototype.requestRender=function(){var a=this.renderRequested;this.renderRequested=this._renderRequestedCalled=!0;this.parent&&this.parent.requestRender();a!==this.renderRequested&&this.hasEventListener("will-render")&&this.emit("will-render")};b.prototype.dispose=function(){};b.prototype.doRender=function(a){};b.prototype.ready=function(){this._isReady=!0;
this.emit("isReady")};return b}(h);a.DisplayObject=e})},"esri/views/2d/engine/ImageryBitmapSource":function(){define(["require","exports"],function(e,a){Object.defineProperty(a,"__esModule",{value:!0});e=function(){function a(a,b,c){this.pixelBlock=a;this.extent=b;this.originalPixelBlock=c}Object.defineProperty(a.prototype,"width",{get:function(){return this.pixelBlock?this.pixelBlock.width:0},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"height",{get:function(){return this.pixelBlock?
this.pixelBlock.height:0},enumerable:!0,configurable:!0});a.prototype.render=function(a){var b=this.pixelBlock;if(b){var c=this.filter({pixelBlock:b}),b=c.pixelBlock.getAsRGBA(),c=a.createImageData(c.pixelBlock.width,c.pixelBlock.height);c.data.set(b);a.putImageData(c,0,0)}};a.prototype.getRenderedRasterPixels=function(){var a=this.filter({pixelBlock:this.pixelBlock});return{width:a.pixelBlock.width,height:a.pixelBlock.height,renderedRasterPixels:new Uint8Array(a.pixelBlock.getAsRGBA().buffer)}};
return a}();a.default=e})},"esri/views/2d/engine/BitmapContainer":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/decorateHelper ../engine ./webgl/WGLContainer".split(" "),function(e,a,c,h,b,g){Object.defineProperty(a,"__esModule",{value:!0});e=function(a){function f(){return null!==a&&a.apply(this,arguments)||this}c(f,a);f.prototype.prepareRenderPasses=function(d){var f=this,c=d.registerRenderPass({name:"bitmap",brushes:[b.brushes.Bitmap],target:function(){return f.children}});
return a.prototype.prepareRenderPasses.call(this,d).concat([c])};return f}(g.default);a.BitmapContainer=e})},"esri/views/2d/engine/webgl/WGLContainer":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/tsSupport/assignHelper ../../../../core/maybe ../../engine ../Container ./ClippingInfo ./enums".split(" "),function(e,a,c,h,b,g,m,f,d){Object.defineProperty(a,"__esModule",{value:!0});e=function(a){function l(d){var f=a.call(this)||this;f.name=f.constructor.name;
f._lastTime=null;f.setClips(d);return f}c(l,a);l.prototype.setClips=function(a){var d=this;b.isSome(this._clippingInfos)&&(this._clippingInfos.forEach(function(a){return a.destroy()}),this._clippingInfos=null);b.isSome(a)&&a.length&&(this._clippingInfos=a.items.map(function(a){return f.default.fromClipArea(d,a)}));this.requestRender()};l.prototype.doRender=function(a){this.attachChildren();this.detachChildren();var f=this.createRenderParams(a),b=f.context,l=f.painter,q=f.globalOpacity,n=f.profiler,
q=f.drawPhase===d.WGLDrawPhase.LABEL?1:q*this.opacity;n.recordContainerStart(this.name);l.beforeRenderLayer(b,this._clippingInfos?255:0,q);this.updateTransforms(a.state);this.renderChildren(f);l.compositeLayer(b,q);n.recordContainerEnd()};l.prototype.renderChildren=function(a){b.isNone(this._renderPasses)&&(this._renderPasses=this.prepareRenderPasses(this.stage.painter));for(var d=0,f=this._renderPasses;d<f.length;d++)f[d].render(a)};l.prototype.createRenderParams=function(a){var d=Date.now(),f=(b.isSome(this._lastTime)?
d-this._lastTime:0)/1E3;this._lastTime=d;return h({},a,{context:this.stage.context,painter:this.stage.painter,profiler:this.stage.profiler,renderingOptions:this.stage.renderingOptions,driverTestResult:this.stage.driverTestResult,timeDelta:f,timeline:this.stage.timeline})};l.prototype.prepareRenderPasses=function(a){var f=this;return[a.registerRenderPass({name:"clip",brushes:[g.brushes.Clip],target:function(){return f._clippingInfos},drawPhase:d.WGLDrawPhase.MAP|d.WGLDrawPhase.LABEL|d.WGLDrawPhase.LABEL_ALPHA|
d.WGLDrawPhase.DEBUG})]};l.prototype.updateTransforms=function(a){for(var d=0,f=this.children;d<f.length;d++)f[d].setTransform(a)};return l}(m.Container);a.default=e})},"esri/views/2d/engine/Container":function(){define(["require","exports","../../../core/tsSupport/extendsHelper","./DisplayObject"],function(e,a,c,h){Object.defineProperty(a,"__esModule",{value:!0});e=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;b._childrenSet=new Set;b._childrenToAttach=[];b._childrenToDetach=
[];b.children=[];return b}c(b,a);Object.defineProperty(b.prototype,"numChildren",{get:function(){return this.children.length},enumerable:!0,configurable:!0});b.prototype.detach=function(){for(var a=0,f=this.children.concat(this._childrenToDetach);a<f.length;a++){var d=f[a];d.attached&&(this.detachChild(d),d.attached=!1,d.parent=null)}};b.prototype.doRender=function(a){var f=a.globalOpacity;a.globalOpacity*=this.opacity;this.attachChildren();this.detachChildren();this.renderChildren(a);a.globalOpacity=
f};b.prototype.addChild=function(a){return this.addChildAt(a,this.children.length)};b.prototype.addChildAt=function(a,f){void 0===f&&(f=this.numChildren);if(!a||this.contains(a))return a;var d=a.parent;d&&d!==this&&d.removeChild(a);f>=this.numChildren?this.children.push(a):this.children.splice(f,0,a);this._childrenSet.add(a);f=this._childrenToDetach.indexOf(a);-1<f&&this._childrenToDetach.splice(f,1);this._childrenToAttach.push(a);this.requestRender();return a};b.prototype.contains=function(a){return this._childrenSet.has(a)};
b.prototype.getChildIndex=function(a){return this.children.indexOf(a)};b.prototype.getChildAt=function(a){return 0>a||a>this.children.length?null:this.children[a]};b.prototype.removeAllChildren=function(){for(var a=this.numChildren;a--;)this.removeChildAt(0)};b.prototype.removeChild=function(a){return this.contains(a)?this.removeChildAt(this.getChildIndex(a)):a};b.prototype.removeChildAt=function(a){if(0>a||a>=this.children.length)return null;a=this.children.splice(a,1)[0];this._childrenSet["delete"](a);
if(a.attached)this._childrenToDetach.push(a);else{var f=this._childrenToAttach.indexOf(a);-1<f&&this._childrenToAttach.splice(f,1)}return a};b.prototype.setChildIndex=function(a,f){var d=this.getChildIndex(a);-1<d&&(this.children.splice(d,1),this.children.splice(f,0,a))};b.prototype.sortChildren=function(a){return this.children.sort(a)};b.prototype.attachChildren=function(){var a=this._childrenToAttach;if(0!==a.length)for(var f=0,d=!1;!d;)d=a[f],d.parent=this,d.stage=this.stage,this.attachChild(d)?
(d.attached=!0,a.splice(f,1)):++f,d=a.length===f};b.prototype.detachChildren=function(){for(var a=this._childrenToDetach;0<a.length;){var f=a.shift();this.detachChild(f);f.attached=!1;f.parent=null;f.stage=null}};b.prototype.renderChildren=function(a){for(var f=this.children,d=f.length,b=0;b<d;b++)f[b].processRender(a)};b.prototype.attachChild=function(a){return a.attach()};b.prototype.detachChild=function(a){a.detach()};return b}(h.DisplayObject);a.Container=e})},"esri/views/2d/engine/webgl/ClippingInfo":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/Error ../../../../core/Logger ../../../../core/maybe ../DisplayObject ./Mesh2D ../../../webgl/VertexArrayObject".split(" "),
function(e,a,c,h,b,g,m,f,d){Object.defineProperty(a,"__esModule",{value:!0});var l=b.getLogger("esri.views.2d.engine.webgl.ClippingInfo");e=function(a){function b(d,f){var b=a.call(this)||this;b._cache={};b.parent=d;b._handle=f.watch("version",function(){return b._invalidate()});b._clip=f;b.attach();b.attached=!0;return b}c(b,a);b.fromClipArea=function(a,d){return new b(a,d)};b.prototype._destroyGL=function(){g.isSome(this._cache.mesh)&&(this._cache.mesh.destroy(),this._cache.mesh=null);g.isSome(this._cache.vao)&&
(this._cache.vao.dispose(),this._cache.vao=null)};b.prototype.destroy=function(){this._destroyGL();this._handle.remove()};b.prototype.doRender=function(){};b.prototype.getVAO=function(a,b,f,l){var n=b.size,q=n[0],n=n[1];if("geometry"===this._clip.type||this._lastWidth!==q||this._lastHeight!==n)this._lastWidth=q,this._lastHeight=n,this._destroyGL();g.isNone(this._cache.vao)&&(b=this._createMesh(b,this._clip),q=b.getIndexBuffer(a),n=b.getVertexBuffers(a),this._cache.mesh=b,this._cache.vao=new d(a,f,
l,n,q));return this._cache.vao};b.prototype._invalidate=function(){this._destroyGL();this.requestRender()};b.prototype._createScreenRect=function(a,d){var b=a.size;a=b[0];var b=b[1],f="string"===typeof d.left?parseFloat(d.left)/100*a:d.left,n="string"===typeof d.right?parseFloat(d.right)/100*a:d.right,l="string"===typeof d.top?parseFloat(d.top)/100*b:d.top;d="string"===typeof d.bottom?parseFloat(d.bottom)/100*b:d.bottom;return{x:f,y:l,width:Math.max(a-n-f,0),height:Math.max(b-d-l,0)}};b.prototype._createMesh=
function(a,d){switch(d.type){case "rect":return f.default.fromRect(this._createScreenRect(a,d));case "path":return f.default.fromPath(d);case "geometry":return f.default.fromGeometry(a,d);default:return l.error(new h("mapview-bad-type","Unable to create ClippingInfo mesh from clip of type: ${clip.type}")),f.default.fromRect({x:0,y:0,width:1,height:1})}};return b}(m.DisplayObject);a.default=e})},"esri/views/2d/engine/webgl/Mesh2D":function(){define("require exports ../../../../core/tsSupport/assignHelper ../../../../core/Error ../../../../core/Logger ../../../../core/maybe ../../../../core/libs/earcut/earcut ../../../../core/libs/gl-matrix-2/vec2 ../../../../core/libs/gl-matrix-2/vec2f64 ../../../../layers/graphics/featureConversionUtils ../../../../layers/graphics/OptimizedGeometry ./number ../../../webgl/BufferObject".split(" "),
function(e,a,c,h,b,g,m,f,d,l,z,v,A){Object.defineProperty(a,"__esModule",{value:!0});var x=b.getLogger("esri.views.2d.engine.webgl.Mesh2D"),u=function(a,d){var b=a.coords;a=a.lengths;for(var f=[],k=0,n=0;k<a.length;n+=a[k],k+=1){for(var l=n,c=[];k<a.length-1;k+=1,n+=a[k]){for(var q=n+a[k],z=0,u=1;u<a[k+1];u++)z+=(b[2*(q+u)]-b[2*(q+u-1)])*(b[2*(q+u)+1]+b[2*(q+u-1)+1]);if(!(d?0<z:0>z))break;c.push(n+a[k]-l)}z=b.slice(2*l,2*(n+a[k]));q=0;for(c=m(z,c,2);q<c.length;q++)f.push(c[q]+l)}return f};e=function(){function a(a,
d,b,k){void 0===k&&(k=!1);this._cache={};this.vertices=a;this.indices=d;this.primitiveType=b;this.isMapSpace=k}a.fromRect=function(d){var b=d.x,f=d.y;return a.fromScreenExtent({xmin:b,ymin:f,xmax:b+d.width,ymax:f+d.height})};a.fromPath=function(d){var b=l.convertFromNestedArray(new z.default,d.path,!1,!1);d=b.coords;for(var b=new Uint32Array(u(b,!0)),f=new Uint32Array(d.length/2),k=0;k<f.length;k++)f[k]=v.i1616to32(Math.floor(d[2*k]),Math.floor(d[2*k+1]));return new a({geometry:f},b,4)};a.fromGeometry=
function(d,b){var f=b.geometry.type;switch(f){case "polygon":return a.fromPolygon(d,b.geometry);case "extent":return a.fromMapExtent(d,b.geometry);default:return x.error(new h("mapview-bad-type","Unable to create a mesh from type "+f,b)),a.fromRect({x:0,y:0,width:1,height:1})}};a.fromPolygon=function(b,c){var n=l.convertFromPolygon(new z.default,c,!1,!1);c=n.coords;for(var n=new Uint32Array(u(n,!1)),k=new Uint32Array(c.length/2),q=d.vec2f64.create(),p=d.vec2f64.create(),g=0;g<k.length;g++)f.vec2.set(q,
c[2*g],c[2*g+1]),b.toScreen(p,q),k[g]=v.i1616to32(Math.floor(p[0]),Math.floor(p[1]));return new a({geometry:k},n,4,!0)};a.fromScreenExtent=function(d){var b=d.xmin,f=d.xmax,k=d.ymin;d=d.ymax;b={geometry:new Uint32Array([v.i1616to32(b,k),v.i1616to32(f,k),v.i1616to32(b,d),v.i1616to32(b,d),v.i1616to32(f,k),v.i1616to32(f,d)])};f=new Uint32Array([0,1,2,3,4,5]);return new a(b,f,4)};a.fromMapExtent=function(d,b){var f=d.toScreen([0,0],[b.xmin,b.ymin]),k=f[0],f=f[1];b=d.toScreen([0,0],[b.xmax,b.ymax]);d=
b[0];b=b[1];k={geometry:new Uint32Array([v.i1616to32(k,f),v.i1616to32(d,f),v.i1616to32(k,b),v.i1616to32(k,b),v.i1616to32(d,f),v.i1616to32(d,b)])};f=new Uint32Array([0,1,2,3,4,5]);return new a(k,f,4)};a.prototype.destroy=function(){g.isSome(this._cache.indexBuffer)&&this._cache.indexBuffer.dispose();for(var a in this._cache.vertexBuffers)g.isSome(this._cache.vertexBuffers[a])&&this._cache.vertexBuffers[a].dispose()};Object.defineProperty(a.prototype,"elementType",{get:function(){var a;a:switch(this.indices.BYTES_PER_ELEMENT){case 1:a=
5121;break a;case 2:a=5123;break a;case 4:a=5125;break a;default:throw new h("Cannot get DataType of array");}return a},enumerable:!0,configurable:!0});a.prototype.getIndexBuffer=function(a,d){void 0===d&&(d=35044);this._cache.indexBuffer||(this._cache.indexBuffer=A.createIndex(a,d,this.indices));return this._cache.indexBuffer};a.prototype.getVertexBuffers=function(a,d){var b=this;void 0===d&&(d=35044);this._cache.vertexBuffers||(this._cache.vertexBuffers=Object.keys(this.vertices).reduce(function(k,
f){var l;return c({},k,(l={},l[f]=A.createVertex(a,d,b.vertices[f]),l))},{}));return this._cache.vertexBuffers};return a}();a.default=e})},"esri/core/libs/earcut/earcut":function(){define([],function(){function e(k,b,f){f=f||2;var l=b&&b.length,n=l?b[0]*f:k.length,q=a(k,0,n,f,!0),p=[];if(!q||q.next===q.prev)return p;var z,w,y,v;if(l){var x=f,l=[],A,e,C;v=0;for(A=b.length;v<A;v++)e=b[v]*x,C=v<A-1?b[v+1]*x:k.length,e=a(k,e,C,x,!1),e===e.next&&(e.steiner=!0),l.push(d(e));l.sort(g);for(v=0;v<l.length;v++){b=
l[v];x=q;if(x=m(b,x))b=u(x,b),c(b,b.next);q=c(q,q.next)}}if(k.length>80*f){z=y=k[0];w=l=k[1];for(x=f;x<n;x+=f)v=k[x],b=k[x+1],v<z&&(z=v),b<w&&(w=b),v>y&&(y=v),b>l&&(l=b);y=Math.max(y-z,l-w);y=0!==y?1/y:0}h(q,p,f,z,w,y);return p}function a(a,d,b,f,l){var k;if(l===0<y(a,d,b,f))for(l=d;l<b;l+=f)k=q(l,a[l],a[l+1],k);else for(l=b-f;l>=d;l-=f)k=q(l,a[l],a[l+1],k);k&&v(k,k.next)&&(n(k),k=k.next);return k}function c(a,d){if(!a)return a;d||(d=a);var k;do if(k=!1,a.steiner||!v(a,a.next)&&0!==z(a.prev,a,a.next))a=
a.next;else{n(a);a=d=a.prev;if(a===a.next)break;k=!0}while(k||a!==d);return d}function h(a,d,q,p,y,g,m){if(a){if(!m&&g){var k=a,w=k;do null===w.z&&(w.z=f(w.x,w.y,p,y,g)),w.prevZ=w.prev,w=w.nextZ=w.next;while(w!==k);w.prevZ.nextZ=null;w.prevZ=null;var k=w,e,C,B,F,G,E,N=1;do{w=k;B=k=null;for(F=0;w;){F++;C=w;for(e=G=0;e<N&&(G++,C=C.nextZ,C);e++);for(E=N;0<G||0<E&&C;)0!==G&&(0===E||!C||w.z<=C.z)?(e=w,w=w.nextZ,G--):(e=C,C=C.nextZ,E--),B?B.nextZ=e:k=e,e.prevZ=B,B=e;w=C}B.nextZ=null;N*=2}while(1<F)}for(k=
a;a.prev!==a.next;){w=a.prev;C=a.next;if(g)B=b(a,p,y,g);else a:if(B=a,F=B.prev,G=B,N=B.next,0<=z(F,G,N))B=!1;else{E=e=B.next.next;for(var H=0;e!==B.prev&&(0===H||e!==E);){H++;if(l(F.x,F.y,G.x,G.y,N.x,N.y,e.x,e.y)&&0<=z(e.prev,e,e.next)){B=!1;break a}e=e.next}B=!0}if(B)d.push(w.i/q),d.push(a.i/q),d.push(C.i/q),n(a),k=a=C.next;else if(a=C,a===k){if(!m)h(c(a),d,q,p,y,g,1);else if(1===m){m=d;k=q;w=a;do C=w.prev,B=w.next.next,!v(C,B)&&A(C,w,w.next,B)&&x(C,B)&&x(B,C)&&(m.push(C.i/k),m.push(w.i/k),m.push(B.i/
k),n(w),n(w.next),w=a=B),w=w.next;while(w!==a);a=w;h(a,d,q,p,y,g,2)}else if(2===m)a:{m=a;do{for(k=m.next.next;k!==m.prev;){if(w=m.i!==k.i){w=m;C=k;B=void 0;if(B=w.next.i!==C.i&&w.prev.i!==C.i){B=void 0;b:{B=w;do{if(B.i!==w.i&&B.next.i!==w.i&&B.i!==C.i&&B.next.i!==C.i&&A(B,B.next,w,C)){B=!0;break b}B=B.next}while(B!==w);B=!1}B=!B}F=void 0;if(F=B&&x(w,C)&&x(C,w)){B=w;F=!1;G=(w.x+C.x)/2;C=(w.y+C.y)/2;do B.y>C!==B.next.y>C&&B.next.y!==B.y&&G<(B.next.x-B.x)*(C-B.y)/(B.next.y-B.y)+B.x&&(F=!F),B=B.next;
while(B!==w)}w=F}if(w){a=u(m,k);m=c(m,m.next);a=c(a,a.next);h(m,d,q,p,y,g);h(a,d,q,p,y,g);break a}k=k.next}m=m.next}while(m!==a)}break}}}}function b(a,d,b,c){var k=a.prev,q=a.next;if(0<=z(k,a,q))return!1;var n=k.x>a.x?k.x>q.x?k.x:q.x:a.x>q.x?a.x:q.x,p=k.y>a.y?k.y>q.y?k.y:q.y:a.y>q.y?a.y:q.y,w=f(k.x<a.x?k.x<q.x?k.x:q.x:a.x<q.x?a.x:q.x,k.y<a.y?k.y<q.y?k.y:q.y:a.y<q.y?a.y:q.y,d,b,c);d=f(n,p,d,b,c);b=a.prevZ;for(c=a.nextZ;b&&b.z>=w&&c&&c.z<=d;){if(b!==a.prev&&b!==a.next&&l(k.x,k.y,a.x,a.y,q.x,q.y,b.x,
b.y)&&0<=z(b.prev,b,b.next))return!1;b=b.prevZ;if(c!==a.prev&&c!==a.next&&l(k.x,k.y,a.x,a.y,q.x,q.y,c.x,c.y)&&0<=z(c.prev,c,c.next))return!1;c=c.nextZ}for(;b&&b.z>=w;){if(b!==a.prev&&b!==a.next&&l(k.x,k.y,a.x,a.y,q.x,q.y,b.x,b.y)&&0<=z(b.prev,b,b.next))return!1;b=b.prevZ}for(;c&&c.z<=d;){if(c!==a.prev&&c!==a.next&&l(k.x,k.y,a.x,a.y,q.x,q.y,c.x,c.y)&&0<=z(c.prev,c,c.next))return!1;c=c.nextZ}return!0}function g(a,d){return a.x-d.x}function m(a,d){var b=d,k=a.x,f=a.y,c=-Infinity,q;do{if(f<=b.y&&f>=b.next.y&&
b.next.y!==b.y){var n=b.x+(f-b.y)*(b.next.x-b.x)/(b.next.y-b.y);if(n<=k&&n>c){c=n;if(n===k){if(f===b.y)return b;if(f===b.next.y)return b.next}q=b.x<b.next.x?b:b.next}}b=b.next}while(b!==d);if(!q)return null;if(k===c)return q.prev;d=q;for(var n=q.x,p=q.y,z=Infinity,u,b=q.next;b!==d;)k>=b.x&&b.x>=n&&k!==b.x&&l(f<p?k:c,f,n,p,f<p?c:k,f,b.x,b.y)&&(u=Math.abs(f-b.y)/(k-b.x),(u<z||u===z&&b.x>q.x)&&x(b,a)&&(q=b,z=u)),b=b.next;return q}function f(a,b,d,f,l){a=32767*(a-d)*l;b=32767*(b-f)*l;a=(a|a<<8)&16711935;
a=(a|a<<4)&252645135;a=(a|a<<2)&858993459;b=(b|b<<8)&16711935;b=(b|b<<4)&252645135;b=(b|b<<2)&858993459;return(a|a<<1)&1431655765|((b|b<<1)&1431655765)<<1}function d(a){var b=a,d=a;do{if(b.x<d.x||b.x===d.x&&b.y<d.y)d=b;b=b.next}while(b!==a);return d}function l(a,b,d,f,l,c,q,n){return 0<=(l-q)*(b-n)-(a-q)*(c-n)&&0<=(a-q)*(f-n)-(d-q)*(b-n)&&0<=(d-q)*(c-n)-(l-q)*(f-n)}function z(a,b,d){return(b.y-a.y)*(d.x-b.x)-(b.x-a.x)*(d.y-b.y)}function v(a,b){return a.x===b.x&&a.y===b.y}function A(a,b,d,f){return v(a,
b)&&v(d,f)||v(a,f)&&v(d,b)?!0:0<z(a,b,d)!==0<z(a,b,f)&&0<z(d,f,a)!==0<z(d,f,b)}function x(a,b){return 0>z(a.prev,a,a.next)?0<=z(a,b,a.next)&&0<=z(a,a.prev,b):0>z(a,b,a.prev)||0>z(a,a.next,b)}function u(a,b){var d=new p(a.i,a.x,a.y),f=new p(b.i,b.x,b.y),k=a.next,l=b.prev;a.next=b;b.prev=a;d.next=k;k.prev=d;f.next=d;d.prev=f;l.next=f;f.prev=l;return f}function q(a,b,d,f){a=new p(a,b,d);f?(a.next=f.next,a.prev=f,f.next.prev=a,f.next=a):(a.prev=a,a.next=a);return a}function n(a){a.next.prev=a.prev;a.prev.next=
a.next;a.prevZ&&(a.prevZ.nextZ=a.nextZ);a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function p(a,b,d){this.i=a;this.x=b;this.y=d;this.nextZ=this.prevZ=this.z=this.next=this.prev=null;this.steiner=!1}function y(a,b,d,f){for(var k=0,l=d-f;b<d;b+=f)k+=(a[l]-a[b])*(a[b+1]+a[l+1]),l=b;return k}e.deviation=function(a,b,d,f){var k=b&&b.length,l=Math.abs(y(a,0,k?b[0]*d:a.length,d));if(k)for(var k=0,c=b.length;k<c;k++)l-=Math.abs(y(a,b[k]*d,k<c-1?b[k+1]*d:a.length,d));for(k=b=0;k<f.length;k+=3){var c=f[k]*d,q=f[k+1]*
d,n=f[k+2]*d;b+=Math.abs((a[c]-a[n])*(a[q+1]-a[c+1])-(a[c]-a[q])*(a[n+1]-a[c+1]))}return 0===l&&0===b?0:Math.abs((b-l)/l)};e.flatten=function(a){for(var b=a[0][0].length,d={vertices:[],holes:[],dimensions:b},f=0,k=0;k<a.length;k++){for(var l=0;l<a[k].length;l++)for(var c=0;c<b;c++)d.vertices.push(a[k][l][c]);0<k&&(f+=a[k-1].length,d.holes.push(f))}return d};return e})},"esri/views/2d/engine/webgl/number":function(){define(["require","exports"],function(e,a){function c(a,b,f){return Math.round(Math.max(Math.min(a,
f),b))}Object.defineProperty(a,"__esModule",{value:!0});var h=new Float32Array(1),b=new Uint32Array(h.buffer);a.i8=function(a){return c(a,-128,127)};a.i16=function(a){return c(a,-32768,32767)};a.i32=function(a){return c(a,-2147483648,2147483647)};a.u8=function(a){return c(a,0,255)};a.u16=function(a){return c(a,0,65535)};a.u32=function(a){return c(a,0,4294967295)};a.toUint32=function(a){h[0]=a;return b[0]};a.toFloat32=function(a){b[0]=a;return h[0]};a.u32to4Xu8=function(a){return[a&255,(a&65280)>>>
8,(a&16711680)>>>16,(a&4278190080)>>>24]};a.i1616to32=function(a,b){return 65535&a|b<<16};a.i8888to32=function(a,b,f,d){return a&255|(b&255)<<8|(f&255)<<16|d<<24};a.i8816to32=function(a,b,f){return a&255|(b&255)<<8|f<<16};a.numTo32=function(a){return a|0}})},"esri/views/2d/engine/webgl/enums":function(){define(["require","exports"],function(e,a){Object.defineProperty(a,"__esModule",{value:!0});(function(a){a[a.FILL=0]="FILL";a[a.LINE=1]="LINE";a[a.MARKER=2]="MARKER";a[a.TEXT=3]="TEXT";a[a.LABEL=4]=
"LABEL"})(a.WGLGeometryType||(a.WGLGeometryType={}));(function(a){a[a.SUCCEEDED=0]="SUCCEEDED";a[a.FAILED_OUT_OF_MEMORY=1]="FAILED_OUT_OF_MEMORY"})(a.WGLGeometryTransactionStatus||(a.WGLGeometryTransactionStatus={}));(function(a){a[a.NONE=0]="NONE";a[a.MAP=1]="MAP";a[a.LABEL=2]="LABEL";a[a.LABEL_ALPHA=4]="LABEL_ALPHA";a[a.HITTEST=8]="HITTEST";a[a.HIGHLIGHT=16]="HIGHLIGHT";a[a.CLIP=32]="CLIP";a[a.DEBUG=64]="DEBUG";a[a.NUM_DRAW_PHASES=9]="NUM_DRAW_PHASES"})(a.WGLDrawPhase||(a.WGLDrawPhase={}));(function(a){a[a.SIZE=
0]="SIZE";a[a.COLOR=1]="COLOR";a[a.OPACITY=2]="OPACITY";a[a.ROTATION=3]="ROTATION"})(a.VVType||(a.VVType={}));(function(a){a[a.NONE=0]="NONE";a[a.OPACITY=1]="OPACITY";a[a.COLOR=2]="COLOR";a[a.ROTATION=4]="ROTATION";a[a.SIZE_MINMAX_VALUE=8]="SIZE_MINMAX_VALUE";a[a.SIZE_SCALE_STOPS=16]="SIZE_SCALE_STOPS";a[a.SIZE_FIELD_STOPS=32]="SIZE_FIELD_STOPS";a[a.SIZE_UNIT_VALUE=64]="SIZE_UNIT_VALUE"})(a.WGLVVFlag||(a.WGLVVFlag={}));(function(a){a[a.MINMAX_TARGETS_OUTLINE=128]="MINMAX_TARGETS_OUTLINE";a[a.SCALE_TARGETS_OUTLINE=
256]="SCALE_TARGETS_OUTLINE";a[a.FIELD_TARGETS_OUTLINE=512]="FIELD_TARGETS_OUTLINE";a[a.UNIT_TARGETS_OUTLINE=1024]="UNIT_TARGETS_OUTLINE"})(a.WGLVVTarget||(a.WGLVVTarget={}));(function(a){a[a.SPRITE=0]="SPRITE";a[a.GLYPH=1]="GLYPH"})(a.MosaicType||(a.MosaicType={}))})},"esri/views/2d/engine/BitmapTile":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/decorateHelper ./Bitmap ./webgl/TiledDisplayObject".split(" "),function(e,a,c,h,b,g){Object.defineProperty(a,
"__esModule",{value:!0});e=function(a){function f(d,f,c,g){void 0===g&&(g=null);var l=a.call(this,d,f,c,c)||this;d=l.requestRender.bind(l);l.bitmap=new b.Bitmap(g,d);l.bitmap.coordScale=c;l.bitmap.once("isReady",function(){return l.ready()});return l}c(f,a);Object.defineProperty(f.prototype,"stencilRef",{get:function(){return this.bitmap.stencilRef},set:function(a){this.bitmap.stencilRef=a},enumerable:!0,configurable:!0});f.prototype.setTransform=function(b,f){a.prototype.setTransform.call(this,b,
f);this.bitmap.transforms.dvs=this.transforms.dvs};f.prototype.attach=function(){this.bitmap.stage=this.stage;var a=this.bitmap.attach();a&&(this.bitmap.attached=!0);return a};f.prototype.detach=function(){this.bitmap.detach()};return f}(g.TiledDisplayObject);a.BitmapTile=e})},"esri/views/2d/engine/webgl/TiledDisplayObject":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/has ../../../../core/libs/gl-matrix-2/mat3 ../../../../core/libs/gl-matrix-2/mat3f32 ../DisplayObject ../../tiling/TileKey".split(" "),
function(e,a,c,h,b,g,m,f){Object.defineProperty(a,"__esModule",{value:!0});e=function(a){function d(b,d,l,c){void 0===c&&(c=l);var z=a.call(this)||this;z.transforms={dvs:g.mat3f32.create(),tileMat3:g.mat3f32.create()};z.triangleCount=0;z.key=f.pool.acquire(b);z.bounds=d;z.size=l;z.coordRange=c;return z}c(d,a);d.prototype.destroy=function(){f.pool.release(this.key);this.key=null;this.texture&&(this.texture.dispose(),this.texture=null)};Object.defineProperty(d.prototype,"coords",{get:function(){return this._coords},
enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"bounds",{get:function(){return this._bounds},set:function(a){this._coords=[a[0],a[3]];this._bounds=a},enumerable:!0,configurable:!0});d.prototype.setTransform=function(a,d){d/=a.resolution*a.pixelRatio;var f=this.transforms.tileMat3,l=a.toScreenNoRotation([0,0],this.coords);b.mat3.set(f,this.size[0]/this.coordRange[0]*d,0,0,0,this.size[1]/this.coordRange[1]*d,0,l[0],l[1],1);b.mat3.multiply(this.transforms.dvs,a.displayViewMat3,f)};
return d}(m.DisplayObject);a.TiledDisplayObject=e})},"esri/views/2d/engine/webgl/TileContainer":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/tsSupport/assignHelper ./enums ./WGLContainer ./brushes/WGLBrushInfo ./brushes/WGLBrushStencil".split(" "),function(e,a,c,h,b,g,m,f){Object.defineProperty(a,"__esModule",{value:!0});a.sortByLevel=function(a,b){return 0!==a.key.level-b.key.level?a.key.level-b.key.level:0!==a.key.row-b.key.row?a.key.row-b.key.row:
a.key.col-b.key.col};e=function(d){function l(a,b){b=d.call(this,b)||this;b._tileInfoView=a;return b}c(l,d);l.prototype.renderChildren=function(b){this.sortChildren(a.sortByLevel);this.setStencilReference();d.prototype.renderChildren.call(this,b)};l.prototype.createRenderParams=function(a){var b=a.state;return h({},d.prototype.createRenderParams.call(this,a),{requiredLevel:this._tileInfoView.getClosestInfoForScale(b.scale).level,displayLevel:this._tileInfoView.tileInfo.scaleToZoom(b.scale)})};l.prototype.prepareRenderPasses=
function(a){var l=this,c=a.registerRenderPass({name:"stencil",brushes:[f.default],drawPhase:b.WGLDrawPhase.DEBUG|b.WGLDrawPhase.MAP,target:function(){return l.children}}),z=a.registerRenderPass({name:"tileInfo",brushes:[m.default],drawPhase:b.WGLDrawPhase.DEBUG,target:function(){return l.children},has:"esri-tiles-debug"});return d.prototype.prepareRenderPasses.call(this,a).concat([c,z])};l.prototype.updateTransforms=function(a){for(var b=0,d=this.children;b<d.length;b++){var f=d[b],l=this._tileInfoView.getTileResolution(f.key);
f.setTransform(a,l)}};l.prototype.setStencilReference=function(){for(var a=1,b=0,d=this.children;b<d.length;b++)d[b].stencilRef=a++};return l}(g.default);a.default=e})},"esri/views/2d/engine/webgl/brushes/WGLBrushInfo":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/libs/gl-matrix-2/vec4f32 ../../../../webgl ./WGLBrush ../shaders/BackgroundPrograms ../shaders/TileInfoPrograms".split(" "),function(e,a,c,h,b,g,m,f){Object.defineProperty(a,"__esModule",
{value:!0});e=function(a){function d(){var b=null!==a&&a.apply(this,arguments)||this;b._color=h.vec4f32.fromValues(1,0,0,1);return b}c(d,a);d.prototype.dispose=function(){this._outlineProgram&&(this._outlineProgram.dispose(),this._outlineProgram=null);this._tileInfoProgram&&(this._tileInfoProgram.dispose(),this._tileInfoProgram=null);this._outlineVertexArrayObject&&(this._outlineVertexArrayObject.dispose(),this._outlineVertexArrayObject=null);this._tileInfoVertexArrayObject&&(this._tileInfoVertexArrayObject.dispose(),
this._tileInfoVertexArrayObject=null);this._canvas=null};d.prototype.prepareState=function(a){a=a.context;a.setBlendingEnabled(!0);a.setBlendFunctionSeparate(1,771,1,771);a.setColorMask(!0,!0,!0,!0);a.setStencilWriteMask(0);a.setStencilTestEnabled(!1)};d.prototype.draw=function(a,b){a=a.context;if(b.isReady){this._loadWGLResources(a);a.bindVAO(this._outlineVertexArrayObject);a.bindProgram(this._outlineProgram);this._outlineProgram.setUniformMatrix3fv("u_dvsMat3",b.transforms.dvs);this._outlineProgram.setUniform2f("u_coord_range",
b.coordRange[0],b.coordRange[1]);this._outlineProgram.setUniform1f("u_depth",0);this._outlineProgram.setUniform4fv("u_color",this._color);a.drawArrays(3,0,4);a.bindVAO();var d=this._getTexture(a,b);d&&(a.bindVAO(this._tileInfoVertexArrayObject),a.bindProgram(this._tileInfoProgram),a.bindTexture(d,0),this._tileInfoProgram.setUniformMatrix3fv("u_dvsMat3",b.transforms.dvs),this._tileInfoProgram.setUniform1f("u_depth",0),this._tileInfoProgram.setUniform2f("u_coord_ratio",b.coordRange[0]/b.size[0],b.coordRange[1]/
b.size[1]),this._tileInfoProgram.setUniform2f("u_delta",8,8),this._tileInfoProgram.setUniform2f("u_dimensions",d.descriptor.width,d.descriptor.height),a.drawArrays(5,0,4),a.bindVAO())}};d.prototype._loadWGLResources=function(a){if(!this._outlineProgram||!this._tileInfoProgram){var d=b.createProgram(a,m.background),l=b.createProgram(a,f.tileInfo),c={geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}]},u=new Int8Array([0,0,1,0,1,1,0,1]),u=b.BufferObject.createVertex(a,
35044,u),u=new b.VertexArrayObject(a,m.background.attributes,c,{geometry:u}),q=new Int8Array([0,0,1,0,0,1,1,1]),q=b.BufferObject.createVertex(a,35044,q);a=new b.VertexArrayObject(a,f.tileInfo.attributes,c,{geometry:q});this._outlineProgram=d;this._tileInfoProgram=l;this._outlineVertexArrayObject=u;this._tileInfoVertexArrayObject=a}};d.prototype._getTexture=function(a,d){if(d.texture)return d.texture;this._canvas||(this._canvas=document.createElement("canvas"),this._canvas.setAttribute("id","canvas2d"),
this._canvas.setAttribute("width","300"),this._canvas.setAttribute("height","32"),this._canvas.setAttribute("style","display:none"));var f=d.triangleCount,l=d.key.id;0<d.triangleCount&&(l+=", "+f);var c=this._canvas,q=c.getContext("2d");q.font="24px sans-serif";q.textAlign="left";q.textBaseline="top";q.clearRect(0,0,300,32);1E5<f?(q.fillStyle="red",q.fillRect(0,0,300,32),q.fillStyle="black"):(q.clearRect(0,0,300,32),q.fillStyle="blue");q.fillText(l,0,0);d.texture=new b.Texture(a,{target:3553,pixelFormat:6408,
dataType:5121,samplingMode:9728,wrapMode:33071},c);return d.texture};return d}(g.default);a.default=e})},"esri/views/2d/engine/webgl/brushes/WGLBrush":function(){define(["require","exports"],function(e,a){Object.defineProperty(a,"__esModule",{value:!0});e=function(){function a(){this.name=this.constructor.name||"UnnamedBrush"}a.prototype.prepareState=function(a,b,c){};a.prototype.draw=function(a,b,c){};a.prototype.drawMany=function(a,b,c){for(var g=0;g<b.length;g++)this.draw(a,b[g],c)};return a}();
a.default=e})},"esri/views/2d/engine/webgl/shaders/BackgroundPrograms":function(){define(["require","exports","./sources/resolver"],function(e,a,c){Object.defineProperty(a,"__esModule",{value:!0});a.background={name:"background",shaders:{vertexShader:c.resolveIncludes("background/background.vert"),fragmentShader:c.resolveIncludes("background/background.frag")},attributes:{a_pos:0}}})},"esri/views/2d/engine/webgl/shaders/sources/resolver":function(){define(["require","exports","../../../../../webgl",
"./shaderRepository"],function(e,a,c,h){Object.defineProperty(a,"__esModule",{value:!0});var b=new c.ShaderCompiler(function(a){var b=h;a.split("/").forEach(function(a){b&&(b=b[a])});return b});a.resolveIncludes=function(a){return b.resolveIncludes(a)}})},"esri/views/2d/engine/webgl/shaders/sources/shaderRepository":function(){define(["require","exports"],function(e,a){return{background:{"background.frag":"uniform lowp vec4 u_color;\nvoid main() {\n  gl_FragColor \x3d u_color;\n}","background.vert":"attribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform mediump vec2 u_coord_range;\nuniform mediump float u_depth;\nvoid main() {\n  vec3 v_pos \x3d u_dvsMat3 * vec3(u_coord_range * a_pos, 1.0);\n  gl_Position \x3d vec4(v_pos.xy, 0.0, 1.0);\n}"},
bitBlit:{"bitBlit.frag":"uniform lowp sampler2D u_tex;\nuniform lowp float u_opacity;\nvarying mediump vec2 v_uv;\nvoid main() {\n  lowp vec4 color \x3d texture2D(u_tex, v_uv);\n  gl_FragColor \x3d color *  u_opacity;\n}","bitBlit.vert":"attribute vec2 a_pos;\nattribute vec2 a_tex;\nvarying mediump vec2 v_uv;\nvoid main(void) {\n  gl_Position \x3d vec4(a_pos, 0.0, 1.0);\n  v_uv \x3d a_tex;\n}"},filtering:{"bicubic.glsl":"vec4 computeWeights(float v) {\n  float b \x3d 1.0 / 6.0;\n  float v2 \x3d v * v;\n  float v3 \x3d v2 * v;\n  float w0 \x3d b * (-v3 + 3.0 * v2 - 3.0 * v + 1.0);\n  float w1 \x3d b * (3.0 * v3  - 6.0 * v2 + 4.0);\n  float w2 \x3d b * (-3.0 * v3 + 3.0 * v2 + 3.0 * v + 1.0);\n  float w3 \x3d b * v3;\n  return vec4(w0, w1, w2, w3);\n}\nvec4 bicubicOffsetsAndWeights(float v) {\n  vec4 w \x3d computeWeights(v);\n  float g0 \x3d w.x + w.y;\n  float g1 \x3d w.z + w.w;\n  float h0 \x3d 1.0 - (w.y / g0) + v;\n  float h1 \x3d 1.0 + (w.w / g1) - v;\n  return vec4(h0, h1, g0, g1);\n}\nvec4 sampleBicubicBSpline(sampler2D sampler, vec2 coords, vec2 texSize) {\n  vec2 eX \x3d vec2(1.0 / texSize.x, 0.0);\n  vec2 eY \x3d vec2(0.0, 1.0 / texSize.y);\n  vec2 texel \x3d coords * texSize - 0.5;\n  vec3 hgX \x3d bicubicOffsetsAndWeights(fract(texel).x).xyz;\n  vec3 hgY \x3d bicubicOffsetsAndWeights(fract(texel).y).xyz;\n  vec2 coords10 \x3d coords + hgX.x * eX;\n  vec2 coords00 \x3d coords - hgX.y * eX;\n  vec2 coords11 \x3d coords10 + hgY.x * eY;\n  vec2 coords01 \x3d coords00 + hgY.x * eY;\n  coords10 \x3d coords10 - hgY.y * eY;\n  coords00 \x3d coords00 - hgY.y * eY;\n  vec4 color00 \x3d texture2D(sampler, coords00);\n  vec4 color10 \x3d texture2D(sampler, coords10);\n  vec4 color01 \x3d texture2D(sampler, coords01);\n  vec4 color11 \x3d texture2D(sampler, coords11);\n  color00 \x3d mix(color00, color01, hgY.z);\n  color10 \x3d mix(color10, color11, hgY.z);\n  color00 \x3d mix(color00, color10, hgX.z);\n  return color00;\n}",
"bilinear.glsl":"vec4 sampleBilinear(sampler2D sampler, vec2 coords, vec2 texSize) {\n  vec2 texelStart \x3d floor(coords * texSize);\n  vec2 coord0 \x3d texelStart / texSize;\n  vec2 coord1 \x3d (texelStart +  vec2(1.0, 0.0)) / texSize;\n  vec2 coord2 \x3d (texelStart +  vec2(0.0, 1.0)) / texSize;\n  vec2 coord3 \x3d (texelStart +  vec2(1.0, 1.0)) / texSize;\n  vec4 color0 \x3d texture2D(sampler, coord0);\n  vec4 color1 \x3d texture2D(sampler, coord1);\n  vec4 color2 \x3d texture2D(sampler, coord2);\n  vec4 color3 \x3d texture2D(sampler, coord3);\n  vec2 blend \x3d fract(coords * texSize);\n  vec4 color01 \x3d mix(color0, color1, blend.x);\n  vec4 color23 \x3d mix(color2, color3, blend.x);\n  return mix(color01, color23, blend.y);\n}",
"epx.glsl":"vec4 sampleEPX(sampler2D sampler, float size, vec2 coords, vec2 texSize) {\n  vec2 invSize \x3d 1.0 / texSize;\n  vec2 texel \x3d coords * texSize;\n  vec2 texel_i \x3d floor(texel);\n  vec2 texel_frac \x3d fract(texel);\n  vec4 colorP \x3d texture2D(sampler, texel_i * invSize);\n  vec4 colorP1 \x3d vec4(colorP);\n  vec4 colorP2 \x3d vec4(colorP);\n  vec4 colorP3 \x3d vec4(colorP);\n  vec4 colorP4 \x3d vec4(colorP);\n  vec4 colorA \x3d texture2D(sampler, (texel_i - vec2(0.0, 1.0)) * invSize);\n  vec4 colorB \x3d texture2D(sampler, (texel_i + vec2(1.0, 0.0)) * invSize);\n  vec4 colorC \x3d texture2D(sampler, (texel_i - vec2(1.0, 0.0)) * invSize);\n  vec4 colorD \x3d texture2D(sampler, (texel_i + vec2(0.0, 1.0)) * invSize);\n  if (colorC \x3d\x3d colorA \x26\x26 colorC !\x3d colorD \x26\x26 colorA !\x3d colorB) {\n    colorP1 \x3d colorA;\n  }\n  if (colorA \x3d\x3d colorB \x26\x26 colorA !\x3d colorC \x26\x26 colorB !\x3d colorD) {\n    colorP2 \x3d colorB;\n  }\n  if (colorD \x3d\x3d colorC \x26\x26 colorD !\x3d colorB \x26\x26 colorC !\x3d colorA) {\n    colorP3 \x3d colorC;\n  }\n  if (colorB \x3d\x3d colorD \x26\x26 colorB !\x3d colorA \x26\x26 colorD !\x3d colorC) {\n    colorP4 \x3d colorD;\n  }\n  vec4 colorP12 \x3d mix(colorP1, colorP2, texel_frac.x);\n  vec4 colorP34 \x3d mix(colorP1, colorP2, texel_frac.x);\n  return mix(colorP12, colorP34, texel_frac.y);\n}"},
fx:{integrate:{"integrate.frag":"precision mediump float;\nuniform lowp sampler2D u_sourceTexture;\nuniform lowp sampler2D u_maskTexture;\nuniform mediump float u_zoomLevel;\nuniform highp float u_timeDelta;\nuniform highp float u_animationTime;\nvarying highp vec2 v_texcoord;\n#include \x3cmaterials/utils.glsl\x3e\nvoid main()\n{\n#ifdef DELTA\n  vec4 texel \x3d texture2D(u_sourceTexture, v_texcoord);\n  vec4 data0 \x3d texture2D(u_maskTexture, v_texcoord);\n  float flags \x3d data0.r * 255.0;\n  float groupMinZoom \x3d data0.g * 255.0;\n  float isVisible \x3d getFilterBit(flags, 0);\n  float wouldClip \x3d step(groupMinZoom, u_zoomLevel);\n  float direction \x3d wouldClip * 1.0 + (1.0 - wouldClip) * -1.0;\n  float dt \x3d u_timeDelta / max(u_animationTime, 0.0001);\n  vec4 nextState \x3d vec4(texel + direction * dt);\n  gl_FragColor \x3d  vec4(nextState);\n#elif defined(UPDATE)\n  vec4 texel \x3d texture2D(u_sourceTexture, v_texcoord);\n  gl_FragColor \x3d texel;\n#endif\n}",
"integrate.vert":"precision mediump float;\nattribute vec2 a_pos;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\n  v_texcoord \x3d a_pos;\n  gl_Position \x3d vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\n}"}},highlight:{"blur.frag":"varying mediump vec2 v_texcoord;\nuniform mediump vec4 u_direction;\nuniform mediump mat4 u_channelSelector;\nuniform mediump vec4 u_sigmas;\nuniform sampler2D u_texture;\nmediump vec4 gauss4(mediump vec2 dir) {\n  return exp(-dot(dir, dir) / (2.0 * u_sigmas * u_sigmas));\n}\nmediump float gauss1(mediump vec2 dir) {\n  return exp(-dot(dir, dir) / (2.0 * u_sigmas[3] * u_sigmas[3]));\n}\nmediump vec4 selectChannel(mediump vec4 sample) {\n  return u_channelSelector * sample;\n}\nvoid accumGauss4(mediump float i, inout mediump vec4 tot, inout mediump vec4 weight) {\n  mediump vec4 w \x3d gauss4(i * u_direction.xy);\n  tot +\x3d selectChannel(texture2D(u_texture, v_texcoord + i * u_direction.zw)) * w;\n  weight +\x3d w;\n}\nvoid accumGauss1(mediump float i, inout mediump float tot, inout mediump float weight) {\n  mediump float w \x3d gauss1(i * u_direction.xy);\n  tot +\x3d selectChannel(texture2D(u_texture, v_texcoord + i * u_direction.zw))[3] * w;\n  weight +\x3d w;\n}\nvoid main(void) {\n  mediump float tot \x3d 0.0;\n  mediump float weight \x3d 0.0;\n  accumGauss1(-4.0, tot, weight);\n  accumGauss1(-3.0, tot, weight);\n  accumGauss1(-2.0, tot, weight);\n  accumGauss1(-1.0, tot, weight);\n  accumGauss1(0.0, tot, weight);\n  accumGauss1(1.0, tot, weight);\n  accumGauss1(2.0, tot, weight);\n  accumGauss1(3.0, tot, weight);\n  accumGauss1(4.0, tot, weight);\n  gl_FragColor \x3d vec4(0.0, 0.0, 0.0, tot / weight);\n}",
"highlight.frag":"varying mediump vec2 v_texcoord;\nuniform sampler2D u_texture;\nuniform mediump vec4 u_sigmas;\nuniform sampler2D u_shade;\nuniform mediump vec2 u_minMaxDistance;\nmediump float estimateDistance() {\n  mediump float sigma \x3d u_sigmas[3];\n  mediump float y \x3d texture2D(u_texture, v_texcoord)[3];\n  const mediump float y0 \x3d 0.5;\n  mediump float m0 \x3d 1.0 / (sqrt(2.0 * 3.1415) * sigma);\n  mediump float d \x3d (y - y0) / m0;\n  return d;\n}\nmediump vec4 shade(mediump float d) {\n  mediump float mappedDistance \x3d (d - u_minMaxDistance.x) / (u_minMaxDistance.y - u_minMaxDistance.x);\n  mappedDistance \x3d clamp(mappedDistance, 0.0, 1.0);\n  return texture2D(u_shade, vec2(mappedDistance, 0.5));\n}\nvoid main(void) {\n  mediump float d \x3d estimateDistance();\n  gl_FragColor \x3d shade(d);\n}",
"textured.vert":"attribute mediump vec2 a_position;\nattribute mediump vec2 a_texcoord;\nvarying mediump vec2 v_texcoord;\nvoid main(void) {\n  gl_Position \x3d vec4(a_position, 0.0, 1.0);\n  v_texcoord \x3d a_texcoord;\n}"},magnifier:{"magnifier.frag":"uniform lowp vec4 u_background;\nuniform mediump sampler2D u_readbackTexture;\nuniform mediump sampler2D u_maskTexture;\nuniform mediump sampler2D u_overlyTexture;\nvarying mediump vec2 v_texCoord;\nvoid main(void)\n{\n  lowp vec4 color \x3d texture2D(u_readbackTexture, v_texCoord);\n  color \x3d color + (1.0 - color.a) * u_background;\n  lowp vec4 mask_color \x3d texture2D(u_maskTexture, v_texCoord);\n  lowp float gray \x3d 1.0 - dot(mask_color, vec4(0.3, 0.59, 0.11, 0));\n  color *\x3d gray;\n  lowp vec4 overley_color \x3d texture2D(u_overlyTexture, v_texCoord);\n  overley_color.rgb *\x3d overley_color.a;\n  gl_FragColor \x3d overley_color + (1.0 - overley_color.a) * color;\n}",
"magnifier.vert":"precision mediump float;\nattribute mediump vec2 a_pos;\nuniform mediump vec2 u_drawPos;\nuniform mediump float u_width;\nuniform mediump float u_height;\nvarying mediump vec2 v_texCoord;\nvoid main(void)\n{\n  v_texCoord \x3d a_pos;\n  vec2 coord \x3d u_drawPos + vec2(a_pos - 0.5) * vec2(u_width, u_height);\n  gl_Position \x3d vec4(coord, 0.0, 1.0);\n}"},materials:{"attributeData.glsl":"uniform highp sampler2D u_attributeData0;\nuniform highp sampler2D u_attributeData1;\nuniform highp sampler2D u_attributeData2;\nuniform highp sampler2D u_attributeData3;\nuniform highp int u_attributeTextureSize;\nhighp vec2 getAttributeDataCoords(in highp vec4 id) {\n  highp vec4 texel \x3d unpackLocalIdTexel(id);\n  highp float size \x3d float(u_attributeTextureSize);\n  highp float u32 \x3d float(int(texel.r) + int(texel.g) * 256 + int(texel.b) * 256 * 256 + int(texel.a) * 256 * 256 * 256);\n  highp float col \x3d mod(u32, size);\n  highp float row \x3d (u32 - col) / size;\n  highp float u \x3d col / size;\n  highp float v \x3d row / size;\n  return vec2(u, v);\n}\nhighp vec4 getAttributeData0(in highp vec4 id) {\n  vec2 coords \x3d getAttributeDataCoords(id);\n  return texture2D(u_attributeData0, coords);\n}\nhighp vec4 getAttributeData1(in highp vec4 id) {\n  highp vec2 coords \x3d getAttributeDataCoords(id);\n  return texture2D(u_attributeData1, coords);\n}\nhighp vec4 getAttributeData2(in highp vec4 id) {\n  highp vec2 coords \x3d getAttributeDataCoords(id);\n  return texture2D(u_attributeData2, coords);\n}\nhighp vec4 getAttributeData3(in highp vec4 id) {\n  highp vec2 coords \x3d getAttributeDataCoords(id);\n  return texture2D(u_attributeData3, coords);\n}\nfloat u88VVToFloat(in vec2 v) {\n  bool isMagic \x3d v.x \x3d\x3d 255.0 \x26\x26 v.y \x3d\x3d 255.0;\n  if (isMagic) {\n    return NAN_MAGIC_NUMBER;\n  }\n  return (v.x + v.y * float(0x100)) - 32768.0;\n}",
"constants.glsl":"const float C_DEG_TO_RAD \x3d 3.14159265359 / 180.0;\nconst float SIGNED_BYTE_TO_UNSIGNED \x3d 128.0;\nconst float SOFT_EDGE_RATIO \x3d 1.0;\nconst float THIN_LINE_WIDTH_FACTOR \x3d 1.1;\nconst float THIN_LINE_HALF_WIDTH \x3d 1.0;\nconst float OFFSET_PRECISION \x3d 1.0 / 8.0;\nconst float OUTLINE_SCALE \x3d 1.0 / 5.0;\nconst float SDF_FONT_SIZE \x3d 24.0;\nconst float MAX_SDF_DISTANCE \x3d 8.0;\nconst float PLACEMENT_PADDING \x3d 8.0;\nconst float EPSILON \x3d 0.0000001;\nconst int MAX_FILTER_COUNT \x3d 2;\nconst int ATTR_VV_SIZE \x3d 0;\nconst int ATTR_VV_COLOR \x3d 1;\nconst int ATTR_VV_OPACITY \x3d 2;\nconst int ATTR_VV_ROTATION \x3d 3;\nconst highp float NAN_MAGIC_NUMBER \x3d 1e-30;",
"effects.glsl":"uniform highp mat4 u_insideEffectMat4[ MAX_FILTER_COUNT ];\nuniform highp mat4 u_outsideEffectMat4[ MAX_FILTER_COUNT ];\nuniform highp float u_insideOpacities[ MAX_FILTER_COUNT ];\nuniform highp float u_outsideOpacities[ MAX_FILTER_COUNT ];\nvec4 getEffectColor(in vec4 color, in float filterFlags) {\n  vec4 rgbw \x3d vec4(color.a \x3e 0.0 ? color.rgb / color.a : vec3(0.0), 1.0);\n  float a \x3d color.a;\n  for (int i \x3d 1; i \x3c EFFECT_COUNT + 1; i++) {\n    float bit \x3d getFilterBit(filterFlags, i);\n    rgbw \x3d u_insideEffectMat4[ i ] * (bit  * rgbw) + u_outsideEffectMat4[ i ] * ((1.0 - bit) * rgbw);\n    a    \x3d u_insideOpacities[ i ]  * (bit  * a)    + u_outsideOpacities[ i ]  * ((1.0 - bit) * a);\n  }\n  return vec4(rgbw.rgb * a, a);\n}\nvec3 applyFilter(inout vec4 color, inout vec3 pos, in float filterFlags) {\n  vec4 rgbw \x3d vec4(color.a \x3e 0.0 ? color.rgb / color.a : vec3(0.0), 1.0);\n  float a \x3d color.a;\n  for (int i \x3d 0; i \x3c EFFECT_COUNT + 1; i++) {\n    float bit \x3d getFilterBit(filterFlags, i);\n    rgbw \x3d u_insideEffectMat4[ i ] * (bit  * rgbw) + u_outsideEffectMat4[ i ] * ((1.0 - bit) * rgbw);\n    a    \x3d u_insideOpacities[ i ]  * (bit  * a)    + u_outsideOpacities[ i ]  * ((1.0 - bit) * a);\n  }\n  color.rgb \x3d rgbw.rgb * a;\n  color.a \x3d a;\n  pos.z +\x3d 2.0 * (1.0 - getFilterBit(filterFlags, 0));\n#ifdef HIGHLIGHT\n  pos.z +\x3d 2.0 * (1.0 - getHighlightBit(filterFlags));\n#endif\n  return pos;\n}\nvec3 applyFilterLabels(inout vec4 color, inout vec3 pos, in float filterFlags) {\n  float bit \x3d getFilterBit(filterFlags, 0);\n  pos.z +\x3d 2.0 * (1.0 - bit);\n#ifndef OUTSIDE_LABELS_VISIBLE\n  for (int i \x3d 1; i \x3c EFFECT_COUNT + 1; i++) {\n    float bit \x3d getFilterBit(filterFlags, i);\n    pos.z +\x3d 2.0 * (1.0 - bit);\n  }\n#endif\n  return pos;\n}",
fill:{"common.glsl":"#ifdef PATTERN\nuniform mediump vec2 u_mosaicSize;\n#endif\n#ifdef DOT_DENSITY\nuniform lowp vec4 u_isActive[ 2 ];\nuniform highp float u_dotValue;\nuniform highp float u_tileDotsOverArea;\nuniform highp float u_dotTextureDotCount;\nuniform mediump float u_tileZoomFactor;\n#endif\nvarying vec3 v_pos;\nvarying lowp float v_opacity;\nvarying lowp vec4 v_color;\nvarying highp vec4 v_id;\nvarying highp float v_flags;\n#ifdef PATTERN\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_tileTextureCoord;\n#endif\n#ifdef DOT_DENSITY\nvarying vec2 v_dotTextureCoords;\nvarying vec4 v_dotThresholds[ 2 ];\n#endif",
"fill.frag":"precision highp float;\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cmaterials/fill/common.glsl\x3e\n#ifdef DOT_DENSITY\n#include \x3cmaterials/effects.glsl\x3e\n#endif\n#ifdef PATTERN\nuniform lowp sampler2D u_texture;\n#endif\n#ifdef DOT_DENSITY\nuniform mediump mat4 u_dotColors[ 2 ];\nuniform sampler2D u_dotTextures[ 2 ];\nuniform vec4 u_dotBackgroundColor;\n#endif\nvoid main() {\n#ifdef ID\n  gl_FragColor \x3d v_id;\n#elif defined(PATTERN)\n  mediump vec2 normalizedTextureCoord \x3d mod(v_tileTextureCoord, 1.0);\n  mediump vec2 samplePos \x3d mix(v_tlbr.xy, v_tlbr.zw, normalizedTextureCoord);\n  lowp vec4 color \x3d texture2D(u_texture, samplePos);\n  gl_FragColor \x3d v_opacity * v_color * color;\n#elif defined(DOT_DENSITY) \x26\x26 !defined(HIGHLIGHT)\n  vec4 textureThresholds0 \x3d texture2D(u_dotTextures[0], v_dotTextureCoords);\n  vec4 textureThresholds1 \x3d texture2D(u_dotTextures[1], v_dotTextureCoords);\n  vec4 difference0 \x3d v_dotThresholds[0] - textureThresholds0;\n  vec4 difference1 \x3d v_dotThresholds[1] - textureThresholds1;\n#ifdef DD_DOT_BLENDING\n  vec4 isPositive0 \x3d step(0.0, difference0);\n  vec4 isPositive1 \x3d step(0.0, difference1);\n  float weightSum \x3d dot(isPositive0, difference0) + dot(isPositive1, difference1);\n  float lessThanEqZero \x3d step(weightSum, 0.0);\n  float greaterThanZero \x3d 1.0 - lessThanEqZero ;\n  float divisor \x3d (weightSum + lessThanEqZero);\n  vec4 weights0 \x3d difference0 * isPositive0 / divisor;\n  vec4 weights1 \x3d difference1 * isPositive1 / divisor;\n  vec4 dotColor \x3d u_dotColors[0] * weights0 + u_dotColors[1] * weights1;\n  vec4 preEffectColor \x3d greaterThanZero * dotColor + lessThanEqZero * u_dotBackgroundColor;\n#else\n  float diffMax \x3d max(max4(difference0), max4(difference1));\n  float lessThanZero \x3d step(diffMax, 0.0);\n  float greaterOrEqZero \x3d 1.0 - lessThanZero;\n  vec4 isMax0 \x3d step(diffMax, difference0);\n  vec4 isMax1 \x3d step(diffMax, difference1);\n  vec4 dotColor \x3d u_dotColors[0] * isMax0 + u_dotColors[1] * isMax1;\n  vec4 preEffectColor \x3d greaterOrEqZero * dotColor + lessThanZero * u_dotBackgroundColor;\n#endif\n  gl_FragColor \x3d getEffectColor(preEffectColor, v_flags);\n#else\n  gl_FragColor \x3d v_opacity * v_color;\n#endif\n#ifdef HIGHLIGHT\n  gl_FragColor.a \x3d 1.0;\n#endif\n}",
"fill.vert":"precision mediump float;\n#ifdef DOT_DENSITY\nattribute float a_inverseArea;\nvec4 a_color \x3d vec4(0.0, 0.0, 0.0, 1.0);\nvec4 a_aux3 \x3d vec4(0.0);\n#else\nattribute vec4 a_color;\nattribute vec4 a_tlbr;\nattribute vec4 a_aux1;\nattribute vec2 a_aux2;\nattribute vec4 a_aux3;\n#endif\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/fill/common.glsl\x3e\n#ifdef DOT_DENSITY\nvec4 dotThreshold(vec4 featureAttrOverFeatureArea, float dotValue, float tileDotsOverArea) {\n  return featureAttrOverFeatureArea * (1.0 / dotValue)  * (1.0 / tileDotsOverArea);\n}\n#endif\n#ifdef PATTERN\nmat3 getPatternMatrix() {\n  mat3 patternMatrix \x3d mat3(1.0);\n  vec2 aux2 \x3d (1.0 / SIGNED_BYTE_TO_UNSIGNED) * a_aux2;\n  patternMatrix[0][0] \x3d 1.0 / (u_zoomFactor * a_aux1.x * aux2.x);\n  patternMatrix[1][1] \x3d 1.0 / (u_zoomFactor * a_aux1.y * aux2.y);\n  return patternMatrix;\n}\n#endif\nvoid main()\n{\n  INIT;\n  float a_bitSet \x3d a_aux3.a;\n  v_color     \x3d getColor(a_color, a_bitSet, 0);\n  v_opacity   \x3d getOpacity(a_bitSet, 1);\n  v_id        \x3d norm(a_id);\n  v_pos       \x3d u_dvsMat3 * vec3(a_pos, 1.);\n  v_flags     \x3d getFilterFlags();\n#ifdef PATTERN\n  vec2 symbolOffset \x3d u_zoomFactor * (a_aux1.zw - SIGNED_BYTE_TO_UNSIGNED);\n  v_tileTextureCoord \x3d (getPatternMatrix() * vec3(a_pos + symbolOffset, 1.0)).xy;\n  v_tlbr \x3d a_tlbr / u_mosaicSize.xyxy;\n#elif defined(DOT_DENSITY)\n  vec4 ddAttributeData0 \x3d getAttributeData2(a_id) * u_isActive[0] * a_inverseArea;\n  vec4 ddAttributeData1 \x3d getAttributeData3(a_id) * u_isActive[1] * a_inverseArea;\n  float size \x3d u_tileZoomFactor * 512.0 * 1.0 / u_pixelRatio;\n  v_dotThresholds[0] \x3d dotThreshold(ddAttributeData0, u_dotValue, u_tileDotsOverArea);\n  v_dotThresholds[1] \x3d dotThreshold(ddAttributeData1, u_dotValue, u_tileDotsOverArea);\n  v_dotTextureCoords \x3d (a_pos + 0.5) / size;\n#endif\n  gl_Position \x3d vec4(applyFilter(v_color, v_pos, v_flags), 1.0);\n}"},
icon:{"common.glsl":"uniform lowp vec2 u_mosaicSize;\nvarying lowp vec4 v_color;\nvarying highp vec4 v_id;\nvarying vec4 v_sizeTex;\nvarying vec3 v_pos;\nvarying float v_filters;\nvarying lowp float v_opacity;\n#ifdef SDF\nvarying lowp vec4 v_outlineColor;\nvarying mediump float v_outlineWidth;\nvarying mediump float v_distRatio;\nvarying float v_overridingOutlineColor;\nvarying float v_isThin;\n#endif","icon.frag":"precision mediump float;\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cutil/encoding.glsl\x3e\n#include \x3cmaterials/effects.glsl\x3e\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/icon/common.glsl\x3e\nuniform lowp sampler2D u_texture;\nvoid main()\n{\n  vec2 v_size \x3d v_sizeTex.xy;\n  vec2 v_tex  \x3d v_sizeTex.zw;\n#ifdef SDF\n  lowp vec4 fillPixelColor \x3d v_color;\n  float d \x3d 0.5 - rgba2float(texture2D(u_texture, v_tex));\n  float size \x3d max(v_size.x, v_size.y);\n  float dist \x3d d * size * SOFT_EDGE_RATIO * v_distRatio;\n  fillPixelColor *\x3d clamp(0.5 - dist, 0.0, 1.0);\n  float outlineWidth \x3d v_outlineWidth;\n  #ifdef HIGHLIGHT\n    outlineWidth \x3d max(outlineWidth, 4.0 * v_isThin);\n  #endif\n  if (outlineWidth \x3e 0.25) {\n    lowp vec4 outlinePixelColor \x3d v_overridingOutlineColor * v_color + (1.0 - v_overridingOutlineColor) * v_outlineColor;\n    float clampedOutlineSize \x3d min(outlineWidth, size);\n    outlinePixelColor *\x3d clamp(0.5 - abs(dist) + clampedOutlineSize * 0.5, 0.0, 1.0);\n    gl_FragColor \x3d v_opacity * ((1.0 - outlinePixelColor.a) * fillPixelColor + outlinePixelColor);\n  }\n  else {\n    gl_FragColor \x3d v_opacity * fillPixelColor;\n  }\n#else\n   lowp vec4 texColor \x3d texture2D(u_texture, v_tex);\n   gl_FragColor \x3d v_opacity * getEffectColor(texColor, v_filters);\n#endif\n#ifdef HIGHLIGHT\n  gl_FragColor.a \x3d step(1.0 / 255.0, gl_FragColor.a);\n#endif\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"icon.vert":"precision mediump float;\nattribute vec4 a_color;\nattribute vec4 a_outlineColor;\nattribute vec4 a_sizeAndOutlineWidth;\nattribute vec2 a_vertexOffset;\nattribute vec2 a_texCoords;\nattribute vec4 a_bitSetAndDistRatio;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/icon/common.glsl\x3e\nvec2 getMarkerSize(inout vec2 offset, inout vec2 baseSize, inout float outlineSize, in float referenceSize, in float bitSet) {\n#ifdef VV_SIZE\n  float r \x3d getSize(baseSize.y) / referenceSize;\n  baseSize.xy *\x3d r;\n  offset.xy *\x3d r;\n  float scaleSymbolProportionally \x3d getBit(bitSet, 3);\n  outlineSize *\x3d scaleSymbolProportionally * (r - 1.0) + 1.0;\n#endif\n  return baseSize;\n}\nvec3 getOffset(in vec2 in_offset, float a_bitSet) {\n  float isMapAligned \x3d getBit(a_bitSet, 0);\n  vec3  offset       \x3d getRotation() * vec3(in_offset, 0.0);\n  return getMatrix(isMapAligned) * offset;\n}\nvoid main()\n{\n  INIT;\n  vec2  a_size   \x3d a_sizeAndOutlineWidth.xy * a_sizeAndOutlineWidth.xy / 256.0;\n  vec2  a_offset \x3d a_vertexOffset / 16.0;\n  float a_outlineSize \x3d a_sizeAndOutlineWidth.z * a_sizeAndOutlineWidth.z / 256.0;\n  float a_bitSet \x3d a_bitSetAndDistRatio.z;\n  vec2 v_size \x3d getMarkerSize(a_offset, a_size, a_outlineSize, a_sizeAndOutlineWidth.w * a_sizeAndOutlineWidth.w / 256.0, a_bitSet);\n  vec2 v_tex      \x3d a_texCoords / u_mosaicSize;\n  v_color    \x3d getColor(a_color, a_bitSet, 1);\n  v_opacity  \x3d getOpacity(a_bitSet, 1);\n  v_id       \x3d norm(a_id);\n  v_filters  \x3d getFilterFlags();\n  v_pos      \x3d u_dvsMat3 * vec3(a_pos, 1.0) + getOffset(a_offset, a_bitSet);\n  v_sizeTex  \x3d vec4(v_size.xy, v_tex.xy);\n#ifdef SDF\n  v_isThin   \x3d getBit(a_bitSet, 2);\n  #ifdef VV_COLOR\n    v_overridingOutlineColor \x3d v_isThin;\n  #else\n    v_overridingOutlineColor \x3d 0.0;\n  #endif\n  v_outlineWidth \x3d min(a_outlineSize, max(max(v_size.x, v_size.y) - 0.99, 0.0));\n  v_outlineColor \x3d getEffectColor(a_outlineColor, v_filters);\n  v_distRatio \x3d a_bitSetAndDistRatio.w / 126.0;\n#endif\n  gl_Position \x3d vec4(applyFilter(v_color, v_pos, v_filters), 1.0);\n}"},
label:{"common.glsl":"uniform mediump float u_zoomLevel;\nuniform float u_mapRotation;\nuniform float u_mapAligned;\nuniform vec2 u_mosaicSize;\nvarying mediump float v_antialiasingWidth;\nvarying mediump float v_edgeDistanceOffset;\nvarying mediump vec2 v_tex;\nvarying mediump vec4 v_color;\nvarying lowp vec4 v_animation;","label.frag":"precision mediump float;\n#include \x3cmaterials/label/common.glsl\x3e\nuniform mediump vec2 u_screenSize;\nuniform highp float u_pixelRatio;\nuniform lowp sampler2D u_texture;\nvoid main()\n{\n  mediump vec2 refTextPos \x3d gl_FragCoord.xy / (u_pixelRatio * u_screenSize.xy);\n  lowp float dist \x3d texture2D(u_texture, v_tex).a;\n  float glyphEdgeDistance \x3d max(0.75 - v_edgeDistanceOffset, 0.25);\n  lowp float sdfAlpha \x3d smoothstep(glyphEdgeDistance - v_antialiasingWidth, glyphEdgeDistance + v_antialiasingWidth, dist);\n  gl_FragColor \x3d v_animation.r * sdfAlpha * v_color;\n}",
"label.vert":"precision mediump float;\nattribute vec4 a_color;\nattribute vec2 a_vertexOffset;\nattribute vec4 a_texAndSize;\nattribute vec4 a_refSymbolAndPlacementOffset;\nattribute vec4 a_zoomRangeAndEmpty;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/label/common.glsl\x3e\nfloat getZ(in float minZoom, in float maxZoom, in float angle) {\n  float glyphAngle \x3d angle * 360.0 / 254.0;\n  float mapAngle \x3d u_mapRotation * 360.0 / 254.0;\n  float diffAngle \x3d min(360.0 - abs(mapAngle - glyphAngle), abs(mapAngle - glyphAngle));\n  float z \x3d 0.0;\n  z +\x3d u_mapAligned * (2.0 * (1.0 - step(minZoom, u_zoomLevel)));\n  z +\x3d u_mapAligned * 2.0 * step(90.0, diffAngle);\n  z +\x3d 2.0 * (1.0 - step(u_zoomLevel, maxZoom));\n  return z;\n}\nvoid main()\n{\n  INIT;\n  float groupMinZoom    \x3d getMinZoom();\n  float glyphMinZoom    \x3d a_zoomRangeAndEmpty.x;\n  float a_minZoom       \x3d max(groupMinZoom, glyphMinZoom);\n  float a_maxZoom       \x3d a_zoomRangeAndEmpty.y;\n  vec2  a_placementDir  \x3d a_refSymbolAndPlacementOffset.zw - 1.0;\n  float a_refSymbolSize \x3d a_refSymbolAndPlacementOffset.y;\n  float fontSize        \x3d a_texAndSize.z;\n  float isHalo          \x3d mod(a_pos, 2.0).x;\n  vec2  vertexOffset \x3d a_vertexOffset * OFFSET_PRECISION;\n  vec3  pos          \x3d vec3(floor(a_pos * 0.5), 1.0);\n  float z            \x3d getZ(a_minZoom, a_maxZoom, a_refSymbolAndPlacementOffset.x);\n  float fontScale    \x3d fontSize / SDF_FONT_SIZE;\n  float halfSize     \x3d getSize(a_refSymbolSize) / 2.0;\n  v_color     \x3d a_color;\n  v_tex       \x3d a_texAndSize.xy / u_mosaicSize;\n  v_animation \x3d pow(getAnimationState(), vec4(2.0));\n  v_edgeDistanceOffset \x3d isHalo * OUTLINE_SCALE * a_texAndSize.w / fontScale / MAX_SDF_DISTANCE;\n  v_antialiasingWidth  \x3d 0.106 * SDF_FONT_SIZE / fontSize / u_pixelRatio;\n  vec2 placementOffset \x3d a_placementDir * (halfSize + PLACEMENT_PADDING);\n  vec3 glyphOffset     \x3d u_displayMat3 * vec3(vertexOffset + placementOffset, 0.0);\n  vec3 v_pos           \x3d vec3((u_dvsMat3 * pos + glyphOffset).xy, z);\n  gl_Position \x3d vec4(applyFilterLabels(v_color, v_pos, getFilterFlags()), 1.0);\n#ifdef DEBUG\n  v_color \x3d vec4(a_color.rgb, z \x3d\x3d 0.0 ? 1.0 : 0.645);\n#endif\n}"},
line:{"common.glsl":"varying lowp vec4 v_color;\nvarying highp vec4 v_id;\nvarying mediump vec2 v_normal;\nvarying mediump float v_lineHalfWidth;\nvarying lowp float v_opacity;\nvarying vec3 v_pos;\n#ifdef PATTERN\nuniform mediump vec2 u_mosaicSize;\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_patternSize;\n#endif\n#if defined(PATTERN) || defined(SDF)\nvarying highp float v_accumulatedDistance;\n#endif","line.frag":"precision lowp float;\n#include \x3cutil/encoding.glsl\x3e\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/line/common.glsl\x3e\nuniform lowp float u_blur;\nuniform mediump float u_zoomFactor;\n#if defined(PATTERN) || defined(SDF)\nuniform sampler2D u_texture;\n#endif\n#ifdef SDF\nconst float sdfPatternHalfWidth \x3d 15.5;\nconst float widthFactor \x3d 2.0;\n#endif\nvoid main()\n{\n  mediump float thinLineFactor \x3d max(THIN_LINE_WIDTH_FACTOR * step(v_lineHalfWidth, THIN_LINE_HALF_WIDTH), 1.0);\n  mediump float fragDist \x3d length(v_normal) * v_lineHalfWidth;\n  lowp float alpha \x3d clamp(thinLineFactor * (v_lineHalfWidth - fragDist) / (u_blur + thinLineFactor - 1.0), 0.0, 1.0);\n#if defined(SDF) \x26\x26 !defined(HIGHLIGHT)\n  mediump float lineHalfWidth \x3d widthFactor * v_lineHalfWidth;\n  mediump float lineWidthRatio \x3d lineHalfWidth / sdfPatternHalfWidth;\n  mediump float relativeTexX \x3d mod((u_zoomFactor * v_accumulatedDistance + v_normal.x * lineHalfWidth) / (lineWidthRatio * v_patternSize.x), 1.0);\n  mediump float relativeTexY \x3d 0.5 + 0.5 * v_normal.y;\n  mediump vec2 texCoord \x3d mix(v_tlbr.xy, v_tlbr.zw, vec2(relativeTexX, relativeTexY));\n  mediump float d \x3d rgba2float(texture2D(u_texture, texCoord)) - 0.5;\n  float dist \x3d d * lineHalfWidth;\n  lowp vec4 fillPixelColor \x3d v_opacity * alpha * clamp(0.5 - dist, 0.0, 1.0) * v_color;\n  gl_FragColor \x3d fillPixelColor;\n#elif defined(PATTERN) \x26\x26 !defined(HIGHLIGHT)\n  mediump float relativeTexX \x3d mod((u_zoomFactor * v_accumulatedDistance + v_normal.x * v_lineHalfWidth) / v_patternSize.x, 1.0);\n  mediump float relativeTexY \x3d 0.5 + (v_normal.y * v_lineHalfWidth / v_patternSize.y);\n  mediump vec2 texCoord \x3d mix(v_tlbr.xy, v_tlbr.zw, vec2(relativeTexX, relativeTexY));\n  lowp vec4 color \x3d texture2D(u_texture, texCoord);\n  gl_FragColor \x3d v_opacity * alpha * v_color * color;\n#else\n  gl_FragColor \x3d v_opacity * alpha * v_color;\n#endif\n#ifdef HIGHLIGHT\n  gl_FragColor.a \x3d step(1.0 / 255.0, gl_FragColor.a);\n#endif\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"line.vert":"precision mediump float;\nattribute vec4 a_color;\nattribute vec4 a_offsetAndNormal;\nattribute vec2 a_accumulatedDistanceAndHalfWidth;\nattribute vec4 a_tlbr;\nattribute vec4 a_segmentDirection;\nattribute vec2 a_aux;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/line/common.glsl\x3e\nconst float SCALE \x3d 1.0 / 31.0;\nfloat getBaseLineHalfWidth(in float in_lineHalfWidth) {\n#ifdef VV_SIZE\n  float referenceHalfWidth \x3d a_aux.x * SCALE;\n  float lineWidth \x3d 2.0 * in_lineHalfWidth;\n  return 0.5 * (in_lineHalfWidth / referenceHalfWidth) * getSize(lineWidth);\n#else\n  return in_lineHalfWidth;\n#endif\n}\nfloat getLineHalfWidth(in float baseWidth, in float aa) {\n  float halfWidth \x3d max(baseWidth + aa, 0.45) + 0.1 * aa;\n#ifdef HIGHLIGHT\n  halfWidth \x3d max(halfWidth, 2.0);\n#endif\n  return halfWidth;\n}\nvec2 getDist(in vec2 offset, in float halfWidth) {\n  float thinLineFactor \x3d max(THIN_LINE_WIDTH_FACTOR * step(halfWidth, THIN_LINE_HALF_WIDTH), 1.0);\n#if defined(SDF) \x26\x26 !defined(HIGHLIGHT)\n  thinLineFactor *\x3d 2.0;\n#endif\n  return thinLineFactor * halfWidth * offset * SCALE;\n}\nvoid main()\n{\n  INIT;\n  float a_bitSet          \x3d a_segmentDirection.w;\n  float a_accumulatedDist \x3d a_accumulatedDistanceAndHalfWidth.x;\n  float a_lineHalfWidth   \x3d a_accumulatedDistanceAndHalfWidth.y * SCALE;\n  float aa                \x3d 0.5 * u_antialiasing;\n  vec2  a_offset          \x3d a_offsetAndNormal.xy;\n  float baseWidth \x3d getBaseLineHalfWidth(a_lineHalfWidth);\n  float halfWidth \x3d getLineHalfWidth(baseWidth, aa);\n  float z         \x3d 2.0 * step(baseWidth, 0.0);\n  vec2  dist      \x3d getDist(a_offset, halfWidth);\n  vec3  offset    \x3d u_displayViewMat3 * vec3(dist, 0.0);\n  vec3  pos       \x3d u_dvsMat3 * vec3(a_pos.xy, 1.0) + offset;\n  v_color         \x3d getColor(a_color, a_bitSet, 0);\n  v_opacity       \x3d getOpacity(a_bitSet, 0);\n  v_lineHalfWidth \x3d halfWidth;\n  v_id            \x3d norm(a_id);\n  v_normal        \x3d a_offsetAndNormal.zw * SCALE;\n  v_pos           \x3d vec3(pos.xy, z);\n#ifdef PATTERN\n  v_tlbr          \x3d a_tlbr / u_mosaicSize.xyxy;\n  v_patternSize   \x3d vec2(a_tlbr.z - a_tlbr.x, a_tlbr.w - a_tlbr.y);\n#endif\n#if defined(PATTERN) || defined(SDF)\n  v_accumulatedDistance \x3d a_accumulatedDist + dot(SCALE * a_segmentDirection.xy, dist / u_zoomFactor);\n#endif\n  gl_Position \x3d vec4(applyFilter(v_color, v_pos, getFilterFlags()), 1.0);\n}"},
text:{"common.glsl":"uniform vec2 u_mosaicSize;\nvarying highp vec4 v_id;\nvarying vec3 v_pos;\nvarying float v_opacity;\nvarying vec4 v_color;\nvarying vec2 v_tex;\nvarying float v_antialiasingWidth;\nvarying float v_edgeDistanceOffset;\nvarying lowp float v_transparency;","text.frag":"precision mediump float;\n#include \x3cmaterials/text/common.glsl\x3e\nuniform lowp sampler2D u_texture;\nvoid main()\n{\n  lowp float dist \x3d texture2D(u_texture, v_tex).a;\n  float glyphEdgeDistance \x3d max(0.75 - v_edgeDistanceOffset, 0.25);\n  #ifdef HIGHLIGHT\n    glyphEdgeDistance /\x3d 2.0;\n  #endif\n  lowp float alpha \x3d smoothstep(glyphEdgeDistance - v_antialiasingWidth, glyphEdgeDistance + v_antialiasingWidth, dist) * v_opacity;\n  gl_FragColor \x3d alpha * v_color;\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"text.vert":"precision mediump float;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/text/common.glsl\x3e\nattribute vec4 a_color;\nattribute vec2 a_vertexOffset;\nattribute vec4 a_texFontSize;\nattribute vec4 a_aux;\nfloat getTextSize(inout vec2 offset, in float baseSize, in float referenceSize) {\n#ifdef VV_SIZE\n   float ratio \x3d baseSize / referenceSize;\n   baseSize \x3d ratio * getSize(baseSize);\n#endif\n  return baseSize;\n}\nvoid main()\n{\n  INIT;\n  float a_bitSet    \x3d a_aux.w;\n  float a_fontSize  \x3d a_texFontSize.z;\n  vec2  a_offset    \x3d a_vertexOffset * OFFSET_PRECISION;\n  float a_isHalo    \x3d getBit(a_pos.x, 0);\n  vec3  in_pos      \x3d vec3(floor(a_pos * 0.5), 1.0);\n  float fontSize    \x3d getTextSize(a_offset, a_fontSize, a_aux.z * a_aux.z / 256.0);\n  float scaleFactor \x3d fontSize / a_fontSize;\n  float fontScale   \x3d fontSize / SDF_FONT_SIZE;\n  vec3  offset      \x3d getRotation() * vec3(scaleFactor * a_offset, 0.0);\n  v_color   \x3d a_isHalo * a_color + (1.0 - a_isHalo) * getColor(a_color, a_bitSet, 0);\n  v_opacity \x3d getOpacity(a_bitSet, 0);\n  v_id      \x3d norm(a_id);\n  v_tex     \x3d a_texFontSize.xy / u_mosaicSize;\n  v_pos     \x3d u_dvsMat3 * in_pos + u_displayMat3 * offset;\n  v_edgeDistanceOffset \x3d a_isHalo * OUTLINE_SCALE * a_texFontSize.w / fontScale / MAX_SDF_DISTANCE;\n  v_antialiasingWidth  \x3d 0.105 * SDF_FONT_SIZE / fontSize / u_pixelRatio;\n  gl_Position \x3d  vec4(applyFilter(v_color, v_pos, getFilterFlags()), 1.0);\n}"},
"utils.glsl":"float rshift(in float u32, in int amount) {\n  return floor(u32 / pow(2.0, float(amount)));\n}\nfloat getBit(in float bitset, in int bitIndex) {\n  float offset \x3d pow(2.0, float(bitIndex));\n  return mod(floor(bitset / offset), 2.0);\n}\nfloat getFilterBit(in float bitset, in int bitIndex) {\n  return getBit(bitset, bitIndex + 1);\n}\nfloat getHighlightBit(in float bitset) {\n  return getBit(bitset, 0);\n}\nhighp vec4 unpackLocalIdTexel(in highp vec4 bitset) {\n  float isAggregate \x3d getBit(bitset.a, 7);\n  return (1.0 - isAggregate) * bitset + isAggregate * (vec4(bitset.rgba) - vec4(0.0, 0.0, 0.0, float(0x80)));\n}\nvec4 unpack(in float u32) {\n  float r \x3d mod(rshift(u32, 0), 255.0);\n  float g \x3d mod(rshift(u32, 8), 255.0);\n  float b \x3d mod(rshift(u32, 16), 255.0);\n  float a \x3d mod(rshift(u32, 24), 255.0);\n  return vec4(r, g, b, a);\n}\nvec4 norm(in vec4 v) {\n  return v /\x3d 255.0;\n}\nfloat max4(vec4 target) {\n  return max(max(max(target.x, target.y), target.z), target.w);\n}",
"vcommon.glsl":"#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cmaterials/attributeData.glsl\x3e\n#include \x3cmaterials/vv.glsl\x3e\n#include \x3cmaterials/effects.glsl\x3e\nattribute vec2 a_pos;\nattribute highp vec4 a_id;\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform highp float u_pixelRatio;\nuniform mediump float u_zoomFactor;\nuniform mediump float u_antialiasing;\nvec4 VV_ADATA \x3d vec4(0.0);\nvoid loadVisualVariableData(inout vec4 target) {\n#ifdef OES_TEXTURE_FLOAT\n  target.rgba \x3d getAttributeData2(a_id);\n#else\n  vec4 data0 \x3d getAttributeData2(a_id);\n  vec4 data1 \x3d getAttributeData3(a_id);\n  target.r \x3d u88VVToFloat(data0.rg * 255.0);\n  target.g \x3d u88VVToFloat(data0.ba * 255.0);\n  target.b \x3d u88VVToFloat(data1.rg * 255.0);\n  target.a \x3d u88VVToFloat(data1.ba * 255.0);\n#endif\n}\n#ifdef VV\n  #define INIT loadVisualVariableData(VV_ADATA)\n#else\n  #define INIT\n#endif\nvec4 getColor(in vec4 a_color, in float a_bitSet, int index) {\n#ifdef VV_COLOR\n  float isColorLocked   \x3d getBit(a_bitSet, index);\n  return getVVColor(VV_ADATA[ATTR_VV_COLOR], a_color, isColorLocked);\n#else\n  return a_color;\n#endif\n}\nfloat getOpacity(in float a_bitSet, in int index) {\n#ifdef VV_OPACITY\n  float isOpacityLocked \x3d getBit(a_bitSet, index);\n  return getVVOpacity(VV_ADATA[ATTR_VV_OPACITY], isOpacityLocked);\n#else\n  return 1.0;\n#endif\n}\nfloat getSize(in float in_size) {\n#ifdef VV_SIZE\n  return getVVSize(in_size, VV_ADATA[ATTR_VV_SIZE]);\n#else\n  return in_size;\n#endif\n}\nmat3 getRotation() {\n#ifdef VV_ROTATION\n  return getVVRotationMat3(VV_ADATA[ATTR_VV_ROTATION]);\n#else\n  return mat3(1.0);\n#endif\n}\nfloat getFilterFlags() {\n#ifdef IGNORES_SAMPLER_PRECISION\n  return ceil(getAttributeData0(a_id).x * 255.0);\n#else\n  return getAttributeData0(a_id).x * 255.0;\n#endif\n}\nvec4 getAnimationState() {\n  return getAttributeData1(a_id);\n}\nfloat getMinZoom() {\n  vec4 data0 \x3d getAttributeData0(a_id) * 255.0;\n  return data0.g;\n}\nmat3 getMatrix(float isMapAligned) {\n  return isMapAligned * u_displayViewMat3 + (1.0 - isMapAligned) * u_displayMat3;\n}",
"vv.glsl":"#if defined(VV_SIZE_MIN_MAX_VALUE) || defined(VV_SIZE_SCALE_STOPS) || defined(VV_SIZE_FIELD_STOPS) || defined(VV_SIZE_UNIT_VALUE)\n  #define VV_SIZE\n#endif\n#if defined(VV_COLOR) || defined(VV_SIZE) || defined(VV_OPACITY) || defined(VV_ROTATION)\n  #define VV\n#endif\n#ifdef VV_COLOR\nuniform highp float u_vvColorValues[8];\nuniform vec4 u_vvColors[8];\n#endif\n#ifdef VV_SIZE_MIN_MAX_VALUE\nuniform highp vec4 u_vvSizeMinMaxValue;\n#endif\n#ifdef VV_SIZE_SCALE_STOPS\nuniform highp float u_vvSizeScaleStopsValue;\n#endif\n#ifdef VV_SIZE_FIELD_STOPS\nuniform highp float u_vvSizeFieldStopsValues[6];\nuniform float u_vvSizeFieldStopsSizes[6];\n#endif\n#ifdef VV_SIZE_UNIT_VALUE\nuniform highp float u_vvSizeUnitValueWorldToPixelsRatio;\n#endif\n#ifdef VV_OPACITY\nuniform highp float u_vvOpacityValues[8];\nuniform float u_vvOpacities[8];\n#endif\n#ifdef VV_ROTATION\nuniform lowp float u_vvRotationType;\n#endif\nbool isNan(float val) {\n  return (val \x3d\x3d NAN_MAGIC_NUMBER);\n}\n#ifdef VV_SIZE_MIN_MAX_VALUE\nfloat getVVMinMaxSize(float sizeValue, float fallback) {\n  if (isNan(sizeValue)) {\n    return fallback;\n  }\n  float interpolationRatio \x3d (sizeValue  - u_vvSizeMinMaxValue.x) / (u_vvSizeMinMaxValue.y - u_vvSizeMinMaxValue.x);\n  interpolationRatio \x3d clamp(interpolationRatio, 0.0, 1.0);\n  return u_vvSizeMinMaxValue.z + interpolationRatio * (u_vvSizeMinMaxValue.w - u_vvSizeMinMaxValue.z);\n}\n#endif\n#ifdef VV_SIZE_FIELD_STOPS\nconst int VV_SIZE_N \x3d 6;\nfloat getVVStopsSize(float sizeValue, float fallback) {\n  if (isNan(sizeValue)) {\n    return fallback;\n  }\n  if (sizeValue \x3c\x3d u_vvSizeFieldStopsValues[0]) {\n    return u_vvSizeFieldStopsSizes[0];\n  }\n  for (int i \x3d 1; i \x3c VV_SIZE_N; ++i) {\n    if (u_vvSizeFieldStopsValues[i] \x3e\x3d sizeValue) {\n      float f \x3d (sizeValue - u_vvSizeFieldStopsValues[i-1]) / (u_vvSizeFieldStopsValues[i] - u_vvSizeFieldStopsValues[i-1]);\n      return mix(u_vvSizeFieldStopsSizes[i-1], u_vvSizeFieldStopsSizes[i], f);\n    }\n  }\n  return u_vvSizeFieldStopsSizes[VV_SIZE_N - 1];\n}\n#endif\n#ifdef VV_SIZE_UNIT_VALUE\nfloat getVVUnitValue(float sizeValue, float fallback) {\n  if (isNan(sizeValue)) {\n    return fallback;\n  }\n  return u_vvSizeUnitValueWorldToPixelsRatio * sizeValue;\n}\n#endif\n#ifdef VV_OPACITY\nconst int VV_OPACITY_N \x3d 8;\nfloat getVVOpacity(float opacityValue, float isOpacityLocked) {\n  if (isNan(opacityValue) || isOpacityLocked \x3d\x3d 1.0) {\n    return 1.0;\n  }\n  if (opacityValue \x3c\x3d u_vvOpacityValues[0]) {\n    return u_vvOpacities[0];\n  }\n  for (int i \x3d 1; i \x3c VV_OPACITY_N; ++i) {\n    if (u_vvOpacityValues[i] \x3e\x3d opacityValue) {\n      float f \x3d (opacityValue - u_vvOpacityValues[i-1]) / (u_vvOpacityValues[i] - u_vvOpacityValues[i-1]);\n      return mix(u_vvOpacities[i-1], u_vvOpacities[i], f);\n    }\n  }\n  return u_vvOpacities[VV_OPACITY_N - 1];\n}\n#endif\n#ifdef VV_ROTATION\nmat4 getVVRotation(float rotationValue) {\n  if (isNan(rotationValue)) {\n    return mat4(1, 0, 0, 0,\n                0, 1, 0, 0,\n                0, 0, 1, 0,\n                0, 0, 0, 1);\n  }\n  float rotation \x3d rotationValue;\n  if (u_vvRotationType \x3d\x3d 1.0) {\n    rotation \x3d 90.0 - rotation;\n  }\n  float angle \x3d C_DEG_TO_RAD * rotation;\n  float sinA \x3d sin(angle);\n  float cosA \x3d cos(angle);\n  return mat4(cosA, sinA, 0, 0,\n              -sinA,  cosA, 0, 0,\n              0,     0, 1, 0,\n              0,     0, 0, 1);\n}\nmat3 getVVRotationMat3(float rotationValue) {\n  if (isNan(rotationValue)) {\n    return mat3(1, 0, 0,\n                0, 1, 0,\n                0, 0, 1);\n  }\n  float rotation \x3d rotationValue;\n  if (u_vvRotationType \x3d\x3d 1.0) {\n    rotation \x3d 90.0 - rotation;\n  }\n  float angle \x3d C_DEG_TO_RAD * -rotation;\n  float sinA \x3d sin(angle);\n  float cosA \x3d cos(angle);\n  return mat3(cosA, -sinA, 0,\n             sinA, cosA, 0,\n              0,    0,    1);\n}\n#endif\n#ifdef VV_COLOR\nconst int VV_COLOR_N \x3d 8;\nvec4 getVVColor(float colorValue, vec4 fallback, float isColorLocked) {\n  if (isNan(colorValue) || isColorLocked \x3d\x3d 1.0) {\n    return fallback;\n  }\n  if (colorValue \x3c\x3d u_vvColorValues[0]) {\n    return u_vvColors[0];\n  }\n  for (int i \x3d 1; i \x3c VV_COLOR_N; ++i) {\n    if (u_vvColorValues[i] \x3e\x3d colorValue) {\n      float f \x3d (colorValue - u_vvColorValues[i-1]) / (u_vvColorValues[i] - u_vvColorValues[i-1]);\n      return mix(u_vvColors[i-1], u_vvColors[i], f);\n    }\n  }\n  return u_vvColors[VV_COLOR_N - 1];\n}\n#endif\nfloat getVVSize(in float size, in float vvSize)  {\n#ifdef VV_SIZE_MIN_MAX_VALUE\n  return getVVMinMaxSize(vvSize, size);\n#elif defined(VV_SIZE_SCALE_STOPS)\n  return u_vvSizeScaleStopsValue;\n#elif defined(VV_SIZE_FIELD_STOPS)\n  float outSize \x3d getVVStopsSize(vvSize, size);\n  return isNan(outSize) ? size : outSize;\n#elif defined(VV_SIZE_UNIT_VALUE)\n  return getVVUnitValue(vvSize, size);\n#else\n  return size;\n#endif\n}"},
raster:{bitmap:{"bitmap.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\nuniform sampler2D u_texture;\nuniform highp vec2 u_coordScale;\n#include \x3cfiltering/bicubic.glsl\x3e\nvoid main() {\n#ifdef BICUBIC\n  vec4 color \x3d sampleBicubicBSpline(u_texture, v_texcoord, u_coordScale);\n#else\n  vec4 color \x3d texture2D(u_texture, v_texcoord);\n#endif\n  gl_FragColor \x3d vec4(color.rgb * color.a, color.a);\n}","bitmap.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\n  v_texcoord \x3d a_pos;\n  gl_Position \x3d vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"},
common:{"common.glsl":"uniform sampler2D u_image;\nuniform int u_bandCount;\nuniform bool u_isFloatTexture;\nuniform bool u_flipY;\nuniform bool u_applyTransform;\nuniform float u_opacity;\nuniform int u_resampling;\n#include \x3craster/common/projection.glsl\x3e\nvec2 getPixelLocation(vec2 coords) {\n  vec2 targetLocation \x3d u_flipY ? vec2(coords.s, 1.0 - coords.t) : coords;\n  if (!u_applyTransform) {\n    return targetLocation;\n  }\n  return projectPixelLocation(targetLocation);\n}\nbool isOutside(vec2 coords){\n   if (coords.t\x3e1.00001 ||coords.t\x3c-0.00001 || coords.s\x3e1.00001 ||coords.s\x3c-0.00001) {\n     return true;\n   } else {\n     return false;\n   }\n}\nvec4 getPixel(vec2 pixelLocation) {\n  return texture2D(u_image, pixelLocation);\n}",
"contrastBrightness.glsl":"uniform float u_contrastOffset;\nuniform float u_brightnessOffset;\nvec4 adjustContrastBrightness(vec4 currentPixel, bool isFloat) {\n  vec4 pixelValue \x3d isFloat ? currentPixel * 255.0 : currentPixel;\n  float maxI \x3d 255.0;\n  float mid \x3d 128.0;\n  float c \x3d u_contrastOffset;\n  float b \x3d u_brightnessOffset;\n  vec4 v;\n  if (c \x3e 0.0 \x26\x26 c \x3c 100.0) {\n    v \x3d (200.0 * pixelValue - 100.0 * maxI + 2.0 * maxI * b) / (2.0 * (100.0 - c)) + mid;\n  } else if (c \x3c\x3d 0.0 \x26\x26 c \x3e -100.0) {\n    v \x3d (200.0 * pixelValue - 100.0 * maxI + 2.0 * maxI * b) * (100.0 + c) / 20000.0 + mid;\n  } else if (c \x3d\x3d 100.0) {\n    v \x3d (200.0 * pixelValue - 100.0 * maxI + (maxI + 1.0) * (100.0 - c) + 2.0 * maxI * b);\n    v \x3d (sign(v) + 1.0) / 2.0;\n  } else if (c \x3d\x3d -100.0) {\n    v \x3d vec4(mid, mid, mid, currentPixel.a);\n  }\n  return vec4(v.r / 255.0, v.g / 255.0, v.b / 255.0, currentPixel.a);\n}",
"projection.glsl":"uniform sampler2D u_transformGrid;\nuniform vec2 u_transformSpacing;\nuniform vec2 u_transformGridSize;\nuniform vec2 u_targetImageSize;\nuniform vec2 u_srcImageSize;\nvec2 projectPixelLocation(vec2 coords) {\n  vec2 index_image \x3d floor(coords * u_targetImageSize);\n  vec2 oneTransformPixel \x3d vec2(0.25 / u_transformGridSize.s, 1.0 / u_transformGridSize.t);\n  vec2 index_transform \x3d floor(index_image / u_transformSpacing) / u_transformGridSize;\n  vec2 pos \x3d fract((index_image + vec2(0.5, 0.5)) / u_transformSpacing);\n  vec2 srcLocation;\n  vec2 transform_location \x3d index_transform + oneTransformPixel * 0.5;\n  if (pos.s \x3c\x3d pos.t) {\n    vec4 ll_abc \x3d texture2D(u_transformGrid, vec2(transform_location.s, transform_location.t));\n    vec4 ll_def \x3d texture2D(u_transformGrid, vec2(transform_location.s + oneTransformPixel.s, transform_location.t));\n    srcLocation.s \x3d dot(ll_abc.rgb, vec3(pos, 1.0));\n    srcLocation.t \x3d dot(ll_def.rgb, vec3(pos, 1.0));\n  } else {\n    vec4 ur_abc \x3d texture2D(u_transformGrid, vec2(transform_location.s + 2.0 * oneTransformPixel.s, transform_location.t));\n    vec4 ur_def \x3d texture2D(u_transformGrid, vec2(transform_location.s + 3.0 * oneTransformPixel.s, transform_location.t));\n    srcLocation.s \x3d dot(ur_abc.rgb, vec3(pos, 1.0));\n    srcLocation.t \x3d dot(ur_def.rgb, vec3(pos, 1.0));\n  }\n  return srcLocation;\n}"},
lut:{"colorize.glsl":"uniform sampler2D u_colormap;\nuniform float u_colormapOffset;\nuniform float u_colormapMaxIndex;\nvec4 colorize(vec4 currentPixel, bool isFloat) {\n  float clrIndex \x3d isFloat ? currentPixel.r - u_colormapOffset : currentPixel.r * 255.0 - u_colormapOffset;\n  vec4 result;\n  if (currentPixel.a \x3d\x3d 0.0 || clrIndex \x3e u_colormapMaxIndex) {\n    result \x3d vec4(0.0, 0.0, 0.0, 0.0);\n  } else {\n    vec2 clrPosition \x3d vec2((clrIndex + 0.5) / (u_colormapMaxIndex + 1.0), 0.0);\n    vec4 color \x3d texture2D(u_colormap, clrPosition);\n    result \x3d vec4(color.rgb, color.a * u_opacity);\n  }\n  return result;\n}",
"lut.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\n#include \x3craster/common/common.glsl\x3e\n#include \x3craster/lut/colorize.glsl\x3e\nvoid main() {\n  vec2 pixelLocation \x3d getPixelLocation(v_texcoord);\n  if (isOutside(pixelLocation)) {\n     gl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\n     return;\n  }\n  vec4 currentPixel \x3d getPixel(pixelLocation);\n  gl_FragColor \x3d colorize(currentPixel, true);\n}","lut.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\n  v_texcoord \x3d a_pos;\n  gl_Position \x3d vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"},
stretch:{"stretch.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\n#include \x3craster/common/common.glsl\x3e\nuniform float u_minCutOff[3];\nuniform float u_maxCutOff[3];\nuniform float u_minOutput;\nuniform float u_maxOutput;\nuniform float u_factor[3];\nuniform bool u_useGamma;\nuniform float u_gamma[3];\nuniform float u_gammaCorrection[3];\nuniform bool u_applyColormap;\n#include \x3craster/lut/colorize.glsl\x3e\nfloat stretchOneValue(float val, float minCutOff, float maxCutOff, float minOutput, float maxOutput, float factor, bool useGamma, float gamma, float gammaCorrection) {\n  if (val \x3e\x3d maxCutOff) {\n    return maxOutput;\n  } else if (val \x3c\x3d minCutOff) {\n    return minOutput;\n  }\n  float stretchedVal;\n  if (useGamma) {\n  \tfloat tempf \x3d 1.0;\n\t  float outRange \x3d maxOutput - minOutput;\n\t  float relativeVal \x3d (val - minCutOff) / (maxCutOff - minCutOff);\n\t  if (gamma \x3e 1.0) {\n      tempf -\x3d pow(1.0 / outRange, relativeVal * gammaCorrection);\n    }\n    stretchedVal \x3d floor(tempf * outRange * pow(relativeVal, 1.0 / gamma)) + minOutput;\n  } else {\n    stretchedVal \x3d minOutput + (val - minCutOff) * factor;\n  }\n  return stretchedVal;\n}\nvoid main() {\n  vec2 pixelLocation \x3d getPixelLocation(v_texcoord);\n  if (isOutside(pixelLocation)) {\n     gl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\n     return;\n  }\n  vec4 currentPixel \x3d getPixel(pixelLocation);\n  if (currentPixel.a \x3d\x3d 0.0) {\n    gl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\n    return;\n  }\n  if (u_bandCount \x3d\x3d 1) {\n    float grayVal \x3d stretchOneValue(currentPixel.r, u_minCutOff[0], u_maxCutOff[0], u_minOutput, u_maxOutput, u_factor[0], u_useGamma, u_gamma[0], u_gammaCorrection[0]);\n    if (u_applyColormap) {\n      gl_FragColor \x3d colorize(vec4(grayVal, grayVal, grayVal, currentPixel.a), true);\n    } else {\n      gl_FragColor \x3d vec4(grayVal, grayVal, grayVal, currentPixel.a);\n    }\n  } else {\n    float redVal \x3d stretchOneValue(currentPixel.r, u_minCutOff[0], u_maxCutOff[0], u_minOutput, u_maxOutput, u_factor[0], u_useGamma, u_gamma[0], u_gammaCorrection[0]);\n    float greenVal \x3d stretchOneValue(currentPixel.g, u_minCutOff[1], u_maxCutOff[1], u_minOutput, u_maxOutput, u_factor[1], u_useGamma, u_gamma[1], u_gammaCorrection[1]);\n    float blueVal \x3d stretchOneValue(currentPixel.b, u_minCutOff[2], u_maxCutOff[2], u_minOutput, u_maxOutput, u_factor[2], u_useGamma, u_gamma[2], u_gammaCorrection[2]);\n    gl_FragColor \x3d vec4(redVal, greenVal, blueVal, currentPixel.a);\n  }\n}",
"stretch.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\n  v_texcoord \x3d a_pos;\n  gl_Position \x3d vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"}},stencil:{"stencil.frag":"void main() {\n  gl_FragColor \x3d vec4(1.0, 1.0, 1.0, 1.0);\n}","stencil.vert":"attribute vec2 a_pos;\nvoid main() {\n  gl_Position \x3d vec4(a_pos, 0.0, 1.0);\n}"},tileInfo:{"tileInfo.frag":"uniform mediump sampler2D u_texture;\nvarying mediump vec2 v_tex;\nvoid main(void) {\n  lowp vec4 color \x3d texture2D(u_texture, v_tex);\n  gl_FragColor \x3d 0.75 * color;\n}",
"tileInfo.vert":"attribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform mediump float u_depth;\nuniform mediump vec2 u_coord_ratio;\nuniform mediump vec2 u_delta;\nuniform mediump vec2 u_dimensions;\nvarying mediump vec2 v_tex;\nvoid main() {\n  mediump vec2 offset \x3d u_coord_ratio * vec2(u_delta + a_pos * u_dimensions);\n  vec3 v_pos \x3d u_dvsMat3 * vec3(offset, 1.0);\n  gl_Position \x3d vec4(v_pos.xy, 0.0, 1.0);\n  v_tex \x3d a_pos;\n}"},util:{"encoding.glsl":"const vec4 rgba2float_factors \x3d vec4(\n    255.0 / (256.0),\n    255.0 / (256.0 * 256.0),\n    255.0 / (256.0 * 256.0 * 256.0),\n    255.0 / (256.0 * 256.0 * 256.0 * 256.0)\n  );\nfloat rgba2float(vec4 rgba) {\n  return dot(rgba, rgba2float_factors);\n}"}}})},
"esri/views/2d/engine/webgl/shaders/TileInfoPrograms":function(){define(["require","exports","./sources/resolver"],function(e,a,c){Object.defineProperty(a,"__esModule",{value:!0});a.tileInfo={name:"tileInfo",shaders:{vertexShader:c.resolveIncludes("tileInfo/tileInfo.vert"),fragmentShader:c.resolveIncludes("tileInfo/tileInfo.frag")},attributes:{a_pos:0}}})},"esri/views/2d/engine/webgl/brushes/WGLBrushStencil":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/libs/gl-matrix-2/vec4f32 ../../../../webgl ./WGLBrush ../shaders/BackgroundPrograms".split(" "),
function(e,a,c,h,b,g,m){Object.defineProperty(a,"__esModule",{value:!0});e=function(a){function d(){var b=null!==a&&a.apply(this,arguments)||this;b._color=h.vec4f32.fromValues(1,0,0,1);b._initialized=!1;return b}c(d,a);d.prototype.dispose=function(){this._solidProgram&&(this._solidProgram.dispose(),this._solidProgram=null);this._solidVertexArrayObject&&(this._solidVertexArrayObject.dispose(),this._solidVertexArrayObject=null)};d.prototype.prepareState=function(a,b){a=a.context;a.setDepthWriteEnabled(!1);
a.setDepthTestEnabled(!1);a.setStencilTestEnabled(!0);a.setBlendingEnabled(!1);a.setColorMask(!1,!1,!1,!1);a.setStencilOp(7680,7680,7681);a.setStencilWriteMask(255);a.setStencilFunctionSeparate(1032,516,b.stencilRef,255)};d.prototype.draw=function(a,b){a=a.context;this._initialized||this._initialize(a);a.bindVAO(this._solidVertexArrayObject);a.bindProgram(this._solidProgram);this._solidProgram.setUniformMatrix3fv("u_dvsMat3",b.transforms.dvs);this._solidProgram.setUniform2fv("u_coord_range",b.coordRange);
this._solidProgram.setUniform1f("u_depth",0);this._solidProgram.setUniform4fv("u_color",this._color);a.drawArrays(5,0,4);a.bindVAO()};d.prototype._initialize=function(a){if(this._initialized)return!0;var d=b.createProgram(a,m.background);if(!d)return!1;var f=new Int8Array([0,0,1,0,0,1,1,1]),f=b.BufferObject.createVertex(a,35044,f);a=new b.VertexArrayObject(a,m.background.attributes,{geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}]},{geometry:f});this._solidProgram=
d;this._solidVertexArrayObject=a;return this._initialized=!0};return d}(g.default);a.default=e})},"esri/views/2d/engine/RasterTile":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/decorateHelper ./RasterBitmap ./webgl/TiledDisplayObject".split(" "),function(e,a,c,h,b,g){Object.defineProperty(a,"__esModule",{value:!0});e=function(a){function f(d,f,c,g){void 0===g&&(g=null);var l=a.call(this,d,f,c)||this;d=l.requestRender.bind(l);l.bitmap=new b.RasterBitmap(g,
null,null,d);l.bitmap.coordScale=c;l.bitmap.once("isReady",function(){return l.ready()});return l}c(f,a);Object.defineProperty(f.prototype,"stencilRef",{get:function(){return this.bitmap.stencilRef},set:function(a){this.bitmap.stencilRef=a},enumerable:!0,configurable:!0});f.prototype.setTransform=function(b,f){a.prototype.setTransform.call(this,b,f);this.bitmap.transforms.dvs=this.transforms.dvs};f.prototype.attach=function(){this.bitmap.stage=this.stage;var a=this.bitmap.attach();a&&(this.bitmap.attached=
!0);return a};f.prototype.detach=function(){this.bitmap.detach()};return f}(g.TiledDisplayObject);a.RasterTile=e})},"esri/views/2d/engine/RasterBitmap":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/assignHelper ../../../core/libs/gl-matrix-2/mat3 ../../../core/libs/gl-matrix-2/mat3f32 ../../../core/libs/gl-matrix-2/vec2f32 ../../../layers/support/rasterFunctions/pixelUtils ./DisplayObject ./webgl/WGLRasterUtils".split(" "),function(e,a,c,h,b,g,m,
f,d,l){function z(a){A.has(a)&&(v.splice(v.indexOf(a),1),A.delete(a))}Object.defineProperty(a,"__esModule",{value:!0});var v=[],A=new Set;e=function(a){function d(b,d,f,l){void 0===b&&(b=null);void 0===d&&(d=null);void 0===f&&(f=null);void 0===l&&(l=function(){return null});var k=a.call(this)||this;k.stencilRef=0;k.coordScale=[1,1];k.height=null;k.pixelRatio=1;k.resolution=0;k.rotation=0;k._source=null;k._bandIds=null;k._interpolation=null;k._transformGrid=null;k.width=null;k.x=0;k.y=0;k.transforms=
{dvs:g.mat3f32.create()};k.source=b;k.transformGrid=d;k.interpolation=f;k.requestRender=l;return k}c(d,a);Object.defineProperty(d.prototype,"source",{get:function(){return this._source},set:function(a){this._source=a;this._rasterTexture&&(this._rasterTexture.dispose(),this._rasterTexture=null)},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"bandIds",{get:function(){return this._bandIds},set:function(a){this.attached&&this._updateRasterTexture(a);this._bandIds=a},enumerable:!0,
configurable:!0});Object.defineProperty(d.prototype,"interpolation",{get:function(){return this._interpolation},set:function(a){this._interpolation=a;this._rasterTexture&&this._rasterTexture.setSamplingMode("bilinear"===a?9729:9728)},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"transformGrid",{get:function(){return this._transformGrid},set:function(a){this._transformGrid=a;this._transformGridTexture&&(this._transformGridTexture.dispose(),this._transformGridTexture=null)},enumerable:!0,
configurable:!0});d.prototype.attach=function(){this.updateTexture();return!0};d.prototype.detach=function(){this._rasterTexture&&(this._rasterTexture.dispose(),this._rasterTexture=null);this._transformGridTexture&&(this._transformGridTexture.dispose(),this._transformGridTexture=null);this._colormapTexture&&(this._colormapTexture.dispose(),this._colormapTexture=null);z(this)};d.prototype.invalidateTexture=function(){this.attached?this.updateTexture():z(this)};d.prototype.setTransform=function(a){var d=
b.mat3.identity(this.transforms.dvs),f=a.toScreenNoRotation([0,0],this.x,this.y),l=this.resolution/this.pixelRatio/a.resolution,k=l*this.width,l=l*this.height,q=Math.PI*this.rotation/180;b.mat3.translate(d,d,m.vec2f32.fromValues(f[0],f[1]));b.mat3.translate(d,d,m.vec2f32.fromValues(k/2,l/2));b.mat3.rotate(d,d,-q);b.mat3.translate(d,d,m.vec2f32.fromValues(-k/2,-l/2));b.mat3.scaleByVec2(d,d,m.vec2f32.fromValues(k,l));b.mat3.multiply(this.transforms.dvs,a.displayViewMat3,d)};d.prototype.updateTexture=
function(){var a=this.stage.context,b=this.source,b=b&&b.pixels&&0<b.pixels.length;!this._rasterTexture&&b&&this._updateRasterTexture(this.bandIds);this._rasterTexture&&b&&(this._updateColormapTexture(),this.transformGrid&&!this._transformGridTexture&&(this._transformGridTexture=l.createTransformTexture(a,this.transformGrid)));this._rasterTexture&&!b&&this._rasterTexture.setData(null);this.ready();this.requestRender()};d.prototype.getUniforms=function(){var a=this.source,b=this.transformGrid,d;switch(this.symbolizerParameters.type){case "lut":d=
this._getColormapUniforms();break;case "stretch":d=this._getStretchUniforms()}a=h({},d,{u_srcImageSize:[a.width,a.height],u_resampling:"nearest",u_flipY:!0,u_applyTransform:b?!0:!1,u_dvsMat3:this.transforms.dvs});this.transformGrid&&(a.u_transformSpacing=b.spacing,a.u_transformGridSize=b.size,a.u_targetImageSize=new Float32Array([this.width,this.height]));return a};d.prototype.getTextures=function(){if(!this._rasterTexture)return null;var a=[],b=[];this._transformGridTexture&&(b.push(this._transformGridTexture),
a.push("u_transformGrid"));this._rasterTexture&&(b.push(this._rasterTexture),a.push("u_image"));this._colormapTexture&&(b.push(this._colormapTexture),a.push("u_colormap"));return{names:a,textures:b}};d.prototype._getColormapUniforms=function(){var a=this.symbolizerParameters;return{u_colormapOffset:a.colormapOffset||0,u_colormapMaxIndex:a.colormap.length/4-1,u_isFloatTexture:!1}};d.prototype._getStretchUniforms=function(){var a=this.symbolizerParameters;return{u_bandCount:a.bandCount,u_minOutput:a.outMin,
u_maxOutput:a.outMax,u_minCutOff:a.minCutOff,u_maxCutOff:a.maxCutOff,u_factor:a.factor,u_useGamma:a.useGamma,u_gamma:a.gamma,u_gammaCorrection:a.gammaCorrection,u_contrast:a.contrast,u_brightness:a.brightness}};d.prototype._updateRasterTexture=function(a){var b=this.source?f.extractBands(this.source,a):null;if(b&&b.pixels&&0<b.pixels.length){a=null==a&&null==this.bandIds||a&&this.bandIds&&a.join("")===this.bandIds.join("");if(this._rasterTexture){if(a)return;this._rasterTexture.dispose();this._rasterTexture=
null}this._rasterTexture=l.createRasterTexture(this.stage.context,b,this.interpolation||"nearest")}else this._rasterTexture&&(this._rasterTexture.dispose(),this._rasterTexture=null)};d.prototype._updateColormapTexture=function(){var a=this._colormap,b=this.symbolizerParameters.colormap;if(b){var d=this.stage.context;if(!a)this._colormapTexture=l.createColormapTexture(d,b),this._colormap=b;else if(b.length!==a.length||b.some(function(b,d){return b!==a[d]}))this._colormapTexture&&(this._colormapTexture.dispose(),
this._colormapTexture=null),this._colormapTexture=l.createColormapTexture(d,b),this._colormap=b}else this._colormapTexture&&(this._colormapTexture.dispose(),this._colormapTexture=null),this._colormap=null};return d}(d.DisplayObject);a.RasterBitmap=e})},"esri/layers/support/rasterFunctions/pixelUtils":function(){define(["require","exports","../PixelBlock"],function(e,a,c){function h(a,b){a=Math.min(Math.max(a,-100),100);b=Math.min(Math.max(b,-100),100);var d,f,c=new Uint8Array(256);for(d=0;256>d;d++)0<
a&&100>a?f=(200*d-25500+510*b)/(2*(100-a))+128:0>=a&&-100<a?f=(200*d-25500+510*b)*(100+a)/2E4+128:100===a?(f=200*d-25500+256*(100-a)+510*b,f=0<f?255:0):-100===a&&(f=128),c[d]=255<f?255:0>f?0:f;return c}function b(a,b,l,c,g,m,x,u){return{xmin:g<=l*a?0:g<l*a+a?g-l*a:a,ymin:m<=c*b?0:m<c*b+b?m-c*b:b,xmax:g+x<=l*a?0:g+x<l*a+a?g+x-l*a:a,ymax:m+u<=c*b?0:m+u<c*b+b?m+u-c*b:b}}function g(a,d,l,z){var f=a.filter(function(a){return m(a)})[0];if(null==f)return null;var g=z?z.width:d.width;z=z?z.height:d.height;
var x=f.width,u=f.height,q=d.width/x;d=d.height/u;var n=l?l.x:0;l=l?l.y:0;var p=f.pixelType,y=c.getPixelArrayConstructor(p),k=f.pixels.length,f=[],h,w,e,E,G,F,M,J,L,K;for(G=0;G<k;G++){w=new y(g*z);for(F=0;F<d;F++)for(M=0;M<q;M++)if(e=a[F*q+M])for(h=e.pixels[G],K=b(x,u,M,F,n,l,g,z),J=K.ymin;J<K.ymax;J++)for(e=(F*u+J-l)*g+(M*x-n),E=J*x,L=K.xmin;L<K.xmax;L++)w[e+L]=h[E+L];f.push(w)}var Q;if(a.some(function(a){return null==a||a.mask&&0<a.mask.length}))for(Q=new Uint8Array(g*z),F=0;F<d;F++)for(M=0;M<q;M++)if(y=
(e=a[F*q+M])?e.mask:null,K=b(x,u,M,F,n,l,g,z),y)for(J=K.ymin;J<K.ymax;J++)for(e=(F*u+J-l)*g+(M*x-n),E=J*x,L=K.xmin;L<K.xmax;L++)Q[e+L]=y[E+L];else if(e)for(J=K.ymin;J<K.ymax;J++)for(e=(F*u+J-l)*g+(M*x-n),E=J*x,L=K.xmin;L<K.xmax;L++)Q[e+L]=1;else for(J=K.ymin;J<K.ymax;J++)for(e=(F*u+J-l)*g+(M*x-n),E=J*x,L=K.xmin;L<K.xmax;L++)Q[e+L]=0;a=new c({width:g,height:z,pixels:f,pixelType:p,mask:Q});a.updateStatistics();return a}Object.defineProperty(a,"__esModule",{value:!0});var m=function(a){return a&&"esri.layers.support.PixelBlock"===
a.declaredClass&&a.pixels&&0<a.pixels.length};a.extractBands=function(a,b){if(!b||!m(a))return a;var d=a.pixels.length;return b&&b.some(function(a){return a>=d})||1===d&&1===b.length&&0===b[0]||d===b.length&&!b.some(function(a,b){return a!==b})?a:new c({pixelType:a.pixelType,width:a.width,height:a.height,mask:a.mask,validPixelCount:a.validPixelCount,maskIsAlpha:a.maskIsAlpha,pixels:b.map(function(b){return a.pixels[b]}),statistics:a.statistics&&b.map(function(b){return a.statistics[b]})})};a.createColormapLUT=
function(a){if(a){var b=a.colormap;if(b&&0!==b.length){var b=b.sort(function(a,b){return a[0]-b[0]}),f=0;0>b[0][0]&&(f=b[0][0]);var c=Math.max(256,b[b.length-1][0]-f+1),g=new Uint8Array(4*c),m=[],x=0,u=0,q=5===b[0].length;if(65536<c)return b.forEach(function(a){m[a[0]-f]=q?a.slice(1):a.slice(1).concat([255])}),{indexed2DColormap:m,offset:f,alphaSpecified:q};if(a.fillUnspecified)for(a=b[u],x=a[0]-f;x<c;x++)g[4*x]=a[1],g[4*x+1]=a[2],g[4*x+2]=a[3],g[4*x+3]=q?a[4]:255,x===a[0]-f&&(a=u===b.length-1?a:
b[++u]);else for(x=0;x<b.length;x++)a=b[x],u=4*(a[0]-f),g[u]=a[1],g[u+1]=a[2],g[u+2]=a[3],g[u+3]=q?a[4]:255;return{indexedColormap:g,offset:f,alphaSpecified:q}}}};a.colorize=function(a,b){if(!m(a)||!b&&(b.indexedColormap||b.indexed2DColormap))return a;var d=a.clone(),f=d.pixels,c=d.mask,g=d.width*d.height;if(1!==f.length)return a;var x=b.indexedColormap;a=b.indexed2DColormap;var u=b.offset;b=b.alphaSpecified;var q=x.length-1,n=0,f=f[0],p=new Uint8Array(f.length),y=new Uint8Array(f.length),k=new Uint8Array(f.length),
h=0;if(x)if(c)for(n=0;n<g;n++)c[n]&&(h=4*(f[n]-u),h<u||h>q?c[n]=0:(p[n]=x[h],y[n]=x[h+1],k[n]=x[h+2],c[n]=x[h+3]));else{c=new Uint8Array(g);for(n=0;n<g;n++)h=4*(f[n]-u),h<u||h>q?c[n]=0:(p[n]=x[h],y[n]=x[h+1],k[n]=x[h+2],c[n]=x[h+3]);d.mask=c}else if(c)for(n=0;n<g;n++)c[n]&&(x=a[f[n]],p[n]=x[0],y[n]=x[1],k[n]=x[2],c[n]=x[3]);else{c=new Uint8Array(g);for(n=0;n<g;n++)x=a[f[n]],p[n]=x[0],y[n]=x[1],k[n]=x[2],c[n]=x[3];d.mask=c}d.pixels=[p,y,k];d.statistics=null;d.pixelType="u8";d.maskIsAlpha=b;return d};
a.estimateStatisticsHistograms=function(a){if(!m(a))return null;var b=a.pixels,f=a.mask,c=a.pixelType,g=a.statistics;a=a.width*a.height;var h=b.length,x,u,q,n,p,y=[],k=[],e,w,B;for(n=0;n<h;n++){e=new Uint32Array(256);B=b[n];if("u8"===c)if(x=-.5,u=255.5,f)for(p=0;p<a;p++)f[p]&&e[B[p]]++;else for(p=0;p<a;p++)e[B[p]]++;else{x=g[n].minValue;u=g[n].maxValue;q=(u-x)/256;w=new Uint32Array(257);if(f)for(p=0;p<a;p++)f[p]&&w[Math.floor((B[p]-x)/q)]++;else for(p=0;p<a;p++)w[Math.floor((B[p]-x)/q)]++;for(p=0;255>
p;p++)e[p]=w[p];e[255]=w[255]+w[256]}y.push({min:x,max:u,size:256,counts:e});for(p=B=w=q=0;256>p;p++)q+=e[p],w+=p*e[p];w/=q;for(p=0;256>p;p++)B+=e[p]*Math.pow(p-w,2);e=Math.sqrt(B/(q-1));q=(u-x)/256;p=(w+.5)*q+x;e*=q;k.push({min:x,max:u,avg:p,stddev:e})}return{statistics:k,histograms:y}};a.createStretchLUT=function(a){var b=a.minCutOff,f=a.maxCutOff,c=a.gamma,g=a.pixelType,m=a.outMin||0,x=a.outMax||255;if(-1===["u8","u16","s8","s16"].indexOf(g))return null;var u=b.length,q,n=0;"s8"===g?n=-127:"s16"===
g&&(n=-32767);var p=256;-1<["u16","s16"].indexOf(g)&&(p=65536);for(var y=[],k=x-m,g=0;g<u;g++)y[g]=f[g]-b[g];q=c&&c.length>=u;var e=[];if(q)for(g=0;g<u;g++)e[g]=1<c[g]?2<c[g]?6.5+Math.pow(c[g]-2,2.5):6.5+100*Math.pow(2-c[g],4):1;var w,B=[],E,G,F;if(q)for(g=0;g<u;g++){F=[];for(q=0;q<p;q++)E=q+n,w=(E-b[g])/y[g],G=1,1<c[g]&&(G-=Math.pow(1/k,w*e[g])),F[q]=E<f[g]&&E>b[g]?Math.floor(G*k*Math.pow(w,1/c[g]))+m:E>=f[g]?x:m;B[g]=F}else for(g=0;g<u;g++){F=[];for(q=0;q<p;q++)E=q+n,F[q]=E<=b[g]?m:E>=f[g]?x:Math.floor((E-
b[g])/y[g]*k)+m;B[g]=F}if(null!=a.contrastOffset)for(a=h(a.contrastOffset,a.brightnessOffset),g=0;g<u;g++)for(F=B[g],q=0;q<p;q++)F[q]=a[F[q]];return{lut:B,offset:n}};a.createContrastBrightnessLUT=h;a.stretch=function(a,b){if(!m(a))return null;a=a.clone();var d=a.pixels,f=a.mask,c=b.minCutOff,g=b.maxCutOff,x=b.gamma,u=b.outMin||0;b=b.outMax||255;var q=a.width*a.height,n=d.length,p,y,k,h,w,e=b-u,E=[];for(p=0;p<n;p++)E[p]=g[p]-c[p];y=x&&x.length>=n;var G=[];if(y)for(p=0;p<n;p++)G[p]=1<x[p]?2<x[p]?6.5+
Math.pow(x[p]-2,2.5):6.5+100*Math.pow(2-x[p],4):1;if(y)if(null!=f)for(y=0;y<q;y++){if(f[y])for(p=0;p<n;p++)k=d[p][y],w=(k-c[p])/E[p],h=1,1<x[p]&&(h-=Math.pow(1/e,w*G[p])),d[p][y]=k<g[p]&&k>c[p]?Math.floor(h*e*Math.pow(w,1/x[p]))+u:k>=g[p]?b:u}else for(y=0;y<q;y++)for(p=0;p<n;p++)k=d[p][y],w=(k-c[p])/E[p],h=1,1<x[p]&&(h-=Math.pow(1/e,w*G[p])),d[p][y]=k<g[p]&&k>c[p]?Math.floor(h*e*Math.pow(w,1/x[p]))+u:k>=g[p]?b:u;else if(null!=f)for(y=0;y<q;y++){if(f[y])for(p=0;p<n;p++)k=d[p][y],d[p][y]=k<g[p]&&k>
c[p]?Math.floor((k-c[p])/E[p]*e)+u:k>=g[p]?b:u}else for(y=0;y<q;y++)for(p=0;p<n;p++)k=d[p][y],d[p][y]=k<g[p]&&k>c[p]?Math.floor((k-c[p])/E[p]*e)+u:k>=g[p]?b:u;a.pixelType="u8";a.updateStatistics();return a};a.lookupPixels=function(a,b){if(!m(a))return null;var d=a.pixels,f=a.mask,g=a.width*a.height,h=d.length,x=b.lut;b=b.offset;var u,q;x&&1===x[0].length&&(x=d.map(function(){return x}));var n=[],p,y,k;if(b)if(null==f)for(u=0;u<h;u++){p=d[u];y=x[u];k=new Uint8Array(g);for(q=0;q<g;q++)k[q]=y[p[q]-b];
n.push(k)}else for(u=0;u<h;u++){p=d[u];y=x[u];k=new Uint8Array(g);for(q=0;q<g;q++)f[q]&&(k[q]=y[p[q]-b]);n.push(k)}else if(null==f)for(u=0;u<h;u++){p=d[u];y=x[u];k=new Uint8Array(g);for(q=0;q<g;q++)k[q]=y[p[q]];n.push(k)}else for(u=0;u<h;u++){p=d[u];y=x[u];k=new Uint8Array(g);for(q=0;q<g;q++)f[q]&&(k[q]=y[p[q]]);n.push(k)}a=new c({width:a.width,height:a.height,pixels:n,mask:f,pixelType:"u8"});a.updateStatistics();return a};a.remapColor=function(a,b){if(!m(a))return null;a=a.clone();var d=a.width*
a.height,f=b.length,c=Math.floor(f/2),g=b[Math.floor(c)],h=a.pixels[0],u,q,n,p,y,k,e=!1,w=new Uint8Array(d),B=new Uint8Array(d),E=new Uint8Array(d),G=a.mask,F=4===b[0].mappedColor.length;G||(G=new Uint8Array(d),G.fill(F?255:1),a.mask=G);for(y=0;y<d;y++)if(G[y]){u=h[y];e=!1;k=c;q=g;n=0;for(p=f-1;1<p-n;){if(u===q.value){e=!0;break}u>q.value?n=k:p=k;k=Math.floor((n+p)/2);q=b[Math.floor(k)]}e||(u===b[n].value?(q=b[n],e=!0):u===b[p].value?(q=b[p],e=!0):u<b[n].value?(e=!1,q=null):u>b[n].value&&(u<b[p].value?
(q=b[n],e=!0):p===f-1?(e=!1,q=null):(q=b[p],e=!0)));e?(w[y]=q.mappedColor[0],B[y]=q.mappedColor[1],E[y]=q.mappedColor[2],G[y]=q.mappedColor[3]):w[y]=B[y]=E[y]=G[y]=0}a.pixels=[w,B,E];a.mask=G;a.pixelType="u8";a.maskIsAlpha=F;return a};a.getClipBounds=b;a.mosaicPixelData=function(a,b){if(!a||0===a.length)return null;var d=a.filter(function(a){return a.pixelBlock})[0];if(!d)return null;var f=(d.extent.xmax-d.extent.xmin)/d.pixelBlock.width,c=(d.extent.ymax-d.extent.ymin)/d.pixelBlock.height,m=.01*Math.min(f,
c),h=a.sort(function(a,b){return Math.abs(a.extent.ymax-b.extent.ymax)>m?b.extent.ymax-a.extent.ymax:Math.abs(a.extent.xmin-b.extent.xmin)>m?a.extent.xmin-b.extent.xmin:0}),u=Math.min.apply(null,h.map(function(a){return a.extent.xmin})),q=Math.min.apply(null,h.map(function(a){return a.extent.ymin})),n=Math.max.apply(null,h.map(function(a){return a.extent.xmax})),p=Math.max.apply(null,h.map(function(a){return a.extent.ymax}));a={x:Math.round((b.xmin-u)/f),y:Math.round((p-b.ymax)/c)};u={width:Math.round((n-
u)/f),height:Math.round((p-q)/c)};f={width:Math.round((b.xmax-b.xmin)/f),height:Math.round((b.ymax-b.ymin)/c)};if(Math.round(u.width/d.pixelBlock.width)*Math.round(u.height/d.pixelBlock.height)!==h.length||0>a.x||0>a.y||u.width<f.width||u.height<f.height)return null;d=h.map(function(a){return a.pixelBlock});d=g(d,u,a,f);return{extent:b,pixelBlock:d}};a.mosaic=g;a.setValidBoundary=function(a,b,c){if(!m(a))return null;var d=a.width,f=a.height,l=b.x;b=b.y;var g=c.width+l;c=c.height+b;if(0>l||0>b||g>
d||c>f||0===l&&0===b&&g===d&&c===f)return a;a.mask||(a.mask=new Uint8Array(d*f));for(var u=a.mask,q=0;q<f;q++)for(var n=q*d,p=0;p<d;p++)u[n+p]=q<b||q>=c||p<l||p>=g?0:1;a.updateStatistics();return a};a.clip=function(a,b,l){if(!m(a))return null;var d=b.x,f=b.y,g=b.x+l.width;b=b.x+l.height;if(b===a.height&&g===a.width)return a;for(var h=a.pixels,u=a.mask,q=a.width,n=q*a.height,p=h.length,y=[],k=0;k<p;k++){for(var e=h[k],w=c.createEmptyBand(a.pixelType,n),B=0,E=f;E<=b;E++)for(var G=E*q,F=d;F<=g;F++)w[B++]=
e[G+F];y.push(w)}var M;if(u)for(M=new Uint8Array(l.width*l.height),B=0,E=f;E<=b;E++)for(G=E*q,F=d;F<=g;F++)M[B++]=u[G+F];a=new c({width:l.width,height:l.height,pixels:y,mask:M});a.updateStatistics();return a};a.approximateTransform=function(a,b,l,g){if(!m(a))return null;var d=a.pixels,f=a.mask,h=a.pixelType,u=a.width,q=a.height;a=c.getPixelArrayConstructor(h);var n=d.length,p=b.width,y=b.height;b=g.cols;g=g.rows;for(var k=Math.ceil(p/b),z=Math.ceil(y/g),w,e,E,G,F,M,J,L=new Uint16Array(p*y),K=new Uint16Array(p*
y),Q=0,I,R,O=0;O<z;O++)for(var N=0;N<k;N++){w=12*(O*k+N);e=l[w];E=l[w+1];G=l[w+2];F=l[w+3];M=l[w+4];J=l[w+5];for(var H=0;H<g;H++){Q=(O*g+H)*p+N*b;R=(H+.5)/g;for(var U=0;U<H;U++)I=(U+.5)/b,L[Q+U]=Math.round((e*I+E*R+G)*u-.5),K[Q+U]=Math.round((F*I+M*R+J)*q-.5)}w+=6;e=l[w];E=l[w+1];G=l[w+2];F=l[w+3];M=l[w+4];J=l[w+5];for(H=0;H<g;H++)for(Q=(O*g+H)*p+N*b,R=(H+.5)/g,U=H;U<b;U++)I=(U+.5)/b,L[Q+U]=Math.round((e*I+E*R+G)*u-.5),K[Q+U]=Math.round((F*I+M*R+J)*q-.5)}l=function(a,b){for(var d=0;d<y;d++){w=d*p;
for(var k=0;k<p;k++)a[w]=b[L[w]+K[w]*u],w++}};q=[];for(g=0;g<n;g++)b=new a(p*y),l(b,d[g]),q.push(b);d=new c({width:p,height:y,pixelType:h,pixels:q});f&&(d.mask=new Uint8Array(p*y),l(d.mask,f));d.updateStatistics();return d}})},"esri/layers/support/PixelBlock":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/compilerUtils ../../core/Error ../../core/JSONSupport ../../core/lang ../../core/Logger ../../core/accessorSupport/decorators".split(" "),
function(e,a,c,h,b,g,m,f,d,l){var z=d.getLogger("esri.layers.support.PixelBlock");return function(a){function d(b){b=a.call(this,b)||this;b.width=null;b.height=null;b.pixelType="f32";b.validPixelCount=null;b.mask=null;b.maskIsAlpha=!1;b.pixels=null;b.statistics=null;return b}c(d,a);m=d;d.createEmptyBand=function(a,b){return new (m.getPixelArrayConstructor(a))(b)};d.getPixelArrayConstructor=function(a){var d;switch(a){case "u1":case "u2":case "u4":case "u8":d=Uint8Array;break;case "u16":d=Uint16Array;
break;case "u32":d=Uint32Array;break;case "s8":d=Int8Array;break;case "s16":d=Int16Array;break;case "s32":d=Int32Array;break;case "u32":d=Uint32Array;break;case "f32":d=Float32Array;break;case "f64":d=Float64Array;break;case "c64":case "c128":case "unknown":d=Float32Array;break;default:b.neverReached(a)}return d};d.prototype.castPixelType=function(a){if(!a)return"f32";a=a.toLowerCase();-1<["u1","u2","u4"].indexOf(a)?a="u8":-1==="unknown u8 s8 u16 s16 u32 s32 f32 f64".split(" ").indexOf(a)&&(a="f32");
return a};d.prototype.getPlaneCount=function(){return this.pixels&&this.pixels.length};d.prototype.addData=function(a){if(!a.pixels||a.pixels.length!==this.width*this.height)throw new g("pixelblock:invalid-or-missing-pixels","add data requires valid pixels array that has same length defined by pixel block width * height");this.pixels||(this.pixels=[]);this.statistics||(this.statistics=[]);this.pixels.push(a.pixels);this.statistics.push(a.statistics||{minValue:null,maxValue:null})};d.prototype.getAsRGBA=
function(){var a=new ArrayBuffer(this.width*this.height*4);switch(this.pixelType){case "s8":case "s16":case "u16":case "s32":case "u32":case "f32":case "f64":this._fillFromNon8Bit(a);break;default:this._fillFrom8Bit(a)}return new Uint8ClampedArray(a)};d.prototype.getAsRGBAFloat=function(){var a=new Float32Array(this.width*this.height*4);this._fillFrom32Bit(a);return a};d.prototype.updateStatistics=function(){var a=this;this.statistics=this.pixels.map(function(b){return a._calculateBandStatistics(b,
a.mask)});var b=this.mask,d=0;if(b)for(var f=0;f<b.length;f++)b[f]&&d++;else d=this.width*this.height;this.validPixelCount=d};d.prototype.clamp=function(a){if(a&&"f64"!==a&&"f32"!==a){var b;switch(a){case "u8":b=[0,255];break;case "u16":b=[0,65535];break;case "u32":b=[0,4294967295];break;case "s8":b=[-128,127];break;case "s16":b=[-32768,32767];break;case "s32":b=[-2147483648,2147483647];break;default:b=[-3.4*1E39,3.4*1E39]}var d=b[0];b=b[1];for(var f=this.pixels,c=this.width*this.height,k=f.length,
l,g,u,h=[],z=0;z<k;z++){u=m.createEmptyBand(a,c);l=f[z];for(var x=0;x<c;x++)g=l[x],u[x]=g>b?b:g<d?d:g;h.push(u)}this.pixels=h;this.pixelType=a}};d.prototype.clone=function(){var a=new m({width:this.width,height:this.height,pixelType:this.pixelType,maskIsAlpha:this.maskIsAlpha,validPixelCount:this.validPixelCount});this.mask&&(a.mask=this.mask instanceof Uint8Array?new Uint8Array(this.mask):this.mask.slice(0));var b,d=m.getPixelArrayConstructor(this.pixelType);if(this.pixels&&0<this.pixels.length){a.pixels=
[];var c=this.pixels[0].slice;for(b=0;b<this.pixels.length;b++)a.pixels[b]=c?this.pixels[b].slice(0,this.pixels[b].length):new d(this.pixels[b])}if(this.statistics)for(a.statistics=[],b=0;b<this.statistics.length;b++)a.statistics[b]=f.clone(this.statistics[b]);return a};d.prototype._fillFrom8Bit=function(a){var b=this.mask,d=this.maskIsAlpha,f=this.pixels;if(a&&f&&f.length){var c,k,l;c=k=l=f[0];3<=f.length?(k=f[1],l=f[2]):2===f.length&&(k=f[1]);a=new Uint32Array(a);f=this.width*this.height;if(c.length!==
f)z.error("getAsRGBA()","Unable to convert to RGBA. The pixelblock is invalid.");else if(b&&b.length===f)if(d)for(d=0;d<f;d++)b[d]&&(a[d]=b[d]<<24|l[d]<<16|k[d]<<8|c[d]);else for(d=0;d<f;d++)b[d]&&(a[d]=-16777216|l[d]<<16|k[d]<<8|c[d]);else for(d=0;d<f;d++)a[d]=-16777216|l[d]<<16|k[d]<<8|c[d]}else z.error("getAsRGBA()","Unable to convert to RGBA. The input pixel block is empty.")};d.prototype._fillFromNon8Bit=function(a){var b=this.pixels,d=this.mask,f=this.statistics;if(a&&b&&b.length){var c=this.pixelType,
k=1,l=0,k=1;f&&0<f.length?(l=f.map(function(a){return a.minValue}).reduce(function(a,b){return Math.min(a,b)}),k=f.map(function(a){return a.maxValue-a.minValue}).reduce(function(a,b){return Math.max(a,b)}),k=255/k):(k=255,"s8"===c?(l=-128,k=127):"u16"===c?k=65535:"s16"===c?(l=-32768,k=32767):"u32"===c?k=4294967295:"s32"===c?(l=-2147483648,k=2147483647):"f32"===c?(l=-3.4*1E39,k=3.4*1E39):"f64"===c&&(l=-Number.MAX_VALUE,k=Number.MAX_VALUE),k=255/(k-l));a=new Uint32Array(a);var c=this.width*this.height,
g,u,f=g=u=b[0];if(f.length!==c)return z.error("getAsRGBA()","Unable to convert to RGBA. The pixelblock is invalid.");if(2<=b.length)if(g=b[1],3<=b.length&&(u=b[2]),d&&d.length===c)for(b=0;b<c;b++)d[b]&&(a[b]=-16777216|(u[b]-l)*k<<16|(g[b]-l)*k<<8|(f[b]-l)*k);else for(b=0;b<c;b++)a[b]=-16777216|(u[b]-l)*k<<16|(g[b]-l)*k<<8|(f[b]-l)*k;else if(d&&d.length===c)for(b=0;b<c;b++)g=(f[b]-l)*k,d[b]&&(a[b]=-16777216|g<<16|g<<8|g);else for(b=0;b<c;b++)g=(f[b]-l)*k,a[b]=-16777216|g<<16|g<<8|g}else z.error("getAsRGBA()",
"Unable to convert to RGBA. The input pixel block is empty.")};d.prototype._fillFrom32Bit=function(a){var b=this.pixels,d=this.mask;if(!a||!b||!b.length)return z.error("getAsRGBAFloat()","Unable to convert to RGBA. The input pixel block is empty.");var f,c,k;f=c=k=b[0];3<=b.length?(c=b[1],k=b[2]):2===b.length&&(c=b[1]);var l=this.width*this.height;if(f.length!==l)return z.error("getAsRGBAFloat()","Unable to convert to RGBA. The pixelblock is invalid.");var g=0;if(d&&d.length===l)for(b=0;b<l;b++)a[g++]=
f[b],a[g++]=c[b],a[g++]=k[b],a[g++]=d[b]&1;else for(b=0;b<l;b++)a[g++]=f[b],a[g++]=c[b],a[g++]=k[b],a[g++]=1};d.prototype._calculateBandStatistics=function(a,b){var d=Infinity,f=-Infinity,c=a.length,k,l=0;if(b)for(k=0;k<c;k++)b[k]&&(l=a[k],d=l<d?l:d,f=l>f?l:f);else for(k=0;k<c;k++)l=a[k],d=l<d?l:d,f=l>f?l:f;return{minValue:d,maxValue:f}};var m;h([l.property({json:{write:!0}})],d.prototype,"width",void 0);h([l.property({json:{write:!0}})],d.prototype,"height",void 0);h([l.property({json:{write:!0}})],
d.prototype,"pixelType",void 0);h([l.cast("pixelType")],d.prototype,"castPixelType",null);h([l.property({json:{write:!0}})],d.prototype,"validPixelCount",void 0);h([l.property({json:{write:!0}})],d.prototype,"mask",void 0);h([l.property({json:{write:!0}})],d.prototype,"maskIsAlpha",void 0);h([l.property({json:{write:!0}})],d.prototype,"pixels",void 0);h([l.property({json:{write:!0}})],d.prototype,"statistics",void 0);return d=m=h([l.subclass("esri.layers.support.PixelBlock")],d)}(l.declared(m.JSONSupport))})},
"esri/views/2d/engine/webgl/WGLRasterUtils":function(){define(["require","exports","../../../webgl"],function(e,a,c){Object.defineProperty(a,"__esModule",{value:!0});a.createRasterTexture=function(a,b,g,m){void 0===g&&(g="nearest");void 0===m&&(m=!1);var f=!(m&&"u8"===b.pixelType);m=f?5126:5121;f=null==b.pixels||0===b.pixels.length?null:f?b.getAsRGBAFloat():b.getAsRGBA();return new c.Texture(a,{width:b.width,height:b.height,target:3553,pixelFormat:6408,internalFormat:6408,samplingMode:"bilinear"===
g?9729:9728,dataType:m,wrapMode:33071,flipped:!1},f)};a.createFrameBuffer=function(a,b,g,m){m=new c.Texture(a,{width:b,height:g,target:3553,pixelFormat:6408,internalFormat:6408,samplingMode:9728,dataType:m?5121:5126,wrapMode:33071,flipped:!1});return new c.FramebufferObject(a,{colorTarget:0,depthStencilTarget:3,width:b,height:g},m)};a.createTransformTexture=function(a,b){for(var g=4*b.size[0],m=b.size[1],f={width:g,height:m,target:3553,pixelFormat:6408,internalFormat:6408,dataType:5126,samplingMode:9728,
wrapMode:33071,flipped:!1},g=new Float32Array(g*m*4),d=m=0;d<b.coefficients.length;d++)g[m++]=b.coefficients[d],2===d%3&&(g[m++]=1);return new c.Texture(a,f,g)};a.createColormapTexture=function(a,b){return new c.Texture(a,{width:b.length/4,height:1,target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071,flipped:!1},b)};a.getUniformInfos=function(a,b){a=a.gl;b=b.glName;for(var c=a.getProgramParameter(b,a.ACTIVE_UNIFORMS),m=new Map,f,d=0;d<c;d++)(f=a.getActiveUniform(b,
d))&&m.set(f.name,{location:a.getUniformLocation(b,f.name),info:f});return m};a.setUniforms=function(a,b,c,m){Object.keys(m).forEach(function(f){var d=c.get(f)||c.get(f+"[0]");if(d){var l=m[f];if(null!==d&&null!=l){var g=a.gl,d=d.info;switch(d.type){case g.FLOAT:1<d.size?b.setUniform1fv(f,l):b.setUniform1f(f,l);break;case g.FLOAT_VEC2:b.setUniform2fv(f,l);break;case g.FLOAT_VEC3:b.setUniform3fv(f,l);break;case g.FLOAT_VEC4:b.setUniform4fv(f,l);break;case g.FLOAT_MAT3:b.setUniformMatrix3fv(f,l);break;
case g.FLOAT_MAT4:b.setUniformMatrix4fv(f,l);break;case g.INT:case g.BOOL:1<d.size?b.setUniform1iv(f,l):b.setUniform1i(f,l);break;case g.INT_VEC2:case g.BOOL_VEC2:b.setUniform2iv(f,l);break;case g.INT_VEC3:case g.BOOL_VEC3:b.setUniform3iv(f,l);break;case g.INT_VEC4:case g.BOOL_VEC4:b.setUniform4iv(f,l)}}}})};a.setTextures=function(a,b,c,m){c.length===m.length&&(m.some(function(a){return null==a})||c.some(function(a){return null==a})||c.forEach(function(f,d){b.setUniform1i(f,d);a.bindTexture(m[d],
d)}))}})},"esri/views/2d/engine/RasterTileContainer":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/decorateHelper ../../../geometry/support/aaBoundingRect ../engine ./RasterTile ./webgl/enums ./webgl/TileContainer".split(" "),function(e,a,c,h,b,g,m,f,d){Object.defineProperty(a,"__esModule",{value:!0});e=function(a){function d(){return null!==a&&a.apply(this,arguments)||this}c(d,a);d.prototype.createTile=function(a){var d=this._tileInfoView.getTileBounds(b.create(),
a);return new m.RasterTile(a,d,this._tileInfoView.tileInfo.size)};d.prototype.destroyTile=function(){};d.prototype.prepareRenderPasses=function(b){var d=this,c=b.registerRenderPass({name:"bitmap (tile)",brushes:[g.brushes.Raster],target:function(){return d.children.map(function(a){return a.bitmap})},drawPhase:f.WGLDrawPhase.MAP});return a.prototype.prepareRenderPasses.call(this,b).concat([c])};d.prototype.doRender=function(b){this.visible&&b.drawPhase===f.WGLDrawPhase.MAP&&a.prototype.doRender.call(this,
b)};return d}(d.default);a.RasterTileContainer=e})},"esri/views/2d/engine/Stage":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/assignHelper ../../../core/Error ../../../core/events ../../../core/has ../../../core/promiseUtils ../../../core/scheduling ../../../core/watchUtils ../../../core/libs/gl-matrix-2/common ../../../core/libs/gl-matrix-2/mat2d ../../../core/libs/gl-matrix-2/mat2df64 ../../../core/libs/gl-matrix-2/vec2 ../../../core/libs/gl-matrix-2/vec2f64 ../../webgl ./Container ./webgl/BitBlitRenderer ./webgl/definitions ./webgl/enums ./webgl/Painter ./webgl/Profiler ./webgl/WebGLDriverTest ./webgl/shaders/StencilPrograms ../support/Timeline ../../support/screenshotUtils".split(" "),
function(e,a,c,h,b,g,m,f,d,l,z,v,A,x,u,q,n,p,y,k,C,w,B,E,G,F){Object.defineProperty(a,"__esModule",{value:!0});e=function(a){function n(f,k){var c=a.call(this)||this;c._renderParameters={drawPhase:0,state:c.state,pixelRatio:window.devicePixelRatio,stationary:!1,globalOpacity:1};c._clipData=new Float32Array(8);c._upperLeft=u.vec2f64.create();c._upperRight=u.vec2f64.create();c._lowerLeft=u.vec2f64.create();c._lowerRight=u.vec2f64.create();c._mat2=A.mat2df64.create();c._clipRendererInitialized=!1;c._supersampleScreenshots=
!0;c.dataUploadCounter=0;c.stage=c;c._stationary=!0;c.attached=!0;var l=k.canvas,l=void 0===l?document.createElement("canvas"):l,n=k.alpha,p=k.stencil,y=k.renderContext,h=k.supersampleScreenshots,h=void 0===h?!0:h,x=k.contextOptions,x=void 0===x?{}:x;c._canvas=l;n=q.createContextOrErrorHTML(l,{alpha:void 0===n?!0:n,antialias:!1,depth:!0,stencil:void 0===p?!0:p},void 0===y?"webgl":y);c.context=new q.RenderingContext(n,x);c.painter=new C.default(c.context);c._taskHandle=d.addFrameTask({render:function(){return c.renderFrame()}});
c._taskHandle.pause();c._supersampleScreenshots=h;c._lostWebGLContextHandle=g.on(l,"webglcontextlost",function(){c.emit("webgl-error",{error:new b("webgl-context-lost")})});m("esri-2d-profiler")&&(c._debugOutput=document.createElement("div"),c._debugOutput.setAttribute("style","margin: 24px 64px; position: absolute; color: red;"),f.appendChild(c._debugOutput));l.setAttribute("style","width: 100%; height:100%; display:block;");c.profiler=new w.Profiler(c.context,c._debugOutput);c.renderingOptions=
k.renderingOptions;c.timeline=k.timeline||new G.Timeline;c.driverTestResult=B.testWebGLDriver(c.context);f.appendChild(l);return c}c(n,a);n.prototype.destroy=function(){this.removeAllChildren();this.renderFrame();this._taskHandle.remove();this._boundFBO=this._taskHandle=null;this._clipFBO&&(this._clipFBO.dispose(),this._clipFBO=null);this._blitRenderer&&(this._blitRenderer.dispose(),this._blitRenderer=null);this._clipVAO&&(this._clipVAO.dispose(),this._clipVBO=this._clipVAO=null);this._clipStencilProgram&&
(this._clipStencilProgram.dispose(),this._clipStencilProgram=null);this._lostWebGLContextHandle&&(this._lostWebGLContextHandle.remove(),this._lostWebGLContextHandle=null);this._canvas.parentNode&&this._canvas.parentNode.removeChild(this._canvas);this._debugOutput&&this._debugOutput.parentNode&&this._debugOutput.parentNode.removeChild(this._debugOutput);this.painter.dispose();this.context.dispose();this._canvas=null};Object.defineProperty(n.prototype,"background",{get:function(){return this._background},
set:function(a){this._background=a;this.requestRender()},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"highlightOptions",{get:function(){return this._highlightOptions},set:function(a){var b=this;this._highlightOptionsHandle&&(this._highlightOptionsHandle.remove(),this._highlightOptionsHandle=null);if(this._highlightOptions=a)this._highlightOptionsHandle=l.init(this._highlightOptions,"version",function(){b.painter.setHighlightOptions(a);b.requestRender()})},enumerable:!0,configurable:!0});
Object.defineProperty(n.prototype,"renderingOptions",{get:function(){return this._renderingOptions},set:function(a){this._renderingOptions=a;this.requestRender()},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"state",{get:function(){return this._state},set:function(a){this._state=a;this.requestRender()},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"stationary",{get:function(){return this._stationary},set:function(a){this._stationary!==a&&(this._stationary=
a,this.requestRender())},enumerable:!0,configurable:!0});n.prototype.requestRender=function(){this._lastRenderRequestTime=Date.now();this._taskHandle&&this._taskHandle.resume()};n.prototype.renderFrame=function(){var a=Date.now()-this._lastRenderRequestTime;this._renderParameters.state=this._state;this._renderParameters.stationary=this.stationary;this._renderParameters.pixelRatio=window.devicePixelRatio;this._renderParameters.globalOpacity=1;this.processRender(this._renderParameters);a>=y.MAX_ANIMATION_TIME_MS&&
this._taskHandle.pause()};n.prototype.renderChildren=function(a){var b=this.context,d=this.children,d=a.children?a.children:d;this.profiler.recordStart("drawLayers");this.dataUploadCounter=0;this.beforeRenderChildren(a);a.drawPhase=k.WGLDrawPhase.MAP;this.painter.beforeRenderLayers(b);for(var f=0;f<d.length;f++){var c=d[f];c.attached&&c.processRender(a)}this.painter.renderLayers(b);a.drawPhase=k.WGLDrawPhase.LABEL;this.painter.beforeRenderLayers(b);for(f=0;f<d.length;f++)c=d[f],c.attached&&c.processRender(a);
this.painter.renderLayers(b);if(m("esri-tiles-debug")){a.drawPhase=k.WGLDrawPhase.DEBUG;this.painter.beforeRenderLayers(b);for(f=0;f<d.length;f++)c=d[f],c.attached&&c.processRender(a);this.painter.renderLayers(b)}this.profiler.recordEnd("drawLayers");this.afterRenderChildren()};n.prototype.beforeRenderChildren=function(a){var b=this.context,d=a.state,f=a.pixelRatio;if(this.painter){b.enforceState();var c=d.size;a=d.rotation;var k=Math.round(c[0]*f),c=Math.round(c[1]*f);this._boundFBO=b.getBoundFramebufferObject();
if(d.spatialReference&&(d.spatialReference._isWrappable?d.spatialReference._isWrappable():d.spatialReference.isWrappable)){var l=z.common.toRadian(a),g=Math.abs(Math.cos(l)),n=Math.abs(Math.sin(l)),p=Math.round(d.worldScreenWidth);if(Math.round(k*g+c*n)<=p)this._clipFrame=!1;else{this._clipFBO&&this._clipFBO.width===k&&this._clipFBO.height===c||(this._clipFBO=new q.FramebufferObject(b,{colorTarget:0,depthStencilTarget:3,width:k,height:c}));var y=(this.state.padding.left-this.state.padding.right)/
2,w=(this.state.padding.bottom-this.state.padding.top)/2,m=.5*k,u=.5*c,d=1/k,h=1/c,f=.5*p*f,e=.5*(k*n+c*g),k=this._upperLeft,g=this._upperRight,n=this._lowerLeft,p=this._lowerRight;x.vec2.set(k,-f,-e);x.vec2.set(g,f,-e);x.vec2.set(n,-f,e);x.vec2.set(p,f,e);v.mat2d.identity(this._mat2);v.mat2d.translate(this._mat2,this._mat2,[m+y,u+w]);0!==a&&v.mat2d.rotate(this._mat2,this._mat2,l);x.vec2.transformMat2d(k,k,this._mat2);x.vec2.transformMat2d(g,g,this._mat2);x.vec2.transformMat2d(n,n,this._mat2);x.vec2.transformMat2d(p,
p,this._mat2);a=this._clipData;a.set([2*n[0]*d-1,2*(c-n[1])*h-1,2*p[0]*d-1,2*(c-p[1])*h-1,2*k[0]*d-1,2*(c-k[1])*h-1,2*g[0]*d-1,2*(c-g[1])*h-1]);this._clipRendererInitialized||this._initializeClipRenderer(b);this._clipVBO.setData(a);this._boundFBO=b.getBoundFramebufferObject();b.bindFramebuffer(this._clipFBO);b.setDepthWriteEnabled(!0);b.setStencilWriteMask(255);b.setClearColor(0,0,0,0);b.setClearDepth(1);b.setClearStencil(0);b.clear(b.gl.COLOR_BUFFER_BIT|b.gl.DEPTH_BUFFER_BIT|b.gl.STENCIL_BUFFER_BIT);
b.setDepthWriteEnabled(!1);this._clipFrame=!0}}else this._clipFrame=!1}};n.prototype.afterRenderChildren=function(){var a=this.context;a.logIno();this._clipFrame&&this._clipRendererInitialized&&(a.bindFramebuffer(this._boundFBO),this._boundFBO=null,a.bindVAO(this._clipVAO),a.bindProgram(this._clipStencilProgram),a.setDepthWriteEnabled(!1),a.setDepthTestEnabled(!1),a.setStencilTestEnabled(!0),a.setBlendingEnabled(!1),a.setColorMask(!1,!1,!1,!1),a.setStencilOp(7680,7680,7681),a.setStencilWriteMask(255),
a.setStencilFunction(519,1,255),a.drawElements(4,6,5123,0),a.bindVAO(),a.setColorMask(!0,!0,!0,!0),a.setBlendingEnabled(!0),a.setStencilFunction(514,1,255),this._blitRenderer.render(a,this._clipFBO.colorTexture,9728,1),a.setStencilTestEnabled(!1))};n.prototype.doRender=function(b){var d=this.context,f=b.state,c=b.pixelRatio;this._resizeCanvas(b);this.context.enforceState();d.setViewport(0,0,c*f.size[0],c*f.size[1]);d.setDepthWriteEnabled(!0);d.setStencilWriteMask(255);this.background&&this.background.color?
(f=this.background.color,d.setClearColor(f.r/255,f.g/255,f.b/255,f.a)):d.setClearColor(0,0,0,0);d.setClearDepth(1);d.setClearStencil(0);d.clear(d.gl.COLOR_BUFFER_BIT|d.gl.DEPTH_BUFFER_BIT|d.gl.STENCIL_BUFFER_BIT);d.setDepthWriteEnabled(!1);a.prototype.doRender.call(this,b)};n.prototype.takeScreenshot=function(a,b){var d=F.screenshotSuperSampleSettings(a,this._supersampleScreenshots,this._state.padding),c=d.framebufferWidth,k=d.framebufferHeight,l=this.context,g=a.layers,n={drawPhase:null,globalOpacity:1,
stationary:!0,state:this._renderParameters.state.clone(),pixelRatio:d.pixelRatio};if(null!=a.rotation){var p=n.state.viewpoint;p.rotation=a.rotation;n.state.viewpoint=p}0<g.length&&(n.children=[],g.forEach(function(a){var d=b.find(function(b){return b.layer.id===a.id});d&&"container"in d&&d.container&&d.attached&&n.children.push(d.container)}));var y=new q.FramebufferObject(l,{colorTarget:0,depthStencilTarget:3,width:c,height:k}),g=l.getBoundFramebufferObject(),p=l.getViewport();l.bindFramebuffer(y);
l.setViewport(0,0,c,k);c=l.gl;!a.ignoreBackground&&this.background&&this.background.color?(k=this.background.color,l.setClearColor(k.r/255,k.g/255,k.b/255,k.a)):l.setClearColor(0,0,0,0);l.setClearDepth(1);l.setClearStencil(0);l.clear(c.COLOR_BUFFER_BIT|c.DEPTH_BUFFER_BIT|c.STENCIL_BUFFER_BIT);this.renderChildren(n);d=this._readbackScreenshot(d);l.bindFramebuffer(g);l.setViewport(p.x,p.y,p.width,p.height);this.requestRender();l=this._ensureScreenshotEncodeCanvas();a=F.encodeResult(d,a,l,{flipY:!0,
premultipliedAlpha:!0});return f.resolve(a)};n.prototype._ensureScreenshotEncodeCanvas=function(){this._screenshotEncodeCanvas||(this._screenshotEncodeCanvas=document.createElement("canvas"));return this._screenshotEncodeCanvas};n.prototype._readbackScreenshot=function(a){var b=a.framebufferWidth,d=a.framebufferHeight,f=a.region;a=a.resample;var c=this.context.gl;if(a){var k=F.createEmptyImageData(b,d,this._ensureScreenshotEncodeCanvas());c.readPixels(0,0,b,d,6408,5121,new Uint8Array(k.data.buffer));
b=F.createEmptyImageData(f.width,f.height,this._ensureScreenshotEncodeCanvas());return F.resampleHermite(k,b,!0,a.region.x,d-(a.region.y+a.region.height),a.region.width,a.region.height)}k=F.createEmptyImageData(f.width,f.height,this._ensureScreenshotEncodeCanvas());c.readPixels(f.x,d-(f.y+f.height),f.width,f.height,6408,5121,new Uint8Array(k.data.buffer));return k};n.prototype._resizeCanvas=function(a){var b=this._canvas,d=b.style,f=a.state.size,c=a.pixelRatio;a=f[0];var f=f[1],k=Math.round(a*c),
c=Math.round(f*c);if(b.width!==k||b.height!==c)b.width=k,b.height=c;d.width=a+"px";d.height=f+"px"};n.prototype._initializeClipRenderer=function(a){if(this._clipRendererInitialized)return!0;this._blitRenderer=new p.BitBlitRenderer;var b=E.stencil.attributes,d=q.createProgram(a,E.stencil);if(!d)return!1;var f=q.BufferObject.createVertex(a,35040,32),c=new Uint16Array([0,1,2,2,1,3]),c=q.BufferObject.createIndex(a,35044,c);a=new q.VertexArrayObject(a,b,{geometry:[{name:"a_pos",count:2,type:5126,offset:0,
stride:8,normalized:!1,divisor:0}]},{geometry:f},c);this._clipStencilProgram=d;this._clipVBO=f;this._clipVAO=a;return this._clipRendererInitialized=!0};return n}(n.Container);a.Stage=e})},"esri/views/2d/engine/webgl/BitBlitRenderer":function(){define(["require","exports","../../../webgl","./shaders/BitBlitPrograms"],function(e,a,c,h){Object.defineProperty(a,"__esModule",{value:!0});e=function(){function a(){this._initialized=!1}a.prototype.dispose=function(){this._program&&(this._program.dispose(),
this._program=null);this._vertexArrayObject&&(this._vertexArrayObject.dispose(),this._vertexArrayObject=null)};a.prototype.render=function(a,b,f,d){a&&(this._initialized||this._initialize(a),a.setBlendFunctionSeparate(1,771,1,771),a.bindVAO(this._vertexArrayObject),a.bindProgram(this._program),b.setSamplingMode(f),a.bindTexture(b,0),this._program.setUniform1i("u_tex",0),this._program.setUniform1f("u_opacity",d),a.drawArrays(5,0,4),a.bindVAO())};a.prototype._initialize=function(a){if(this._initialized)return!0;
var b=h.bitBlit.attributes,f=c.createProgram(a,h.bitBlit);if(!f)return!1;var d=new Int8Array(16);d[0]=-1;d[1]=-1;d[2]=0;d[3]=0;d[4]=1;d[5]=-1;d[6]=1;d[7]=0;d[8]=-1;d[9]=1;d[10]=0;d[11]=1;d[12]=1;d[13]=1;d[14]=1;d[15]=1;a=new c.VertexArrayObject(a,b,{geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:4,normalized:!1,divisor:0},{name:"a_tex",count:2,type:5120,offset:2,stride:4,normalized:!1,divisor:0}]},{geometry:c.BufferObject.createVertex(a,35044,d)});this._program=f;this._vertexArrayObject=
a;return this._initialized=!0};return a}();a.BitBlitRenderer=e})},"esri/views/2d/engine/webgl/shaders/BitBlitPrograms":function(){define(["require","exports","./sources/resolver"],function(e,a,c){Object.defineProperty(a,"__esModule",{value:!0});a.bitBlit={name:"bitBlit",shaders:{vertexShader:c.resolveIncludes("bitBlit/bitBlit.vert"),fragmentShader:c.resolveIncludes("bitBlit/bitBlit.frag")},attributes:{a_pos:0,a_tex:1}}})},"esri/views/2d/engine/webgl/definitions":function(){define(["require","exports"],
function(e,a){Object.defineProperty(a,"__esModule",{value:!0});a.WEBGL_MAX_STOPS=8;a.WEBGL_MAX_INNER_STOPS=a.WEBGL_MAX_STOPS-2;a.NAN_MAGIC_NUMBER=1E-30;a.EXTRUDE_SCALE=64;a.PICTURE_FILL_COLOR=4294967295;a.TILE_SIZE=512;a.RASTER_TILE_SIZE=256;a.ANGLE_FACTOR_256=256/360;a.DEBUG_LABELS=!1;a.COLLISION_BUCKET_SIZE=128;a.DOT_DENSITY_MAX_FIELDS=8;a.COLLISION_MAX_ZOOM_DELTA=3;a.COLLISION_EARLY_REJECT_BUCKET_SIZE=16;a.COLLISION_BOX_PADDING=16;a.COLLISION_TILE_BOX_SIZE=a.TILE_SIZE/a.COLLISION_BUCKET_SIZE;a.COLLISION_PLACEMENT_PADDING=
8;a.HEURISTIC_GLYPHS_PER_LINE=50;a.HEURISTIC_GLYPHS_PER_FEATURE=10;a.GLYPH_SIZE=24;a.TEXT_LINE_HEIGHT=1.2*a.GLYPH_SIZE;a.TEXT_MAX_WIDTH=10*a.GLYPH_SIZE;a.TEXT_SPACING=0;a.AVERAGE_GLYPH_MOSAIC_ITEM={metrics:{width:15,height:17,left:0,top:-7,advance:14}};a.ATTRIBUTE_STORE_TEXTURE_SIZE=1024;a.TEXTURE_BINDING_SPRITE_ATLAS=0;a.TEXTURE_BINDING_GLYPH_ATLAS=0;a.TEXTURE_BINDING_BITMAP=0;a.TEXTURE_BINDING_ATTRIBUTE_DATA_0=1;a.TEXTURE_BINDING_ATTRIBUTE_DATA_1=2;a.TEXTURE_BINDING_ATTRIBUTE_DATA_2=3;a.TEXTURE_BINDING_ATTRIBUTE_DATA_3=
4;a.TEXTURE_BINDING_HIGHLIGHT_0=5;a.TEXTURE_BINDING_HIGHLIGHT_1=6;a.TEXTURE_BINDING_RENDERER_0=5;a.TEXTURE_BINDING_RENDERER_1=6;a.ATTRIBUTE_DATA_FILTER_FLAGS=0;a.ATTRIBUTE_DATA_ANIMATION=1;a.ATTRIBUTE_DATA_VV=2;a.ATTRIBUTE_DATA_DD0=3;a.ATTRIBUTE_DATA_DD1=3;a.MAX_FILTERS=2;a.HIGHLIGHT_FLAG=1;a.FILTER_FLAG_0=2;a.EFFECT_FLAG_0=4;a.THIN_LINE_THRESHOLD=2.5;a.HITTEST_SEARCH_SIZE=24;a.MAX_ANIMATION_TIME_MS=2E3;a.VTL_TEXTURE_BINDING_UNIT_SPRITES=5;a.VTL_TEXTURE_BINDING_UNIT_GLYPHS=6;a.VTL_HIGH_RES_CUTOFF=
1.15;a.MAX_GPU_UPLOADS_PER_FRAME=2})},"esri/views/2d/engine/webgl/Painter":function(){define("require exports ../../../../core/tsSupport/assignHelper ../../../webgl ../../engine ../vectorTiles/shaders/ProgramCache ./BitBlitRenderer ./enums ./MaterialManager ./TextureManager ./effects/AnimationEffect ./effects/HighlightEffect ./effects/HittestEffect ./painter/RenderPass".split(" "),function(e,a,c,h,b,g,m,f,d,l,z,v,A,x){Object.defineProperty(a,"__esModule",{value:!0});e=function(){return function(){}}();
a.PainterOptions=e;e=function(){function a(a){this.context=a;this._blitRenderer=new m.BitBlitRenderer;this._brushCache=new Map;this._vtlProgramCache=null;this.brushNameToCtor={marker:b.brushes.Marker,line:b.brushes.Line,fill:b.brushes.Fill,text:b.brushes.Text,label:b.brushes.Label,clip:b.brushes.Clip,stencil:b.brushes.Stencil,bitmap:b.brushes.Bitmap,tileInfo:b.brushes.TileInfo,vtlBackground:b.brushes.VTLBackground,vtlFill:b.brushes.VTLFill,vtlLine:b.brushes.VTLLine,vtlCircle:b.brushes.VTLCircle,vtlSymbol:b.brushes.VTLSymbol};
this.textureManager=new l;this.effects={highlight:new v.default,hittest:new A.HittestEffect,integrate:new z.AnimationEffect};this.materialManager=new d(a);this._vtlProgramCache=new g.default(a)}a.prototype.getFbos=function(a,b){if(a!==this._lastWidth||b!==this._lastHeight){this._lastWidth=a;this._lastHeight=b;if(this._fbos)for(var d in this._fbos)this._fbos[d].dispose();d={target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071,width:a,height:b};var f={colorTarget:0,depthStencilTarget:3};
a=new h.Renderbuffer(this.context,{width:a,height:b,internalFormat:34041});this._fbos={output:new h.FramebufferObject(this.context,f,d,a),alpha:new h.FramebufferObject(this.context,f,d,a),effect0:new h.FramebufferObject(this.context,f,d,a)}}return this._fbos};a.prototype.beforeRenderLayers=function(a){var b=a.getViewport(),b=this.getFbos(b.width,b.height);this._prevFBO=a.getBoundFramebufferObject();a.bindFramebuffer(b.output);a.setDepthWriteEnabled(!0);a.setClearColor(0,0,0,0);a.setClearDepth(1);
a.clear(a.gl.COLOR_BUFFER_BIT|a.gl.DEPTH_BUFFER_BIT);a.setDepthWriteEnabled(!1)};a.prototype.beforeRenderLayer=function(a,b,d){1!==d?(a.bindFramebuffer(this._fbos.alpha),a.setClearColor(0,0,0,0),a.clear(a.gl.COLOR_BUFFER_BIT)):a.bindFramebuffer(this._fbos.output);a.setDepthWriteEnabled(!1);a.setDepthTestEnabled(!1);a.setStencilTestEnabled(!0);a.setClearStencil(b);a.setStencilWriteMask(255);a.clear(a.gl.STENCIL_BUFFER_BIT)};a.prototype.compositeLayer=function(a,b){1!==b&&(a.bindFramebuffer(this._fbos.output),
a.setStencilTestEnabled(!1),a.setStencilWriteMask(0),a.setBlendingEnabled(!0),a.setBlendFunctionSeparate(1,771,1,771),a.setColorMask(!0,!0,!0,!0),this._blitRenderer.render(a,this._fbos.alpha.colorTexture,9728,b))};a.prototype.renderLayers=function(a){a.bindFramebuffer(this._prevFBO);this._fbos&&(a.setStencilTestEnabled(!1),a.setStencilWriteMask(0),a.setBlendingEnabled(!0),a.setBlendFunctionSeparate(1,771,1,771),a.setColorMask(!0,!0,!0,!0),this._blitRenderer.render(a,this._fbos.output.colorTexture,
9728,1))};a.prototype.dispose=function(){this.materialManager.dispose();this.textureManager.dispose();this._blitRenderer&&(this._blitRenderer.dispose(),this._blitRenderer=null);this._vtlProgramCache&&(this._vtlProgramCache.dispose(),this._vtlProgramCache=null);this._brushCache&&(this._brushCache.forEach(function(a){return a.dispose()}),this._brushCache.clear(),this._brushCache=null);if(this._fbos)for(var a in this._fbos)this._fbos[a]&&this._fbos[a].dispose();if(this.effects)for(var b in this.effects)this.effects[b]&&
this.effects[b].dispose();this._prevFBO=null};a.prototype.getGeometryBrush=function(a){var d;a=(d={},d[f.WGLGeometryType.FILL]=b.brushes.Fill,d[f.WGLGeometryType.LINE]=b.brushes.Line,d[f.WGLGeometryType.MARKER]=b.brushes.Marker,d[f.WGLGeometryType.TEXT]=b.brushes.Text,d)[a];d=this._brushCache.get(a);void 0===d&&(d=new a,this._brushCache.set(a,d));return this._brushCache.get(a)};a.prototype.renderObject=function(a,b,d,f){d=this.brushNameToCtor[d];if(!d)return null;var c=this._brushCache.get(d);void 0===
c&&(c=new d,this._brushCache.set(d,c));c.prepareState(a,b,f);c.draw(a,b,f)};a.prototype.renderObjects=function(a,b,d,f){d=this.brushNameToCtor[d];if(!d)return null;var c=this._brushCache.get(d);void 0===c&&(c=new d,this._brushCache.set(d,c));c.drawMany(a,b,f)};a.prototype.getVectorTileProgramCach=function(){return this._vtlProgramCache};a.prototype.registerRenderPass=function(a){var b=this,d=a.brushes.map(function(a){b._brushCache.has(a)||b._brushCache.set(a,new a);return b._brushCache.get(a)});return new x.default(d,
a)};a.prototype.setHighlightOptions=function(a){this.effects.highlight.setHighlightOptions(a)};return a}();a.default=e})},"esri/views/2d/engine/vectorTiles/shaders/ProgramCache":function(){define(["require","exports","../../../../webgl","./Programs"],function(e,a,c,h){Object.defineProperty(a,"__esModule",{value:!0});e=function(){function a(a){this._cache=Array(8);for(var b=0;8>b;b++)this._cache[b]={};this._programRepo=new c.ProgramCache(a)}a.prototype.dispose=function(){this._programRepo&&(this._programRepo.dispose(),
this._programRepo=null)};a.prototype.getProgram=function(a,b,f){var d=this._cache[a];d[b]||(a=this._programRepo.getProgram(this._getProgramTemplate(a),f),d[b]=a);return d[b]};a.prototype.getProgramAttributes=function(a){switch(a){case 0:return h.background.attributes;case 5:return h.circle.attributes;case 1:return h.fill.attributes;case 4:return h.icon.attributes;case 3:return h.line.attributes;case 2:return h.outline.attributes;case 6:return h.text.attributes;default:return null}};a.prototype._getProgramTemplate=
function(a){switch(a){case 0:return h.background;case 5:return h.circle;case 1:return h.fill;case 4:return h.icon;case 3:return h.line;case 2:return h.outline;case 6:return h.text;default:return null}};return a}();a.default=e})},"esri/views/2d/engine/vectorTiles/shaders/Programs":function(){define(["require","exports","../../../../webgl","./sources/resolver"],function(e,a,c,h){Object.defineProperty(a,"__esModule",{value:!0});a.background={name:"background",shaders:function(a){return{vertexShader:c.glslifyDefineMap({ID:a.id,
PATTERN:a.pattern})+h.resolveIncludes("background/background.vert"),fragmentShader:c.glslifyDefineMap({ID:a.id,PATTERN:a.pattern})+h.resolveIncludes("background/background.frag")}},attributes:{a_pos:0}};a.circle={name:"circle",shaders:function(a){return{vertexShader:c.glslifyDefineMap({ID:a.id})+h.resolveIncludes("circle/circle.vert"),fragmentShader:c.glslifyDefineMap({ID:a.id})+h.resolveIncludes("circle/circle.frag")}},attributes:{a_pos:0,a_color:1,a_stroke_color:2,a_data:3}};var b=function(a){return c.glslifyDefineMap({ID:a.id,
DD:a.dd,PATTERN:a.pattern})};a.fill={name:"fill",shaders:function(a){return{vertexShader:b(a)+h.resolveIncludes("fill/fill.vert"),fragmentShader:b(a)+h.resolveIncludes("fill/fill.frag")}},attributes:{a_pos:0,a_color:1}};a.outline={name:"outline",shaders:function(a){return{vertexShader:c.glslifyDefineMap({ID:a.id,DD:a.dd})+h.resolveIncludes("outline/outline.vert"),fragmentShader:c.glslifyDefineMap({ID:a.id,DD:a.dd})+h.resolveIncludes("outline/outline.frag")}},attributes:{a_pos:0,a_offset:1,a_xnormal:2,
a_color:3}};a.icon={name:"icon",shaders:function(a){return{vertexShader:c.glslifyDefineMap({ID:a.id,DD:a.dd,SDF:a.sdf})+h.resolveIncludes("icon/icon.vert"),fragmentShader:c.glslifyDefineMap({ID:a.id,DD:a.dd,SDF:a.sdf})+h.resolveIncludes("icon/icon.frag")}},attributes:{a_pos:0,a_vertexOffset:1,a_tex:2,a_levelInfo:3,a_color:4,a_size:5}};var g=function(a){return c.glslifyDefineMap({ID:a.id,DD:a.dd,PATTERN:a.pattern})};a.line={name:"line",shaders:function(a){return{vertexShader:g(a)+h.resolveIncludes("line/line.vert"),
fragmentShader:g(a)+h.resolveIncludes("line/line.frag")}},attributes:{a_pos:0,a_offsetAndNormal:1,a_accumulatedDistance:2,a_color:3,a_width:4}};a.text={name:"text",shaders:function(a){return{vertexShader:c.glslifyDefineMap({ID:a.id,DD:a.dd})+h.resolveIncludes("text/text.vert"),fragmentShader:c.glslifyDefineMap({ID:a.id,DD:a.dd})+h.resolveIncludes("text/text.frag")}},attributes:{a_pos:0,a_vertexOffset:1,a_tex:2,a_levelInfo:3,a_color:4,a_size:5}}})},"esri/views/2d/engine/vectorTiles/shaders/sources/resolver":function(){define(["require",
"exports","../../../../../webgl","./shaderRepository"],function(e,a,c,h){Object.defineProperty(a,"__esModule",{value:!0});var b=new c.ShaderCompiler(function(a){var b=h;a.split("/").forEach(function(a){b&&(b=b[a])});return b});a.resolveIncludes=function(a){return b.resolveIncludes(a)}})},"esri/views/2d/engine/vectorTiles/shaders/sources/shaderRepository":function(){define(["require","exports"],function(e,a){return{background:{"background.frag":"#ifdef PATTERN\nuniform lowp float u_opacity;\nuniform mediump vec2 u_pattern_tl;\nuniform mediump vec2 u_pattern_br;\nuniform sampler2D u_texture;\nvarying mediump vec2 v_tileTextureCoord;\n#else\nuniform lowp vec4 u_color;\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main() {\n#ifdef PATTERN\n  mediump vec2 normalizedTextureCoord \x3d mod(v_tileTextureCoord, 1.0);\n  mediump vec2 samplePos \x3d mix(u_pattern_tl, u_pattern_br, normalizedTextureCoord);\n  lowp vec4 color \x3d texture2D(u_texture, samplePos);\n  gl_FragColor \x3d u_opacity * color;\n#else\n  gl_FragColor \x3d u_color;\n#endif\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"background.vert":"precision mediump float;\nattribute vec2 a_pos;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform mediump float u_coord_range;\nuniform mediump float u_depth;\n#ifdef PATTERN\nuniform mediump mat3 u_pattern_matrix;\nvarying mediump vec2 v_tileTextureCoord;\n#endif\nvoid main() {\n  gl_Position \x3d vec4((u_dvsMat3 * vec3(u_coord_range * a_pos, 1.0)).xy, u_depth, 1.0);\n#ifdef PATTERN\n  v_tileTextureCoord \x3d (u_pattern_matrix * vec3(a_pos, 1.0)).xy;\n#endif\n#ifdef ID\n  v_id \x3d u_id / 255.0;\n#endif\n}"},
circle:{"circle.frag":"precision lowp float;\nvarying lowp vec4 v_color;\nvarying lowp vec4 v_stroke_color;\nvarying mediump float v_blur;\nvarying mediump float v_stroke_width;\nvarying mediump float v_radius;\nvarying mediump vec2 v_offset;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\n  mediump float dist \x3d length(v_offset);\n  mediump float alpha \x3d smoothstep(0.0, -v_blur, dist - 1.0);\n  lowp float color_mix_ratio \x3d v_stroke_width \x3c 0.01 ? 0.0 : smoothstep(-v_blur, 0.0, dist - v_radius / (v_radius + v_stroke_width));\n  gl_FragColor \x3d alpha * mix(v_color, v_stroke_color, color_mix_ratio);\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"circle.vert":"precision mediump float;\nattribute vec2 a_pos;\nattribute vec4 a_color;\nattribute vec4 a_stroke_color;\nattribute vec4 a_data;\nconst float sizePrecision \x3d 0.25;\nconst float blurPrecision \x3d 0.03125;\nvarying lowp vec4 v_color;\nvarying lowp vec4 v_stroke_color;\nvarying mediump float v_blur;\nvarying mediump float v_stroke_width;\nvarying mediump float v_radius;\nvarying mediump vec2 v_offset;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform mediump vec2 u_circleTranslation;\nuniform mediump float u_depth;\nuniform mediump float u_radius;\nuniform lowp vec4 u_color;\nuniform mediump float u_blur;\nuniform mediump float u_stroke_width;\nuniform lowp vec4 u_stroke_color;\nuniform mediump float u_antialiasingWidth;\nvoid main()\n{\n  v_color \x3d a_color * u_color;\n  v_stroke_color \x3d a_stroke_color * u_stroke_color;\n  v_stroke_width \x3d a_data[1] * sizePrecision * u_stroke_width;\n  v_radius \x3d a_data[2] * u_radius;\n  v_blur \x3d max(a_data[0] * blurPrecision + u_blur, u_antialiasingWidth / (v_radius + v_stroke_width));\n  mediump vec2 offset \x3d vec2(mod(a_pos, 2.0) * 2.0 - 1.0);\n  v_offset \x3d offset;\n#ifdef ID\n  v_id \x3d u_id / 255.0;\n#endif\n  mediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos * 0.5, 1.0) + u_displayMat3 * vec3((v_radius + v_stroke_width) * offset + u_circleTranslation, 0.0);\n  gl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n}"},
fill:{"fill.frag":"precision lowp float;\n#ifdef PATTERN\nuniform mediump vec2 u_pattern_tl;\nuniform mediump vec2 u_pattern_br;\nuniform lowp sampler2D u_texture;\nvarying mediump vec2 v_tileTextureCoord;\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\nvec4 mixColors(vec4 color1, vec4 color2) {\n  float compositeAlpha \x3d color2.a + color1.a * (1.0 - color2.a);\n  vec3 compositeColor \x3d color2.rgb + color1.rgb * (1.0 - color2.a);\n  return vec4(compositeColor, compositeAlpha);\n}\nvoid main()\n{\n#ifdef PATTERN\n  mediump vec2 normalizedTextureCoord \x3d fract(v_tileTextureCoord);\n  mediump vec2 samplePos \x3d mix(u_pattern_tl, u_pattern_br, normalizedTextureCoord);\n  lowp vec4 color \x3d texture2D(u_texture, samplePos);\n  gl_FragColor \x3d v_color[3] * color;\n#else\n  gl_FragColor \x3d v_color;\n#endif\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"fill.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform mediump float u_depth;\nuniform mediump vec2 u_fillTranslation;\n#ifdef PATTERN\nuniform mediump mat3 u_pattern_matrix;\nvarying mediump vec2 v_tileTextureCoord;\n#endif\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\n#ifdef DD\nattribute vec4 a_color;\n#endif\nuniform lowp vec4 u_color;\nvarying lowp vec4 v_color;\nvoid main()\n{\n#ifdef DD\n  v_color \x3d a_color * u_color;\n#else\n  v_color \x3d u_color;\n#endif\n#ifdef ID\n  v_id \x3d u_id / 255.0;\n#endif\n#ifdef PATTERN\n  v_tileTextureCoord \x3d (u_pattern_matrix * vec3(a_pos, 1.0)).xy;\n#endif\n  vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + u_displayMat3 * vec3(u_fillTranslation, 0.0);\n  gl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n}"},
icon:{"icon.frag":"precision mediump float;\nuniform lowp sampler2D u_texture;\n#ifdef SDF\nuniform lowp vec4 u_color;\nuniform lowp vec4 u_outlineColor;\nuniform mediump float u_outlineSize;\n#endif\nvarying mediump vec2 v_tex;\nvarying lowp float v_transparency;\nvarying mediump vec2 v_size;\nvarying lowp vec4 v_color;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\n#include \x3cutil/encoding.glsl\x3e\nvec4 mixColors(vec4 color1, vec4 color2) {\n  float compositeAlpha \x3d color2.a + color1.a * (1.0 - color2.a);\n  vec3 compositeColor \x3d color2.rgb + color1.rgb * (1.0 - color2.a);\n  return vec4(compositeColor, compositeAlpha);\n}\nvoid main()\n{\n#ifdef SDF\n  lowp vec4 fillPixelColor \x3d v_color;\n  float d \x3d rgba2float(texture2D(u_texture, v_tex)) - 0.5;\n  const float sofetEdgeRatio \x3d 0.248062016;\n  float size \x3d max(v_size.x, v_size.y);\n  float dist \x3d d * sofetEdgeRatio * size;\n  fillPixelColor *\x3d clamp(0.5 - dist, 0.0, 1.0);\n  if (u_outlineSize \x3e 0.25) {\n    lowp vec4 outlinePixelColor \x3d u_outlineColor;\n    const float outlineLimitRatio \x3d (16.0 / 86.0);\n    float clampedOutlineSize \x3d sofetEdgeRatio * min(u_outlineSize, outlineLimitRatio * max(v_size.x, v_size.y));\n    outlinePixelColor *\x3d clamp(0.5 - (abs(dist) - clampedOutlineSize), 0.0, 1.0);\n    gl_FragColor \x3d v_transparency * mixColors(fillPixelColor, outlinePixelColor);\n  }\n  else {\n    gl_FragColor \x3d v_transparency * fillPixelColor;\n  }\n#else\n  lowp vec4 texColor \x3d texture2D(u_texture, v_tex);\n  gl_FragColor \x3d v_transparency * texColor;\n#endif\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"icon.vert":"attribute vec2 a_pos;\nattribute vec2 a_vertexOffset;\nattribute vec4 a_tex;\nattribute vec4 a_levelInfo;\n#ifdef DD\nattribute vec4 a_color;\nattribute mediump float a_size;\n#endif\nuniform lowp vec4 u_color;\nuniform mediump float u_size;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform mediump vec2 u_iconTranslation;\nuniform vec2 u_mosaicSize;\nuniform mediump float u_depth;\nuniform mediump float u_mapRotation;\nuniform mediump float u_level;\nuniform lowp float u_keepUpright;\nuniform mediump float u_fadeSpeed;\nuniform mediump float u_minfadeLevel;\nuniform mediump float u_maxfadeLevel;\nuniform mediump float u_fadeChange;\nuniform mediump float u_opacity;\nvarying mediump vec2 v_tex;\nvarying lowp float v_transparency;\nvarying mediump vec2 v_size;\nconst float C_OFFSET_PRECISION \x3d 1.0 / 8.0;\nconst float C_256_TO_RAD \x3d 3.14159265359 / 128.0;\nconst float C_DEG_TO_RAD \x3d 3.14159265359 / 180.0;\nconst float tileCoordRatio \x3d 1.0 / 8.0;\nvoid main()\n{\n  mediump float a_labelMinLevel \x3d a_levelInfo[0];\n  mediump float a_angle         \x3d a_levelInfo[1];\n  mediump float a_minLevel      \x3d a_levelInfo[2];\n  mediump float a_maxLevel      \x3d a_levelInfo[3];\n  mediump float delta_z \x3d 0.0;\n  mediump float rotated \x3d mod(a_angle + u_mapRotation, 256.0);\n  delta_z +\x3d (1.0 - step(u_keepUpright, 0.0)) * step(64.0, rotated) * (1.0 - step(192.0, rotated));\n  delta_z +\x3d 1.0 - step(a_minLevel, u_level);\n  delta_z +\x3d step(a_maxLevel, u_level);\n  mediump float alpha \x3d u_fadeSpeed !\x3d 0.0 ? clamp((u_fadeChange - a_labelMinLevel) / u_fadeSpeed, 0.0, 1.0) : 1.0;\n  v_transparency \x3d (u_fadeSpeed \x3e\x3d 0.0 ? alpha : 1.0 - alpha);\n  if (u_maxfadeLevel \x3c a_labelMinLevel)\n  {\n    v_transparency \x3d 0.0;\n  }\n  if (u_minfadeLevel \x3e\x3d a_labelMinLevel)\n  {\n    v_transparency \x3d 1.0;\n  }\n  delta_z +\x3d step(v_transparency, 0.0);\n  vec2 offset \x3d C_OFFSET_PRECISION * a_vertexOffset;\n  v_size \x3d abs(offset);\n#ifdef SDF\n  offset \x3d (120.0 / 86.0) * offset;\n#endif\n#ifdef DD\n  mediump float icon_size \x3d a_size * u_size;\n#else\n  mediump float icon_size \x3d u_size;\n#endif\n  mediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + u_displayViewMat3 * vec3(icon_size * offset, 0.0) + u_displayMat3 * vec3(u_iconTranslation, 0.0);\n  gl_Position \x3d vec4(pos.xy, u_depth + delta_z, 1.0);\n#ifdef DD\n  v_color \x3d a_color * u_color;\n#else\n  v_color \x3d u_color;\n#endif\n#ifdef ID\n  v_id \x3d u_id / 255.0;\n#endif\n  v_tex \x3d a_tex.xy / u_mosaicSize;\n  v_transparency *\x3d v_color.w;\n}"},
line:{"line.frag":"varying mediump vec2 v_normal;\nvarying highp float v_accumulatedDistance;\nvarying mediump float v_lineHalfWidth;\nvarying lowp vec4 v_color;\nvarying mediump float v_blur;\n#ifdef PATTERN\nuniform mediump vec2 u_pattern_tl;\nuniform mediump vec2 u_pattern_br;\nuniform mediump vec2 u_spriteSize;\nuniform sampler2D u_texture;\nconst mediump float tileCoordRatio \x3d 8.0;\n#else\nvarying mediump vec2 v_dasharray;\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\n  mediump float fragDist \x3d length(v_normal) * v_lineHalfWidth;\n  lowp float alpha \x3d clamp((v_lineHalfWidth - fragDist) / v_blur, 0.0, 1.0);\n#ifdef PATTERN\n  mediump float relativeTexX \x3d mod((v_accumulatedDistance + v_normal.x * v_lineHalfWidth * tileCoordRatio) / u_spriteSize.x, 1.0);\n  mediump float relativeTexY \x3d 0.5 + (v_normal.y * v_lineHalfWidth / u_spriteSize.y);\n  mediump vec2 texCoord \x3d mix(u_pattern_tl, u_pattern_br, vec2(relativeTexX, relativeTexY));\n  lowp vec4 color \x3d texture2D(u_texture, texCoord);\n  gl_FragColor \x3d alpha * v_color[3] * color;\n#else\n  lowp float dashPos \x3d  mod(v_accumulatedDistance, v_dasharray.x + v_dasharray.y);\n  lowp float dashAlpha \x3d clamp(min(dashPos, v_dasharray.x - dashPos) + 0.5, 0.0, 1.0);\n  dashAlpha \x3d max(sign(-v_dasharray.y), dashAlpha);\n  alpha *\x3d dashAlpha;\n  gl_FragColor \x3d alpha * v_color;\n#endif\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"line.vert":"attribute vec2 a_pos;\nattribute vec4 a_offsetAndNormal;\nattribute vec2 a_accumulatedDistance;\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform mediump vec2 u_lineTranslation;\nuniform mediump float u_blur;\nuniform mediump float u_antialiasing;\nuniform mediump float u_depth;\nvarying mediump vec2 v_normal;\nvarying highp float v_accumulatedDistance;\nconst float scale \x3d 1.0 / 31.0;\n#ifdef DD\nattribute vec4 a_color;\nattribute mediump float a_width;\n#endif\nuniform lowp vec4 u_color;\nuniform mediump float u_width;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\nvarying mediump float v_lineHalfWidth;\nvarying mediump float v_blur;\n#ifndef PATTERN\nuniform mediump vec2 u_dasharray;\nvarying mediump vec2 v_dasharray;\n#endif\nvoid main()\n{\n  v_normal \x3d a_offsetAndNormal.zw * scale;\n#ifdef DD\n  v_lineHalfWidth \x3d a_width * u_width;\n#else\n  v_lineHalfWidth \x3d u_width;\n#endif\n  v_lineHalfWidth +\x3d u_antialiasing;\n  v_lineHalfWidth *\x3d 0.5;\n#ifndef PATTERN\n#ifdef DD\n  v_dasharray \x3d u_dasharray * a_width;\n#else\n  v_dasharray \x3d u_dasharray * u_width;\n#endif\n#endif\n  mediump vec2 dist \x3d v_lineHalfWidth * scale * a_offsetAndNormal.xy;\n  mediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) +  u_displayViewMat3 * vec3(dist, 0.0) + u_displayMat3 * vec3(u_lineTranslation, 0.0);\n  gl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n  v_accumulatedDistance \x3d a_accumulatedDistance.x;\n  v_blur \x3d u_blur + u_antialiasing;\n  #ifdef DD\n    v_color \x3d a_color * u_color;\n  #else\n    v_color \x3d u_color;\n  #endif\n  #ifdef ID\n    v_id \x3d u_id / 255.0;\n  #endif\n}"},
outline:{"outline.frag":"varying lowp vec4 v_color;\nvarying mediump vec2 v_normal;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\n  lowp float dist \x3d abs(v_normal.y);\n  lowp float alpha \x3d smoothstep(1.0, 0.0, dist);\n  gl_FragColor \x3d alpha * v_color;\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}","outline.vert":"attribute vec2 a_pos;\nattribute vec2 a_offset;\nattribute vec2 a_xnormal;\n#ifdef DD\nattribute vec4 a_color;\n#endif\nuniform lowp vec4 u_color;\nvarying lowp vec4 v_color;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform mediump vec2 u_fillTranslation;\nuniform mediump float u_depth;\nuniform mediump float u_outline_width;\nvarying lowp vec2 v_normal;\nconst float scale \x3d 1.0 / 15.0;\nvoid main()\n{\n#ifdef DD\n  v_color \x3d a_color * u_color;\n#else\n  v_color \x3d u_color;\n#endif\n#ifdef ID\n  v_id \x3d u_id / 255.0;\n#endif\n  v_normal \x3d a_xnormal;\n  mediump vec2 dist \x3d u_outline_width * scale * a_offset;\n  mediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + u_displayMat3 * vec3(dist + u_fillTranslation, 0.0);\n  gl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n}"},
text:{"text.frag":"uniform lowp sampler2D u_texture;\nuniform mediump float u_edgeDistance;\nvarying lowp vec2 v_tex;\nvarying lowp float v_transparency;\nvarying lowp vec4 v_color;\nvarying mediump float v_edgeWidth;\nvarying mediump float v_edgeDistance;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\n  lowp float dist \x3d texture2D(u_texture, v_tex).a;\n  mediump float alpha \x3d smoothstep(v_edgeDistance - v_edgeWidth, v_edgeDistance + v_edgeWidth, dist) * v_transparency;\n  gl_FragColor \x3d alpha * v_color;\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"text.vert":"attribute vec2 a_pos;\nattribute vec2 a_vertexOffset;\nattribute vec4 a_tex;\nattribute vec4 a_levelInfo;\nuniform lowp vec4 u_color;\n#ifdef DD\nattribute vec4 a_color;\n#endif\nvarying lowp vec4 v_color;\nuniform mediump float u_size;\n#ifdef DD\nattribute mediump float a_size;\n#endif\nvarying mediump float v_size;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform mediump vec2 u_textTranslation;\nuniform vec2 u_mosaicSize;\nuniform mediump float u_depth;\nuniform mediump float u_mapRotation;\nuniform mediump float u_level;\nuniform lowp float u_keepUpright;\nuniform mediump float u_fadeSpeed;\nuniform mediump float u_minfadeLevel;\nuniform mediump float u_maxfadeLevel;\nuniform mediump float u_fadeChange;\nuniform mediump float u_opacity;\nvarying lowp vec2 v_tex;\nvarying lowp float v_transparency;\nconst float offsetPrecision \x3d 1.0 / 8.0;\nconst mediump float edgePos \x3d 0.75;\nuniform mediump float u_edgeDistance;\nuniform mediump float u_edgeBlur;\nuniform mediump float u_antialiasingWidth;\nvarying mediump float v_edgeDistance;\nvarying mediump float v_edgeWidth;\nuniform lowp float u_halo;\nconst float sdfFontScale \x3d 1.0 / 24.0;\nvoid main()\n{\n  mediump float a_labelMinLevel \x3d a_levelInfo[0];\n  mediump float a_angle        \x3d a_levelInfo[1];\n  mediump float a_minLevel    \x3d a_levelInfo[2];\n  mediump float a_maxLevel    \x3d a_levelInfo[3];\n  mediump float delta_z \x3d 0.0;\n  mediump float rotated \x3d mod(a_angle + u_mapRotation, 256.0);\n  delta_z +\x3d (1.0 - step(u_keepUpright, 0.0)) * step(64.0, rotated) * (1.0 - step(192.0, rotated));\n  delta_z +\x3d 1.0 - step(a_minLevel, u_level);\n  delta_z +\x3d step(a_maxLevel, u_level);\n  mediump float alpha \x3d u_fadeSpeed !\x3d 0.0 ? clamp((u_fadeChange - a_labelMinLevel) / u_fadeSpeed, 0.0, 1.0) : 1.0;\n  v_transparency \x3d (u_fadeSpeed \x3e\x3d 0.0 ? alpha : 1.0 - alpha);\n  if (u_maxfadeLevel \x3c a_labelMinLevel)\n  {\n    v_transparency \x3d 0.0;\n  }\n  if (u_minfadeLevel \x3e\x3d a_labelMinLevel)\n  {\n    v_transparency \x3d 1.0;\n  }\n  delta_z +\x3d step(v_transparency, 0.0);\n  v_tex \x3d a_tex.xy / u_mosaicSize;\n#ifdef DD\n  if (u_halo \x3e 0.5)\n  {\n    v_color \x3d u_color;\n  }\n  else\n  {\n    v_color \x3d a_color * u_color;\n  }\n#else\n  v_color \x3d u_color;\n#endif\n#ifdef DD\n  v_size \x3d a_size * u_size;\n#else\n  v_size \x3d u_size;\n#endif\n#ifdef ID\n  v_id \x3d u_id / 255.0;\n#endif\n  v_edgeDistance \x3d edgePos - u_edgeDistance / v_size;\n  v_edgeWidth \x3d (u_antialiasingWidth + u_edgeBlur) / v_size;\n  mediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + sdfFontScale * u_displayViewMat3 * vec3(offsetPrecision * v_size * a_vertexOffset, 0.0) + u_displayMat3 * vec3(u_textTranslation, 0.0);\n  gl_Position \x3d vec4(pos.xy, u_depth + delta_z, 1.0);\n}"},
util:{"encoding.glsl":"const vec4 rgba2float_factors \x3d vec4(\n    255.0 / (256.0),\n    255.0 / (256.0 * 256.0),\n    255.0 / (256.0 * 256.0 * 256.0),\n    255.0 / (256.0 * 256.0 * 256.0 * 256.0)\n  );\nfloat rgba2float(vec4 rgba) {\n  return dot(rgba, rgba2float_factors);\n}"}}})},"esri/views/2d/engine/webgl/MaterialManager":function(){define("require exports ../../../../core/tsSupport/assignHelper ../../../../core/maybe ../../../webgl ./enums ./shaders/MaterialPrograms".split(" "),function(e,
a,c,h,b,g,m){var f=function(a){return a===g.WGLDrawPhase.HITTEST||a===g.WGLDrawPhase.LABEL_ALPHA},d=function(a,b,d,e){e=e.reduce(function(b,d){var f;return c({},b,(f={},f[d]=a.driverTestResult[d],f))},{});b=c({},b.getVariation(),a.rendererInfo.getVariation(),{highlight:a.drawPhase===g.WGLDrawPhase.HIGHLIGHT,id:f(a.drawPhase)},e);if(h.isSome(d))for(e=0;e<d.length;e++)b[d[e]]=!0;return b};return function(){function a(a){this._programByKey=new Map;this._programCache=new b.ProgramCache(a)}a.prototype.dispose=
function(){this._programCache&&this._programCache.dispose()};a.prototype.getProgram=function(a,b,d,f){void 0===d&&(d=[]);void 0===f&&(f=[]);var l=b.path+d.join(".")+f.join(".");if(this._programByKey.has(l))return this._programByKey.get(l);f=f.reduce(function(b,d){var f;return c({},b,(f={},f[d]=a.driverTestResult[d],f))},{});d=c({},d.reduce(function(a,b){var d;return c({},a,(d={},d[b]=!0,d))},{}),f);b=this._programCache.getProgram(m.createProgramTemplate(b.path,b.attributes),d);if(!b)throw Error("Unable to get program for key: ${key}");
this._programByKey.set(l,b);return b};a.prototype.getMaterialProgram=function(a,b,c,l,u,q){void 0===q&&(q=["ignoresSamplerPrecision"]);var n,p=q;n=a.rendererInfo;var y=a.drawPhase,p=b.getVariationHash()+"-"+p.join(".")+"-",y=(f(y)?1:0)|(y===g.WGLDrawPhase.HIGHLIGHT?2:0);n=p+y+"-"+n.getVariationHash()+"-"+(h.isSome(u)&&u.join("."));if(this._programByKey.has(n))return this._programByKey.get(n);a=d(a,b,u,q);c=this._programCache.getProgram(m.createProgramTemplate(c,l),a);if(!c)throw Error("Unable to get program for key: ${key}");
this._programByKey.set(n,c);return c};return a}()})},"esri/views/2d/engine/webgl/shaders/MaterialPrograms":function(){define(["require","exports","../../../../webgl","./sources/resolver"],function(e,a,c,h){Object.defineProperty(a,"__esModule",{value:!0});var b=function(a){var b={},f;for(f in a){for(var d=f,l=void 0,l=""+d[0].toUpperCase(),g=1;g<d.length;g++){var h=d[g];h===h.toUpperCase()?(l+="_",l+=h):l+=h.toUpperCase()}b[l]=a[f]}return c.glslifyDefineMap(b)};a.createProgramTemplate=function(a,c){var f=
a+a.substring(a.lastIndexOf("/"));return{name:name,attributes:c,shaders:function(a){return{vertexShader:b(a)+h.resolveIncludes(f+".vert"),fragmentShader:b(a)+h.resolveIncludes(f+".frag")}}}}})},"esri/views/2d/engine/webgl/TextureManager":function(){define("require exports ../../../../core/tsSupport/assignHelper ../../../../core/tsSupport/awaiterHelper ../../../../core/tsSupport/generatorHelper ../../../../config ../../../../request ../../../../core/Error ../../../../core/Logger ../../../../core/promiseUtils ../../../../core/libs/gl-matrix-2/vec2 ../../../../core/libs/gl-matrix-2/vec2f32 ../../../../symbols/cim/Rasterizer ./definitions ./enums ./fontUtils ./GlyphMosaic ./GlyphSource ./SDFConverter ./SpriteMosaic ./util/Result ./util/symbolUtils".split(" "),
function(e,a,c,h,b,g,m,f,d,l,z,v,A,x,u,q,n,p,y,k,C,w){var B=v.vec2f32.create(),E=d.getLogger("esri.views.2d.engine.webgl.TextureManager"),G=function(){function a(a,b,d){this.mosaicType=a;this.page=b;this.sdf=d}a.fromMosaic=function(b,d){return new a(b,d.page,d.sdf)};return a}();return function(){function a(){this._invalidFontsMap=new Map;this._sdfConverter=new y.default(126);this._bindingInfos=[];this._hashToBindingIndex=new Map;this._rasterizer=new A.default;this._spriteMosaic=new k(2048,2048,500);
this._glyphSource=new p(g.fontsUrl+"/{fontstack}/{range}.pbf");this._glyphMosaic=new n(1024,1024,this._glyphSource)}Object.defineProperty(a.prototype,"sprites",{get:function(){return this._spriteMosaic},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"glyphs",{get:function(){return this._glyphMosaic},enumerable:!0,configurable:!0});a.prototype.dispose=function(){this._spriteMosaic.dispose();this._glyphMosaic.dispose();this._rasterizer.dispose();this._rasterizer=this._glyphMosaic=
this._spriteMosaic=null};a.prototype._hashMosaic=function(a,b){return 1|a<<1|(b.sdf?1:0)<<2|b.page<<3};a.prototype._setTextureBinding=function(a,b){var d=this._hashMosaic(a,b);this._hashToBindingIndex.has(d)||(a=G.fromMosaic(a,b),this._hashToBindingIndex.set(d,this._bindingInfos.length+1),this._bindingInfos.push(a));b.textureBinding=this._hashToBindingIndex.get(d)};a.prototype.rasterizeItem=function(a,b,d){var c=this;void 0===b&&(b=null);return a?a.type&&-1!==a.type.toLowerCase().indexOf("3d")?(E.error(new f("mapview-invalid-type",
"MapView does not support 3d symbol type: "+a.type,a)),l.resolve({glyphMosaicItems:[],spriteMosaicItem:null})):!a.type||"text"!==a.type&&"esriTS"!==a.type&&"CIMTextSymbol"!==a.type?this._rasterizeSpriteSymbol(a,d).then(function(a){C.ok(a)&&a&&c._setTextureBinding(u.MosaicType.SPRITE,a);return{spriteMosaicItem:a}}):this._rasterizeTextSymbol(a,b,d).then(function(a){a.forEach(function(a){return c._setTextureBinding(u.MosaicType.GLYPH,a)});return{glyphMosaicItems:a}}):(E.error(new f("mapview-null-resource",
"Unable to rasterize null resource")),l.resolve(null))};a.prototype.bindTextures=function(a,b,d,f){void 0===f&&(f=1);if(0!==d.textureBinding){var c=this._bindingInfos[d.textureBinding-1];d=c.page;switch(c.mosaicType){case u.MosaicType.SPRITE:c=this.sprites.getWidth(d)/f;f=this.sprites.getHeight(d)/f;f=z.vec2.set(B,c,f);this._bindSpritePage(a,d,x.TEXTURE_BINDING_SPRITE_ATLAS,9729);b.setUniform1i("u_texture",x.TEXTURE_BINDING_SPRITE_ATLAS);b.setUniform2fv("u_mosaicSize",f);break;case u.MosaicType.GLYPH:c=
this.glyphs.width/f;f=this.glyphs.height/f;f=z.vec2.set(B,c,f);this._bindGlyphsPage(a,d,x.TEXTURE_BINDING_GLYPH_ATLAS);b.setUniform1i("u_texture",x.TEXTURE_BINDING_GLYPH_ATLAS);b.setUniform2fv("u_mosaicSize",f);break;default:E.error("mapview-texture-manager","Cannot handle unknown type "+c.mosaicType)}}};a.prototype._bindSpritePage=function(a,b,d,f){f||(f=9729);this._spriteMosaic.bind(a,f,b,d)};a.prototype._bindGlyphsPage=function(a,b,d){this._glyphMosaic.bind(a,9729,b,d)};a.prototype._rasterizeTextSymbol=
function(a,b,d){var c=this,k=q.getFullyQualifiedFontName(a.font);a=this._invalidFontsMap.has(k);return this._glyphMosaic.getGlyphItems(a?"arial-unicode-ms-regular":k,b,d).catch(function(){E.error(new f("mapview-invalid-resource","Couldn't find font "+k+". Falling back to Arial Unicode MS Regular"));c._invalidFontsMap.set(k,!0);return c._glyphMosaic.getGlyphItems("arial-unicode-ms-regular",b,d)})};a.prototype._rasterizeSpriteSymbol=function(a,d){return h(this,void 0,void 0,function(){var c,k,l,g,n,
p;return b(this,function(b){b="CIMSolidStroke"===a.type||"CIMSolidFill"===a.type?!0:a&&(w.isFillSymbol(a)||w.isLineSymbol(a))&&"style"in a&&("solid"===a.style||"esriSFSSolid"===a.style||"esriSLSSolid"===a.style||"none"===a.style||"esriSFSNull"===a.style||"esriSLSNull"===a.style);if(b)return[2,null];c=w.keyFromSymbol(a);return this._spriteMosaic.has(c)?[2,this._spriteMosaic.getSpriteItem(c)]:"simple-marker"!==a.type&&"esriSMS"!==a.type||!a.path?a.url||a.imageData?[2,this._handleImage(a,c,d)]:(k=this._rasterizer.rasterizeJSONResource(a))?
(l=k.size,g=k.image,n=k.sdf,p=k.simplePattern,[2,this._addItemToMosaic(c,l,g,!w.isMarkerSymbol(a),n,p)]):[2,new f("TextureManager","unrecognized or null rasterized image")]:[2,this._handleSVG(a,c,d)]})})};a.prototype._handleSVG=function(a,d,f){return h(this,void 0,void 0,function(){var c,k;return b(this,function(b){switch(b.label){case 0:return c=[126,126],[4,this._sdfConverter.draw(a.path,f)];case 1:return k=b.sent(),[2,this._addItemToMosaic(d,c,new Uint32Array(k.buffer),!1,!0,!0)]}})})};a.prototype._handleImage=
function(a,d,k){return h(this,void 0,void 0,function(){var g,n,p,q,y,h,u;return b(this,function(b){switch(b.label){case 0:g=a.imageData?"data:"+a.contentType+";base64,"+a.imageData:a.url,b.label=1;case 1:return b.trys.push([1,3,,4]),[4,m(g,c({responseType:"image"},k))];case 2:return n=b.sent().data,p=this._rasterizer.rasterizeImageResource(n,a.colorSubstitutions),q=p.size,y=p.sdf,h=p.image,[2,this._addItemToMosaic(d,q,h,!w.isMarkerSymbol(a),y,!1)];case 3:return u=b.sent(),l.isAbortError(u)?[3,4]:
[2,new f("mapview-invalid-resource","Could not fetch requested resource at "+g)];case 4:return[2,void 0]}})})};a.prototype._addItemToMosaic=function(a,b,d,f,c,k){return this._spriteMosaic.addSpriteItem(a,b,d,f,c,k)};return a}()})},"esri/symbols/cim/Rasterizer":function(){define(["require","exports","./CIMSymbolHelper","./SDFHelper","./utils"],function(e,a,c,h,b){Object.defineProperty(a,"__esModule",{value:!0});e=function(){function a(){}a.prototype.dispose=function(){this._rasterizationCanvas=null};
a.prototype.rasterizeJSONResource=function(a,b){this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));if("simple-fill"===a.type||"esriSFS"===a.type)return b=c.SymbolHelper.rasterizeSimpleFill(this._rasterizationCanvas,a.style),{size:[b[1],b[2]],image:new Uint32Array(b[0].buffer),sdf:!1,simplePattern:!0,anchorX:0,anchorY:0};if("simple-line"===a.type||"esriSLS"===a.type)return b=c.SymbolHelper.rasterizeSimpleLine(a.style,a.cap),{size:[b[1],b[2]],image:new Uint32Array(b[0].buffer),
sdf:!0,simplePattern:!0,anchorX:0,anchorY:0};var d;a="simple-marker"===a.type||"esriSMS"===a.type?c.CIMSymbolHelper.fromSimpleMarker(a):a;if((d=h.getSDFInfo(a))&&!b)return b=h.buildSDF(d),(a=b[0])?{size:[b[1],b[2]],image:new Uint32Array(a.buffer),sdf:!0,simplePattern:!0,anchorX:0,anchorY:0}:null;b=c.CIMSymbolHelper.rasterize(this._rasterizationCanvas,a,!b);a=b[0];d=b[3];var f=b[4];return a?{size:[b[1],b[2]],image:new Uint32Array(a.buffer),sdf:!1,simplePattern:!1,anchorX:d,anchorY:f}:null};a.prototype.rasterizeImageResource=
function(a,f){this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));this._rasterizationCanvas.width=a.width;this._rasterizationCanvas.height=a.height;var d=this._rasterizationCanvas.getContext("2d");d.drawImage(a,0,0,a.width,a.height);d=d.getImageData(0,0,a.width,a.height);d=new Uint8Array(d.data);if(f)for(var c=0;c<f.length;c++){var g=f[c];if(g&&g.oldColor&&4===g.oldColor.length&&g.newColor&&4===g.newColor.length){var h=g.oldColor,e=h[0],x=h[1],u=h[2],h=h[3],q=g.newColor,
g=q[0],n=q[1],p=q[2],y=q[3];if(e!==g||x!==n||u!==p||h!==y)for(q=0;q<d.length;q+=4)e===d[q]&&x===d[q+1]&&u===d[q+2]&&h===d[q+3]&&(d[q]=g,d[q+1]=n,d[q+2]=p,d[q+3]=y)}}for(q=0;q<d.length;q+=4)f=d[q+3]/255,d[q]*=f,d[q+1]*=f,d[q+2]*=f;f=a.width;c=a.height;e=d;if(512<=f||512<=c)e=a.width/a.height,1<e?(f=512,c=Math.round(512/e)):(c=512,f=Math.round(512*e)),e=new Uint8Array(4*f*c),b.resampleHermite(d,a.width,a.height,new Uint8ClampedArray(e.buffer),f,c,!1);return{size:[f,c],image:new Uint32Array(e.buffer),
sdf:!1,simplePattern:!1,anchorX:0,anchorY:0}};return a}();a.default=e})},"esri/symbols/cim/CIMSymbolHelper":function(){define("require exports ../../Color ../../core/Logger ../../geometry/support/jsonUtils ../cim/CIMCursor ../cim/CIMEffects ../cim/CIMOperators ../cim/CIMPlacements ./CIMSymbolDrawHelper ./packingUtils".split(" "),function(e,a,c,h,b,g,m,f,d,l,z){function v(a,b){switch(b.type){case "CIMSymbolReference":var c={type:"point",x:0,y:0};a.drawSymbol(b.symbol,c);break;case "CIMPointSymbol":c=
{type:"point",x:0,y:0};a.drawSymbol(b,c);break;case "CIMVectorMarker":c=new d.Placement,a.drawMarker(b,c)}return a.envelope()}Object.defineProperty(a,"__esModule",{value:!0});var A=Math.PI,x=A/2,u=h.getLogger("esri.symbols.cim.CIMSymbolHelper");e=function(){function a(){}a.getEnvelope=function(a){var b=new l.EnvDrawHelper;if(Array.isArray(a)){for(var d=void 0,c=0;c<a.length;c++){var f=a[c];d?d.union(v(b,f)):d=v(b,f)}return d}return v(b,a)};a.getTextureAnchor=function(a){a=this.getEnvelope(a);if(!a||
0>=a.width||0>=a.height)return[0,0];var b=96/72;return[(a.x+.5*a.width)*b/(a.width*b+2),-(a.y+.5*a.height)*b/(a.height*b+2)]};a.rasterize=function(a,b,c){void 0===c&&(c=!0);var f=this.getEnvelope(b);if(!f||0>=f.width||0>=f.height)return[null,0,0,0,0];var g=96/72,n=(f.x+.5*f.width)*g,p=(f.y+.5*f.height)*g;a.width=f.width*g+2;a.height=f.height*g+2;f=a.getContext("2d");g=l.Transformation.createScale(g,-g);g.translate(.5*a.width-n,.5*a.height+p);g=new l.CanvasDrawHelper(f,g);switch(b.type){case "CIMPointSymbol":g.drawSymbol(b,
{type:"point",x:0,y:0});break;case "CIMVectorMarker":var y=new d.Placement;g.drawMarker(b,y)}b=f.getImageData(0,0,a.width,a.height);b=new Uint8Array(b.data);if(c)for(c=void 0,f=0;f<b.length;f+=4)c=b[f+3]/255,b[f]*=c,b[f+1]*=c,b[f+2]*=c;return[b,a.width,a.height,-n/a.width,-p/a.height]};a.fromSimpleMarker=function(a){var b,d,c=a.style;if("circle"===c||"esriSMSCircle"===c){b=Math.acos(.995);d=Math.ceil(A/b/4);0===d&&(d=1);b=x/d;d*=4;c=[];c.push([50,0]);for(var f=1;f<d;f++)c.push([50*Math.cos(f*b),-50*
Math.sin(f*b)]);c.push([50,0]);b={rings:[c]};d={xmin:-50,ymin:-50,xmax:50,ymax:50}}else if("cross"===c||"esriSMSCross"===c)b=0,b={rings:[[[b,50],[b,b],[50,b],[50,-b],[b,-b],[b,-50],[-b,-50],[-b,-b],[-50,-b],[-50,b],[-b,b],[-b,50],[b,50]]]},d={xmin:-50,ymin:-50,xmax:50,ymax:50};else if("diamond"===c||"esriSMSDiamond"===c)b={rings:[[[-50,0],[0,50],[50,0],[0,-50],[-50,0]]]},d={xmin:-50,ymin:-50,xmax:50,ymax:50};else if("square"===c||"esriSMSSquare"===c)b={rings:[[[-50,-50],[-50,50],[50,50],[50,-50],
[-50,-50]]]},d={xmin:-50,ymin:-50,xmax:50,ymax:50};else if("x"===c||"esriSMSX"===c)b=0,b={rings:[[[0,b],[50-b,50],[50,50-b],[b,0],[50,b-50],[50-b,-50],[0,-b],[b-50,-50],[-50,b-50],[-b,0],[-50,50-b],[b-50,50],[0,b]]]},d={xmin:-50,ymin:-50,xmax:50,ymax:50};else if("triangle"===c||"esriSMSTriangle"===c)d=2/3*100,c=d-100,b={rings:[[[-57.735026918962575,c],[0,d],[57.735026918962575,c],[-57.735026918962575,c]]]},d={xmin:-57.735026918962575,ymin:c,xmax:57.735026918962575,ymax:d};var l;b&&d&&(l=[{type:"CIMSolidFill",
enable:!0,color:a.color}],a.outline&&l.push({type:"CIMSolidStroke",enable:!0,width:a.outline.width,color:a.outline.color}),l={type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,rotation:a.angle,size:a.size,offsetX:a.xoffset,offsetY:a.yoffset,frame:d,markerGraphics:[{type:"CIMMarkerGraphic",geometry:b,symbol:{type:"CIMPolygonSymbol",symbolLayers:l}}]}]});return l};a.getFillColor=function(b){if(!b)return null;switch(b.type){case "CIMPolygonSymbol":if(b.symbolLayers){var d=0;for(b=
b.symbolLayers;d<b.length;d++){var c=a.getFillColor(b[d]);if(null!=c)return c}}break;case "CIMTextSymbol":return a.getFillColor(b.symbol);case "CIMSolidFill":return b.color}};a.getStrokeColor=function(b){if(b)switch(b.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(b.symbolLayers){var d=0;for(b=b.symbolLayers;d<b.length;d++){var c=a.getStrokeColor(b[d]);if(void 0!==c)return c}}break;case "CIMTextSymbol":return a.getStrokeColor(b.symbol);case "CIMSolidStroke":return b.color}};a.getStrokeWidth=
function(b){if(b)switch(b.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(b.symbolLayers){var d=0;for(b=b.symbolLayers;d<b.length;d++){var c=a.getStrokeWidth(b[d]);if(void 0!==c)return c}}break;case "CIMTextSymbol":return a.getStrokeWidth(b.symbol);case "CIMSolidStroke":case "CIMGradientStroke":case "CIMPictureStroke":return b.width}};a.getSize=function(b){if(b)switch(b.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":var d=0;if(b.symbolLayers){var c=0;for(b=b.symbolLayers;c<
b.length;c++){var f=a.getSize(b[c]);f>d&&(d=f)}}return d;case "CIMSolidStroke":case "CIMPictureStroke":case "CIMGradientStroke":return b.width;case "CIMCharacterMarker":case "CIMPictureMarker":case "CIMVectorMarker":return b.size}};a.getMarkerScaleRatio=function(a){if(a)switch(a.type){case "CIMVectorMarker":if(!1!==a.scaleSymbolsProportionally&&a.frame)return a.size/(a.frame.ymax-a.frame.ymin)}return 1};a.executeEffects=function(a,b,d){void 0===d&&(d=!1);var c=96/72,l=a?a.length:0;l&&d&&--l;for(d=
0;d<l;++d){var g=a[d];if(g){var n=f.getEffectOperator(g);n&&(b=n.execute(b,g,c))}}return b};a.processEffects=function(d,c,f){var k;d.effects&&0<d.effects.length&&(k=g.deltaEncodeGeometry(f),k=new m.SimpleGeometryCursor(k),k=a.executeEffects(d.effects,k));d=d.symbolLayers[c];d.effects&&0<d.effects.length&&(c=!1,"CIMGeometricEffectDashes"===d.effects[d.effects.length-1].type&&(c=!0),k||(k=g.deltaEncodeGeometry(f),k=new m.SimpleGeometryCursor(k)),k=a.executeEffects(d.effects,k,c));if(!k)return f;f=[];
for(d=k.next();d;)f.push(d),d=k.next();k=f.length;switch(k){case 0:return null;case 1:return g.deltaEncodeGeometry(f[0]);default:d=f[0];for(c=1;c<k;++c){var l=f[c];b.isPolygon(d)&&b.isPolygon(l)&&Array.prototype.push.apply(d.rings,l.rings);b.isPolyline(d)&&b.isPolyline(l)&&Array.prototype.push.apply(d.paths,l.paths)}return g.deltaEncodeGeometry(d)}};return a}();a.CIMSymbolHelper=e;e=function(){function a(){}a.rasterizeSimpleFill=function(a,b){"solid"!==b&&"none"!==b&&"esriSFSSolid"!==b&&"esriSFSNull"!==
b||console.error("Unexpected: style does not require rasterization");a.width=8;a.height=8;var d=a.getContext("2d");d.strokeStyle="#FFFFFF";d.lineWidth=1;d.beginPath();if("vertical"===b||"cross"===b||"esriSFSCross"===b||"esriSFSVertical"===b)d.moveTo(0,0),d.lineTo(0,8);if("horizontal"===b||"cross"===b||"esriSFSCross"===b||"esriSFSHorizontal"===b)d.moveTo(0,0),d.lineTo(8,0);if("forward-diagonal"===b||"diagonal-cross"===b||"esriSFSDiagonalCross"===b||"esriSFSForwardDiagonal"===b)d.moveTo(0,0),d.lineTo(8,
8);if("backward-diagonal"===b||"diagonal-cross"===b||"esriSFSBackwardDiagonal"===b||"esriSFSDiagonalCross"===b)d.moveTo(8,0),d.lineTo(0,8);d.stroke();b=d.getImageData(0,0,a.width,a.height);b=new Uint8Array(b.data);for(var c=0;c<b.length;c+=4)d=b[c+3]/255,b[c]*=d,b[c+1]*=d,b[c+2]*=d;return[b,a.width,a.height]};a.rasterizeSimpleLine=function(a,b){switch(b){case "butt":b="Butt";break;case "square":b="Square";break;default:b="Round"}var d="Butt"===b;switch(a){case "dash":case "esriSLSDash":a=d?[4,3]:
[3,4];break;case "dash-dot":case "esriSLSDashDot":a=d?[4,3,1,3]:[3,4,0,4];break;case "dot":case "esriSLSDot":a=d?[1,3]:[0,4];break;case "long-dash":case "esriSLSLongDash":a=d?[8,3]:[7,4];break;case "long-dash-dot":case "esriSLSLongDashDot":a=d?[8,3,1,3]:[7,4,0,4];break;case "long-dash-dot-dot":case "esriSLSDashDotDot":a=d?[8,3,1,3,1,3]:[7,4,0,4,0,4];break;case "short-dash":case "esriSLSShortDash":a=d?[4,1]:[3,2];break;case "short-dash-dot":case "esriSLSShortDashDot":a=d?[4,1,1,1]:[3,2,0,2];break;
case "short-dash-dot-dot":case "esriSLSShortDashDotDot":a=d?[4,1,1,1,1,1]:[3,2,0,2,0,2];break;case "short-dot":case "esriSLSShortDot":a=d?[1,1]:[0,2];break;case "solid":case "esriSLSSolid":case "none":u.error("Unexpected: style does not require rasterization");a=[0,0];break;default:u.error("Tried to rasterize SLS, but found an unexpected style: "+a+"!"),a=[0,0]}return this.rasterizeDash(a,b)};a.rasterizeDash=function(a,b){var d="Butt"===b,c="Square"===b;b=!d&&!c;for(var f=0,l=0;l<a.length;l++)var g=
a[l],f=f+g;for(var f=15*f,h=31*f,l=new Float32Array(h),q=b?225:15,g=0;g<h;++g)l[g]=q;for(var q=h=0,n=!0,u=0;u<a.length;u++){for(var g=a[u],h=q,q=q+15*g,e=h;e<q;){for(var x=0;31>x;){var g=x*f+e,p=b?(x-15)*(x-15):Math.abs(x-15);l[g]=n?d?Math.max(Math.max(h+7.5-e,p),Math.max(e-q+7.5,p)):p:b?Math.min((e-h)*(e-h)+p,(e-q)*(e-q)+p):c?Math.min(Math.max(e-h,p),Math.max(q-e,p)):Math.min(Math.max(e-h+7.5,p),Math.max(q+7.5-e,p));x++}e++}n=!n}a=l.length;d=new Uint8Array(4*a);for(g=0;g<a;++g)z.packFloatRGBA((b?
Math.sqrt(l[g]):l[g])/15,d,4*g);return[d,f,31]};return a}();a.SymbolHelper=e;e=function(){function a(){}a.findApplicableOverrides=function(b,d,c){if(d){if(b.primitiveName){for(var f=!1,l=0;l<c.length;l++){var g=c[l];if(g.primitiveName===b.primitiveName){f=!0;break}}if(!f)for(f=0;f<d.length;f++)g=d[f],g.primitiveName===b.primitiveName&&c.push(g)}switch(b.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":if(b.effects)for(f=0,l=b.effects;f<l.length;f++)g=l[f],a.findApplicableOverrides(g,
d,c);if(b.symbolLayers)for(g=0,b=b.symbolLayers;g<b.length;g++)a.findApplicableOverrides(b[g],d,c);break;case "CIMSolidStroke":case "CIMPictureStroke":case "CIMGradientStroke":case "CIMSolidFill":case "CIMPictureFill":case "CIMHatchFill":case "CIMGradientFill":case "CIMVectorMarker":case "CIMCharacterMarker":case "CIMPictureMarker":if(b.effects)for(f=0,l=b.effects;f<l.length;f++)g=l[f],a.findApplicableOverrides(g,d,c);b.markerPlacement&&a.findApplicableOverrides(b.markerPlacement,d,c);if("CIMVectorMarker"===
b.type){if(b.markerGraphics)for(g=0,b=b.markerGraphics;g<b.length;g++)f=b[g],a.findApplicableOverrides(f,d,c),a.findApplicableOverrides(f.symbol,d,c)}else"CIMCharacterMarker"===b.type?a.findApplicableOverrides(b.symbol,d,c):"CIMHatchFill"===b.type&&a.findApplicableOverrides(b.lineSymbol,d,c)}}};a.applyOverrides=function(b,d,c,f){if(d){if(b.primitiveName)for(var k=0;k<d.length;k++){var l=d[k];if(l.primitiveName===b.primitiveName){var g;g=(g=l.propertyName)?g.charAt(0).toLowerCase()+g.substr(1):g;f&&
f.push({cim:b,nocapPropertyName:g,value:b[g]});l.expression&&(l.value=a.toValue(l.propertyName,l.expression));if(c){for(var h=!1,q=0,e=c;q<e.length;q++)e[q].primitiveName===b.primitiveName&&(h=!0);h||c.push(l)}b[g]=l.value}}switch(b.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":if(b.effects)for(l=0,g=b.effects;l<g.length;l++)k=g[l],a.applyOverrides(k,d,c,f);if(b.symbolLayers)for(k=0,b=b.symbolLayers;k<b.length;k++)a.applyOverrides(b[k],d,c,f);break;case "CIMSolidStroke":case "CIMSolidFill":case "CIMVectorMarker":if(b.effects)for(l=
0,g=b.effects;l<g.length;l++)k=g[l],a.applyOverrides(k,d,c,f);if("CIMVectorMarker"===b.type&&b.markerGraphics)for(k=0,b=b.markerGraphics;k<b.length;k++)l=b[k],a.applyOverrides(l,d,c,f),a.applyOverrides(l.symbol,d,c,f)}}};a.restoreOverrides=function(a){for(var b=0;b<a.length;b++){var d=a[b];d.cim[d.nocapPropertyName]=d.value}};a.buildOverrideKey=function(a){for(var b="",d=0;d<a.length;d++){var c=a[d];void 0!==c.value&&(b+=""+c.primitiveName+c.propertyName+JSON.stringify(c.value))}return b};a.toValue=
function(a,b){return"DashTemplate"===a?b.split(" ").map(function(a){return Number(a)}):"Color"===a?(a=(new c(b)).toRgba(),a[3]*=255,a):b};return a}();a.OverrideHelper=e})},"esri/symbols/cim/CIMCursor":function(){define(["require","exports","../../geometry/support/jsonUtils","./CIMPlacements"],function(e,a,c,h){function b(a){if(a)for(var b=a.length-1;0<b;--b)a[b][0]-=a[b-1][0],a[b][1]-=a[b-1][1]}function g(a){if(a)for(var d=0;d<a.length;d++)b(a[d])}function m(a){if(a)for(var b=a.length,d=1;d<b;++d)a[d][0]+=
a[d-1][0],a[d][1]+=a[d-1][1]}function f(a){if(a)for(var b=0;b<a.length;b++)m(a[b])}function d(a){a&&a.reverse()}function l(a){return{rings:[[[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]]]}}Object.defineProperty(a,"__esModule",{value:!0});a.deltaEncodePath=b;a.deltaEncodeMultipath=g;a.deltaDecodeGeometry=function(a){c.isPolygon(a)?f(a.rings):c.isPolyline(a)?f(a.paths):c.isMultipoint(a)&&m(a.points);return a};a.deltaEncodeGeometry=function(a){c.isPolygon(a)?g(a.rings):
c.isPolyline(a)?g(a.paths):c.isMultipoint(a)&&b(a.points);return a};a.reverseMultipath=function(a){if(a)for(var b=0;b<a.length;b++)d(a[b])};a.reversePath=d;a.getCoord2D=function(a,b,d){return[a[0]+(b[0]-a[0])*d,a[1]+(b[1]-a[1])*d]};a.isClosedPath=function(a){return a&&0!==a.length?a[0][0]===a[a.length-1][0]&&a[0][1]===a[a.length-1][1]:!1};a.getId=function(a){return a[4]};a.setId=function(a,b){a[4]=b};e=function(){function a(a,b,d,f){this.acceptPolygon=b;this.acceptPolyline=d;this.geomUnitsPerPoint=
f;this.pathIndex=this.pathCount=-1;this.iteratePath=!1;a&&(c.isPolygon(a)?b&&(this.multiPath=a.rings,this.isClosed=!0):c.isPolyline(a)?d&&(this.multiPath=a.paths,this.isClosed=!1):c.isExtent(a)&&b&&(this.multiPath=l(a).rings,this.isClosed=!0),this.multiPath&&(this.pathCount=this.multiPath.length));this.internalPlacement=new h.Placement}a.prototype.next=function(){if(!this.multiPath)return null;for(;this.iteratePath||this.pathIndex<this.pathCount-1;){this.iteratePath||this.pathIndex++;var a=this.processPath(this.multiPath[this.pathIndex]);
if(a)return a}this.pathIndex=this.pathCount=-1;return this.multiPath=null};return a}();a.PathTransformationCursor=e;e=function(){function a(a,b,d,c){this.inputGeometries=a;this.acceptPolygon=b;this.acceptPolyline=d;this.geomUnitsPerPoint=c;this.pathIndex=this.pathCount=-1;this.iteratePath=!1}a.prototype.next=function(){for(;;){if(!this.multiPath){for(var a=this.inputGeometries.next();a;)if(c.isPolygon(a)?this.acceptPolygon&&(this.multiPath=a.rings,this.isClosed=!0):c.isPolyline(a)?this.acceptPolyline&&
(this.multiPath=a.paths,this.isClosed=!1):c.isExtent(a)&&this.acceptPolygon&&(this.multiPath=l(a).rings,this.isClosed=!0),this.multiPath){this.pathCount=this.multiPath.length;this.pathIndex=-1;break}else a=this.inputGeometries.next();if(!this.multiPath)return null}for(;this.iteratePath||this.pathIndex<this.pathCount-1;)if(this.iteratePath||this.pathIndex++,a=this.processPath(this.multiPath[this.pathIndex]))return a;this.pathIndex=this.pathCount=-1;this.multiPath=null}};return a}();a.PathGeometryCursor=
e})},"esri/symbols/cim/CIMPlacements":function(){define(["require","exports"],function(e,a){Object.defineProperty(a,"__esModule",{value:!0});e=function(){function a(){this.setIdentity()}a.prototype.setIdentity=function(){this.tz=this.ty=this.tx=0;this.s=1;this.rz=this.ry=this.rx=0;this.rz_c=1;this.rz_s=0};a.prototype.setTranslate=function(a,b){this.tx=a;this.ty=b};a.prototype.setTranslateZ=function(a){this.tz=a};a.prototype.setRotateCS=function(a,b){this.rz=void 0;this.rz_c=a;this.rz_s=b};a.prototype.setRotate=
function(a){this.rz=a;this.rz_s=this.rz_c=void 0};a.prototype.setRotateY=function(a){this.ry=a};a.prototype.setScale=function(a){this.s=a};a.prototype.setMeasure=function(a){this.m=a};return a}();a.Placement=e;e=function(){function a(){}a.prototype.next=function(){return null};return a}();a.EmptyPlacementCursor=e})},"esri/symbols/cim/CIMEffects":function(){define(["require","exports","../../core/lang"],function(e,a,c){Object.defineProperty(a,"__esModule",{value:!0});e=function(){function a(a){this._geometry=
a}a.prototype.next=function(){var a=this._geometry;this._geometry=null;return a};return a}();a.SimpleGeometryCursor=e;a.clone=function(a){return c.clone(a)}})},"esri/symbols/cim/CIMOperators":function(){define(["require","exports"],function(e,a){Object.defineProperty(a,"__esModule",{value:!0});a.getEffectOperator=function(a){return null};a.getPlacementOperator=function(a){return null}})},"esri/symbols/cim/CIMSymbolDrawHelper":function(){define("require exports ../../core/tsSupport/extendsHelper ../../core/tsSupport/decorateHelper ../../core/Logger ../../geometry/support/jsonUtils ../cim/CIMEffects ../cim/CIMOperators ../cim/CIMPlacements ./Rect".split(" "),
function(e,a,c,h,b,g,m,f,d,l){Object.defineProperty(a,"__esModule",{value:!0});a.C_DEG_TO_RAD=Math.PI/180;var z=b.getLogger("esri.symbols.cim.CIMSymbolDrawHelper"),v=function(){function a(a){this._t=a}a.createIdentity=function(){return new a([1,0,0,0,1,0])};a.prototype.clone=function(){return new a(this._t.slice())};a.prototype.transform=function(a){var b=this._t;return[b[0]*a[0]+b[1]*a[1]+b[2],b[3]*a[0]+b[4]*a[1]+b[5]]};a.createScale=function(b,d){return new a([b,0,0,0,d,0])};a.prototype.scale=function(a,
b){var d=this._t;d[0]*=a;d[1]*=a;d[2]*=a;d[3]*=b;d[4]*=b;d[5]*=b;return this};a.prototype.scaleRatio=function(){return Math.sqrt(this._t[0]*this._t[0]+this._t[1]*this._t[1])};a.createTranslate=function(b,d){return new a([0,0,b,0,0,d])};a.prototype.translate=function(a,b){var d=this._t;d[2]+=a;d[5]+=b;return this};a.createRotate=function(b){var d=Math.cos(b);b=Math.sin(b);return new a([d,-b,0,b,d,0])};a.prototype.rotate=function(b){return this.multiply(a.createRotate(b))};a.prototype.multiply=function(a){var b=
this._t;a=a._t;var d=b[1]*a[0]+b[4]*a[1],c=b[2]*a[0]+b[5]*a[1]+a[2],f=b[0]*a[3]+b[3]*a[4],l=b[1]*a[3]+b[4]*a[4],k=b[2]*a[3]+b[5]*a[4]+a[5];b[0]=b[0]*a[0]+b[3]*a[1];b[1]=d;b[2]=c;b[3]=f;b[4]=l;b[5]=k;return this};return a}();a.Transformation=v;e=function(){function b(a){this._transfos=[];this._sizeTransfos=[];this._transfos.push(a||v.createIdentity());this._sizeTransfos.push(a?a.scaleRatio():1)}b.prototype.transformPt=function(a){return this._transfos[this._transfos.length-1].transform(a)};b.prototype.transformSize=
function(a){return a*this._sizeTransfos[this._sizeTransfos.length-1]};b.prototype.back=function(){return this._transfos[this._transfos.length-1]};b.prototype.push=function(a){var b=a.scaleRatio();a.multiply(this.back());this._transfos.push(a);this._sizeTransfos.push(this._sizeTransfos[this._sizeTransfos.length-1]*b)};b.prototype.pop=function(){this._transfos.splice(-1,1);this._sizeTransfos.splice(-1,1)};b.prototype.drawSymbol=function(a,b){if(a)switch(a.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":this.drawMultiLayerSymbol(a,
b)}};b.prototype.drawMultiLayerSymbol=function(a,b){if(a){var d=a.symbolLayers;if(d)if(a=a.effects){if(b=this.executeEffects(a,b))for(a=b.next();a;)this.drawSymbolLayers(d,a),a=b.next()}else this.drawSymbolLayers(d,b)}};b.prototype.executeEffects=function(a,b){var d=96/72;b=new m.SimpleGeometryCursor(b);for(var c=a?a.length:0,l=0;l<c;++l){var g=a[l];if(g){var k=f.getEffectOperator(g);k&&(b=k.execute(b,g,d))}}return b};b.prototype.drawSymbolLayers=function(a,b){for(var d=a.length;d--;){var c=a[d];
if(c&&!1!==c.enable){var f=c.effects;if(f){if(f=this.executeEffects(f,b))for(var l=f.next();l;)this.drawSymbolLayer(c,l),l=f.next()}else this.drawSymbolLayer(c,b)}}};b.prototype.drawSymbolLayer=function(a,b){switch(a.type){case "CIMSolidFill":this.drawSolidFill(b,a.color);break;case "CIMSolidStroke":this.drawSolidStroke(b,a.color,a.width);break;case "CIMCharacterMarker":case "CIMPictureMarker":case "CIMVectorMarker":this.drawMarkerLayer(a,b)}};b.prototype.drawMarkerLayer=function(a,b){var c=a.markerPlacement;
if(c){var l=96/72,g=f.getPlacementOperator(c);if(g&&(b=g.execute(b,c,l)))for(c=b.next();c;)this.drawMarker(a,c),c=b.next()}else c=new d.Placement,c.tx=b.x,c.ty=b.y,this.drawMarker(a,c)};b.prototype.drawMarker=function(a,b){switch(a.type){case "CIMCharacterMarker":case "CIMPictureMarker":this.drawPictureMarker(a,b);break;case "CIMVectorMarker":this.drawVectorMarker(a,b)}};b.prototype.drawPictureMarker=function(a,b){};b.prototype.drawVectorMarker=function(b,d){if(b){var c=b.markerGraphics;if(c){var f=
b.size,l=b.frame,g=l?l.ymax-l.ymin:0,f=f&&g?f/g:1,g=v.createIdentity();l&&g.translate(.5*-(l.xmax+l.xmin),.5*-(l.ymax+l.ymin));var k=b.anchorPoint;if(k){var h=k.x,k=k.y;"Absolute"!==b.anchorPointUnits&&l&&(h*=l.xmax-l.xmin,k*=l.ymax-l.ymin);g.translate(-h,-k)}1!==f&&g.scale(f,f);b.rotation&&g.rotate(b.rotation*a.C_DEG_TO_RAD);g.translate(b.offsetX||0,b.offsetY||0);g.translate(d.tx,d.ty);this.push(g);for(b=0;b<c.length;b++)(d=c[b])&&d.symbol&&d.geometry||z.error("Invalid marker graphic",d),this.drawSymbol(d.symbol,
d.geometry);this.pop()}}};return b}();a.CIMSymbolDrawHelper=e;h=function(a){function b(){var b=a.call(this)||this;b.reset();return b}c(b,a);b.prototype.reset=function(){this._xmin=this._ymin=Infinity;this._xmax=this._ymax=-Infinity};b.prototype.envelope=function(){return new l.default(this._xmin,this._ymin,this._xmax-this._xmin,this._ymax-this._ymin)};b.prototype._merge=function(a,b){a[0]-b<this._xmin&&(this._xmin=a[0]-b);a[0]+b>this._xmax&&(this._xmax=a[0]+b);a[1]-b<this._ymin&&(this._ymin=a[1]-
b);a[1]+b>this._ymax&&(this._ymax=a[1]+b)};b.prototype.drawSolidFill=function(a){if(a&&a.rings){var b=0;for(a=a.rings;b<a.length;b++){var d=a[b],c=d?d.length:0;if(2<c){this._merge(this.transformPt(d[0]),0);for(var f=1;f<c;++f)this._merge(this.transformPt(d[f]),0)}}}};b.prototype.drawSolidStroke=function(a,b,d){b=.5*this.transformSize(d);if(a=g.isPolygon(a)?a.rings:a.paths)for(d=0;d<a.length;d++){var c=a[d],f=c?c.length:0;if(1<f){this._merge(this.transformPt(c[0]),b);for(var l=1;l<f;++l)this._merge(this.transformPt(c[l]),
b)}}};return b}(e);a.EnvDrawHelper=h;e=function(a){function b(b,d){d=a.call(this,d)||this;d._ctx=b;return d}c(b,a);b.prototype.drawSolidFill=function(a,b){if(a&&a.rings){var d=this._ctx;d.fillStyle="string"===typeof b?b:"rgba("+Math.round(b[0])+","+Math.round(b[1])+","+Math.round(b[2])+","+b[3]/255+")";d.beginPath();b=0;for(a=a.rings;b<a.length;b++){var c=a[b],f=c?c.length:0;if(2<f){var l=this.transformPt(c[0]);d.moveTo(l[0],l[1]);for(var g=1;g<f;++g)l=this.transformPt(c[g]),d.lineTo(l[0],l[1]);d.closePath()}}d.fill("evenodd")}};
b.prototype.drawSolidStroke=function(a,b,d){var c=this._ctx;c.strokeStyle="string"===typeof b?b:"rgba("+Math.round(b[0])+","+Math.round(b[1])+","+Math.round(b[2])+","+b[3]/255+")";c.lineWidth=this.transformSize(d)+.5;c.beginPath();b=!1;g.isPolygon(a)?(d=a.rings,b=!0):d=a.paths;for(a=0;a<d.length;a++){var f=d[a],l=f?f.length:0;if(1<l){var h=this.transformPt(f[0]);c.moveTo(h[0],h[1]);for(var e=1;e<l;++e)h=this.transformPt(f[e]),c.lineTo(h[0],h[1]);b&&c.closePath()}}c.stroke()};return b}(e);a.CanvasDrawHelper=
e})},"esri/symbols/cim/Rect":function(){define(["require","exports"],function(e,a){Object.defineProperty(a,"__esModule",{value:!0});e=function(){function a(a,b,c,e){void 0===a&&(a=0);void 0===b&&(b=0);void 0===c&&(c=0);void 0===e&&(e=0);this.x=a;this.y=b;this.width=c;this.height=e}Object.defineProperty(a.prototype,"isEmpty",{get:function(){return 0>=this.width||0>=this.height},enumerable:!0,configurable:!0});a.prototype.union=function(a){this.x=Math.min(this.x,a.x);this.y=Math.min(this.y,a.y);this.width=
Math.max(this.width,a.width);this.height=Math.max(this.height,a.height)};return a}();a.default=e})},"esri/symbols/cim/packingUtils":function(){define(["require","exports"],function(e,a){function c(a){return a-Math.floor(a)}Object.defineProperty(a,"__esModule",{value:!0});var h=[1,256,65536,16777216],b=[1/256,1/65536,1/16777216,1/4294967296],g=function(a,c){void 0===c&&(c=0);for(var d=0,f=0;4>f;f++)d+=a[c+f]*b[f];return d}(new Uint8ClampedArray([255,255,255,255]));a.packFloatRGBA=function(a,b,d){void 0===
d&&(d=0);a=0>a?0:a>g?g:a;for(var f=0;4>f;f++)b[d+f]=Math.floor(256*c(a*h[f]))}})},"esri/symbols/cim/SDFHelper":function(){define(["require","exports","../../geometry/support/jsonUtils","./packingUtils","./Rect"],function(e,a,c,h,b){function g(a){if(!a)return null;switch(a.type){case "CIMPointSymbol":a=a.symbolLayers;if(!a||1!==a.length)break;return g(a[0]);case "CIMVectorMarker":a=a.markerGraphics;if(!a||1!==a.length)break;var b=a[0];if(!b)break;a=b.geometry;if(!a)break;b=b.symbol;if(!b||"CIMPolygonSymbol"!==
b.type&&"CIMLineSymbol"!==b.type)break;return{geom:a,asFill:"CIMPolygonSymbol"===b.type};case "sdf":return{geom:a.geom,asFill:a.asFill}}return null}function m(a){for(var b=Infinity,c=-Infinity,f=Infinity,g=-Infinity,h=0;h<a.length;h++)for(var e=0,m=a[h];e<m.length;e++){var q=m[e];q[0]<b&&(b=q[0]);q[0]>c&&(c=q[0]);q[1]<f&&(f=q[1]);q[1]>g&&(g=q[1])}return[b,f,c,g]}Object.defineProperty(a,"__esModule",{value:!0});a.getSDFInfo=g;a.getSDFSymbol=function(a){a=a.markerGraphics;if(!a||1!==a.length)return null;
a=a[0];if(!a)return null;a=a.symbol;return!a||"CIMPolygonSymbol"!==a.type&&"CIMLineSymbol"!==a.type?null:a};a.getExtent=function(a){return a?a.rings?m(a.rings):a.paths?m(a.paths):c.isExtent(a)?[a.xmin,a.ymin,a.xmax,a.ymax]:null:null};a.getSDFMetrics=function(a,b,c,g,h){var d=a[0],f=a[1],l=a[2];a=a[3];if(l<d||a<f)return[0,0,0];var e=l-d,m=a-f,l=Math.floor(31.5);a=(128-2*(l+1))/Math.max(e,m);var e=Math.round(e*a),m=Math.round(m*a)+2*l,p=1;b&&(p=m/a/(b.ymax-b.ymin));var y=0,k=0;g&&(h?b&&c&&0<b.ymax-
b.ymin&&(y=g.x/((b.xmax-b.xmin)/(b.ymax-b.ymin)*c),k=g.y/c):(y=g.x,k=g.y));y=.5*(b.xmax+b.xmin)+y*(b.xmax-b.xmin);k=.5*(b.ymax+b.ymin)+k*(b.ymax-b.ymin);y=(y-d)*a+l;k=(k-f)*a+l;return[p,y/(e+2*l)-.5,-(k/m-.5)]};a.buildSDF=function(a){var d,c=a.geom;d=c?c.rings?c.rings:c.paths?c.paths:void 0!==c.xmin&&void 0!==c.ymin&&void 0!==c.xmax&&void 0!==c.ymax?[[[c.xmin,c.ymin],[c.xmin,c.ymax],[c.xmax,c.ymax],[c.xmax,c.ymin],[c.xmin,c.ymin]]]:null:null;var f,c=Infinity,g=-Infinity,e=Infinity,m=-Infinity;for(f=
0;f<d.length;f++)for(var u=0,q=d[f];u<q.length;u++){var n=q[u];n[0]<c&&(c=n[0]);n[0]>g&&(g=n[0]);n[1]<e&&(e=n[1]);n[1]>m&&(m=n[1])}f=new b.default(c,e,g-c,m-e);e=Math.floor(31.5);u=(128-2*(e+1))/Math.max(f.width,f.height);c=Math.round(f.width*u)+2*e;g=Math.round(f.height*u)+2*e;m=[];for(q=0;q<d.length;q++){var p=d[q];if(p&&1<p.length){for(var n=[],y=0;y<p.length;y++){var k=p[y],C=k[0],k=k[1],C=C-f.x,k=k-f.y,C=C*u,k=k*u,C=C+(e-.5),k=k+(e-.5);n.push([C,k])}a.asFill&&(y=n.length-1,n[0][0]===n[y][0]&&
n[0][1]===n[y][1]||n.push(n[0]));m.push(n)}}f=c*g;d=Array(f);q=e*e+1;for(u=0;u<f;++u)d[u]=q;for(q=0;q<m.length;q++)for(n=m[q],y=n.length,u=1;u<y;++u){var p=n[u-1],C=n[u],w=void 0,k=void 0;p[0]<C[0]?(w=p[0],k=C[0]):(w=C[0],k=p[0]);var B=void 0,E=void 0;p[1]<C[1]?(B=p[1],E=C[1]):(B=C[1],E=p[1]);var G=Math.floor(w)-e,k=Math.floor(k)+e,B=Math.floor(B)-e,E=Math.floor(E)+e;0>G&&(G=0);k>c&&(k=c);0>B&&(B=0);E>g&&(E=g);for(var w=C[0]-p[0],F=C[1]-p[1],M=w*w+F*F;G<k;G++)for(var J=B;J<E;J++){var L=(G-p[0])*w+
(J-p[1])*F,K=void 0,Q=void 0;0>L?(K=p[0],Q=p[1]):L>M?(K=C[0],Q=C[1]):(L/=M,K=p[0]+L*w,Q=p[1]+L*F);L=(G-K)*(G-K)+(J-Q)*(J-Q);K=(g-J-1)*c+G;L<d[K]&&(d[K]=L)}}for(u=0;u<f;++u)d[u]=Math.sqrt(d[u]);if(a.asFill)for(a=0;a<m.length;a++)for(f=m[a],u=f.length,q=1;q<u;++q)for(n=f[q-1],y=f[q],C=p=void 0,n[0]<y[0]?(p=n[0],C=y[0]):(p=y[0],C=n[0]),k=B=void 0,n[1]<y[1]?(B=n[1],k=y[1]):(B=y[1],k=n[1]),p=Math.floor(p),C=Math.floor(C)+1,B=Math.floor(B),k=Math.floor(k)+1,p<e&&(p=e),C>c-e&&(C=c-e),B<e&&(B=e),k>g-e&&(k=
g-e);B<k;++B)if(n[1]>B!==y[1]>B){E=(g-B-1)*c;for(w=p;w<C;++w)w<(y[0]-n[0])*(B-n[1])/(y[1]-n[1])+n[0]&&(d[E+w]=-d[E+w]);for(w=e;w<p;++w)d[E+w]=-d[E+w]}e*=2;m=d.length;a=new Uint8Array(4*m);for(f=0;f<m;++f)h.packFloatRGBA(.5-d[f]/e,a,4*f);return[a,c,g]}})},"esri/symbols/cim/utils":function(){define(["require","exports"],function(e,a){Object.defineProperty(a,"__esModule",{value:!0});a.evaluateValueOrFunction=function(a,e,b,g){return"function"===typeof a?a(e,b,g):a};a.colorToArray=function(a){return[a.r,
a.g,a.b,a.a]};a.resampleHermite=function(a,e,b,g,m,f,d){void 0===d&&(d=!0);var c=e/m;b/=f;for(var h=Math.ceil(c/2),v=Math.ceil(b/2),A=0;A<f;A++)for(var x=0;x<m;x++){for(var u=4*(x+(d?f-A-1:A)*m),q=0,n=0,p=0,y=0,k=0,C=0,w=0,B=(A+.5)*b,E=Math.floor(A*b);E<(A+1)*b;E++)for(var G=Math.abs(B-(E+.5))/v,F=(x+.5)*c,G=G*G,M=Math.floor(x*c);M<(x+1)*c;M++){var J=Math.abs(F-(M+.5))/h,q=Math.sqrt(G+J*J);-1<=q&&1>=q&&(q=2*q*q*q-3*q*q+1,0<q&&(J=4*(M+E*e),w+=q*a[J+3],p+=q,255>a[J+3]&&(q=q*a[J+3]/250),y+=q*a[J],k+=
q*a[J+1],C+=q*a[J+2],n+=q))}g[u]=y/n;g[u+1]=k/n;g[u+2]=C/n;g[u+3]=w/p}}})},"esri/views/2d/engine/webgl/fontUtils":function(){define(["require","exports"],function(e,a){function c(a){a=a.toLowerCase().split(" ").join("-");switch(a){case "serif":return"noto-serif";case "sans-serif":return"arial-unicode-ms";case "monospace":return"ubuntu-mono";case "fantasy":return"cabin-sketch";case "cursive":return"redressed";default:return a}}Object.defineProperty(a,"__esModule",{value:!0});a.getFullyQualifiedFontName=
function(a){var b;a:{if(a.weight)switch(a.weight.toLowerCase()){case "bold":case "bolder":b="-bold";break a}b=""}var g;a:{if(a.style)switch(a.style.toLowerCase()){case "italic":case "oblic":g="-italic";break a}g=""}b+=g;return c(a.family)+(0<b.length?b:"-regular")};a.getFontDecorationTop=function(a){switch(a){case "underline":return-26;case "line-through":return-18}return NaN}})},"esri/views/2d/engine/webgl/GlyphMosaic":function(){define("require exports ../../../../core/has ../../../../core/promiseUtils ../../../webgl ./Rect ./RectangleBinPack".split(" "),
function(e,a,c,h,b,g,m){return function(){function a(a,b,c){this.height=this.width=0;this._dirties=[];this._glyphData=[];this._currentPage=0;this._glyphIndex={};this._textures=[];this._rangePromises=new Map;this.width=a;this.height=b;this._glyphSource=c;this._binPack=new m(a-4,b-4);this._glyphData.push(new Uint8Array(a*b));this._dirties.push(!0);this._textures.push(void 0);this._addDecorationGlyph()}a.prototype.getGlyphItems=function(a,b,c){for(var d=this,f=[],l=this._glyphSource,g=new Set,e=1/256,
m=0;m<b.length;m++)g.add(Math.floor(b[m]*e));var p=[];g.forEach(function(b){if(256>=b){var f=a+b;d._rangePromises.has(f)?p.push(d._rangePromises.get(f)):(b=l.getRange(a,b,c).then(function(){d._rangePromises["delete"](f)}).catch(function(a){d._rangePromises["delete"](f);if(!h.isAbortError(a))throw Error("Unable to query resource");}),d._rangePromises.set(f,b),p.push(b))}});return h.all(p).then(function(){var c,k=d._glyphIndex[a];k||(k={},d._glyphIndex[a]=k);for(var g=0;g<b.length;g++){c=b[g];var e=
k[c];if(e)f[c]={sdf:!0,rect:e.rect,metrics:e.metrics,page:e.page};else if((e=l.getGlyph(a,c))&&e.metrics){var h=d._recordGlyph(e);k[c]={rect:h,metrics:e.metrics,tileIDs:null,page:d._currentPage};f[c]={sdf:!0,rect:h,metrics:e.metrics,page:d._currentPage};d._dirties[d._currentPage]=!0}}return f})};a.prototype._recordGlyph=function(a){var b=a.metrics;if(0===b.width)b=new g.default(0,0,0,0);else{var d=b.width+6,c=b.height+6,f=d%4?4-d%4:4,e=c%4?4-c%4:4;1===f&&(f=5);1===e&&(e=5);b=this._binPack.allocate(d+
f,c+e);b.isEmpty&&(this._dirties[this._currentPage]||(this._glyphData[this._currentPage]=null),this._currentPage=this._glyphData.length,this._glyphData.push(new Uint8Array(this.width*this.height)),this._dirties.push(!0),this._textures.push(void 0),this._binPack=new m(this.width-4,this.height-4),b=this._binPack.allocate(d+f,c+e));f=this._glyphData[this._currentPage];a=a.bitmap;var h=e=void 0;if(a)for(var q=0;q<c;q++)for(var e=d*q,h=this.width*(b.y+q+1)+b.x,n=0;n<d;n++)f[h+n+1]=a[e+n]}return b};a.prototype._addDecorationGlyph=
function(){for(var a=[117,149,181,207,207,181,149,117],b=[],c=0;c<a.length;c++)for(var f=a[c],g=0;11>g;g++)b.push(f);a={metrics:{width:5,height:2,left:0,top:0,advance:0},bitmap:new Uint8Array(b)};this._recordGlyph(a)};a.prototype.bind=function(a,c,f,g){this._textures[f]||(this._textures[f]=new b.Texture(a,{pixelFormat:6406,dataType:5121,width:this.width,height:this.height},new Uint8Array(this.width*this.height)));var d=this._textures[f];d.setSamplingMode(c);this._dirties[f]&&d.setData(this._glyphData[f]);
a.bindTexture(d,g);this._dirties[f]=!1};a.prototype.dispose=function(){this._binPack=null;for(var a=0,b=this._textures;a<b.length;a++){var c=b[a];c&&c.dispose()}this._textures.length=0;this._glyphData.length=0};return a}()})},"esri/views/2d/engine/webgl/Rect":function(){define(["require","exports"],function(e,a){Object.defineProperty(a,"__esModule",{value:!0});e=function(){function a(a,b,c,e){void 0===a&&(a=0);void 0===b&&(b=0);void 0===c&&(c=0);void 0===e&&(e=0);this.x=a;this.y=b;this.width=c;this.height=
e}Object.defineProperty(a.prototype,"isEmpty",{get:function(){return 0>=this.width||0>=this.height},enumerable:!0,configurable:!0});a.prototype.union=function(a){this.x=Math.min(this.x,a.x);this.y=Math.min(this.y,a.y);this.width=Math.max(this.width,a.width);this.height=Math.max(this.height,a.height)};return a}();a.default=e})},"esri/views/2d/engine/webgl/RectangleBinPack":function(){define(["require","exports","./Rect"],function(e,a,c){return function(){function a(a,g){this._height=this._width=0;
this._free=[];this._width=a;this._height=g;this._free.push(new c.default(0,0,a,g))}Object.defineProperty(a.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0});a.prototype.allocate=function(a,g){if(a>this._width||g>this._height)return new c.default;for(var b=null,f=-1,d=0;d<this._free.length;++d){var l=this._free[d];a<=l.width&&g<=l.height&&(null===b||l.y<=
b.y&&l.x<=b.x)&&(b=l,f=d)}if(null===b)return new c.default;this._free.splice(f,1);b.width<b.height?(b.width>a&&this._free.push(new c.default(b.x+a,b.y,b.width-a,g)),b.height>g&&this._free.push(new c.default(b.x,b.y+g,b.width,b.height-g))):(b.width>a&&this._free.push(new c.default(b.x+a,b.y,b.width-a,b.height)),b.height>g&&this._free.push(new c.default(b.x,b.y+g,a,b.height-g)));return new c.default(b.x,b.y,a,g)};a.prototype.release=function(a){for(var b=0;b<this._free.length;++b){var c=this._free[b];
if(c.y===a.y&&c.height===a.height&&c.x+c.width===a.x)c.width+=a.width;else if(c.x===a.x&&c.width===a.width&&c.y+c.height===a.y)c.height+=a.height;else if(a.y===c.y&&a.height===c.height&&a.x+a.width===c.x)c.x=a.x,c.width+=a.width;else if(a.x===c.x&&a.width===c.width&&a.y+a.height===c.y)c.y=a.y,c.height+=a.height;else continue;this._free.splice(b,1);this.release(a)}this._free.push(a)};return a}()})},"esri/views/2d/engine/webgl/GlyphSource":function(){define("require exports ../../../../core/tsSupport/assignHelper ../../../../request ../../../../core/pbf ../../../../core/promiseUtils".split(" "),
function(e,a,c,h,b,g){var m=function(){function a(a){this._metrics=[];for(this._bitmaps=[];a.next();)switch(a.tag()){case 1:for(var b=a.getMessage();b.next();)switch(b.tag()){case 3:for(var d=b.getMessage(),c=void 0,f=void 0,g=void 0,l=void 0,e=void 0,h=void 0,m=void 0;d.next();)switch(d.tag()){case 1:c=d.getUInt32();break;case 2:f=d.getBytes();break;case 3:g=d.getUInt32();break;case 4:l=d.getUInt32();break;case 5:e=d.getSInt32();break;case 6:h=d.getSInt32();break;case 7:m=d.getUInt32();break;default:d.skip()}d.release();
c&&(this._metrics[c]={width:g,height:l,left:e,top:h,advance:m},this._bitmaps[c]=f);break;default:b.skip()}b.release();break;default:a.skip()}}a.prototype.getMetrics=function(a){return this._metrics[a]};a.prototype.getBitmap=function(a){return this._bitmaps[a]};return a}(),f=function(){function a(){this._ranges=[]}a.prototype.getRange=function(a){return this._ranges[a]};a.prototype.addRange=function(a,b){this._ranges[a]=b};return a}();return function(){function a(a){this._glyphInfo={};this._baseURL=
a}a.prototype.getRange=function(a,d,f){var l=this._getFontStack(a);if(l.getRange(d))return g.resolve();var e=256*d,u=e+255;a=this._baseURL.replace("{fontstack}",a).replace("{range}",e+"-"+u);return h(a,c({responseType:"array-buffer"},f)).then(function(a){l.addRange(d,new m(new b(new Uint8Array(a.data),new DataView(a.data))))})};a.prototype.getGlyph=function(a,b){if(a=this._getFontStack(a)){var d=Math.floor(b/256);if(!(256<d)&&(a=a.getRange(d)))return{metrics:a.getMetrics(b),bitmap:a.getBitmap(b)}}};
a.prototype._getFontStack=function(a){var b=this._glyphInfo[a];b||(b=this._glyphInfo[a]=new f);return b};return a}()})},"esri/views/2d/engine/webgl/SDFConverter":function(){define(["require","exports","../../../../core/promiseUtils","../../../../core/promiseUtils","./packingUtils"],function(e,a,c,h,b){Object.defineProperty(a,"__esModule",{value:!0});e=function(){function a(a){this.size=a;this.canvas=document.createElement("canvas");this.canvas.width=this.canvas.height=a;this.context=this.canvas.getContext("2d");
this._gridOuter=new Float64Array(a*a);this._gridInner=new Float64Array(a*a);this._f=new Float64Array(a);this._d=new Float64Array(a);this._z=new Float64Array(a+1);this._v=new Int16Array(a)}a.prototype.draw=function(a,f,d){var g=this;void 0===d&&(d=31);this._initSVG();var e=this._createSVGString(a);return c.create(function(a,c){var l=new Image;l.src="data:image/svg+xml; charset\x3dutf8, "+encodeURIComponent(e);l.onload=function(){g.context.clearRect(0,0,g.size,g.size);g.context.drawImage(l,0,0,g.size,
g.size);for(var c=g.context.getImageData(0,0,g.size,g.size),f=new Uint8Array(g.size*g.size*4),e=0;e<g.size*g.size;e++){var h=c.data[4*e+3]/255;g._gridOuter[e]=1===h?0:0===h?1E20:Math.pow(Math.max(0,.5-h),2);g._gridInner[e]=1===h?1E20:0===h?0:Math.pow(Math.max(0,h-.5),2)}g._edt(g._gridOuter,g.size,g.size);g._edt(g._gridInner,g.size,g.size);for(e=0;e<g.size*g.size;e++)b.packFloatRGBA(.5-(g._gridOuter[e]-g._gridInner[e])/(2*d),f,4*e);a(f)};var m=f&&f.signal;if(m)h.onAbort(m,function(){return c(h.createAbortError())})})};
a.prototype._initSVG=function(){if(!this._svg){var a=document.createElementNS("http://www.w3.org/2000/svg","svg");a.setAttribute("style","position: absolute;");a.setAttribute("width","0");a.setAttribute("height","0");a.setAttribute("aria-hidden","true");a.setAttribute("role","presentation");document.body.appendChild(a);this._svg=a}};a.prototype._createSVGString=function(a){var b=document.createElementNS("http://www.w3.org/2000/svg","path");b.setAttribute("d",a);this._svg.appendChild(b);a=b.getBBox();
var d=a.width/a.height,c=this.size/2,g,e,h;1<d?(e=g=c/a.width,h=this.size/4,d=c-1/d*c/2):(g=e=c/a.height,h=c-c*d/2,d=this.size/4);b.setAttribute("style","transform: matrix("+g+", 0, 0, "+e+", "+(-a.x*g+h)+", "+(-a.y*e+d)+")");a='\x3csvg style\x3d"fill:red;" height\x3d"'+this.size+'" width\x3d"'+this.size+'" xmlns\x3d"http://www.w3.org/2000/svg"\x3e'+this._svg.innerHTML+"\x3c/svg\x3e";this._svg.removeChild(b);return a};a.prototype._edt=function(a,b,d){for(var c=this._f,f=this._d,g=this._v,e=this._z,
h=0;h<b;h++){for(var m=0;m<d;m++)c[m]=a[m*b+h];this._edt1d(c,f,g,e,d);for(m=0;m<d;m++)a[m*b+h]=f[m]}for(m=0;m<d;m++){for(h=0;h<b;h++)c[h]=a[m*b+h];this._edt1d(c,f,g,e,b);for(h=0;h<b;h++)a[m*b+h]=Math.sqrt(f[h])}};a.prototype._edt1d=function(a,b,d,c,g){d[0]=0;c[0]=-1E20;c[1]=1E20;for(var f=1,l=0;f<g;f++){for(var e=(a[f]+f*f-(a[d[l]]+d[l]*d[l]))/(2*f-2*d[l]);e<=c[l];)l--,e=(a[f]+f*f-(a[d[l]]+d[l]*d[l]))/(2*f-2*d[l]);l++;d[l]=f;c[l]=e;c[l+1]=1E20}for(l=f=0;f<g;f++){for(;c[l+1]<f;)l++;b[f]=(f-d[l])*(f-
d[l])+a[d[l]]}};return a}();a.default=e})},"esri/views/2d/engine/webgl/packingUtils":function(){define(["require","exports"],function(e,a){function c(a){return a-Math.floor(a)}Object.defineProperty(a,"__esModule",{value:!0});var h=[1,256,65536,16777216],b=[1/256,1/65536,1/16777216,1/4294967296],g=function(a,c){void 0===c&&(c=0);for(var d=0,f=0;4>f;f++)d+=a[c+f]*b[f];return d}(new Uint8ClampedArray([255,255,255,255]));a.packFloatRGBA=function(a,b,d){void 0===d&&(d=0);a=0>a?0:a>g?g:a;for(var f=0;4>
f;f++)b[d+f]=Math.floor(256*c(a*h[f]))}})},"esri/views/2d/engine/webgl/SpriteMosaic":function(){define("require exports ../../../../core/has ../../../webgl ./GeometryUtils ./Rect ./RectangleBinPack".split(" "),function(e,a,c,h,b,g,m){return function(){function a(a,b,f){void 0===f&&(f=0);this._size=[];this._mosaicsData=[];this._textures=[];this._dirties=[];this._currentPage=this._maxItemSize=0;this._fixSpriteLocationsTable=c("fix-sprite-locations");this._testId=c("test-id");this._pageHeight=this._pageWidth=
0;this._mosaicRects=new Map;this._spriteCopyQueue=[];this.pixelRatio=1;(0>=a||0>=b)&&console.error("Sprites mosaic defaultWidth and defaultHeight must be greater than zero!");this._pageWidth=a;this._pageHeight=b;0<f&&(this._maxItemSize=f);this.pixelRatio=window.devicePixelRatio||1;if(this._fixSpriteLocationsTable){a=[];for(var d in this._fixSpriteLocationsTable[this._testId])b=this._fixSpriteLocationsTable[this._testId][d],a[b.page]=b.pageSize;for(d=0;d<a.length;d++)b=a[d],this._mosaicsData.push(new Uint32Array(b[0]*
b[1])),this._dirties.push(!0),this._size.push([b[0],b[1]]),this._textures.push(void 0)}this._binPack=new m(this._pageWidth,this._pageHeight);this._mosaicsData.push(new Uint32Array(Math.floor(this._pageWidth)*Math.floor(this._pageHeight)));this._dirties.push(!0);this._size.push([this._pageWidth,this._pageHeight]);this._textures.push(void 0)}a.prototype.getWidth=function(a){return a>=this._size.length?-1:this._size[a][0]};a.prototype.getHeight=function(a){return a>=this._size.length?-1:this._size[a][1]};
a.prototype.getPage=function(a){return a<this._textures.length?this._textures[a]:null};a.prototype.has=function(a){return this._mosaicRects.has(a)};Object.defineProperty(a.prototype,"itemCount",{get:function(){return this._mosaicRects.size},enumerable:!0,configurable:!0});a.prototype.getSpriteItem=function(a){return this._mosaicRects.get(a)};a.prototype.addSpriteItem=function(a,b,c,f,g,e){var d;if(this._mosaicRects.has(a))return this._mosaicRects.get(a);var l,h;this._fixSpriteLocationsTable&&this._fixSpriteLocationsTable[this._testId]&&
this._fixSpriteLocationsTable[this._testId][a]?(d=this._fixSpriteLocationsTable[this._testId][a],l=d.rect,h=d.page,d=d.pageSize):(d=this._allocateImage(b[0],b[1]),l=d[0],h=d[1],d=d[2]);if(0>=l.width||0>=l.height)return null;e={rect:l,width:b[0],height:b[1],sdf:g,simplePattern:e,pixelRatio:1,page:h};this._mosaicRects.set(a,e);this._copy({rect:l,spriteSize:b,spriteData:c,page:h,pageSize:d,repeat:f,sdf:g});return e};a.prototype.hasItemsToProcess=function(){return 0!==this._spriteCopyQueue.length};a.prototype.processNextItem=
function(){var a=this._spriteCopyQueue.pop();a&&this._copy(a)};a.prototype.getSpriteItems=function(a){for(var b={},d=0;d<a.length;d++){var c=a[d];b[c]=this.getSpriteItem(c)}return b};a.prototype.getMosaicItemPosition=function(a){var b=(a=this.getSpriteItem(a))&&a.rect;if(!b)return null;b.width=a.width;b.height=a.height;return{size:[a.width,a.height],tl:[(b.x+1)/this._size[a.page][0],(b.y+1)/this._size[a.page][1]],br:[(b.x+1+a.width)/this._size[a.page][0],(b.y+1+a.height)/this._size[a.page][1]],page:a.page}};
a.prototype.bind=function(a,b,c,f){void 0===c&&(c=0);void 0===f&&(f=0);this._textures[c]||(this._textures[c]=new h.Texture(a,{pixelFormat:6408,dataType:5121,width:this._size[c][0],height:this._size[c][1]},new Uint8Array(this._mosaicsData[c].buffer)));var d=this._textures[c];d.setSamplingMode(b);this._dirties[c]&&(d.setData(new Uint8Array(this._mosaicsData[c].buffer)),d.generateMipmap());a.bindTexture(d,f);this._dirties[c]=!1};a._copyBits=function(a,b,c,f,g,e,h,q,n,p,y){var d=f*b+c;h=q*e+h;if(y)for(h-=
e,y=-1;y<=p;y++,d=((y+p)%p+f)*b+c,h+=e)for(q=-1;q<=n;q++)g[h+q]=a[d+(q+n)%n];else for(y=0;y<p;y++){for(q=0;q<n;q++)g[h+q]=a[d+q];d+=b;h+=e}};a.prototype._copy=function(b){if(!(b.page>=this._mosaicsData.length)){var d=b.spriteData,c=this._mosaicsData[b.page];c&&d||console.error("Source or target images are uninitialized!");a._copyBits(d,b.spriteSize[0],0,0,c,b.pageSize[0],b.rect.x+1,b.rect.y+1,b.spriteSize[0],b.spriteSize[1],b.repeat);this._dirties[b.page]=!0}};a.prototype._allocateImage=function(a,
c){a+=2;c+=2;var d=Math.max(a,c);if(this._maxItemSize&&this._maxItemSize<d){var d=Math.pow(2,Math.ceil(b.log2(a))),f=Math.pow(2,Math.ceil(b.log2(c)));a=new g.default(0,0,a,c);this._mosaicsData.push(new Uint32Array(d*f));this._dirties.push(!0);this._size.push([d,f]);this._textures.push(void 0);return[a,this._mosaicsData.length-1,[d,f]]}d=this._binPack.allocate(a,c);return 0>=d.width?(this._dirties[this._currentPage]||(this._mosaicsData[this._currentPage]=null),this._currentPage=this._mosaicsData.length,
this._mosaicsData.push(new Uint32Array(this._pageWidth*this._pageHeight)),this._dirties.push(!0),this._size.push([this._pageWidth,this._pageHeight]),this._textures.push(void 0),this._binPack=new m(this._pageWidth,this._pageHeight),this._allocateImage(a,c)):[d,this._currentPage,[this._pageWidth,this._pageHeight]]};a.prototype.dispose=function(){this._binPack=null;for(var a=0,b=this._textures;a<b.length;a++){var c=b[a];c&&c.dispose()}this._textures.length=0;this._mosaicsData.length=0;this._mosaicRects.clear()};
return a}()})},"esri/views/2d/engine/webgl/GeometryUtils":function(){define(["require","exports"],function(e,a){function c(a,c){a%=c;return 0<=a?a:a+c}Object.defineProperty(a,"__esModule",{value:!0});a.C_INFINITY=Number.POSITIVE_INFINITY;a.C_PI=Math.PI;a.C_2PI=2*a.C_PI;a.C_PI_BY_2=a.C_PI/2;a.C_RAD_TO_256=128/a.C_PI;a.C_256_TO_RAD=a.C_PI/128;a.C_DEG_TO_256=256/360;a.C_DEG_TO_RAD=a.C_PI/180;a.C_SQRT2=1.414213562;a.C_SQRT2_INV=1/a.C_SQRT2;var h=1/Math.LN2;a.positiveMod=c;a.radToByte=function(b){return c(b*
a.C_RAD_TO_256,256)};a.degToByte=function(b){return c(b*a.C_DEG_TO_256,256)};a.log2=function(a){return Math.log(a)*h};a.sqr=function(a){return a*a};a.interpolate=function(a,c,e){return a*(1-e)+c*e};a.between=function(a,c,e){return a>=c&&a<=e||a>=e&&a<=c}})},"esri/views/2d/engine/webgl/util/Result":function(){define(["require","exports","../../../../../core/Error"],function(e,a,c){Object.defineProperty(a,"__esModule",{value:!0});a.ok=function(a,b){return a&&"name"in a?(b&&b.error(new c(a.name,a.message,
a.details)),!1):!0}})},"esri/views/2d/engine/webgl/util/symbolUtils":function(){define(["require","exports"],function(e,a){function c(a){switch(a){case "esriSMS":return"simple-marker";case "esriPMS":return"picture-marker";case "esriSLS":return"simple-line";case "esriPLS":return"picture-line";case "esriSFS":return"simple-fill";case "esriPFS":return"picture-fill";case "esriTS":return"text"}return a}function h(a){if(a=c(a.type))switch(a){case "picture-marker":case "picture-line":case "picture-fill":return!0;
case "CIMPictureMarker":return!0}return!1}Object.defineProperty(a,"__esModule",{value:!0});a.keyFromSymbol=function(a){if(a.type){switch(c(a.type)){case "simple-marker":return a.path?"simple-marker"+a.style+a.path:"simple-marker"+a.style;case "simple-line":return"simple-line"+a.style+a.cap;case "simple-fill":return"simple-fill"+a.style}if(a.mosaicHash)return a.mosaicHash;if(h(a))return a.imageData?a.imageData:a.url+(""+a.width+a.height)}return JSON.stringify(a)};a.normalizeSymbolType=c;a.isMarkerSymbol=
function(a){if(a=c(a.type)){switch(a){case "simple-marker":case "picture-marker":return!0;case "CIMPointSymbol":return!0;case "CIMVectorMarker":case "CIMPictureMarker":case "CIMCharacterMarker":return!0}return!1}};a.isFillSymbol=function(a){if(a=c(a.type)){switch(a){case "simple-fill":case "picture-fill":return!0;case "CIMPolygonSymbol":return!0}return!1}};a.isLineSymbol=function(a){if(a=c(a.type)){switch(a){case "simple-line":case "picture-line":return!0;case "CIMLineSymbol":return!0}return!1}};
a.isPictureSymbol=h;a.isTextSymbol=function(a){if(a=c(a.type)){switch(a){case "text":return!0;case "CIMTextSymbol":return!0}return!1}}})},"esri/views/2d/engine/webgl/effects/AnimationEffect":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/maybe ../definitions ../VertexStream ./Effect".split(" "),function(e,a,c,h,b,g,m){Object.defineProperty(a,"__esModule",{value:!0});e=function(a){function d(){var b=null!==a&&a.apply(this,arguments)||this;b.defines=
[];b._desc={path:"fx/integrate",attributes:{a_position:0}};return b}c(d,a);d.prototype.dispose=function(){this._quad&&this._quad.dispose()};d.prototype.bind=function(){};d.prototype.unbind=function(){};d.prototype.draw=function(a,d){if(d.size){var c=a.context,f=a.renderingOptions;this._quad||(this._quad=new g(c,[0,0,1,0,0,1,1,1]));var l=c.getBoundFramebufferObject(),e=c.getViewport(),q=e.x,n=e.y,p=e.width,e=e.height;d.bindTextures(c);var y=d.getBlock(b.ATTRIBUTE_DATA_ANIMATION);if(!h.isNone(y)){var k=
y.getFBO(c),y=y.getFBO(c,1);c.setViewport(0,0,d.size,d.size);this._computeDelta(a,y,f.labelsAnimationTime);this._updateAnimationState(a,y,k);c.bindFramebuffer(l);c.setViewport(q,n,p,e)}}};d.prototype._computeDelta=function(a,d,c){var f=a.context,g=a.displayLevel,l=a.painter.materialManager.getProgram(a,this._desc,["delta"]);f.bindFramebuffer(d);f.setClearColor(0,0,0,0);f.clear(f.gl.COLOR_BUFFER_BIT);f.bindProgram(l);l.setUniform1i("u_maskTexture",b.TEXTURE_BINDING_ATTRIBUTE_DATA_0);l.setUniform1i("u_sourceTexture",
b.TEXTURE_BINDING_ATTRIBUTE_DATA_1);l.setUniform1f("u_timeDelta",a.timeDelta);l.setUniform1f("u_animationTime",c/1E3);l.setUniform1f("u_zoomLevel",Math.round(10*g));this._quad.draw()};d.prototype._updateAnimationState=function(a,b,d){var c=a.context;a=a.painter.materialManager.getProgram(a,this._desc,["update"]);c.bindTexture(b.colorTexture,1);c.bindProgram(a);a.setUniform1i("u_sourceTexture",1);c.bindFramebuffer(d);c.setClearColor(0,0,0,0);c.clear(c.gl.COLOR_BUFFER_BIT);this._quad.draw()};return d}(m.Effect);
a.AnimationEffect=e})},"esri/views/2d/engine/webgl/VertexStream":function(){define(["require","exports","../../../../core/tsSupport/declareExtendsHelper","../../../webgl"],function(e,a,c,h){return function(){function a(a,b){this.rctx=a;this._vertexBuffer=h.BufferObject.createVertex(a,35044,new Uint16Array(b));this._vao=new h.VertexArrayObject(a,{a_position:0},{geometry:[{name:"a_position",count:2,type:5123,offset:0,stride:4,normalized:!1}]},{geometry:this._vertexBuffer})}a.prototype.bind=function(){this._vao.bind()};
a.prototype.unbind=function(){this._vao.unbind()};a.prototype.dispose=function(){this._vao.dispose(!1);this._vertexBuffer.dispose()};a.prototype.draw=function(){this.rctx.bindVAO(this._vao);this.rctx.drawArrays(5,0,4)};return a}()})},"esri/views/2d/engine/webgl/effects/Effect":function(){define(["require","exports"],function(e,a){Object.defineProperty(a,"__esModule",{value:!0});e=function(){return function(){this.name=this.constructor.name}}();a.Effect=e})},"esri/views/2d/engine/webgl/effects/HighlightEffect":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/has ../BitBlitRenderer ../effects/Effect ./highlight/HighlightGradient ./highlight/HighlightRenderer ./highlight/HighlightSurfaces".split(" "),
function(e,a,c,h,b,g,m,f,d){Object.defineProperty(a,"__esModule",{value:!0});e=function(a){function g(){var c=null!==a&&a.apply(this,arguments)||this;c.defines=["highlight"];c._hlRenderer=new f.default;c._hlGradient=new m.default;c._width=void 0;c._height=void 0;c._hlSurfaces=new d.default;c._adjustedWidth=void 0;c._adjustedHeight=void 0;c._blitRenderer=new b.BitBlitRenderer;return c}c(g,a);g.prototype.dispose=function(){this._hlSurfaces&&this._hlSurfaces.dispose();this._hlRenderer&&this._hlRenderer.dispose();
this._hlGradient&&this._hlGradient.destroy();this._boundFBO=null};g.prototype.bind=function(a){var b=a.context,d=a.painter,c=b.getViewport(),f=c.width,c=c.height,d=d.getFbos(f,c).effect0;this.setup(a,f,c);b.bindFramebuffer(d);b.setClearColor(0,0,0,0);b.clear(b.gl.COLOR_BUFFER_BIT)};g.prototype.unbind=function(){};g.prototype.setup=function(a,b,d){a=a.context;this._width=b;this._height=d;var c=b%4,f=d%4;b+=2>c?-c:4-c;d+=2>f?-f:4-f;this._adjustedWidth=b;this._adjustedHeight=d;this._boundFBO=a.getBoundFramebufferObject();
b=Math.round(.75*b);d=Math.round(.75*d);this._hlRenderer.setup(a,b,d);this._hlSurfaces.setup(a,b,d)};g.prototype.draw=function(a){a=a.context;var b=a.getBoundFramebufferObject();a.setViewport(0,0,.75*this._adjustedWidth,.75*this._adjustedHeight);a.bindFramebuffer(this._hlSurfaces.sharedBlur1Fbo);a.setStencilTestEnabled(!1);a.setClearColor(0,0,0,0);a.clear(a.gl.COLOR_BUFFER_BIT);this._blitRenderer.render(a,b.colorTexture,9728,1);a.setStencilTestEnabled(!1);a.setBlendingEnabled(!1);a.bindFramebuffer(this._hlSurfaces.sharedBlur2Fbo);
a.setClearColor(0,0,0,0);a.clear(a.gl.COLOR_BUFFER_BIT);this._hlRenderer.preBlur(a,this._hlSurfaces.sharedBlur1Tex);a.bindFramebuffer(this._hlSurfaces.sharedBlur1Fbo);a.setClearColor(0,0,0,0);a.clear(a.gl.COLOR_BUFFER_BIT);this._hlRenderer.finalBlur(a,this._hlSurfaces.sharedBlur2Tex);a.bindFramebuffer(this._boundFBO);a.setBlendingEnabled(!0);a.setViewport(0,0,this._width,this._height);this._hlRenderer.renderHighlight(a,this._hlSurfaces.sharedBlur1Tex,this._hlGradient);this._boundFBO=null};g.prototype.setHighlightOptions=
function(a){this._hlGradient.setHighlightOptions(a)};return g}(g.Effect);a.default=e})},"esri/views/2d/engine/webgl/effects/highlight/HighlightGradient":function(){define("require exports ../../../../../../core/Logger ../../../../../webgl ../../definitions ./parameters".split(" "),function(e,a,c,h,b,g){function m(a,b){b.fillColor[0]=a.color.r/255;b.fillColor[1]=a.color.g/255;b.fillColor[2]=a.color.b/255;b.fillColor[3]=a.color.a;a.haloColor?(b.outlineColor[0]=a.haloColor.r/255,b.outlineColor[1]=a.haloColor.g/
255,b.outlineColor[2]=a.haloColor.b/255,b.outlineColor[3]=a.haloColor.a):(b.outlineColor[0]=b.fillColor[0],b.outlineColor[1]=b.fillColor[1],b.outlineColor[2]=b.fillColor[2],b.outlineColor[3]=b.fillColor[3]);b.fillColor[3]*=a.fillOpacity;b.outlineColor[3]*=a.haloOpacity;b.fillColor[0]*=b.fillColor[3];b.fillColor[1]*=b.fillColor[3];b.fillColor[2]*=b.fillColor[3];b.outlineColor[0]*=b.outlineColor[3];b.outlineColor[1]*=b.outlineColor[3];b.outlineColor[2]*=b.outlineColor[3];b.outlineWidth=g.HIGHLIGHT_SIZING.outlineWidth;
b.outerHaloWidth=g.HIGHLIGHT_SIZING.outerHaloWidth;b.innerHaloWidth=g.HIGHLIGHT_SIZING.innerHaloWidth;b.outlinePosition=g.HIGHLIGHT_SIZING.outlinePosition}Object.defineProperty(a,"__esModule",{value:!0});var f=c.getLogger("esri.views.2d.engine.webgl.painter.highlight.HighlightGradient"),d=[0,0,0,0];e=function(){function a(){this._convertedHighlightOptions={fillColor:[.2*.75,.6*.75,.675,.75],outlineColor:[.2*.9,.54,.81,.9],outlinePosition:g.HIGHLIGHT_SIZING.outlinePosition,outlineWidth:g.HIGHLIGHT_SIZING.outlineWidth,
innerHaloWidth:g.HIGHLIGHT_SIZING.innerHaloWidth,outerHaloWidth:g.HIGHLIGHT_SIZING.outerHaloWidth};this.shadeTexChanged=!0;this.texelData=new Uint8Array(4*g.SHADE_TEXTURE_SIZE);this.minMaxDistance=[0,0]}a.prototype.setHighlightOptions=function(a){function b(a,b,d){k[0]=(1-d)*a[0]+d*b[0];k[1]=(1-d)*a[1]+d*b[1];k[2]=(1-d)*a[2]+d*b[2];k[3]=(1-d)*a[3]+d*b[3]}var c,l=this._convertedHighlightOptions;m(a,l);a=l.outlinePosition-l.outlineWidth/2-l.outerHaloWidth;var e=l.outlinePosition-l.outlineWidth/2,h=
l.outlinePosition+l.outlineWidth/2,n=l.outlinePosition+l.outlineWidth/2+l.innerHaloWidth,p=Math.sqrt(Math.PI/2)*g.SIGMAS[3],y=Math.abs(a)>p?Math.round(10*(Math.abs(a)-p))/10:0,p=Math.abs(n)>p?Math.round(10*(Math.abs(n)-p))/10:0;y&&!p?f.error("The outer rim of the highlight is "+y+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards positive values (inwards)."):!y&&p?f.error("The inner rim of the highlight is "+p+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards negative values (outwards)."):
y&&p&&f.error("The highlight is "+Math.max(y,p)+"px away from the edge of the feature; consider reducing some width values.");for(var k=[void 0,void 0,void 0,void 0],y=this.texelData,p=0;p<g.SHADE_TEXTURE_SIZE;++p)c=a+p/(g.SHADE_TEXTURE_SIZE-1)*(n-a),c<a?(k[4*p+0]=0,k[4*p+1]=0,k[4*p+2]=0,k[4*p+3]=0):c<e?b(d,l.outlineColor,(c-a)/(e-a)):c<h?(c=l.outlineColor,k[0]=c[0],k[1]=c[1],k[2]=c[2],k[3]=c[3]):c<n?b(l.outlineColor,l.fillColor,(c-h)/(n-h)):(c=l.fillColor,k[4*p+0]=c[0],k[4*p+1]=c[1],k[4*p+2]=c[2],
k[4*p+3]=c[3]),y[4*p+0]=255*k[0],y[4*p+1]=255*k[1],y[4*p+2]=255*k[2],y[4*p+3]=255*k[3];this.minMaxDistance[0]=a;this.minMaxDistance[1]=n;this.shadeTexChanged=!0};a.prototype.applyHighlightOptions=function(a,d){this.shadeTex||(this.shadeTex=new h.Texture(a,{target:3553,pixelFormat:6408,dataType:5121,wrapMode:33071,width:g.SHADE_TEXTURE_SIZE,height:1,samplingMode:9729}));this.shadeTexChanged&&(this.shadeTex.updateData(0,0,0,g.SHADE_TEXTURE_SIZE,1,this.texelData),this.shadeTexChanged=!1);a.bindTexture(this.shadeTex,
b.TEXTURE_BINDING_HIGHLIGHT_1);d.setUniform2fv("u_minMaxDistance",this.minMaxDistance)};a.prototype.destroy=function(){this.shadeTex&&(this.shadeTex.dispose(),this.shadeTex=null)};return a}();a.default=e})},"esri/views/2d/engine/webgl/effects/highlight/parameters":function(){define(["require","exports"],function(e,a){Object.defineProperty(a,"__esModule",{value:!0});a.SIGMAS=[void 0,void 0,void 0,1];a.ALPHA_TO_RGBA_CHANNEL_SELECTOR_MATRIX=[0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1];a.RGBA_TO_RGBA_CHANNEL_SELECTOR_MATRIX=
[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];a.SHADE_TEXTURE_SIZE=256;a.HIGHLIGHT_SIZING={outlineWidth:.7,outerHaloWidth:.7,innerHaloWidth:.7,outlinePosition:0}})},"esri/views/2d/engine/webgl/effects/highlight/HighlightRenderer":function(){define("require exports ../../../../../webgl ../../definitions ./parameters ../../shaders/HighlightPrograms".split(" "),function(e,a,c,h,b,g){Object.defineProperty(a,"__esModule",{value:!0});e=function(){function a(){this._height=this._width=void 0;this._resources=null}a.prototype.dispose=
function(){this._resources&&(this._resources.quadGeometry.dispose(),this._resources.quadVAO.dispose(),this._resources.highlightProgram.dispose(),this._resources.blurProgram.dispose(),this._resources=null)};a.prototype.preBlur=function(a,d){a.bindTexture(d,h.TEXTURE_BINDING_HIGHLIGHT_0);a.bindProgram(this._resources.blurProgram);this._resources.blurProgram.setUniform4fv("u_direction",[1,0,1/this._width,0]);this._resources.blurProgram.setUniformMatrix4fv("u_channelSelector",b.ALPHA_TO_RGBA_CHANNEL_SELECTOR_MATRIX);
a.bindVAO(this._resources.quadVAO);a.drawArrays(5,0,4);a.bindVAO()};a.prototype.finalBlur=function(a,d){a.bindTexture(d,h.TEXTURE_BINDING_HIGHLIGHT_0);a.bindProgram(this._resources.blurProgram);this._resources.blurProgram.setUniform4fv("u_direction",[0,1,0,1/this._height]);this._resources.blurProgram.setUniformMatrix4fv("u_channelSelector",b.RGBA_TO_RGBA_CHANNEL_SELECTOR_MATRIX);a.bindVAO(this._resources.quadVAO);a.drawArrays(5,0,4);a.bindVAO()};a.prototype.renderHighlight=function(a,b,c){a.bindTexture(b,
h.TEXTURE_BINDING_HIGHLIGHT_0);a.bindProgram(this._resources.highlightProgram);c.applyHighlightOptions(a,this._resources.highlightProgram);a.bindVAO(this._resources.quadVAO);a.setBlendingEnabled(!0);a.setBlendFunction(1,771);a.drawArrays(5,0,4);a.bindVAO()};a.prototype._initialize=function(a,d,l){this._width=d;this._height=l;d=new c.BufferObject(a,34962,35044,(new Int8Array([-1,-1,0,0,1,-1,1,0,-1,1,0,1,1,1,1,1])).buffer);l=new c.VertexArrayObject(a,{a_position:0,a_texcoord:1},{geometry:[{name:"a_position",
count:2,type:5120,offset:0,stride:4,normalized:!1},{name:"a_texcoord",count:2,type:5121,offset:2,stride:4,normalized:!1}]},{geometry:d});var f=c.createProgram(a,g.highlight);a=c.createProgram(a,g.blur);f.setUniform1i("u_texture",h.TEXTURE_BINDING_HIGHLIGHT_0);f.setUniform1i("u_shade",h.TEXTURE_BINDING_HIGHLIGHT_1);f.setUniform4fv("u_sigmas",b.SIGMAS);a.setUniform1i("u_texture",h.TEXTURE_BINDING_HIGHLIGHT_0);a.setUniform4fv("u_sigmas",b.SIGMAS);this._resources={quadGeometry:d,quadVAO:l,highlightProgram:f,
blurProgram:a}};a.prototype.setup=function(a,b,c){this._resources?(this._width=b,this._height=c):this._initialize(a,b,c)};return a}();a.default=e})},"esri/views/2d/engine/webgl/shaders/HighlightPrograms":function(){define(["require","exports","./sources/resolver"],function(e,a,c){Object.defineProperty(a,"__esModule",{value:!0});a.highlight={name:"highlight",shaders:{vertexShader:c.resolveIncludes("highlight/textured.vert"),fragmentShader:c.resolveIncludes("highlight/highlight.frag")},attributes:{a_position:0,
a_texcoord:1}};a.blur={name:"blur",shaders:{vertexShader:c.resolveIncludes("highlight/textured.vert"),fragmentShader:c.resolveIncludes("highlight/blur.frag")},attributes:{a_position:0,a_texcoord:1}}})},"esri/views/2d/engine/webgl/effects/highlight/HighlightSurfaces":function(){define(["require","exports","../../../../../webgl"],function(e,a,c){function h(a,g,e){g=new c.Texture(a,{target:3553,pixelFormat:6408,dataType:5121,wrapMode:33071,width:g,height:e,samplingMode:9729});a=new c.FramebufferObject(a,
{colorTarget:0,depthStencilTarget:2},g);return[g,a]}Object.defineProperty(a,"__esModule",{value:!0});e=function(){function a(){this._height=this._width=void 0;this._resources=null}a.prototype.dispose=function(){this._resources&&(this._resources.sharedBlur1Tex.dispose(),this._resources.sharedBlur1Fbo.dispose(),this._resources.sharedBlur2Tex.dispose(),this._resources.sharedBlur2Fbo.dispose(),this._resources=null)};a.prototype._initialize=function(a,b,c){this._width=b;this._height=c;var d=h(a,b,c),f=
d[0],d=d[1];a=h(a,b,c);this._resources={sharedBlur1Tex:f,sharedBlur1Fbo:d,sharedBlur2Tex:a[0],sharedBlur2Fbo:a[1]}};a.prototype.setup=function(a,b,c){!this._resources||this._width===b&&this._height===c||this.dispose();this._resources||this._initialize(a,b,c)};Object.defineProperty(a.prototype,"sharedBlur1Tex",{get:function(){return this._resources.sharedBlur1Tex},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"sharedBlur1Fbo",{get:function(){return this._resources.sharedBlur1Fbo},
enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"sharedBlur2Tex",{get:function(){return this._resources.sharedBlur2Tex},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"sharedBlur2Fbo",{get:function(){return this._resources.sharedBlur2Fbo},enumerable:!0,configurable:!0});return a}();a.default=e})},"esri/views/2d/engine/webgl/effects/HittestEffect":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/iteratorUtils ../../../../../core/maybe ../definitions ./Effect".split(" "),
function(e,a,c,h,b,g,m){Object.defineProperty(a,"__esModule",{value:!0});e=function(a){function d(){var b=null!==a&&a.apply(this,arguments)||this;b.name=b.constructor.name;b.defines=["id"];b._buf=new Uint8Array(4*g.HITTEST_SEARCH_SIZE*g.HITTEST_SEARCH_SIZE);b._buf32=new Uint32Array(b._buf.buffer);return b}c(d,a);d.prototype.dispose=function(){b.isSome(this._fbo)&&this._fbo.dispose()};d.prototype.bind=function(a){var b=a.context;a=a.painter;var d=b.getViewport();a=a.getFbos(d.width,d.height).effect0;
b.bindFramebuffer(a);b.setClearColor(0,0,0,0);b.clear(b.gl.COLOR_BUFFER_BIT)};d.prototype.unbind=function(){};d.prototype.draw=function(a,b,d){var c=this,f=a.context,l=a.state,e=a.pixelRatio;void 0===d&&(d=g.HITTEST_SEARCH_SIZE);var n=f.getBoundFramebufferObject(),p=l.size[1],y=d/2,k=d/2;b.forEach(function(a,f){var g=new Map;n.readPixels(Math.floor((f[0]-d/2)*e),Math.floor((p-f[1]-d/2)*e),d,d,6408,5121,c._buf);for(var l=0;l<c._buf32.length;l++){var w=c._buf32[l];if(4294967295!==w&&0!==w){var q=l%
d,m=d-Math.floor(l/d),q=(y-q)*(y-q)+(k-m)*(k-m),m=g.has(w)?g.get(w):4294967295;g.set(w,Math.min(q,m))}}g=h.pairsOfMap(g).sort(function(a,b){return a[1]-b[1]}).map(function(a){return a[0]});a.resolve(g);b.delete(f)})};return d}(m.Effect);a.HittestEffect=e})},"esri/views/2d/engine/webgl/painter/RenderPass":function(){define("require exports @dojo/framework/shim/iterator ../../../../../core/has ../../../../../core/maybe ../enums".split(" "),function(e,a,c,h,b,g){Object.defineProperty(a,"__esModule",
{value:!0});e=function(){function a(a,b){this.brushes=a;this.name=b.name;this.drawPhase=b.drawPhase||g.WGLDrawPhase.MAP;this._targetFn=b.target;this.effects=b.effects||[];this.has=b.has}a.prototype.render=function(a){var b=a.context,c=a.profiler,f=this._targetFn(),g=this.drawPhase&a.drawPhase;c.recordPassStart(this.name);if(g&&(!this.has||h(this.has))){this._doRender(a,f);c.recordPassEnd();for(var g=0,e=this.effects;g<e.length;g++){var m=e[g];if(m.enable()){var u=m.apply;c.recordPassStart(this.name+
"."+u.name);c.recordBrushStart(u.name);var m=m.args&&m.args(),q=b.getViewport(),n=q.x,p=q.y,y=q.width,q=q.height,k=b.getBoundFramebufferObject();u.bind(a,m);this._doRender(a,f,u.defines);u.draw(a,m);u.unbind(a,m);b.bindFramebuffer(k);b.setViewport(n,p,y,q);c.recordBrushEnd();c.recordPassEnd()}}}};a.prototype._doRender=function(a,d,g){if(!b.isNone(d))if(c.isArrayLike(d))for(var f=0;f<d.length;f++){var e=d[f];if(e.isReady&&e.visible)for(var l=0,h=this.brushes;l<h.length;l++){var m=h[l];a.profiler.recordBrushStart(m.name);
m.prepareState(a,e,g);m.draw(a,e,g);a.profiler.recordBrushEnd()}}else for(f=0,e=this.brushes;f<e.length;f++)m=e[f],a.profiler.recordBrushStart(m.name),m.prepareState(a,d,g),m.draw(a,d,g),a.profiler.recordBrushEnd()};return a}();a.default=e})},"esri/views/2d/engine/webgl/Profiler":function(){define("require exports ../../../../core/CircularArray ../../../../core/Evented ../../../../core/has ../../../../core/maybe ../../../webgl/capabilities/DisjointTimerQuery".split(" "),function(e,a,c,h,b,g,m){Object.defineProperty(a,
"__esModule",{value:!0});var f=b("esri-2d-profiler");e=function(){function a(a,b){var d=this;this._events=new h;this._entries=new Map;this._timings=new c.default(10);if(f){this._ext=m.load(a.gl,{});this._debugOutput=b;var g=a.gl;if(this.enableCommandLogging){a=function(a){if("function"===typeof g[a]){var b=g[a],c=-1!==a.indexOf("draw");g[a]=function(){for(var f=[],e=0;e<arguments.length;e++)f[e]=arguments[e];d._events.emit("command",{container:d._currentContainer,pass:d._currentPass,brush:d._currentBrush,
method:a,args:f,isDrawCommand:c});d._currentSummary&&(d._currentSummary.commands++,c&&d._currentSummary.drawCommands++);return b.apply(g,f)}}};for(var e in g)a(e)}}}Object.defineProperty(a.prototype,"enableCommandLogging",{get:function(){return!("object"===typeof f&&f.disableCommands)},enumerable:!0,configurable:!0});a.prototype.recordContainerStart=function(a){f&&(this._currentContainer=a)};a.prototype.recordContainerEnd=function(){f&&(this._currentContainer=null)};a.prototype.recordPassStart=function(a){f&&
(this._currentPass=a,this._initSummary())};a.prototype.recordPassEnd=function(){f&&(this._currentPass=null,this._emitSummary())};a.prototype.recordBrushStart=function(a){f&&(this._currentBrush=a)};a.prototype.recordBrushEnd=function(){f&&(this._currentBrush=null)};a.prototype.recordStart=function(a){if(f&&g.isSome(this._ext)){if(this._entries.has(a)){var b=this._entries.get(a),d=this._ext.resultAvailable(b.query),c=this._ext.disjoint();if(d&&!c){d=this._ext.getResult(b.query)/1E6;c=0;if(g.isSome(this._timings.enqueue(d))){for(var c=
this._timings.entries,e=c.length,l=0,h=0;h<c.length;h++)l+=c[h];c=l/e}d=d.toFixed(2);c=c?c.toFixed(2):"--";this.enableCommandLogging?(console.groupCollapsed("Frame report for "+a+", "+d+" ms ("+c+" last 10 avg)\n"+b.commandsLen+" Commands ("+b.drawCommands+" draw)"),console.log("RenderPass breakdown: "),console.table(b.summaries),console.log("Commands: ",b.commands),console.groupEnd()):console.log("Frame report for "+a+", "+d+" ms ("+c+" last 10 avg)");this._debugOutput.innerHTML=d+" ("+c+")"}d=0;
for(b=b.handles;d<b.length;d++)b[d].remove();this._entries.delete(a)}var n={name:a,query:this._ext.createQuery(),commands:[],commandsLen:0,drawCommands:0,summaries:[],handles:[]};this.enableCommandLogging&&(n.handles.push(this._events.on("command",function(a){n.commandsLen++;n.commands.push(a);a.isDrawCommand&&n.drawCommands++})),n.handles.push(this._events.on("summary",function(a){delete a.target;n.summaries.push(a)})));this._ext.beginTimeElapsed(n.query);this._entries.set(a,n)}};a.prototype.recordEnd=
function(a){f&&g.isSome(this._ext)&&this._entries.has(a)&&this._ext.endTimeElapsed()};a.prototype._initSummary=function(){this.enableCommandLogging&&(this._currentSummary={container:this._currentContainer,pass:this._currentPass,drawCommands:0,commands:0})};a.prototype._emitSummary=function(){this.enableCommandLogging&&this._events.emit("summary",this._currentSummary)};return a}();a.Profiler=e})},"esri/core/CircularArray":function(){define(["require","exports"],function(e,a){Object.defineProperty(a,
"__esModule",{value:!0});e=function(){function a(a){this._start=this.size=0;this.maxSize=a;this._buffer=Array(a)}Object.defineProperty(a.prototype,"entries",{get:function(){return this._buffer},enumerable:!0,configurable:!0});a.prototype.enqueue=function(a){if(this.size===this.maxSize){var b=this._buffer[this._start];this._buffer[this._start]=a;this._start=(this._start+1)%this.maxSize;return b}this._buffer[(this._start+this.size++)%this.maxSize]=a;return null};a.prototype.dequeue=function(){if(0===
this.size)return null;var a=this._buffer[this._start];this._buffer[this._start]=null;this.size--;this._start=(this._start+1)%this.maxSize;return a};return a}();a.default=e})},"esri/views/2d/engine/webgl/WebGLDriverTest":function(){define("require exports ../../../../core/Logger ../../../../core/maybe ../../../webgl ./VertexStream".split(" "),function(e,a,c,h,b,g){Object.defineProperty(a,"__esModule",{value:!0});var m=c.getLogger("esri.views.2d.engine.webgl.WebGLDriverTest"),f=function(){function b(a){this._ignoresSamplerPrecision=
null;this._context=a}Object.defineProperty(b.prototype,"ignoresSamplerPrecision",{get:function(){h.isNone(this._ignoresSamplerPrecision)&&(this._ignoresSamplerPrecision=a.testSamplerPrecision(this._context));return this._ignoresSamplerPrecision},enumerable:!0,configurable:!0});return b}();a.testWebGLDriver=function(a){return new f(a)};a.testSamplerPrecision=function(a){var d=new b.FramebufferObject(a,{colorTarget:0,depthStencilTarget:0},{target:3553,wrapMode:33071,pixelFormat:6408,dataType:5121,samplingMode:9728,
width:1,height:1}),c=new Uint8Array(4),f=new g(a,[0,0,1,0,0,1,1,1]),e=new b.Program(a,"\nprecision highp float;\n\nattribute vec2 a_pos;\n\nuniform highp sampler2D u_texture;\nvarying vec4 v_color;\n\nfloat getBit(in float bitset, in int bitIndex) {\n  float offset \x3d pow(2.0, float(bitIndex));\n\n  return mod(floor(bitset / offset), 2.0);\n}\n\nvoid main() {\n  vec4 value \x3d texture2D(u_texture, vec2(0.0));\n\n  float bit \x3d getBit(value.x * 255.0, 1);\n\n  v_color \x3d bit * vec4(1.0);\n\n  gl_Position \x3d vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\n}\n",
"\nprecision highp float;\n\nvarying vec4 v_color;\n\nvoid main() {\n  gl_FragColor \x3d v_color;\n}\n",{a_pos:0}),h=new b.Texture(a,{target:3553,wrapMode:33071,pixelFormat:6408,dataType:5121,samplingMode:9728,width:1,height:1},new Uint8Array([2,255,0,0]));e.setUniform1i("u_texture",0);a.bindTexture(h,0);a.bindFramebuffer(d);a.bindProgram(e);var u=a.getViewport(),h=u.x,q=u.y,n=u.width,u=u.height;a.setViewport(0,0,1,1);f.draw();a.setViewport(h,q,n,u);d.readPixels(0,0,1,1,6408,5121,c);e.dispose();f.dispose();
d.dispose();(a=255!==c[0]||255!==c[1]||255!==c[2]||255!==c[3])&&m.warn("A problem was detected with your graphics driver. Your driver does not appear to honor sampler precision specifiers, which may result in rendering issues due to numerical instability. We recommend ensuring that your drivers have been updated to the latest version. Applying lowp sampler workaround. ["+c[0]+"."+c[1]+"."+c[2]+"."+c[3]+"]");return a}})},"esri/views/2d/engine/webgl/shaders/StencilPrograms":function(){define(["require",
"exports","./sources/resolver"],function(e,a,c){Object.defineProperty(a,"__esModule",{value:!0});a.stencil={name:"stencil",shaders:{vertexShader:c.resolveIncludes("stencil/stencil.vert"),fragmentShader:c.resolveIncludes("stencil/stencil.frag")},attributes:{a_pos:0}}})},"esri/views/2d/engine/webgl/AttributeStoreView":function(){define("require exports ../../../../core/tsSupport/generatorHelper ../../../../core/tsSupport/awaiterHelper ../../../../core/Error ../../../../core/has ../../../../core/Logger ../../../../core/maybe ../../../../core/promiseUtils ../../../webgl ./definitions ./Utils ./util/debug ../../../webgl/FramebufferObject".split(" "),
function(e,a,c,h,b,g,m,f,d,l,z,v,A,x){Object.defineProperty(a,"__esModule",{value:!0});var u=m.getLogger("esri.views.2d.engine.webgl.AttributeStoreView"),q=A.createDebugLogger(A.DEBUG_ATTR_UPDATES,u),n=function(){function a(a,b,d){this._lastTexture=this._texture=null;this._fbos={};this.texelSize=4;var c=a.buffer,g=a.pixelType;a=a.textureOnly;var k=v.getPixelArrayCtor(g);this.shared=d;this.pixelType=g;this.size=b;this.textureOnly=a;a||(this.data=new k(f.expect(c)));this._resetRange()}a.prototype.destroy=
function(){f.andThen(this._texture,function(a){return a.dispose()});var a=function(a){f.andThen(b._fbos[a],function(b){"0"===a&&b.detachColorTexture();b.dispose()});b._fbos[a]=null},b=this,d;for(d in this._fbos)a(d);this._texture=null};Object.defineProperty(a.prototype,"_textureDesc",{get:function(){return{target:3553,wrapMode:33071,pixelFormat:6408,dataType:this.pixelType,samplingMode:9728,width:this.size,height:this.size}},enumerable:!0,configurable:!0});a.prototype.setData=function(a,b,d){a&=2147483647;
var c=f.expect(this.data);b=a*this.texelSize+b;!c||b>=c.length||(c[b]=d,this.dirtyStart=Math.min(this.dirtyStart,a),this.dirtyEnd=Math.max(this.dirtyEnd,a))};a.prototype.getData=function(a,b){if(f.isNone(this.data))return null;a=(a&2147483647)*this.texelSize+b;return!this.data||a>=this.data.length?null:this.data[a]};a.prototype.getTexture=function(a){var b=this;return f.unwrapOr(this._texture,function(){return b._initTexture(a)})};a.prototype.getFBO=function(a,b){void 0===b&&(b=0);if(f.isNone(this._fbos[b])){var d=
0===b?this.getTexture(a):this._textureDesc;this._fbos[b]=new x(a,{colorTarget:0,depthStencilTarget:0},d)}return this._fbos[b]};Object.defineProperty(a.prototype,"locked",{get:function(){return 5121===this.pixelType&&this.shared&&!this.textureOnly&&g("esri-atomics")&&this.data?1===Atomics.load(this.data,0):!1},enumerable:!0,configurable:!0});a.prototype.updateTexture=function(a){if(!this.locked)try{var d=this.dirtyStart,c=this.dirtyEnd;if(!(d>c)){this._resetRange();var g=f.expect(this.data).buffer,
e=this.getTexture(a),l=(d-d%this.size)/this.size,h=(c-c%this.size)/this.size,n=l*this.size*4,q=4*(this.size+h*this.size)-n,m=v.getPixelArrayCtor(this.pixelType),p=m.BYTES_PER_ELEMENT;try{new m(g,n*p,q)}catch(I){console.debug(I)}var y=new m(g,n*p,q),x=this.size;a=h-l+1;a>this.size?u.error(new b("mapview-webgl","Out-of-bounds index when updating AttributeData")):e.updateData(0,0,l,x,a,y)}}catch(I){console.debug(I)}};a.prototype.update=function(a){var b=a.data,d=a.start,c=a.end;if(f.isSome(b))for(var g=
this.data,e=d*this.texelSize,l=0;l<b.length;l++)a.layout&1<<l%this.texelSize&&(g[e+l]=b[l]);this.dirtyStart=Math.min(this.dirtyStart,d);this.dirtyEnd=Math.max(this.dirtyEnd,c)};a.prototype.resize=function(a,b){var d=this.size;this.size=b;this.textureOnly?d!==this.size&&(this._lastTexture=this._texture,this._texture=null):(b=v.getPixelArrayCtor(this.pixelType),this.destroy(),this.data=new b(f.expect(a.buffer)))};a.prototype._resetRange=function(){this.dirtyStart=2147483647;this.dirtyEnd=0};a.prototype._initTexture=
function(a){var b=new l.Texture(a,this._textureDesc,f.unwrapOr(this.data,void 0));if(f.isSome(this._lastTexture)&&this._fbos[0]){var d=this._lastTexture.descriptor.width,c=this._lastTexture.descriptor.height,g=this._lastTexture.descriptor.dataType,e=this._lastTexture.descriptor.pixelFormat,h=this.getFBO(a),n=v.getPixelBytes(g),q=v.getPixelArrayCtor(g),n=new ArrayBuffer(d*c*n*this.texelSize),q=new q(n),n=a.getBoundFramebufferObject(),m=a.getViewport(),p=m.x,y=m.y,u=m.width,m=m.height;a.bindFramebuffer(h);
h.readPixels(0,0,d,c,e,g,q);b.updateData(0,0,0,2*d,c/2,q);a.setViewport(p,y,u,m);a.bindFramebuffer(n)}this.destroy();return this._texture=b};return a}();e=function(){function a(){this._locked=this._forceNextUpload=this._initialized=!1}a.prototype.initialize=function(a){var b=a.blocks,d=a.shared,c=a.size;this.shared=d;this.size=c;q("Initializing AttributeStoreView",a);if(f.isNone(this._data))this._data=f.mapMany(b,function(a){return new n(a,c,d)});else for(a=0;a<this._data.length;a++){var g=this._data[a],
e=b[a];f.isSome(e)&&(f.isNone(g)?this._data[a]=new n(e,c,d):g.resize(e,c))}this._initialized=!0};a.prototype.destroy=function(){f.andThen(this._data,function(a){return f.mapMany(a,function(a){return a.destroy()})});f.andThen(this._defaultTexture,function(a){return a.dispose()})};a.prototype.getBlock=function(a){return f.isNone(this._data)?null:this._data[a]};a.prototype.setLabelMinZoom=function(a,b){this.setData(a,0,1,b)};a.prototype.getLabelMinZoom=function(a){return this.getData(a,0,1,255)};a.prototype.getFilterFlags=
function(a){return this.getData(a,0,0,0)};a.prototype.getVVSize=function(a){return this.getData(a,z.ATTRIBUTE_DATA_VV,0,0)};a.prototype.getData=function(a,b,d,c){if(!this._data)return 0;b=f.expect(this._data)[b];if(f.isNone(b))return 0;a=b.getData(a,d);return f.isSome(a)?a:c};a.prototype.setData=function(a,b,d,c){b=f.expect(this._data)[b];f.expect(b).setData(a,d,c)};a.prototype.lockTextureUpload=function(){this._locked=!0};a.prototype.unlockTextureUpload=function(){this._locked=!1};a.prototype.forceTextureUpload=
function(){this._forceNextUpload=!0};a.prototype.requestUpdate=function(a){return h(this,void 0,void 0,function(){var f;return c(this,function(c){if(this._pendingAttributeUpdate)return u.error(new b("mapview-webgl","Tried to update attribute data with a pending update")),[2];f=d.createResolver();q("AttributeStoreView Update Requested",a);this._pendingAttributeUpdate={data:a,resolver:f};return[2,f.promise]})})};a.prototype.update=function(){if(this._initialized&&f.isSome(this._pendingAttributeUpdate)){for(var a=
this._pendingAttributeUpdate,b=a.data,a=a.resolver,d=f.expect(this._data),c=function(a){var c=b.blocks[a];f.andThen(d[a],function(b){return f.andThen(c,function(d){q("Updating block "+a,d);b.update(d)})})},g=0;g<b.blocks.length;g++)c(g);this._pendingAttributeUpdate=null;a()}};a.prototype.bindTextures=function(a){this.update();var b=this._getDefaultTexture(a);if(this._initialized){var d=f.expect(this._data);if(!this._locked||this._forceNextUpload)f.forEachSome(d,function(b){return b.updateTexture(a)}),
this._forceNextUpload=!1;a.bindTexture(f.mapOr(d[0],b,function(b){return b.getTexture(a)}),z.TEXTURE_BINDING_ATTRIBUTE_DATA_0);a.bindTexture(f.mapOr(d[1],b,function(b){return b.getTexture(a)}),z.TEXTURE_BINDING_ATTRIBUTE_DATA_1);a.bindTexture(f.mapOr(d[2],b,function(b){return b.getTexture(a)}),z.TEXTURE_BINDING_ATTRIBUTE_DATA_2);a.bindTexture(f.mapOr(d[3],b,function(b){return b.getTexture(a)}),z.TEXTURE_BINDING_ATTRIBUTE_DATA_3)}else a.bindTexture(b,z.TEXTURE_BINDING_ATTRIBUTE_DATA_0),a.bindTexture(b,
z.TEXTURE_BINDING_ATTRIBUTE_DATA_1),a.bindTexture(b,z.TEXTURE_BINDING_ATTRIBUTE_DATA_2),a.bindTexture(b,z.TEXTURE_BINDING_ATTRIBUTE_DATA_3)};a.prototype._getDefaultTexture=function(a){f.isNone(this._defaultTexture)&&(this._defaultTexture=new l.Texture(a,{wrapMode:33071,pixelFormat:6408,dataType:5121,samplingMode:9728,width:1,height:1},new Uint8Array(4)));return this._defaultTexture};return a}();a.AttributeStoreView=e})},"esri/views/2d/engine/webgl/Utils":function(){define("require exports ../../../../core/tsSupport/assignHelper ../../../../core/Error ../../../../core/Logger ../../../../core/mathUtils ../../../../core/screenUtils ../../../../symbols/cim/enums ../../../webgl ./color ./enums ./SymbolProperties".split(" "),
function(e,a,c,h,b,g,m,f,d,l,z,v){function A(a){for(var b={},d=0;d<a.length;d++){var c=a[d];b[c.name]=c.strideInBytes}return b}function x(a){switch(a){case z.WGLGeometryType.MARKER:return C;case z.WGLGeometryType.FILL:return w;case z.WGLGeometryType.LINE:return B;case z.WGLGeometryType.TEXT:return E;case z.WGLGeometryType.LABEL:return G}return null}function u(a){switch(a%4){case 0:case 2:return 4;case 1:case 3:return 1}}function q(a){return"string"===typeof a}function n(a){switch(a){case 5120:case 5121:return 1;
case 5122:case 5123:return 2;case 5126:case 5124:case 5125:return 4}}function p(a){var b={},d=function(d){var f=0;b[d]=a[d].map(function(a){var b=c({},a,{normalized:a.normalized||!1,divisor:a.divisor||0,offset:f,stride:0});f+=a.count*n(a.type);return b});b[d].forEach(function(a){return a.stride=f})},f;for(f in a)d(f);return b}Object.defineProperty(a,"__esModule",{value:!0});var y,k=b.getLogger("esri.views.2d.engine.webgl.Utils");a.C_VBO_GEOMETRY="geometry";a.C_VBO_PERINSTANCE="per_instance";a.C_VBO_PERINSTANCE_VV=
"per_instance_vv";a.C_ICON_VERTEX_DEF=[{name:a.C_VBO_GEOMETRY,strideInBytes:32,divisor:0}];a.C_FILL_VERTEX_DEF=[{name:a.C_VBO_GEOMETRY,strideInBytes:32,divisor:0}];a.C_FILL_VERTEX_DEF_DD=[{name:a.C_VBO_GEOMETRY,strideInBytes:12,divisor:0}];a.C_LINE_VERTEX_DEF=[{name:a.C_VBO_GEOMETRY,strideInBytes:36,divisor:0}];a.C_TEXT_VERTEX_DEF=[{name:a.C_VBO_GEOMETRY,strideInBytes:24,divisor:0}];a.C_LABEL_VERTEX_DEF=[{name:a.C_VBO_GEOMETRY,strideInBytes:28,divisor:0}];a.C_ICON_STRIDE_SPEC=A(a.C_ICON_VERTEX_DEF);
a.C_FILL_STRIDE_SPEC=A(a.C_FILL_VERTEX_DEF);a.C_FILL_STRIDE_SPEC_DD=A(a.C_FILL_VERTEX_DEF_DD);a.C_LINE_STRIDE_SPEC=A(a.C_LINE_VERTEX_DEF);a.C_TEXT_STRIDE_SPEC=A(a.C_TEXT_VERTEX_DEF);a.C_LABEL_STRIDE_SPEC=A(a.C_LABEL_VERTEX_DEF);a.getStrides=function(b,d){switch(b){case z.WGLGeometryType.MARKER:return a.C_ICON_STRIDE_SPEC;case z.WGLGeometryType.FILL:return d?a.C_FILL_STRIDE_SPEC_DD:a.C_FILL_STRIDE_SPEC;case z.WGLGeometryType.LINE:return a.C_LINE_STRIDE_SPEC;case z.WGLGeometryType.TEXT:return a.C_TEXT_STRIDE_SPEC;
case z.WGLGeometryType.LABEL:return a.C_LABEL_STRIDE_SPEC}return null};var C=[a.C_VBO_GEOMETRY],w=[a.C_VBO_GEOMETRY],B=[a.C_VBO_GEOMETRY],E=[a.C_VBO_GEOMETRY],G=[a.C_VBO_GEOMETRY];a.getNamedBuffers=x;a.strideToPackingFactor=u;a.allocateTypedArrayBuffer=function(a,b){switch(b%4){case 0:case 2:return new Uint32Array(Math.floor(a*b/4));case 1:case 3:return new Uint8Array(a*b)}};a.allocateTypedArrayBufferwithData=function(a,b){switch(b%4){case 0:case 2:return new Uint32Array(a);case 1:case 3:return new Uint8Array(a)}};
a.getTextProperties=function(a){return v.TextProperties.pool.acquire(a.color?l.copyAndPremultiply(a.color):[255,255,255,255],a.haloColor?l.copyAndPremultiply(a.haloColor):[255,255,255,255],m.pt2px(a.haloSize),m.pt2px(a.font.size),a.angle*Math.PI/180,a.xoffset/a.font.size,a.yoffset/a.font.size,"left"===a.horizontalAlignment?0:"right"===a.horizontalAlignment?1:.5,"top"===a.verticalAlignment?0:"bottom"===a.verticalAlignment?1:.5)};a.isDefined=function(a){return null!=a};a.isNumber=function(a){return"number"===
typeof a};a.isString=q;a.isStringOrNull=function(a){return null==a||q(a)};a.getCapType=function(a,b){switch(a){case "butt":return f.CapType.BUTT;case "round":return b?f.CapType.SQUARE:f.CapType.ROUND;case "square":return f.CapType.SQUARE;default:return k.error(new h("mapview-invalid-type","Cap type "+a+" is not a valid option. Defaulting to round")),f.CapType.ROUND}};a.getJoinType=function(a){switch(a){case "miter":return f.JoinType.MITER;case "bevel":return f.JoinType.BEVEL;case "round":return f.JoinType.ROUND;
default:return k.error(new h("mapview-invalid-type","Join type "+a+" is not a valid option. Defaulting to round")),f.JoinType.ROUND}};a.getVVType=function(a){switch(a){case "opacity":return z.VVType.OPACITY;case "color":return z.VVType.COLOR;case "rotation":return z.VVType.ROTATION;case "size":return z.VVType.SIZE;default:return k.error("Cannot interpret unknown vv: "+a),null}};a.getTransformParams=function(a){return{transform:a.transform,hasZ:a.hasZ,hasM:a.hasM}};a.copyMeshData=function(a,b,d,c,
f,g,k){for(var e in g)for(var l=g[e].stride,h=u(l),w=g[e].data,n=d[e].data,q=l*f.vertexCount/h,m=l*a/h,h=l*f.vertexFrom/h,l=0;l<q;++l)n[l+m]=w[l+h];d=f.indexCount;for(l=0;l<d;++l)c[l+b]=k[l+f.indexFrom]-f.vertexFrom+a};a.C_VBO_INFO=(y={},y[a.C_VBO_GEOMETRY]=35044,y);a.createGeometryData=function(a,b){for(var d=[],c=0;5>c;++c){for(var f={},g=0,k=x(c);g<k.length;g++){var e=k[g];f[e]={data:b(c,e)}}d.push({data:a(c),buffers:f})}return d};a.createTextureFromTexelData=function(a,b){var c,f;g.isPowerOfTwo(b.width)&&
g.isPowerOfTwo(b.height)?(c=!0,f=9987):(c=!1,f=9729);return new d.Texture(a,{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,hasMipmap:c,samplingMode:f,wrapMode:33071,flipped:!0},b)};a.geometryToMappedGeometry=function(a){return{vertexFrom:void 0,vertexTo:void 0,geometry:a}};a.getBytes=n;a.getPixelBytes=function(a){switch(a){case 5121:return 1;case 32819:return 2;case 5126:return 4;default:k.error(new h("webgl-utils","Unable to handle type "+a))}};a.getPixelArrayCtor=function(a){switch(a){case 5121:return Uint8Array;
case 32819:return Uint16Array;case 5126:return Float32Array;default:k.error(new h("webgl-utils","Unable to handle type "+a))}};var F=new Map;a.createProgramDescriptor=function(a,b){if(!F.has(a)){var d=p(b),c={},f;for(f in d){var g=d[f];c[f]=g.length?g[0].stride:0}f={};for(var k in b)for(var g=0,e=b[k];g<e.length;g++){var l=e[g];f[l.name]=l.location}F.set(a,{strides:c,bufferLayouts:d,attributes:f})}return F.get(a)}})},"esri/symbols/cim/enums":function(){define(["require","exports"],function(e,a){Object.defineProperty(a,
"__esModule",{value:!0});(function(a){a[a.BUTT=0]="BUTT";a[a.ROUND=1]="ROUND";a[a.SQUARE=2]="SQUARE";a[a.UNKNOWN=4]="UNKNOWN"})(a.CapType||(a.CapType={}));(function(a){a[a.BEVEL=0]="BEVEL";a[a.ROUND=1]="ROUND";a[a.MITER=2]="MITER";a[a.UNKNOWN=4]="UNKNOWN"})(a.JoinType||(a.JoinType={}));(function(a){a[a.SCREEN=0]="SCREEN";a[a.MAP=1]="MAP"})(a.Alignment||(a.Alignment={}))})},"esri/views/2d/engine/webgl/color":function(){define(["require","exports","./number"],function(e,a,c){function h(a,b){Array.isArray(b)?
(a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3]):(a[0]=b.r,a[1]=b.g,a[2]=b.b,a[3]=b.a);return a}function b(a,b,d){void 0===b&&(b=0);void 0===d&&(d=!1);var c=a[b+3];a[b+0]*=c;a[b+1]*=c;a[b+2]*=c;d||(a[b+3]*=255);return a}Object.defineProperty(a,"__esModule",{value:!0});a.white=[255,255,255,1];var g=[0,0,0,0];a.premultiplyAlpha=b;a.copyAndPremultiply=function(a){return b(h([],a))};a.premultiplyAlphaUint32=function(a){b(h(g,a));return c.i8888to32(g[0],g[1],g[2],g[3])};a.premultiplyAlphaRGBA=function(a){if(!a)return 0;
var b=a.a;return c.i8888to32(a.r*b,a.g*b,a.b*b,255*b)}})},"esri/views/2d/engine/webgl/SymbolProperties":function(){define(["require","exports","../../../../core/ObjectPool"],function(e,a,c){Object.defineProperty(a,"__esModule",{value:!0});e=function(){function a(){this.color=[0,0,0,0];this.haloColor=[0,0,0,0];this.haloSize=0;this.size=12;this.vAnchor=this.hAnchor=this.offsetY=this.offsetX=this.angle=0}a.prototype.acquire=function(a,c,e,f,d,l,h,v,A){this.color=a;this.haloColor=c;this.haloSize=e;this.size=
f;this.angle=d;this.offsetX=l;this.offsetY=h;this.hAnchor=v;this.vAnchor=A};a.prototype.release=function(){this.color[0]=this.color[1]=this.color[2]=this.color[3]=0;this.vAnchor=this.hAnchor=this.offsetY=this.offsetX=this.angle=this.size=this.haloSize=this.haloColor[0]=this.haloColor[1]=this.haloColor[2]=this.haloColor[3]=0};a.pool=new c(a);return a}();a.TextProperties=e})},"esri/views/2d/engine/webgl/util/debug":function(){define(["require","exports"],function(e,a){Object.defineProperty(a,"__esModule",
{value:!0});a.createDebugLogger=function(a,e){return a&&function(){for(var a=[],c=0;c<arguments.length;c++)a[c]=arguments[c];return e.warn.apply(e,["DEBUG:"].concat(a))}||function(){return null}};a.DEBUG_ATTR_UPDATES=!1})},"esri/views/2d/engine/webgl/collisions/CollisionGrid":function(){define(["require","exports","../definitions"],function(e,a,c){Object.defineProperty(a,"__esModule",{value:!0});e=function(){function a(a){this._bucketSize=a;this._rowsLength=c.TILE_SIZE/a;this._colsLength=c.TILE_SIZE/
a;this._grid=this._initGrid()}a.prototype.checkOverlap=function(a,c){a=Math.floor(a/this._bucketSize);c=Math.floor(c/this._bucketSize);if(0>a||a>=this._rowsLength||0>c||c>=this._colsLength||this._grid[c][a])return!0;this._grid[c][a]=!0;return!1};a.prototype.reset=function(){this._grid=this._initGrid()};a.prototype._initGrid=function(){for(var a=[],c=0;c<this._rowsLength;c++)a.push(Array(this._colsLength));return a};return a}();a.CollisionGrid=e})},"esri/views/2d/engine/webgl/collisions/CollisionEngine":function(){define("require exports ../../../../../core/Error ../../../../../core/iteratorUtils ../../../../../core/Logger ../../../../../core/mathUtils ../definitions ./CollisionBucket ./LayerCollisionInfo".split(" "),
function(e,a,c,h,b,g,m,f,d){Object.defineProperty(a,"__esModule",{value:!0});var l=m.TILE_SIZE/m.COLLISION_BUCKET_SIZE,z=b.getLogger("esri.views.2d.engine.webgl.collisions.CollisionEngine");e=function(){function a(a){this._layers=new Map;this._collisionBuckets=new Map;this._didError=!1;this._tilingScheme=a}Object.defineProperty(a.prototype,"collisionInfos",{get:function(){return h.valuesOfMap(this._layers)},enumerable:!0,configurable:!0});a.prototype.registerLayerView=function(a,b){if(!this._layers.has(a)){var c=
d.default.create(a,b,this.collisionInfos,this._tilingScheme);this._layers.set(a,c);this._collisionBuckets.forEach(function(a){return a.onRegisterLayer(c.index)})}};a.prototype.unregisterLayerView=function(a){var b=this;if(this._layers.has(a)){var c=this._layers.get(a);d.default.delete(c.index,this.collisionInfos);this._layers.delete(a);this._collisionBuckets.forEach(function(a,d){var f=a.getTile(c.index);f&&(a.onUnregisterLayer(c.index),a.canDelete()&&b._collisionBuckets.delete(d),f.reference&&(f.reference.isDirty=
!1))})}};a.prototype.addTile=function(a,b){var d=b.key.id;this._layers.has(a)&&(this._collisionBuckets.has(d)||this._collisionBuckets.set(d,new f.default(b.key,this._layers.size)),a=this._getIndex(a),this._collisionBuckets.get(d).getTile(a).reference=b)};a.prototype.removeTile=function(a,b){this._layers.has(a)&&this._collisionBuckets.has(b)&&(a=this._getIndex(a),b=this._collisionBuckets.get(b).getTile(a),b.dirty=!1,b.reference=null)};a.prototype.run=function(a,b){var f=h.valuesOfMap(this._collisionBuckets).sort(function(a,
b){return a.key.compareRowMajor(b.key)}),g=!0,e=a.renderingOptions.labelCollisionsEnabled&&!this._didError,l=this.collisionInfos;try{for(var m=0;m<f.length;m++)for(var k=f[m],g=g||k.isDirty,x=0;x<this._layers.size;x++){var w=d.default.find(x,l);k.computeNeighbors(this._collisionBuckets);k.reset(a,g,w)}for(a=0;a<this._layers.size;a++)for(w=d.default.find(a,l),g=0,m=f;g<m.length;g++)k=m[g],this._run(e,k,w,b)}catch(B){z.error(new c("mapview-labeling","Encountered an error during decluttering. Disabling collisions",
B)),this._didError=!0}for(b=0;b<f.length;b++)k=f[b],k.ready()};a.prototype._run=function(a,b,d,c){var f=b.getReference(d.index);f&&f.hasData&&(f.key.level!==c?this._resetLabelsMinZoom(b,d):this._runVisibility(a,b,f,d,c))};a.prototype._resetLabelsMinZoom=function(a,b){if(a&&"polyline"!==b.geometryType&&(a=a.getReference(b.index))&&a.hasData){b=b.layerView.tileRenderer.featuresView.attributeView;var d=0;for(a=a.displayObjects;d<a.length;d++)b.setLabelMinZoom(a[d].id,255)}};a.prototype._checkLabelsVisible=
function(a,b){var d=!b.effect||b.effect.excludedLabelsVisible||!!(a&m.EFFECT_FLAG_0);return(!b.filter||!!(a&m.FILTER_FLAG_0))&&d};a.prototype._runVisibility=function(a,b,d,c,f){var g=c.layerView.tileRenderer.featuresView.attributeView,e=0;for(d=d.displayObjects.sort(function(a,b){a=g.getLabelMinZoom(a.id);b=g.getLabelMinZoom(b.id);return a-b});e<d.length;e++){var k=d[e];if(k.metrics.length){var l="polyline"===c.geometryType?0:10*(f-1),h=g.getFilterFlags(k.id),n=this._checkLabelsVisible(h,c.layerView);
if(a)for(var q=0;q<k.metrics.length;q++)h=k.metrics[q],h=n?-1!==h.minZoom?h.minZoom:this._computeLabelVisibility(k,h,c.index,b,h.baseZoom,f):255,l=Math.max(h,l);g.setLabelMinZoom(k.id,l);n=0;for(k=k.metrics;n<k.length;n++)h=k[n],h.minZoom=l}}};a.prototype._computeLabelVisibility=function(a,b,d,c,f,g){for(var e=b.xBucket,k=b.yBucket,h=b.xOverflow,w=b.yOverflow,n=e-h,e=e+h+1,h=k+w+1,k=k-w;k<h;k++)for(w=n;w<e;w++)if(!(w<-l||k<-l||w>l||k>l))for(var q=0;q<=d;q++){var m=this._getRelativeSubBucket(q,c,w,
k);if(m)for(var p=0;p<m.length;p++){var u=m[p];u.id!==a.id&&(u=this._compareLabels(b,u,f,g),f=Math.max(u,f))}}return f};a.prototype._compareLabels=function(a,b,d,c){if(-1===b.minZoom||b.minZoom>10*(c+1))return d;a=a.findCollisionDelta(b);c=g.clamp(Math.floor(10*(a+c)),0,255);return b.minZoom>=c?d:Math.max(d,c)};a.prototype._getNeighboringTile=function(a,b,d,c){return(b=b.neighbors[3*(1+c)+(1+d)])&&b.getTile(a)};a.prototype._getRelativeSubBucket=function(a,b,d,c){var f=g.sign(Math.floor(d/4)),e=g.sign(Math.floor(c/
4));return(a=this._getNeighboringTile(a,b,f,e))&&a.reference&&a.index&&a.reference.hasData?a.index[c-4*e][d-4*f]:null};a.prototype._getIndex=function(a){return this._layers.get(a).index};return a}();a.CollisionEngine=e})},"esri/views/2d/engine/webgl/collisions/CollisionBucket":function(){define(["require","exports","../../../tiling","./CollisionBucketEntry"],function(e,a,c,h){Object.defineProperty(a,"__esModule",{value:!0});e=function(){function a(a,b){this.neighbors=Array(9);this._tiles=Array(b);
for(var c=0;c<b;c++)this._tiles[c]=new h.default;this.key=a}Object.defineProperty(a.prototype,"isDirty",{get:function(){for(var a=0,b=this._tiles;a<b.length;a++)if(b[a].dirty)return!0;return!1},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"size",{get:function(){return this._tiles.length},enumerable:!0,configurable:!0});a.prototype.getTile=function(a){return this._tiles[a]};a.prototype.getReference=function(a){return(a=this._tiles[a])&&a.reference};a.prototype.onRegisterLayer=
function(a){this.invalidateRange(a);this._add(a)};a.prototype.onUnregisterLayer=function(a){this.invalidateRange(a);this._remove(a)};a.prototype.onLabelsRendered=function(){};a.prototype.invalidateRange=function(a){for(;a<this._tiles.length;a++)this._tiles[a].dirty=!0};a.prototype.add=function(a){this._add(a)};a.prototype.remove=function(a){this._remove(a)};a.prototype.canDelete=function(){return 0===this._tiles.length};a.prototype.ready=function(){for(var a=0,b=this._tiles;a<b.length;a++)b[a].dirty=
!1};a.prototype.computeNeighbors=function(a){this.neighbors[0]=this._getNeighbor(a,-1,-1);this.neighbors[1]=this._getNeighbor(a,0,-1);this.neighbors[2]=this._getNeighbor(a,1,-1);this.neighbors[3]=this._getNeighbor(a,-1,0);this.neighbors[4]=this;this.neighbors[5]=this._getNeighbor(a,1,0);this.neighbors[6]=this._getNeighbor(a,-1,1);this.neighbors[7]=this._getNeighbor(a,0,1);this.neighbors[8]=this._getNeighbor(a,1,1)};a.prototype.reset=function(a,b,c){for(var d=0,f=this._tiles;d<f.length;d++){var g=
f[d];g&&g.reset(a,b,c)}};a.prototype._add=function(a){var b=[];if(a>=this._tiles.length)this._tiles.push(new h.default);else{for(var c=0;c<this._tiles.length;c++)c===a&&b.push(new h.default),b.push(this._tiles[c]);this._tiles=b}};a.prototype._remove=function(a){for(var b=[],c=0;c<this._tiles.length;c++)c!==a&&b.push(this._tiles[c]);this._tiles=b};a.prototype._getNeighbor=function(a,b,f){var d=this.key;b=c.TileKey.getId(d.level,d.row+f,d.col+b,d.world);return a.has(b)?a.get(b):null};return a}();a.default=
e})},"esri/views/2d/engine/webgl/collisions/CollisionBucketEntry":function(){define(["require","exports","../../../../../core/libs/gl-matrix-2/vec2"],function(e,a,c){Object.defineProperty(a,"__esModule",{value:!0});e=function(){function a(){this._reference=null}Object.defineProperty(a.prototype,"dirty",{get:function(){return this.reference&&this.reference.isDirty},set:function(a){this.reference&&this.reference.hasData&&(a||this.reference.isDirty)&&(this.reference.isDirty=a)},enumerable:!0,configurable:!0});
Object.defineProperty(a.prototype,"index",{get:function(){return this._reference&&this._reference.labelIndex},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"reference",{get:function(){return this._reference},set:function(a){this._reference=a},enumerable:!0,configurable:!0});a.prototype.reset=function(a,g,e){a=a.state;var b=e.layerView.tileRenderer,d=this.reference;if(!d||!d.hasData)return!1;g&&(d.isDirty=!0);g=d.transforms.labelMat2d;for(var l=g[4],h=g[5],m=0,A=d.displayObjects;m<
A.length;m++)for(var x=A[m],u=b.featuresView.attributeView,u=e.hasVV()?u.getVVSize(x.id):0,q=0,x=x.metrics;q<x.length;q++){var n=x[q];e.hasVV()&&n.computeOffset(u,e.vvEval);var p=n.bounds.center,y=n.bounds.centerT;d.isDirty&&(n.minZoom=-1);var k=c.vec2.copy(y,n.anchor);a.rotation?c.vec2.transformMat2d(k,k,g):(y[0]=k[0]+l,y[1]=k[1]+h);c.vec2.add(y,k,p);y[0]+=n.offsetX;y[1]+=n.offsetY;if(n.boxes)for(p=0,y=n.boxes;p<y.length;p++){var k=y[p],C=k.centerT;c.vec2.add(C,n.anchor,k.center);a.rotation?c.vec2.transformMat2d(C,
C,g):(C[0]+=l,C[1]+=h)}}return!0};return a}();a.default=e})},"esri/views/2d/engine/webgl/collisions/LayerCollisionInfo":function(){define("require exports ../../../../../core/Logger ../../../../../core/mathUtils ../../../../../core/screenUtils ./visualVariableSimpleUtils".split(" "),function(e,a,c,h,b,g){function m(a){return function(d){return b.pt2px(g.getSizeForValueSimple(d,a))}}function f(a){if(!a)return null;for(var b=0;b<a.length;b++){var d=a[b];if("size"===d.type)return m(d)}return null}Object.defineProperty(a,
"__esModule",{value:!0});var d=function(a,b){return a.order-b.order},l=function(a,b){return a.index-b.index},z=c.getLogger("esri/views/2d/engine/webgl/collisions/CollisionEngine");a.createLabelVVEvaluator=f;e=function(){function a(a,b,d,c){var g=this;this._vvHandle=null;var e=a.layer,l=e.geometryType,k=e.labelingInfo,q=e.renderer;this.vvEval=f("visualVariables"in q&&q.visualVariables);this._vvHandle=e.watch("visualVariables",function(a){g.vvEval=f(a)});e=k.map(function(a){var b=!!a.maxScale,d=!!a.minScale&&
c.scaleToZoom(a.minScale)||0;a=b&&c.scaleToZoom(a.maxScale)||255;return{minZoom:h.clamp(Math.floor(10*d),0,255),maxZoom:h.clamp(Math.floor(10*a),0,255)}});this.layerView=a;this.geometryType=l;this.index=b;this.order=d;this.zoomRanges=e;this.layerView=a}a.prototype.hasVV=function(){return!!this.vvEval};a.prototype.allOrNothing=function(){return"polyline"!==this.geometryType};a.prototype.destroy=function(){this._vvHandle.remove()};a.create=function(b,c,f,g){f=f.sort(d);for(var e=!1,l=-1,h=0;h<f.length;h++){var k=
f[h];!e&&k.order>c&&(l=k.index,e=!0);e&&k.index++}e||(l=f.length);return new a(b,l,c,g)};a.delete=function(a,b){for(var d=b.sort(l),c=a+1;c<d.length;c++)b[c].index--;b[a].destroy();b.splice(a,1)};a.find=function(a,b){for(var d=0;d<b.length;d++){var c=b[d];if(c.index===a)return c}z.error("Tried to get a LayerCollisionInfo for an index that doesn't exist!");return null};return a}();a.default=e})},"esri/views/2d/engine/webgl/collisions/visualVariableSimpleUtils":function(){define(["require","exports",
"../../../../../core/mathUtils","../../../../../renderers/support/utils"],function(e,a,c,h){function b(a,b){switch(b.transformationType){case "additive":var d=g(b.minSize,a);return a+(d||b.minDataValue);case "constant":return d=(d=b.stops)&&d.length&&d[0].size,null==d&&(d=b.minSize),g(d,a);case "clamped-linear":var d=(a-b.minDataValue)/(b.maxDataValue-b.minDataValue),e=g(b.minSize,a),l=g(b.maxSize,a);a=a<=b.minDataValue?e:a>=b.maxDataValue?l:e+d*(l-e);return a;case "proportional":return d=a/b.minDataValue,
e=g(b.minSize,a),a=g(b.maxSize,a),c.clamp(d*e,e,a);case "stops":return e=m(a,b.cache.ipData),l=e[0],d=e[1],e=e[2],l===d?a=g(b.stops[l].size,a):(l=g(b.stops[l].size,a),a=g(b.stops[d].size,a),a=l+(a-l)*e),a;case "real-world-size":d=h.meterIn[b.valueUnit];e=g(b.minSize,a);l=g(b.maxSize,a);b=b.valueRepresentation;var x=null,x="area"===b?2*Math.sqrt(a/f)/d:"radius"===b||"distance"===b?2*a/d:a/d;return c.clamp(x,e,l);case "identity":return a;case "unknown":return null}}function g(a,c){return"number"===
typeof a?a:b(c,a)}function m(a,b){if(b){var d=0,c=b.length-1;b.some(function(b,f){if(a<b)return c=f,!0;d=f;return!1});return[d,c,(a-b[d])/(b[c]-b[d])]}}Object.defineProperty(a,"__esModule",{value:!0});var f=Math.PI;a.getSizeForValueSimple=b})},"esri/views/2d/engine/webgl/collisions/LayerViewSorter":function(){define(["require","exports","../../../../../core/Error","../../../../../core/Logger"],function(e,a,c,h){function b(a){return"esri.views.2d.layers.FeatureLayerView2D"===a.declaredClass||"esri.views.2d.layers.StreamLayerView2D"===
a.declaredClass}Object.defineProperty(a,"__esModule",{value:!0});var g=h.getLogger("esri.views.2d.engine.collisions.LayerViewSorter");e=function(){function a(a,b){this.registerLayer=a;this.unregisterLayer=b;this._layerViewState=new Map}a.prototype.findIndex=function(a){return a.view.allLayerViews.findIndex(function(b){return b.uid===a.uid})};a.prototype.update=function(a){for(var d=a.added,f=0,e=a.removed;f<e.length;f++)a=e[f],b(a)&&this._layerViewState.has(a)&&this._deleteState(a);for(f=0;f<d.length;f++){a=
d[f];if(e=b(a))a:if(a.layer&&a.layer.renderer)switch(a.layer.renderer.type){case "class-breaks":case "simple":case "unique-value":case "dictionary":e=!0;break a;default:g.error(new c("mapview-labeling","Renderer of type "+a.layer.renderer.type+" does not currently support labeling")),e=!1}else e=!1;e&&!this._layerViewState.has(a)&&this._createState(a)}this._recomputeOrder()};a.prototype.destroy=function(){this._layerViewState.forEach(function(a){return a.handle.remove()})};a.prototype._createState=
function(a){var b={priority:-1,handle:null};b.handle=a.watch("labelsVisible",this._recomputeOrder.bind(this));this._layerViewState.set(a,b);return b};a.prototype._deleteState=function(a){if(this._layerViewState.has(a)){var b=this._layerViewState.get(a);b.handle.remove();-1!==b.priority&&this.unregisterLayer(a);this._layerViewState.delete(a)}};a.prototype._recomputeOrder=function(){var a=this;this._layerViewState.forEach(function(b,c){var d=c.view.map.allLayers.findIndex(function(a){return a.uid===
c.layer.uid}),f=c.layer,d=f.visible&&f.labelsVisible&&f.labelingInfo?4294967295-d:-1;d!==b.priority&&(b.priority=d,a.unregisterLayer(c),-1!==d&&a.registerLayer(c,d))})};return a}();a.LayerViewSorter=e})},"esri/views/2d/engine/webgl/Geometry":function(){define(["require","exports"],function(e,a){Object.defineProperty(a,"__esModule",{value:!0});e=function(){function a(a,b){this.x=a;this.y=b}a.prototype.clone=function(){return new a(this.x,this.y)};a.prototype.equals=function(a,b){return a===this.x&&
b===this.y};a.prototype.isEqual=function(a){return a.x===this.x&&a.y===this.y};a.prototype.setCoords=function(a,b){this.x=a;this.y=b};a.prototype.normalize=function(){var a=this.x,b=this.y,a=Math.sqrt(a*a+b*b);this.x/=a;this.y/=a};a.prototype.rightPerpendicular=function(){var a=this.x;this.x=this.y;this.y=-a};a.prototype.move=function(a,b){this.x+=a;this.y+=b};a.prototype.assign=function(a){this.x=a.x;this.y=a.y};a.prototype.assignAdd=function(a,b){this.x=a.x+b.x;this.y=a.y+b.y};a.prototype.assignSub=
function(a,b){this.x=a.x-b.x;this.y=a.y-b.y};a.prototype.rotate=function(a,b){var c=this.x,e=this.y;this.x=c*a-e*b;this.y=c*b+e*a};a.prototype.scale=function(a){this.x*=a;this.y*=a};a.prototype.length=function(){var a=this.x,b=this.y;return Math.sqrt(a*a+b*b)};a.distance=function(a,b){var c=b.x-a.x;a=b.y-a.y;return Math.sqrt(c*c+a*a)};a.add=function(c,b){return new a(c.x+b.x,c.y+b.y)};a.sub=function(c,b){return new a(c.x-b.x,c.y-b.y)};return a}();a.Point=e})},"esri/views/2d/engine/webgl/alignmentUtils":function(){define(["require",
"exports"],function(e,a){Object.defineProperty(a,"__esModule",{value:!0});a.getXAnchorDirection=function(a){switch(a){case "left":return 1;case "right":return-1;case "center":case "justify":return 0}};a.getYAnchorDirection=function(a){switch(a){case "top":return-1;case "middle":return 0;case "baseline":case "bottom":return 1}};a.getJustification=function(a){switch(a){case "left":return 0;case "right":return 1;case "center":case "justify":return.5}}})},"esri/views/2d/engine/webgl/brushes/BrushBitmap":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../definitions ../VertexStream ./WGLBrush".split(" "),
function(e,a,c,h,b,g){Object.defineProperty(a,"__esModule",{value:!0});var m={nearest:{defines:[],samplingMode:9728,mips:!1},bilinear:{defines:[],samplingMode:9729,mips:!1},bicubic:{defines:["bicubic"],samplingMode:9729,mips:!1},trilinear:{defines:[],samplingMode:9987,mips:!0}};e=function(a){function d(){var b=null!==a&&a.apply(this,arguments)||this;b._desc={path:"raster/bitmap",attributes:{a_position:0,a_texcoord:1}};return b}c(d,a);d.prototype.dispose=function(){this._quad&&this._quad.dispose()};
d.prototype.prepareState=function(a,b){a=a.context;a.setBlendingEnabled(!0);a.setBlendFunctionSeparate(1,771,1,771);a.setColorMask(!0,!0,!0,!0);a.setStencilWriteMask(0);a.setStencilTestEnabled(!0);a.setStencilFunction(514,b.stencilRef,255)};d.prototype.draw=function(a,d){var c=a.context,f=a.renderingOptions,g=a.painter;if(d.source){a.timeline.begin(this.name);this._quad||(this._quad=new b(c,[0,0,1,0,0,1,1,1]));if("dynamic"===f.samplingMode)var f=a.state,e=d.resolution/d.pixelRatio/f.resolution,l=
Math.round(a.pixelRatio)!==a.pixelRatio,f=f.rotation||1.05<e||.95>e||l||d.isSourceScaled||d.rotation?m.bilinear:m.nearest;else f=m[f.samplingMode];g=g.materialManager.getProgram(a,this._desc,f.defines);d.setSamplingProfile(f);d.bind(h.TEXTURE_BINDING_BITMAP);c.bindProgram(g);g.setUniformMatrix3fv("u_dvsMat3",d.transforms.dvs);g.setUniform1i("u_texture",h.TEXTURE_BINDING_BITMAP);g.setUniform2fv("u_coordScale",d.coordScale);this._quad.draw();a.timeline.end(this.name)}};return d}(g.default);a.default=
e})},"esri/views/2d/engine/webgl/brushes/BrushClip":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/libs/gl-matrix-2/vec4f32 ../Utils ./WGLBrush ../shaders/BackgroundPrograms ../../../../webgl/programUtils".split(" "),function(e,a,c,h,b,g,m,f){Object.defineProperty(a,"__esModule",{value:!0});e=function(a){function d(){var b=null!==a&&a.apply(this,arguments)||this;b._color=h.vec4f32.fromValues(0,1,0,1);return b}c(d,a);d.prototype.dispose=function(){this._program&&
this._program.dispose()};d.prototype.prepareState=function(a){a=a.context;a.setStencilTestEnabled(!0);a.setBlendingEnabled(!1);a.setFaceCullingEnabled(!1);a.setColorMask(!1,!1,!1,!1);a.setStencilOp(7680,7680,7681);a.setStencilWriteMask(255);a.setStencilFunction(519,0,255)};d.prototype.draw=function(a,d){var c=a.context;a=a.state;this._program||(this._program=f.createProgram(c,m.background));var g=this._program,e=b.createProgramDescriptor("clip",{geometry:[{location:0,name:"a_pos",count:2,type:5122}]});
d=d.getVAO(c,a,e.attributes,e.bufferLayouts);c.bindProgram(this._program);g.setUniform2fv("u_coord_range",[1,1]);g.setUniform4fv("u_color",this._color);g.setUniformMatrix3fv("u_dvsMat3",a.displayMat3);c.bindVAO(d);c.drawElements(4,d.indexBuffer.size,5125,0);c.bindVAO()};return d}(g.default);a.default=e})},"esri/views/2d/engine/webgl/brushes/BrushRasterBitmap":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/tsSupport/assignHelper ../VertexStream ../WGLRasterUtils ./WGLBrush".split(" "),
function(e,a,c,h,b,g,m){Object.defineProperty(a,"__esModule",{value:!0});e=function(a){function d(){var b=null!==a&&a.apply(this,arguments)||this;b._desc={lut:{path:"raster/lut",attributes:{a_position:0,a_texcoord:1}},stretch:{path:"raster/stretch",attributes:{a_position:0,a_texcoord:1}}};return b}c(d,a);d.prototype.dispose=function(){this._quad&&this._quad.dispose()};d.prototype.prepareState=function(a,b){a=a.context;a.setBlendingEnabled(!0);a.setBlendFunctionSeparate(1,771,1,771);a.setColorMask(!0,
!0,!0,!0);a.setStencilWriteMask(0);a.setStencilTestEnabled(!0);a.setStencilFunction(514,b.stencilRef,255)};d.prototype.draw=function(a,d){var c=a.context,f=a.painter;if(d.source){a.timeline.begin(this.name);this._quad||(this._quad=new b(c,[0,0,1,0,0,1,1,1]));f=f.materialManager.getProgram(a,this._desc[d.symbolizerParameters.type]);c.bindProgram(f);var e=g.getUniformInfos(c,f),l=d.getTextures();g.setTextures(c,f,l.names,l.textures);l=d.getUniforms();d=h({u_opacity:d.opacity,u_coordScale:d.coordScale},
l);d.u_flipY=!1;g.setUniforms(c,f,e,d);this._quad.draw();a.timeline.end(this.name)}};return d}(m.default);a.default=e})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLBackground":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/libs/gl-matrix-2/mat3f32 ../../../../../core/libs/gl-matrix-2/vec4f32 ../../../../webgl ../../vectorTiles/shaders/Programs ../definitions ../enums ../number ./WGLBrush".split(" "),function(e,a,c,h,b,g,m,f,d,l,z){Object.defineProperty(a,
"__esModule",{value:!0});e=function(a){function e(){var d=null!==a&&a.apply(this,arguments)||this;d._color=b.vec4f32.fromValues(1,0,0,1);d._patternMatrix=h.mat3f32.create();d._programOptions={id:!1,pattern:!1};return d}c(e,a);e.prototype.dispose=function(){this._program&&(this._program.dispose(),this._program=null);this._vao&&(this._vao.dispose(),this._vao=null)};e.prototype.drawMany=function(a,b){var c=a.context,g=a.styleLayerId;this._loadWGLResources(c);var e=a.displayLevel,h=a.styleLayer,k=a.painter.getVectorTileProgramCach(),
m=h.getPaintValue("background-color",e),w=h.getPaintValue("background-opacity",e),u=h.getPaintValue("background-pattern",e),x=void 0!==u,z=m[3]*w,A=a.spriteMosaic,v,J=(window.devicePixelRatio|1)>f.VTL_HIGH_RES_CUTOFF?2:1;a=a.drawPhase===d.WGLDrawPhase.HITTEST;var L=this._programOptions;L.id=a;L.pattern=x;k=k.getProgram(0,(a?1:0)<<1|(x?1:0),L);c.bindVAO(this._vao);c.bindProgram(k);if(x){v=A.getMosaicItemPosition(u,!0);if(!v)return;k.setUniform1f("u_opacity",w);k.setUniform2f("u_pattern_tl",v.tl[0],
v.tl[1]);k.setUniform2f("u_pattern_br",v.br[0],v.br[1]);k.setUniform1i("u_texture",f.VTL_TEXTURE_BINDING_UNIT_SPRITES);A.bind(c,9729,v.page,f.VTL_TEXTURE_BINDING_UNIT_SPRITES)}else this._color[0]=z*m[0],this._color[1]=z*m[1],this._color[2]=z*m[2],this._color[3]=z,k.setUniform4fv("u_color",this._color);k.setUniform1f("u_depth",h.z||0);a&&(g=l.u32to4Xu8(g),k.setUniform4f("u_id",g[0],g[1],g[2],g[3]));for(g=0;g<b.length;g++)h=b[g],k.setUniform1f("u_coord_range",h.coordRange[0]),k.setUniformMatrix3fv("u_dvsMat3",
h.transforms.dvs),x&&(m=J*h.size[0]*Math.max(Math.pow(2,Math.round(e)-h.key.level),1),w=m/v.size[1],this._patternMatrix[0]=m/v.size[0],this._patternMatrix[4]=w,k.setUniformMatrix3fv("u_pattern_matrix",this._patternMatrix)),c.setStencilFunction(514,h.stencilRef,255),c.drawArrays(5,0,4)};e.prototype._loadWGLResources=function(a){if(!this._program||!this._vao){var b=g.createProgram(a,m.background);if(b){var d=new Int8Array([0,0,1,0,0,1,1,1]),d=g.BufferObject.createVertex(a,35044,d);a=new g.VertexArrayObject(a,
m.background.attributes,{geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}]},{geometry:d});this._program=b;this._vao=a}}};return e}(z.default);a.WGLBrushVTLBackground=e})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLCircle":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/libs/gl-matrix-2/vec4f32 ../../../../webgl ../enums ../number ./WGLBrush".split(" "),function(e,a,c,h,b,g,m,f){Object.defineProperty(a,"__esModule",
{value:!0});var d=[1,1,1,1];e=function(a){function f(){var b=null!==a&&a.apply(this,arguments)||this;b._color=h.vec4f32.create();b._strokeColor=h.vec4f32.create();b._programOptions={id:!1};b._vertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:16,normalized:!1,divisor:0},{name:"a_color",count:4,type:5121,offset:4,stride:16,normalized:!0,divisor:0},{name:"a_stroke_color",count:4,type:5121,offset:8,stride:16,normalized:!0,divisor:0},{name:"a_data",count:4,type:5121,offset:12,
stride:16,normalized:!1,divisor:0}]};return b}c(f,a);f.prototype.dispose=function(){};f.prototype.drawMany=function(a,b){var c=a.context,f=a.state,e=a.drawPhase,l=a.styleLayerId,h=a.displayLevel,y=a.styleLayer;a=a.painter.getVectorTileProgramCach();var k=y.hasDataDrivenRadius?1:y.getPaintValue("circle-radius",h),z=y.hasDataDrivenColor?d:y.getPaintValue("circle-color",h),w=y.hasDataDrivenOpacity?1:y.getPaintValue("circle-opacity",h),A=y.hasDataDrivenStrokeWidth?1:y.getPaintValue("circle-stroke-width",
h),v=y.hasDataDrivenStrokeColor?d:y.getPaintValue("circle-stroke-color",h),G=y.hasDataDrivenStrokeOpacity?1:y.getPaintValue("circle-stroke-opacity",h),F=y.hasDataDrivenBlur?0:y.getPaintValue("circle-blur",h),w=w*z[3];this._color[0]=w*z[0];this._color[1]=w*z[1];this._color[2]=w*z[2];this._color[3]=w;w=G*v[3];this._strokeColor[0]=w*v[0];this._strokeColor[1]=w*v[1];this._strokeColor[2]=w*v[2];this._strokeColor[3]=w;z=y.getPaintValue("circle-translate",h);h=y.getPaintValue("circle-translate-anchor",h);
v=e===g.WGLDrawPhase.HITTEST;e=this._programOptions;e.id=v;e=a.getProgram(5,v?1:0,e);c.bindProgram(e);e.setUniformMatrix3fv("u_displayMat3",1===h?f.displayMat3:f.displayViewMat3);e.setUniform2fv("u_circleTranslation",z);e.setUniform1f("u_depth",y.z);e.setUniform1f("u_radius",k);e.setUniform4fv("u_color",this._color);e.setUniform1f("u_blur",F);e.setUniform1f("u_stroke_width",A);e.setUniform4fv("u_stroke_color",this._strokeColor);e.setUniform1f("u_antialiasingWidth",1.2);v&&(f=m.u32to4Xu8(l),e.setUniform4f("u_id",
f[0],f[1],f[2],f[3]));for(f=0;f<b.length;f++)if(y=b[f],y.layerData[l]&&(k=y.layerData[l],A=this._getCircleVAO(c,y,a)))c.bindVAO(A),e.setUniformMatrix3fv("u_dvsMat3",y.transforms.dvs),c.setStencilFunction(514,y.stencilRef,255),c.drawElements(4,k.triangleElementCount,5125,12*k.triangleElementStart),y.triangleCount+=k.triangleElementCount/3};f.prototype._getCircleVAO=function(a,d,c){if(d.circleVertexArrayObject)return d.circleVertexArrayObject;var f=d.circleVertexBuffer,g=d.circleIndexBuffer;if(!f||
!g)return null;d.circleVertexArrayObject=new b.VertexArrayObject(a,c.getProgramAttributes(5),this._vertexAttributes,{geometry:f},g);return d.circleVertexArrayObject};return f}(f.default);a.WGLBrushVTLCircle=e})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLFill":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/libs/gl-matrix-2/mat3f32 ../../../../../core/libs/gl-matrix-2/vec4f32 ../../../../webgl ../definitions ../enums ../number ./WGLBrush".split(" "),
function(e,a,c,h,b,g,m,f,d,l){Object.defineProperty(a,"__esModule",{value:!0});var z=1/65536,v=[1,1,1,1];e=function(a){function e(){var d=null!==a&&a.apply(this,arguments)||this;d._fillVertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:4,normalized:!1,divisor:0}]};d._fillVertexAttributesDD={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:8,normalized:!1,divisor:0},{name:"a_color",count:4,type:5121,offset:4,stride:8,normalized:!0,divisor:0}]};d._outlineVertexAttributes=
{geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:8,normalized:!1,divisor:0},{name:"a_offset",count:2,type:5120,offset:4,stride:8,normalized:!1,divisor:0},{name:"a_xnormal",count:2,type:5120,offset:6,stride:8,normalized:!1,divisor:0}]};d._outlineVertexAttributesDD={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:12,normalized:!1,divisor:0},{name:"a_offset",count:2,type:5120,offset:4,stride:12,normalized:!1,divisor:0},{name:"a_xnormal",count:2,type:5120,offset:6,stride:12,normalized:!1,
divisor:0},{name:"a_color",count:4,type:5121,offset:8,stride:12,normalized:!0,divisor:0}]};d._color=b.vec4f32.create();d._outlineColor=b.vec4f32.create();d._fillProgramOptions={id:!1,dd:!1,pattern:!1};d._outlineProgramOptions={id:!1,dd:!1};d._patternMatrix=h.mat3f32.create();return d}c(e,a);e.prototype.dispose=function(){};e.prototype.drawMany=function(a,b){var c=a.displayLevel,g=a.drawPhase,e=a.renderPass,k=a.styleLayerId,l=a.styleLayer,h=l.getPaintValue("fill-pattern",c),q=l.hasDataDrivenColor?
v:l.getPaintValue("fill-color",c),m=l.hasDataDrivenOpacity?1:l.getPaintValue("fill-opacity",c),u=m*q[3],x=void 0!==h||1>u||l.hasDataDrivenFill;if(!x||"opaque"!==e){this._color[0]=u*q[0];this._color[1]=u*q[1];this._color[2]=u*q[2];this._color[3]=u;var z;g===f.WGLDrawPhase.HITTEST&&(z=d.u32to4Xu8(k));g=l.getPaintValue("fill-translate",c);c=l.getPaintValue("fill-translate-anchor",c);this._drawFill(a,k,l,b,g,c,h,x,z);this._drawOutline(a,k,l,b,g,c,h,z,m)}};e.prototype._drawFill=function(a,b,d,c,g,e,l,
h,x){var k=a.context,w=a.displayLevel,n=a.drawPhase,q=a.renderPass,p=a.spriteMosaic,y=a.state;if(h||"translucent"!==q){h=void 0!==l;var q=a.pixelRatio>m.VTL_HIGH_RES_CUTOFF?2:1,u=d.hasDataDrivenFill;a=a.painter.getVectorTileProgramCach();var C,v=n===f.WGLDrawPhase.HITTEST,n=this._fillProgramOptions;n.id=v;n.dd=u;n.pattern=h;n=a.getProgram(1,(v?1:0)<<2|(u?1:0)<<1|(h?1:0),n);k.bindProgram(n);if(h){C=p.getMosaicItemPosition(l,!0);if(!C){k.bindProgram();return}n.setUniform2f("u_pattern_tl",C.tl[0],C.tl[1]);
n.setUniform2f("u_pattern_br",C.br[0],C.br[1]);n.setUniform1i("u_texture",m.VTL_TEXTURE_BINDING_UNIT_SPRITES);p.bind(k,9729,C.page,m.VTL_TEXTURE_BINDING_UNIT_SPRITES)}n.setUniformMatrix3fv("u_displayMat3",1===e?y.displayMat3:y.displayViewMat3);n.setUniform2fv("u_fillTranslation",g);n.setUniform1f("u_depth",d.z+z);n.setUniform4fv("u_color",this._color);v&&n.setUniform4f("u_id",x[0],x[1],x[2],x[3]);for(d=0;d<c.length;d++)if(g=c[d],g.layerData[b]&&(l=this._getFillVAO(k,g,u,a)))e=g.layerData[b],k.bindVAO(l),
n.setUniformMatrix3fv("u_dvsMat3",g.transforms.dvs),h&&(l=g.coordRange[0]/(q*g.size[0]*Math.max(Math.pow(2,Math.round(w)-g.key.level),1)),x=1/(C.size[1]*l),this._patternMatrix[0]=1/(C.size[0]*l),this._patternMatrix[4]=x,n.setUniformMatrix3fv("u_pattern_matrix",this._patternMatrix)),k.setStencilFunction(514,g.stencilRef,255),k.drawElements(4,e.triangleElementCount,5125,12*e.triangleElementStart),g.triangleCount+=e.triangleElementCount/3}};e.prototype._drawOutline=function(a,b,d,c,g,e,l,h,m){var k=
a.context,w=a.displayLevel,n=a.drawPhase,q=a.pixelRatio,p=a.state;if("opaque"!==a.renderPass&&(l=void 0!==l,d.getPaintValue("fill-antialias",w)&&!l||d.hasDataDrivenOutlineColor)){a=a.painter.getVectorTileProgramCach();l=d.hasDataDrivenOutline;if(d.outlineUsesFillColor){if(1!==this._color[3])return;this._outlineColor[0]=this._color[0];this._outlineColor[1]=this._color[1];this._outlineColor[2]=this._color[2];this._outlineColor[3]=this._color[3]}else w=d.hasDataDrivenOutlineColor?v:d.getPaintValue("fill-outline-color",
w),m*=w[3],this._outlineColor[0]=m*w[0],this._outlineColor[1]=m*w[1],this._outlineColor[2]=m*w[2],this._outlineColor[3]=m;q=.75/q;m=n===f.WGLDrawPhase.HITTEST;n=this._outlineProgramOptions;n.id=m;n.dd=l;n=a.getProgram(2,(m?1:0)<<1|(l?1:0),n);k.bindProgram(n);n.setUniformMatrix3fv("u_displayMat3",1===e?p.displayMat3:p.displayViewMat3);n.setUniform2fv("u_fillTranslation",g);n.setUniform1f("u_depth",d.z+z);n.setUniform1f("u_outline_width",q);n.setUniform4fv("u_color",this._outlineColor);m&&n.setUniform4f("u_id",
h[0],h[1],h[2],h[3]);for(d=0;d<c.length;d++)if(g=c[d],g.layerData[b]){e=g.layerData[b];h=this._getOutlineVAO(k,g,l,a);if(!h)break;k.bindVAO(h);n.setUniformMatrix3fv("u_dvsMat3",g.transforms.dvs);k.setStencilFunction(514,g.stencilRef,255);k.drawElements(4,e.outlineElementCount,5125,12*e.outlineElementStart);g.triangleCount+=e.outlineElementCount/3}}};e.prototype._getFillVAO=function(a,b,d,c){if(d){if(b.fillDDVertexArrayObject)return b.fillDDVertexArrayObject;d=b.fillDDVertexBuffer;var f=b.fillIndexBuffer;
if(!d||!f)return null;b.fillDDVertexArrayObject=new g.VertexArrayObject(a,c.getProgramAttributes(1),this._fillVertexAttributesDD,{geometry:d},f);return b.fillDDVertexArrayObject}if(b.fillVertexArrayObject)return b.fillVertexArrayObject;d=b.fillVertexBuffer;f=b.fillIndexBuffer;if(!d||!f)return null;b.fillVertexArrayObject=new g.VertexArrayObject(a,c.getProgramAttributes(1),this._fillVertexAttributes,{geometry:d},f);return b.fillVertexArrayObject};e.prototype._getOutlineVAO=function(a,b,d,c){if(d){if(b.outlineDDVertexArrayObject)return b.outlineDDVertexArrayObject;
d=b.outlineDDVertexBuffer;var f=b.outlineIndexBuffer;if(!d||!f)return null;b.outlineDDVertexArrayObject=new g.VertexArrayObject(a,c.getProgramAttributes(2),this._outlineVertexAttributesDD,{geometry:d},f);return b.outlineDDVertexArrayObject}if(b.outlineVertexArrayObject)return b.outlineVertexArrayObject;d=b.outlineVertexBuffer;f=b.outlineIndexBuffer;if(!d||!f)return null;b.outlineVertexArrayObject=new g.VertexArrayObject(a,c.getProgramAttributes(2),this._outlineVertexAttributes,{geometry:d},f);return b.outlineVertexArrayObject};
return e}(l.default);a.WGLBrushVTLFill=e})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLLine":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/libs/gl-matrix-2/vec2f32 ../../../../../core/libs/gl-matrix-2/vec4f32 ../../../../webgl ../definitions ../enums ../number ./WGLBrush".split(" "),function(e,a,c,h,b,g,m,f,d,l){Object.defineProperty(a,"__esModule",{value:!0});a.C_DEG_TO_RAD=Math.PI/180;var z=[1,1,1,1];e=function(a){function e(){var d=null!==
a&&a.apply(this,arguments)||this;d._color=b.vec4f32.create();d._dashArray=h.vec2f32.create();d._programOptions={id:!1,dd:!1,pattern:!1};d._vertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:12,normalized:!1,divisor:0},{name:"a_offsetAndNormal",count:4,type:5120,offset:4,stride:12,normalized:!1,divisor:0},{name:"a_accumulatedDistance",count:2,type:5123,offset:8,stride:12,normalized:!1,divisor:0}]};d._vertexAttributesDD={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:20,
normalized:!1,divisor:0},{name:"a_offsetAndNormal",count:4,type:5120,offset:4,stride:20,normalized:!1,divisor:0},{name:"a_accumulatedDistance",count:2,type:5122,offset:8,stride:20,normalized:!1,divisor:0},{name:"a_color",count:4,type:5121,offset:12,stride:20,normalized:!0,divisor:0},{name:"a_width",count:1,type:5126,offset:16,stride:20,normalized:!1,divisor:0}]};return d}c(e,a);e.prototype.dispose=function(){};e.prototype.drawMany=function(a,b){var c=a.context,g=a.displayLevel,e=a.state,l=a.drawPhase,
k=a.styleLayerId,h=a.styleLayer,w=a.painter.getVectorTileProgramCach(),u=h.getPaintValue("line-translate",g),x=h.getPaintValue("line-translate-anchor",g),v=h.getPaintValue("line-pattern",g),A=void 0!==v,M=1/a.pixelRatio,J=h.getPaintValue("line-blur",g),L=h.hasDataDrivenColor?z:h.getPaintValue("line-color",g),K=h.hasDataDrivenOpacity?1:h.getPaintValue("line-opacity",g),Q=h.hasDataDrivenWidth?1:h.getPaintValue("line-width",g),K=K*L[3];this._color[0]=K*L[0];this._color[1]=K*L[1];this._color[2]=K*L[2];
this._color[3]=K;var L=h.hasDataDrivenLine,K=l===f.WGLDrawPhase.HITTEST,I;K&&(I=d.u32to4Xu8(k));l=this._programOptions;l.id=K;l.dd=L;l.pattern=A;l=w.getProgram(3,(K?1:0)<<2|(L?1:0)<<1|(A?1:0),l);c.bindProgram(l);l.setUniformMatrix3fv("u_displayViewMat3",e.displayViewMat3);l.setUniformMatrix3fv("u_displayMat3",1===x?e.displayMat3:e.displayViewMat3);l.setUniform2fv("u_lineTranslation",u);l.setUniform1f("u_depth",h.z);l.setUniform1f("u_blur",J);l.setUniform1f("u_antialiasing",M);l.setUniform4fv("u_color",
this._color);l.setUniform1f("u_width",Q);K&&l.setUniform4f("u_id",I[0],I[1],I[2],I[3]);if(A){if(a=a.spriteMosaic,v=a.getMosaicItemPosition(v,!0))a.bind(c,9729,v.page,m.VTL_TEXTURE_BINDING_UNIT_SPRITES),l.setUniform2f("u_pattern_tl",v.tl[0],v.br[1]),l.setUniform2f("u_pattern_br",v.br[0],v.tl[1]),l.setUniform2f("u_spriteSize",8*v.size[0],v.size[1]),l.setUniform1i("u_texture",m.VTL_TEXTURE_BINDING_UNIT_SPRITES)}else v=h.getPaintValue("line-dasharray",g),2>v.length&&(v=[1,-1]),this._dashArray[0]=8*v[0],
this._dashArray[1]=8*v[1],l.setUniform2fv("u_dasharray",this._dashArray);for(v=0;v<b.length;v++)if(a=b[v],a.layerData[k]&&(g=a.layerData[k],e=this._getLineVAO(c,a,L,w)))c.bindVAO(e),l.setUniformMatrix3fv("u_dvsMat3",a.transforms.dvs),c.setStencilFunction(514,a.stencilRef,255),c.drawElements(4,g.triangleElementCount,5125,12*g.triangleElementStart),a.triangleCount+=g.triangleElementCount/3};e.prototype._getLineVAO=function(a,b,d,c){if(d){if(b.lineDDVertexArrayObject)return b.lineDDVertexArrayObject;
d=b.lineDDVertexBuffer;var f=b.lineIndexBuffer;if(!d||!f)return null;b.lineDDVertexArrayObject=new g.VertexArrayObject(a,c.getProgramAttributes(3),this._vertexAttributesDD,{geometry:d},f);return b.lineDDVertexArrayObject}if(b.lineVertexArrayObject)return b.lineVertexArrayObject;d=b.lineVertexBuffer;f=b.lineIndexBuffer;if(!d||!f)return null;b.lineVertexArrayObject=new g.VertexArrayObject(a,c.getProgramAttributes(3),this._vertexAttributes,{geometry:d},f);return b.lineVertexArrayObject};return e}(l.default);
a.WGLBrushVTLLine=e})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLSymbol":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/libs/gl-matrix-2/vec2f32 ../../../../../core/libs/gl-matrix-2/vec4f32 ../../../../webgl ../definitions ../enums ../GeometryUtils ../number ./WGLBrush".split(" "),function(e,a,c,h,b,g,m,f,d,l,z){Object.defineProperty(a,"__esModule",{value:!0});var v=1/65536,A=[1,1,1,1];e=function(a){function e(){var d=null!==a&&a.apply(this,
arguments)||this;d._vertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:16,normalized:!1,divisor:0},{name:"a_vertexOffset",count:2,type:5122,offset:4,stride:16,normalized:!1,divisor:0},{name:"a_tex",count:4,type:5121,offset:8,stride:16,normalized:!1,divisor:0},{name:"a_levelInfo",count:4,type:5121,offset:12,stride:16,normalized:!1,divisor:0}]};d._vertexAttributesDD={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:24,normalized:!1,divisor:0},{name:"a_vertexOffset",
count:2,type:5122,offset:4,stride:24,normalized:!1,divisor:0},{name:"a_tex",count:4,type:5121,offset:8,stride:24,normalized:!1,divisor:0},{name:"a_levelInfo",count:4,type:5121,offset:12,stride:24,normalized:!1,divisor:0},{name:"a_color",count:4,type:5121,offset:16,stride:24,normalized:!0,divisor:0},{name:"a_size",count:1,type:5126,offset:20,stride:24,normalized:!1,divisor:0}]};d._iconProgramOptions={id:!1,dd:!1,sdf:!1};d._sdfProgramOptions={id:!1,dd:!1};d._spritesTextureSize=h.vec2f32.create();d._haloColor=
b.vec4f32.create();d._sdfColor=b.vec4f32.create();d._color=b.vec4f32.create();return d}c(e,a);e.prototype.dispose=function(){};e.prototype.drawMany=function(a,b){var d=a.drawPhase,c=a.styleLayerId,g=a.styleLayer,e=a.fadeRecorder.getFadeValues(),h;d===f.WGLDrawPhase.HITTEST&&(h=l.u32to4Xu8(c));this._drawIcons(a,g,b,e,h);this._drawText(a,g,b,e,h)};e.prototype._drawIcons=function(a,b,c,g,e){for(var k=this,l=a.context,h=a.displayLevel,n=a.drawPhase,q=a.painter,p=a.state,y=a.styleLayerId,u,x=!1,z=0;z<
c.length;z++){var v=c[z];if(v.layerData[y]&&(u=v.layerData[y],0<u.iconPerPageElementsMap.size)){x=!0;break}}if(x){var v=b.hasDataDrivenIconSize?1:b.getLayoutValue("icon-size",h),I=b.hasDataDrivenIconColor?A:b.getPaintValue("icon-color",h),R=b.hasDataDrivenIconOpacity?1:b.getPaintValue("icon-opacity",h),x=b.getPaintValue("icon-translate",h),z=b.getPaintValue("icon-translate-anchor",h),O=q.getVectorTileProgramCach(),q=I[3]*R;this._color[0]=q*I[0];this._color[1]=q*I[1];this._color[2]=q*I[2];this._color[3]=
q;q=b.getLayoutValue("icon-rotation-alignment",h);2===q&&(q=1===b.getLayoutValue("symbol-placement",h)?0:1);var I=u.isSDF,N=b.hasDataDrivenIcon,n=n===f.WGLDrawPhase.HITTEST,R=this._iconProgramOptions;R.id=n;R.dd=N;R.sdf=I;var H=O.getProgram(4,(n?1:0)<<2|(N?1:0)<<1|(I?1:0),R);l.bindProgram(H);I&&(I=b.getPaintValue("icon-halo-color",h),R=b.getPaintValue("icon-halo-width",h),H.setUniform4f("u_outlineColor",I[0],I[1],I[2],I[3]),H.setUniform1f("u_outlineSize",R));H.setUniformMatrix3fv("u_displayViewMat3",
0===q?p.displayViewMat3:p.displayMat3);H.setUniformMatrix3fv("u_displayMat3",1===z?p.displayMat3:p.displayViewMat3);H.setUniform2fv("u_iconTranslation",x);H.setUniform1f("u_depth",b.z);H.setUniform1f("u_mapRotation",d.degToByte(p.rotation));H.setUniform1f("u_keepUpright",0);H.setUniform1f("u_level",10*h);H.setUniform1f("u_fadeSpeed",10*g.fadeSpeed);H.setUniform1f("u_minfadeLevel",10*g.minfadeLevel);H.setUniform1f("u_maxfadeLevel",10*g.maxfadeLevel);H.setUniform1f("u_fadeChange",10*(h+g.fadeChange));
H.setUniform1i("u_texture",m.VTL_TEXTURE_BINDING_UNIT_SPRITES);H.setUniform1f("u_size",v);H.setUniform4fv("u_color",this._color);n&&H.setUniform4fv("u_id",e);b=function(b){if(!b.layerData[y])return"continue";u=b.layerData[y];if(0===u.iconPerPageElementsMap.size)return"continue";var d=U._getIconVAO(l,b,N,O);if(!d)return"continue";l.bindVAO(d);H.setUniformMatrix3fv("u_dvsMat3",b.transforms.dvs);u.iconPerPageElementsMap.forEach(function(d,c){k._renderIconRange(a,H,d,c,b)})};var U=this;for(g=0;g<c.length;g++)v=
c[g],b(v)}};e.prototype._renderIconRange=function(a,b,d,c,f){var g=a.context,e=a.hasClipping,k=a.requiredLevel;a=a.spriteMosaic;this._spritesTextureSize[0]=a.getWidth(c)/4;this._spritesTextureSize[1]=a.getHeight(c)/4;b.setUniform2fv("u_mosaicSize",this._spritesTextureSize);a.bind(g,9729,c,m.VTL_TEXTURE_BINDING_UNIT_SPRITES);b=!0;k!==f.key.level||e?g.setStencilFunction(514,f.stencilRef,255):b=!1;g.setStencilTestEnabled(b);g.drawElements(4,d[1],5125,12*d[0]);f.triangleCount+=d[1]/3};e.prototype._drawText=
function(a,b,c,g,e){for(var k=this,l=a.context,n=a.displayLevel,p=a.drawPhase,q=a.glyphMosaic,y=a.hasClipping,u=a.painter,x=a.pixelRatio,z=a.requiredLevel,K=a.state,Q=a.styleLayerId,I,R=!1,O=0;O<c.length;O++)if(a=c[O],a.layerData[Q]&&(I=a.layerData[Q],0<I.glyphPerPageElementsMap.size)){R=!0;break}if(R){a=b.getLayoutValue("text-rotation-alignment",n);2===a&&(a=1===b.getLayoutValue("symbol-placement",n)?0:1);var R=0===a,R=b.getLayoutValue("text-keep-upright",n)&&R,p=p===f.WGLDrawPhase.HITTEST,x=.8*
3/x,O=b.hasDataDrivenTextSize?1:b.getLayoutValue("text-size",n),N=b.hasDataDrivenTextColor?A:b.getPaintValue("text-color",n),H=b.hasDataDrivenTextOpacity?1:b.getPaintValue("text-opacity",n),U=b.getPaintValue("text-halo-color",n),da=b.getPaintValue("text-halo-width",n),V=3*b.getPaintValue("text-halo-blur",n),Z=3*da,W=u.getVectorTileProgramCach(),u=N[3]*H;this._sdfColor[0]=u*N[0];this._sdfColor[1]=u*N[1];this._sdfColor[2]=u*N[2];this._sdfColor[3]=u;u=U[3]*H;this._haloColor[0]=u*U[0];this._haloColor[1]=
u*U[1];this._haloColor[2]=u*U[2];this._haloColor[3]=u;this._glyphTextureSize||(this._glyphTextureSize=h.vec2f32.fromValues(q.width/4,q.height/4));var u=b.getPaintValue("text-translate",n),N=b.getPaintValue("text-translate-anchor",n),ga=b.hasDataDrivenText,H=this._sdfProgramOptions;H.id=p;H.dd=ga;var T=W.getProgram(6,(p?1:0)<<1|(ga?1:0),H);l.bindProgram(T);T.setUniformMatrix3fv("u_displayViewMat3",0===a?K.displayViewMat3:K.displayMat3);T.setUniformMatrix3fv("u_displayMat3",1===N?K.displayMat3:K.displayViewMat3);
T.setUniform2fv("u_textTranslation",u);T.setUniform1f("u_depth",b.z+v);T.setUniform2fv("u_mosaicSize",this._glyphTextureSize);T.setUniform1f("u_mapRotation",d.degToByte(K.rotation));T.setUniform1f("u_keepUpright",R?1:0);T.setUniform1f("u_level",10*n);T.setUniform1f("u_fadeSpeed",10*g.fadeSpeed);T.setUniform1f("u_minfadeLevel",10*g.minfadeLevel);T.setUniform1f("u_maxfadeLevel",10*g.maxfadeLevel);T.setUniform1f("u_fadeChange",10*(n+g.fadeChange));T.setUniform1i("u_texture",m.VTL_TEXTURE_BINDING_UNIT_GLYPHS);
T.setUniform1f("u_size",O);T.setUniform1f("u_antialiasingWidth",x);p&&T.setUniform4f("u_id",e[0],e[1],e[2],e[3]);b=function(a){if(!a.layerData[Q])return"continue";I=a.layerData[Q];if(0===I.glyphPerPageElementsMap.size)return"continue";var b=ha._getSDFVAO(l,a,ga,W);if(!b)return"continue";l.bindVAO(b);T.setUniformMatrix3fv("u_dvsMat3",a.transforms.dvs);b=!0;z!==a.key.level||y?l.setStencilFunction(514,a.stencilRef,255):b=!1;l.setStencilTestEnabled(b);I.glyphPerPageElementsMap.forEach(function(b,d){k._renderGlyphRange(l,
b,d,q,T,U[3],da,V,Z,a)})};var ha=this;for(g=0;g<c.length;g++)a=c[g],b(a)}};e.prototype._renderGlyphRange=function(a,b,d,c,f,g,e,l,h,u){c.bind(a,9729,d,m.VTL_TEXTURE_BINDING_UNIT_GLYPHS);0<g&&0<e&&(f.setUniform4fv("u_color",this._haloColor),f.setUniform1f("u_halo",1),f.setUniform1f("u_edgeDistance",h),f.setUniform1f("u_edgeBlur",l),a.drawElements(4,b[1],5125,12*b[0]),u.triangleCount+=b[1]/3);0<this._sdfColor[3]&&(f.setUniform4fv("u_color",this._sdfColor),f.setUniform1f("u_halo",0),f.setUniform1f("u_edgeDistance",
0),f.setUniform1f("u_edgeBlur",0),a.drawElements(4,b[1],5125,12*b[0]),u.triangleCount+=b[1]/3)};e.prototype._getIconVAO=function(a,b,d,c){if(d){if(b.iconDDVertexArrayObject)return b.iconDDVertexArrayObject;d=b.iconDDVertexBuffer;var f=b.iconIndexBuffer;if(!d||!f)return null;b.iconDDVertexArrayObject=new g.VertexArrayObject(a,c.getProgramAttributes(4),this._vertexAttributesDD,{geometry:d},f);return b.iconDDVertexArrayObject}if(b.iconVertexArrayObject)return b.iconVertexArrayObject;d=b.iconVertexBuffer;
f=b.iconIndexBuffer;if(!d||!f)return null;b.iconVertexArrayObject=new g.VertexArrayObject(a,c.getProgramAttributes(4),this._vertexAttributes,{geometry:d},f);return b.iconVertexArrayObject};e.prototype._getSDFVAO=function(a,b,d,c){if(d){if(b.textDDVertexArrayObject)return b.textDDVertexArrayObject;d=b.textDDVertexBuffer;var f=b.textIndexBuffer;if(!d||!f)return null;b.textDDVertexArrayObject=new g.VertexArrayObject(a,c.getProgramAttributes(6),this._vertexAttributesDD,{geometry:d},f);return b.textDDVertexArrayObject}if(b.textVertexArrayObject)return b.textVertexArrayObject;
d=b.textVertexBuffer;f=b.textIndexBuffer;if(!d||!f)return null;b.textVertexArrayObject=new g.VertexArrayObject(a,c.getProgramAttributes(6),this._vertexAttributes,{geometry:d},f);return b.textVertexArrayObject};return e}(z.default);a.WGLBrushVTLSymbol=e})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrush":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../webgl ../definitions ./WGLBrush".split(" "),function(e,a,c,h,b,g){Object.defineProperty(a,"__esModule",
{value:!0});e=function(a){function f(){return null!==a&&a.apply(this,arguments)||this}c(f,a);f.prototype.prepareState=function(a,b,c){a=a.context;c=c&&-1!==c.indexOf("id");a.setBlendingEnabled(!c);a.setBlendFunctionSeparate(1,771,1,771);a.setColorMask(!0,!0,!0,!0);a.setStencilWriteMask(0);a.setStencilTestEnabled(!0);a.setStencilFunction(514,b.stencilRef,255)};f.prototype.draw=function(a,b,c){var d=this;if(b.isReady&&b.hasData){b.commitChanges();var f=this.getGeometryType(),g=b.getDisplayList(),e=
b.getGeometry(f);e&&g&&(a.timeline.begin(this.name),g.byType(f,function(f){d.drawGeometry(a,b,f,e,c)}),a.timeline.end(this.name))}};f.prototype._getVAO=function(a,b,c,f){f.vao||(f.vao=new h.VertexArrayObject(a,c,b,f.vertexBufferMap,f.indexBuffer));return f.vao};f.prototype._setSharedUniforms=function(a,c,f){a.setUniform1f("u_pixelRatio",c.pixelRatio);a.setUniformMatrix3fv("u_dvsMat3",f.transforms.dvs);a.setUniformMatrix3fv("u_displayViewMat3",c.state.displayViewMat3);a.setUniformMatrix4fv("u_insideEffectMat4",
c.rendererInfo.insideEffect);a.setUniformMatrix4fv("u_outsideEffectMat4",c.rendererInfo.outsideEffect);a.setUniform1fv("u_insideOpacities",c.rendererInfo.insideOpacities);a.setUniform1fv("u_outsideOpacities",c.rendererInfo.outsideOpacities);a.setUniform1i("u_attributeTextureSize",c.attributeView.size);a.setUniform1i("u_attributeData0",b.TEXTURE_BINDING_ATTRIBUTE_DATA_0);a.setUniform1i("u_attributeData1",b.TEXTURE_BINDING_ATTRIBUTE_DATA_1);a.setUniform1i("u_attributeData2",b.TEXTURE_BINDING_ATTRIBUTE_DATA_2);
a.setUniform1i("u_attributeData3",b.TEXTURE_BINDING_ATTRIBUTE_DATA_3)};return f}(g.default);a.default=e})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushFill":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/tsSupport/assignHelper ../../../../../core/RandomLCG ../../../../webgl ../definitions ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey".split(" "),function(e,a,c,h,b,g,m,f,d,l,z){Object.defineProperty(a,"__esModule",{value:!0});
e=function(a){function e(){var b=null!==a&&a.apply(this,arguments)||this;b._dotTextureSize=0;b._dotTextures=null;b._dotSamplers=new Int32Array([m.TEXTURE_BINDING_RENDERER_0,m.TEXTURE_BINDING_RENDERER_1]);return b}c(e,a);e.prototype.dispose=function(){this._disposeTextures()};e.prototype.getGeometryType=function(){return f.WGLGeometryType.FILL};e.prototype.drawGeometry=function(a,b,c,f,g){var e=a.context,k=a.painter,l=a.rendererInfo,h=a.requiredLevel,n=c.indexCount,q=c.indexFrom;c=z.FillMaterialKey.load(c.materialKey);
var p=d.createProgramDescriptor(c.data,{geometry:[{location:0,name:"a_pos",count:2,type:5122},{location:1,name:"a_id",count:4,type:5121}].concat(c.dotDensity?[]:[{location:2,name:"a_color",count:4,type:5121,normalized:!0},{location:3,name:"a_tlbr",count:4,type:5123},{location:4,name:"a_aux1",count:4,type:5121},{location:5,name:"a_aux2",count:2,type:5123},{location:6,name:"a_aux3",count:4,type:5121}],c.dotDensity?[{location:2,name:"a_inverseArea",count:1,type:5126}]:[])}),u=p.bufferLayouts,p=p.attributes;
g=k.materialManager.getMaterialProgram(a,c,"materials/fill",p,g);f=this._getVAO(e,u,p,f);e.bindProgram(g);e.bindVAO(f);this._setSharedUniforms(g,a,b);c.textureBinding&&(k.textureManager.bindTextures(e,g,c),k=1/Math.pow(2,h-b.key.level)/a.pixelRatio,g.setUniform1f("u_zoomFactor",k));c.vvColor&&(g.setUniform1fv("u_vvColorValues",l.vvColorValues),g.setUniform4fv("u_vvColors",l.vvColors));c.vvOpacity&&(g.setUniform1fv("u_vvOpacityValues",l.vvOpacityValues),g.setUniform1fv("u_vvOpacities",l.vvOpacities));
c.dotDensity&&(c=m.TILE_SIZE/l.ddDotSize,f=c*window.devicePixelRatio*c*window.devicePixelRatio,k=1/Math.pow(2,h-b.key.level),b=1/k*(1/k),a=l.ddDotScale?a.state.scale/l.ddDotScale:1,g.setUniform1f("u_tileZoomFactor",k),g.setUniform1f("u_tileDotsOverArea",f/(m.TILE_SIZE*window.devicePixelRatio*m.TILE_SIZE*window.devicePixelRatio)),g.setUniformMatrix4fv("u_dotColors",l.ddColors),g.setUniform4fv("u_isActive",l.ddActiveDots),g.setUniform4fv("u_dotBackgroundColor",l.ddBackgroundColor),g.setUniform1f("u_dotValue",
Math.max(1,l.ddDotValue*a*b)),this._bindDotDensityTextures(e,g,l,c));e.drawElements(4,n,5125,4*q);e.bindVAO(null)};e.prototype._disposeTextures=function(){if(this._dotTextures){for(var a=0;a<this._dotTextures.length;a++)this._dotTextures[a].dispose();this._dotTextures=null}};e.prototype._bindDotDensityTextures=function(a,b,d,c){d=this._createDotDensityTextures(a,c,d.ddSeed);b.setUniform1iv("u_dotTextures",this._dotSamplers);for(b=0;b<d.length;b++)a.bindTexture(d[b],this._dotSamplers[b])};e.prototype._createDotDensityTextures=
function(a,d,c){if(this._dotTextureSize!==d||this._seed!==c)this._disposeTextures(),this._dotTextureSize=d,this._seed=c;null===this._dotTextures&&(c=new b(c),this._dotTextures=[this._allocDotDensityTexture(a,d,c),this._allocDotDensityTexture(a,d,c)]);return this._dotTextures};e.prototype._allocDotDensityTexture=function(a,b,d){for(var c=new Float32Array(b*b*4),f=0;f<c.length;f++)c[f]=d.getFloat();return new g.Texture(a,{wrapMode:10497,pixelFormat:6408,dataType:5126,samplingMode:9728,width:b,height:b},
c)};return e}(l.default);a.default=e})},"esri/views/2d/engine/webgl/materialKey/MaterialKey":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/tsSupport/assignHelper ../../../../../renderers ../../../../../core/Error ../../../../../core/maybe ../enums ../mesh/templates/WGLLabelTemplate ../util/vvFlagUtils".split(" "),function(e,a,c,h,b,g,m,f,d,l){Object.defineProperty(a,"__esModule",{value:!0});a.createMaterialKey=function(a,b,d,c){if(m.isSome(b)){a:{if("heatmap"===
b.type)throw Error("Symbol processor does not support heatmap renderer");switch(a){case f.WGLGeometryType.FILL:a=x.from(b);break a;case f.WGLGeometryType.LINE:a=q.from(b,d);break a;case f.WGLGeometryType.MARKER:if("dot-density"===b.type)throw Error("Dot Density renderer does not support Marker GeometryTypes");a=u.from(b);break a;case f.WGLGeometryType.TEXT:if("dot-density"===b.type)throw Error("Dot Density renderer does not support Text GeometryTypes");a=n.from(b);break a;case f.WGLGeometryType.LABEL:if("dot-density"===
b.type)throw Error("Dot Density renderer does not support Label GeometryTypes");a=p.from(b,c);break a;default:throw Error("Unable to createMaterialKey for unknown geometryType "+a);}}return a}switch(a){case f.WGLGeometryType.FILL:return x.from(null);case f.WGLGeometryType.LINE:return q.from(null,d);case f.WGLGeometryType.MARKER:return u.from(null);case f.WGLGeometryType.TEXT:return n.from(null);case f.WGLGeometryType.LABEL:return p.from(null,c);default:throw Error("Unable to createMaterialKey for unknown geometryType "+
a);}};e=function(){function a(a){this._data=0;this._data=a}a.load=function(a){var b=this.shared;b.data=a;return b};Object.defineProperty(a.prototype,"data",{get:function(){return this._data},set:function(a){this._data=a},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"geometryType",{get:function(){return this.bits(5,8)},set:function(a){this.setBits(a,5,8)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"mapAligned",{get:function(){return!!this.bit(17)},set:function(a){this.setBit(17,
a)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"sdf",{get:function(){return!!this.bit(8)},set:function(a){this.setBit(8,a)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"pattern",{get:function(){return!!this.bit(9)},set:function(a){this.setBit(9,a)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"textureBinding",{get:function(){return this.bits(0,5)},set:function(a){this.setBits(a,0,5)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"geometryTypeString",{get:function(){switch(this.geometryType){case f.WGLGeometryType.FILL:return"fill";case f.WGLGeometryType.MARKER:return"marker";case f.WGLGeometryType.LINE:return"line";case f.WGLGeometryType.TEXT:return"text";case f.WGLGeometryType.LABEL:return"label";default:throw new g("Unable to handle unknown geometryType: "+this.geometryType);}},enumerable:!0,configurable:!0});a.prototype.setBit=function(a,b){a=1<<a;this._data=b?this._data|a:this._data&~a};a.prototype.bit=function(a){return(this._data&
1<<a)>>a};a.prototype.setBits=function(a,b,d){for(var c=0;b<d;b++,c++)this.setBit(b,0!==(a&1<<c))};a.prototype.bits=function(a,b){for(var d=0,c=0;a<b;a++,c++)d|=this.bit(a)<<c;return d};a.prototype.hasVV=function(){return!1};a.prototype.setVV=function(a,b){};a.prototype.getVariation=function(){var a={},b;for(b in this)"boolean"===typeof this[b]&&(a[b]=this[b]);return a};a.prototype.getVariationHash=function(){return this._data&~(4&this.textureBinding)};a.shared=new a(0);return a}();a.MaterialKeyBase=
e;h=function(a){return function(a){function b(){return null!==a&&a.apply(this,arguments)||this}c(b,a);Object.defineProperty(b.prototype,"vvSizeMinMaxValue",{get:function(){return 0!==this.bit(13)},set:function(a){this.setBit(13,a)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"vvSizeScaleStops",{get:function(){return 0!==this.bit(14)},set:function(a){this.setBit(14,a)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"vvSizeFieldStops",{get:function(){return 0!==
this.bit(15)},set:function(a){this.setBit(15,a)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"vvSizeUnitValue",{get:function(){return 0!==this.bit(16)},set:function(a){this.setBit(16,a)},enumerable:!0,configurable:!0});b.prototype.hasVV=function(){return a.prototype.hasVV.call(this)||this.vvSizeMinMaxValue||this.vvSizeScaleStops||this.vvSizeFieldStops||this.vvSizeUnitValue};b.prototype.setVV=function(b,d){a.prototype.setVV.call(this,b,d);b&=l.getSizeFlagsMask(b,d);this.vvSizeMinMaxValue=
!!(b&f.WGLVVFlag.SIZE_MINMAX_VALUE);this.vvSizeFieldStops=!!(b&f.WGLVVFlag.SIZE_FIELD_STOPS);this.vvSizeUnitValue=!!(b&f.WGLVVFlag.SIZE_UNIT_VALUE);this.vvSizeScaleStops=!!(b&f.WGLVVFlag.SIZE_SCALE_STOPS)};return b}(a)};var z=function(a){return function(a){function b(){return null!==a&&a.apply(this,arguments)||this}c(b,a);Object.defineProperty(b.prototype,"vvRotation",{get:function(){return 0!==this.bit(12)},set:function(a){this.setBit(12,a)},enumerable:!0,configurable:!0});b.prototype.hasVV=function(){return a.prototype.hasVV.call(this)||
this.vvRotation};b.prototype.setVV=function(b,d){a.prototype.setVV.call(this,b,d);this.vvRotation=!d&&!!(b&f.WGLVVFlag.ROTATION)};return b}(a)},v=function(a){return function(a){function b(){return null!==a&&a.apply(this,arguments)||this}c(b,a);Object.defineProperty(b.prototype,"vvColor",{get:function(){return 0!==this.bit(10)},set:function(a){this.setBit(10,a)},enumerable:!0,configurable:!0});b.prototype.hasVV=function(){return a.prototype.hasVV.call(this)||this.vvColor};b.prototype.setVV=function(b,
d){a.prototype.setVV.call(this,b,d);this.vvColor=!d&&!!(b&f.WGLVVFlag.COLOR)};return b}(a)},A=function(a){return function(a){function b(){return null!==a&&a.apply(this,arguments)||this}c(b,a);Object.defineProperty(b.prototype,"vvOpacity",{get:function(){return 0!==this.bit(11)},set:function(a){this.setBit(11,a)},enumerable:!0,configurable:!0});b.prototype.hasVV=function(){return a.prototype.hasVV.call(this)||this.vvOpacity};b.prototype.setVV=function(b,d){a.prototype.setVV.call(this,b,d);this.vvOpacity=
!d&&!!(b&f.WGLVVFlag.OPACITY)};return b}(a)},x=function(a){function d(){return null!==a&&a.apply(this,arguments)||this}c(d,a);d.load=function(a){var b=this.shared;b.data=a;return b};d.from=function(a){var d=this.load(0);d.geometryType=f.WGLGeometryType.FILL;m.isSome(a)&&(a instanceof b.DotDensityRenderer?d.dotDensity=!0:(a=l.getVVFlags(a.visualVariables),d.setVV(a,!1)));return d.data};d.prototype.getVariation=function(){return a.prototype.getVariation.call(this)};Object.defineProperty(d.prototype,
"dotDensity",{get:function(){return!!this.bit(12)},set:function(a){this.setBit(12,a)},enumerable:!0,configurable:!0});d.shared=new d(0);return d}(v(A(e)));a.FillMaterialKey=x;var u=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}c(b,a);b.load=function(a){var b=this.shared;b.data=a;return b};b.from=function(a){var b=this.load(0);b.geometryType=f.WGLGeometryType.MARKER;m.isSome(a)&&(a=l.getVVFlags(a.visualVariables),b.setVV(a,!1));return b.data};b.prototype.getVariation=function(){return a.prototype.getVariation.call(this)};
b.shared=new b(0);return b}(v(A(z(h(e)))));a.MarkerMaterialKey=u;var q=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}c(b,a);b.load=function(a){var b=this.shared;b.data=a;return b};b.from=function(a,b){var d=this.load(0);d.geometryType=f.WGLGeometryType.LINE;m.isSome(a)&&(a=l.getVVFlags(a.visualVariables),d.setVV(a,b));return d.data};b.prototype.getVariation=function(){return a.prototype.getVariation.call(this)};b.shared=new b(0);return b}(v(A(h(e))));a.LineMaterialKey=q;
var n=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}c(b,a);b.load=function(a){var b=this.shared;b.data=a;return b};b.from=function(a){var b=this.load(0);b.geometryType=f.WGLGeometryType.TEXT;m.isSome(a)&&(a=l.getVVFlags(a.visualVariables),b.setVV(a,!1));return b.data};b.prototype.getVariation=function(){return a.prototype.getVariation.call(this)};b.shared=new b(0);return b}(v(A(z(h(e)))));a.TextMaterialKey=n;var p=function(a){function b(){return null!==a&&a.apply(this,arguments)||
this}c(b,a);b.load=function(a){var b=this.shared;b.data=a;return b};b.from=function(a,b){var c=this.load(0);c.geometryType=f.WGLGeometryType.LABEL;m.isSome(a)&&(a=l.getVVFlags(a.visualVariables),c.setVV(a,!1));c.mapAligned=!!d.isMapAligned(b.labelPlacement);return c.data};b.prototype.getVariation=function(){return a.prototype.getVariation.call(this)};b.shared=new b(0);return b}(h(e));a.LabelMaterialKey=p})},"esri/views/2d/engine/webgl/mesh/templates/WGLLabelTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/mathUtils ../../../../../../core/mathUtils ../../../../../../core/libs/gl-matrix-2/mat2d ../../../../../../core/libs/gl-matrix-2/mat2df32 ../../../../../../core/libs/gl-matrix-2/vec2 ../../../../../../core/libs/gl-matrix-2/vec2f32 ../../../vectorTiles/GeometryUtils ../../color ../../definitions ../../enums ../../number ../../TextShaping ../../collisions/Metric ../../materialKey/MaterialKey ./GlyphGroup ./util ./WGLTextTemplate".split(" "),
function(e,a,c,h,b,g,m,f,d,l,z,v,A,x,u,q,n,p,y,k,C,w){function B(a){switch(a){case "above-left":return[-1,-1];case "above-center":case "above-along":return[0,-1];case "above-right":return[1,-1];case "center-left":return[-1,0];case "center-center":case "center-along":return[0,0];case "center-right":return[1,0];case "below-left":return[-1,1];case "below-center":case "below-along":return[0,1];case "below-right":return[1,1];case "always-horizontal":return[0,0];default:J("Found invalid placement type "+
a)}}Object.defineProperty(a,"__esModule",{value:!0});var E=b.getLogger("esri.views.2d.engine.webgl.WGLLabelTemplate"),G=z.vec2f32.create(),F=d.mat2df32.create(),M={xOffset:0,yOffset:0,width:0,height:0},J=function(a,b){void 0===b&&(b="mapview-labeling");return E.error(new h(b,a))};a.isMapAligned=function(a){switch(a){case "above-along":case "below-along":case "center-along":return 1;default:return 0}};e=function(a){function b(b,d,c,f){c=a.call(this,b,c.font.size,c.haloSize||0,c.color&&A.premultiplyAlphaRGBA(c.color)||
0,c.haloColor&&A.premultiplyAlphaRGBA(c.haloColor)||0,c.horizontalAlignment,c.verticalAlignment,c.font.decoration,!1,c.angle||0,c.xoffset,c.yoffset,c.id)||this;c._refTemplate=M;c.geometryType=u.WGLGeometryType.LABEL;var e=d.symbol,l;l=!!d.minScale&&f.scaleToZoom(d.minScale)||0;l=g.clamp(l,0,25.5);f=!!d.maxScale&&f.scaleToZoom(d.maxScale)||255;f=g.clamp(f,0,25.5);var k=B(d.labelPlacement),h=k[0],k=k[1];c._justify=(-1*h+1)/2;c._xAlignD=h;c._yAlignD=k;c._xPlacementD=h;c._yPlacementD=k;c._minZoom=l;c._maxZoom=
f;b=y.LabelMaterialKey.load(y.createMaterialKey(c.geometryType,b,!1,d));b.sdf=!0;c._materialKey=b.data;b=e.font.decoration.toLowerCase();"underline"===b?c._decorationTop=6:"line-through"===b&&(c._decorationTop=-5);return c}c(b,a);b.fromLabelClass=function(a,d,c){return new b(a,d,d.symbol,c)};b.prototype.bindTextInfo=function(a,b,d){a=this._computeShaping(a,this._justify).getShaping(b,d);isNaN(this._decorationTop)||n.TextShaping.addDecoration(a,this._decorationTop);this._shapedGlyphs=a;this._shapedBox=
n.TextShaping.getBox(a)};b.prototype._computeShaping=function(a,b){return new n.TextShaping([a],x.TEXT_MAX_WIDTH,x.TEXT_LINE_HEIGHT,x.TEXT_SPACING,[0,0],.5,.5,b)};Object.defineProperty(b.prototype,"bounds",{get:function(){return this._bounds},enumerable:!0,configurable:!0});b.prototype.bindReferenceTemplate=function(a){this._refTemplate=a||M};b.prototype._placeGlyphs=function(a,b,d,c){var f=this._size,g=this._haloSize,e=this._shapedBox,l=this._shapedGlyphs,k=this._computeGlyphTransform(e);if("esriGeometryPolyline"!==
a)for(var h=0;h<d.length;h++)for(var w=d[h],n=0,p=l;n<p.length;n++){var q=p[n];w.place(q,a,b,k,this._materialKey,f,g,e,c,this._minZoom,this._maxZoom)}else for(h=0;h<d.length;h++)for(var w=d[h],n=q=w.order,p=n-(n-1)/2-1,u=p-(p-1)/2-1,y=u-(u-1)/2-1,q=-1===q?0:n%2?p%2?u%2?y%2?0:c-3.1:c-2.1:c-1.1:c-.1,n=Math.max(c+m.log2((this._shapedBox.width*this._scale+48)/w.pathLen),Math.max(q,this._minZoom)),p=0,u=l;p<u.length;p++)q=u[p],w.place(q,a,b,k,this._materialKey,f,g,e,c,n,this._maxZoom)};b.prototype.writeMesh=
function(a,b,d,c,f,g,e){var l=this,k=this._computeAnchors(d,f),h=q.i8888to32(0,0,0,this._bitset);if(k.length&&this._shapedGlyphs.length)if(this._placeGlyphs(d,f,k,g),f=y.LabelMaterialKey.load(this._materialKey),"esriGeometryPolyline"!==d){d=k[0];g=this._computeGlyphTransform(this._shapedBox);g=this._createBounds(this._shapedBox,g);var m=d.glyphs.get(0),w=m[0],n=w.anchorX,u=w.anchorY,z=Math.floor(10*w.minZoom),w=Math.floor(10*w.maxZoom),v=a.length;m.forEach(function(a){a.minZoom=25.5;a.maxZoom=25.5});
v=new p.default(c,{from:v,count:a.length-v},n,u,z);n=Math.floor(n/x.COLLISION_BUCKET_SIZE);u=Math.floor(u/x.COLLISION_BUCKET_SIZE);n>=x.COLLISION_TILE_BOX_SIZE||u>=x.COLLISION_TILE_BOX_SIZE||0>n||0>u||(this._writeVertices(a,b,c,m,h,z,w),m=Math.max(this._refTemplate.height,this._refTemplate.width),f.vvSizeFieldStops||f.vvSizeMinMaxValue||f.vvSizeScaleStops||f.vvSizeUnitValue?v.setVV(m,this._xPlacementD,this._yPlacementD):(v.offsetX=(m/2+x.COLLISION_PLACEMENT_PADDING)*this._xPlacementD,v.offsetY=(m/
2+x.COLLISION_PLACEMENT_PADDING)*this._yPlacementD),v.bounds=g,e.push(v),d.clear())}else{f=function(d){var f=k[d],g=f.x,m=f.y;d=a.length;var w=new p.default(c,{from:d,count:-1},g,m,25.5);f.glyphs.forEach(function(d){for(var e=0;e<d.length;e++){var k=d[e];k.minZoom=Math.max(f.minZoom,k.minZoom);if(k.bounds){var n=k.anchorY-m;k.bounds.center[0]+=k.anchorX-g;k.bounds.center[1]+=n;w.add(k.bounds)}}w.bounds&&l._writeHalos(a,b,c,d,h)});f.glyphs.forEach(function(d){w.bounds&&l._writeText(a,b,c,d,h)});w.range.count=
a.length-d;w.bounds&&e.push(w);f.clear()};for(d=0;d<k.length;d++)f(d);this._computedGlyphs=[]}};b.prototype._outsideTile=function(a,b){return 0>a||512<=a||0>b||512<=b};b.prototype._smoothVertices=function(a,b){if(!(0>=b)){var d=a.length;if(!(3>d)){var c=[],f=0;c.push(0);for(var g=1;g<d;g++)f+=C.dist(a[g],a[g-1]),c.push(f);b=Math.min(b,.2*f);f=[];f.push(a[0][0]);f.push(a[0][1]);var e=a[d-1][0],l=a[d-1][1],g=C.sub([0,0],a[0],a[1]);C.normalize(g);a[0][0]+=b*g[0];a[0][1]+=b*g[1];C.sub(g,a[d-1],a[d-2]);
C.normalize(g);a[d-1][0]+=b*g[0];a[d-1][1]+=b*g[1];for(g=1;g<d;g++)c[g]+=b;c[d-1]+=b;for(var k=.5*b,g=1;g<d-1;g++){for(var h=0,m=0,w=0,n=g-1;0<=n&&!(c[n+1]<c[g]-k);n--){var p=k+c[n+1]-c[g],q=c[n+1]-c[n],u=c[g]-c[n]<k?1:p/q;if(1E-6>Math.abs(u))break;var y=u*u,x=u*p-.5*y*q,z=u*q/b,v=a[n+1],A=a[n][0]-v[0],F=a[n][1]-v[1],h=h+z/x*(v[0]*u*p+.5*y*(p*A-q*v[0])-y*u*q*A/3),m=m+z/x*(v[1]*u*p+.5*y*(p*F-q*v[1])-y*u*q*F/3),w=w+z}for(n=g+1;n<d&&!(c[n-1]>c[g]+k);n++){p=k-c[n-1]+c[g];q=c[n]-c[n-1];u=c[n]-c[g]<k?1:
p/q;if(1E-6>Math.abs(u))break;y=u*u;x=u*p-.5*y*q;z=u*q/b;v=a[n-1];A=a[n][0]-v[0];F=a[n][1]-v[1];h+=z/x*(v[0]*u*p+.5*y*(p*A-q*v[0])-y*u*q*A/3);m+=z/x*(v[1]*u*p+.5*y*(p*F-q*v[1])-y*u*q*F/3);w+=z}f.push(h/w);f.push(m/w)}f.push(e);f.push(l);for(n=g=0;g<d;g++)a[g][0]=f[n++],a[g][1]=f[n++]}}};b.prototype._computeLineAnchors=function(a,b,d){b=b.paths;var c=this._scale*this._shapedBox.width;d=c/2+d;for(var c=c/2+16,f=this._shapedBox.width*this._scale,g=0;g<b.length;g++){var e=b[g],l=[];l.push(e[0]);for(var h=
1;h<e.length;h++){var m=l[h-1],w=m[0],m=m[1],w=w+e[h][0],m=m+e[h][1];l.push([w,m])}this._smoothVertices(l,f);e=[];e.push(l[0]);for(h=1;h<l.length;h++){var m=l[h-1],n=l[h],w=Math.round(n[0]-m[0]),m=Math.round(n[1]-m[1]);e.push([w,m])}b[g]=e;l=this._getPathLength(e);if(!(l<2*c))for(var h=l/2,p=0,n=e[0][0],q=e[0][1],u=1;u<e.length;u++){var w=e[u][0],m=e[u][1],y=Math.sqrt(w*w+m*m),p=p+y;if(0<=p-h){var x=p-h,z=y-x,v=z/y,A=n+w*v,F=q+m*v;this._outsideTile(A,F)||(p=new k.default(A,F,v,g,u,n,q,y,l,-1),a.push(p));
for(var C=-1,F=0,F=z-d;0<=F;F-=d){var v=F/y,A=n+w*v,M=q+m*v;C++;this._outsideTile(A,M)||(p=new k.default(A,M,v,g,u,n,q,y,l,C),a.push(p))}p=F+d;F=y-x;v=n;A=q;for(M=u-1;0!==M;M--){var G=e[M][0],B=e[M][1],J=Math.sqrt(G*G+B*B);if(p+J>=d){for(var L=p=d-p;L<J;L+=d){var r=L/J,E=v-G*r,K=A-B*r;C++;(p=L+F+c<h)&&!this._outsideTile(E,K)&&(p=new k.default(E,K,1-r,g,M,v-G,A-B,J,l,C),a.push(p))}p=J-(L-d)}else p+=J;F+=J;v-=G;A-=B}C=-1;for(F=z+d;F<=y;F+=d)v=F/y,A=n+w*v,z=q+m*v,C++,this._outsideTile(A,z)||(p=new k.default(A,
z,v,g,u,n,q,y,l,C),a.push(p));v=n+w;A=q+m;p=y-(F-d);F=x;for(M=u+1;M<e.length;M++){w=e[M][0];m=e[M][1];n=Math.sqrt(w*w+m*m);if(p+n>=d){for(q=p=d-p;q<n;q+=d)u=q/n,y=v+w*u,x=A+m*u,C++,(p=q+F+c<h)&&!this._outsideTile(y,x)&&(p=new k.default(y,x,u,g,M,v,A,n,l,C),a.push(p));p=n-(q-d)}else p+=n;F+=n;v+=w;A+=m}break}n+=w;q+=m}}return a};b.prototype._computeAnchors=function(a,b){var d=[];switch(a){case "esriGeometryPoint":return b=b.geometry,a=b.x,b=b.y,a=new k.default(a,b),d.push(a),d;case "esriGeometryPolygon":if(b.centroid)return b=
b.centroid,a=b.x,b=b.y,a=new k.default(a,b),d.push(a),d;J("Non-centroid polygon anchor placement not supported");break;case "esriGeometryPolyline":return this._computeLineAnchors(d,b.geometry,376);default:return J("Unable to handle geometryType: "+a),d}};b.prototype._getPathLength=function(a){for(var b=0,d=1;d<a.length;d++)var c=a[d][0],f=a[d][1],b=b+Math.sqrt(c*c+f*f);return b};b.prototype._computeGlyphTransform=function(a){var b=this._scale,d=this._angle*v.C_DEG_TO_RAD,c=a.width/2,g=a.height/2,
c=this._xAlignD*c*b+(this._xOffset+this._refTemplate.xOffset)+(a.x+c);a=this._yAlignD*g*b-(this._yOffset+this._refTemplate.yOffset)-(a.y+g);g=f.mat2d.identity(F);f.mat2d.translate(g,g,l.vec2.set(G,c,a));f.mat2d.scale(g,g,l.vec2.set(G,b,b));f.mat2d.rotate(g,g,d);return g};b.prototype._writeVertex=function(a,b,d,c,f,g,e,l,k){b=b.get("geometry");e=Math.min(Math.floor(Math.max(this._refTemplate.width,this._refTemplate.height)),255);var h=this._xPlacementD+1,m=this._yPlacementD+1;l=q.i8888to32(l,k,0,0);
this._refSymbolAndPlacementOffset=q.i8888to32(g.angle,e,h,m);b.push(c);b.push(d);b.push(f);b.push(g.vertexOffsetUpperLeft);b.push(g.texFontSizeUpperLeft);b.push(this._refSymbolAndPlacementOffset);b.push(l);b.push(c);b.push(d);b.push(f);b.push(g.vertexOffsetUpperRight);b.push(g.texFontSizeUpperRight);b.push(this._refSymbolAndPlacementOffset);b.push(l);b.push(c);b.push(d);b.push(f);b.push(g.vertexOffsetLowerLeft);b.push(g.texFontSizeLowerLeft);b.push(this._refSymbolAndPlacementOffset);b.push(l);b.push(c);
b.push(d);b.push(f);b.push(g.vertexOffsetLowerRight);b.push(g.texFontSizeLowerRight);b.push(this._refSymbolAndPlacementOffset);b.push(l);a.vertexCount+=4};return b}(w.default);a.default=e})},"esri/views/2d/engine/vectorTiles/GeometryUtils":function(){define(["require","exports"],function(e,a){function c(a,c){a%=c;return 0<=a?a:a+c}Object.defineProperty(a,"__esModule",{value:!0});a.C_INFINITY=Number.POSITIVE_INFINITY;a.C_PI=Math.PI;a.C_2PI=2*a.C_PI;a.C_PI_BY_2=a.C_PI/2;a.C_RAD_TO_256=128/a.C_PI;a.C_256_TO_RAD=
a.C_PI/128;a.C_DEG_TO_256=256/360;a.C_DEG_TO_RAD=a.C_PI/180;a.C_SQRT2=1.414213562;a.C_SQRT2_INV=1/a.C_SQRT2;var h=1/Math.LN2;a.positiveMod=c;a.radToByte=function(b){return c(b*a.C_RAD_TO_256,256)};a.degToByte=function(b){return c(b*a.C_DEG_TO_256,256)};a.log2=function(a){return Math.log(a)*h};a.sqr=function(a){return a*a};a.interpolate=function(a,c,e){return a*(1-e)+c*e};a.between=function(a,c,e){return a>=c&&a<=e||a>=e&&a<=c}})},"esri/views/2d/engine/webgl/TextShaping":function(){define(["require",
"exports","./Rect"],function(e,a,c){Object.defineProperty(a,"__esModule",{value:!0});e=function(){function a(a,c,e,f,d,l,h,v){this._glyphItems=a;this._maxWidth=c;this._lineHeight=e;this._letterSpacing=f;this._offset=d;this._hAnchor=l;this._vAnchor=h;this._justify=v}a.prototype.getShaping=function(a,c){for(var b=this._letterSpacing,f=this._lineHeight,d=this._justify,g=this._maxWidth,e=[],h=0,A=0,x=0,u=0,q=-1,n=0,p=-1,y=a.length,k=0;k<y;k++){var C=a.charCodeAt(k);if(10===C){if(k!==y-1){if(q>=u){var h=
e[q],w=h.x+h.glyphMosaicItem.metrics.advance,n=Math.max(w,n);d&&this._applyJustification(e,u,q);u=e.length}A=c?A-f:A+f;h=0;++x}}else{for(var w=void 0,B=0,E=this._glyphItems;B<E.length&&!(w=E[B][C]);B++);if(w){e.push({codePoint:C,x:h,y:A,glyphMosaicItem:w});h+=w.metrics.advance+b;if(0<g&&h>g&&0<=p){B=p+1;w=e[B].x;n=Math.max(w,n);for(E=B;E<e.length;E++)e[E].y=c?e[E].y-f:e[E].y+f,e[E].x-=w;d&&this._applyJustification(e,u,p);A=c?A-f:A+f;h-=w;++x;u=B;p=-1}++q;32===C&&(p=e.length-1)}}}q>=u&&(h=e[q],n=Math.max(n,
h.x+h.glyphMosaicItem.metrics.advance),d&&this._applyJustification(e,u,q));if(0<e.length)for(a=(d-this._hAnchor)*n,b=(-this._vAnchor*(x+1)+.5)*f,c&&x&&(b+=x*f),a+=this._offset[0],b+=this._offset[1],c=0;c<e.length;c++)f=e[c],f.x+=a,f.y+=b;return e};a.getBox=function(a){if(!a.length)return null;for(var b=Infinity,c=Infinity,f=0,d=0,e=0;e<a.length;e++)var h=a[e],v=h.glyphMosaicItem.metrics,A=v.height,x=h.x,h=h.y-(A-Math.abs(v.top)),v=x+v.width+v.left,A=h+A,b=Math.min(b,x),f=Math.max(f,v),c=Math.min(c,
h),d=Math.max(d,A);return{x:b,y:c,width:f-b,height:d-c}};a.addDecoration=function(a,g){var b=a.length;if(0!==b){for(var f=a[0].x+a[0].glyphMosaicItem.metrics.left,d=a[0].y,e=1;e<b;e++){var h=a[e];if(h.y!==d){var v=a[e-1].x+a[e-1].glyphMosaicItem.metrics.left+a[e-1].glyphMosaicItem.metrics.width;a.push({codePoint:0,x:f,y:d+g-3,glyphMosaicItem:{sdf:!0,rect:new c.default(4,0,4,8),metrics:{width:v-f,height:8,left:0,top:0,advance:0},page:0}});d=h.y;f=h.x+h.glyphMosaicItem.metrics.left}}b=a[b-1].x+a[b-
1].glyphMosaicItem.metrics.left+a[b-1].glyphMosaicItem.metrics.width;a.push({codePoint:0,x:f,y:d+g-3,glyphMosaicItem:{sdf:!0,rect:new c.default(4,0,4,8),metrics:{width:b-f,height:8,left:0,top:0,advance:0},page:0}})}};a.prototype._applyJustification=function(a,c,e){for(var b=a[e],b=(b.x+b.glyphMosaicItem.metrics.advance)*this._justify;c<=e;c++)a[c].x-=b};return a}();a.TextShaping=e})},"esri/views/2d/engine/webgl/collisions/Metric":function(){define("require exports ../../../../../core/Logger ../../../../../core/libs/gl-matrix-2/vec2f32 ../definitions ./BoundingBox ../util/serializationUtils".split(" "),
function(e,a,c,h,b,g,m){Object.defineProperty(a,"__esModule",{value:!0});var f=c.getLogger("esri/views/2d/engine/webgl/collisions/Metric");e=function(){function a(a,b,d,c,f){this.id=a;this.range=b;this.boxes=null;this.minZoom=-1;this.offsetY=this.offsetX=this.directionY=this.directionX=this.size=0;this.anchor=h.vec2f32.fromValues(d,c);this.baseZoom=f}a.prototype.add=function(a){this.bounds?(this.boxes?this.boxes.push(a):(this.boxes=[this.bounds,a],this.bounds=this.bounds.clone()),this.bounds.extend(a)):
this.bounds=a};a.prototype.computeIndex=function(){var a=this.bounds,d=this.anchor[0],c=this.anchor[1],f=Math.floor(d/b.COLLISION_BUCKET_SIZE),g=Math.floor(c/b.COLLISION_BUCKET_SIZE),e=0;if(f>b.COLLISION_TILE_BOX_SIZE||g>b.COLLISION_TILE_BOX_SIZE)g=f=b.COLLISION_TILE_BOX_SIZE,e=1;if(0>f||0>g)g=f=0,e=1;a=2*Math.max(a.halfWidth+Math.abs(a.center[0]),a.halfHeight+Math.abs(a.center[1]));d%=b.COLLISION_BUCKET_SIZE;c%=b.COLLISION_BUCKET_SIZE;this.xBucket=f;this.yBucket=g;this.xOverflow=Math.ceil(Math.abs((a-
d)/b.COLLISION_BUCKET_SIZE))+e;this.yOverflow=Math.ceil(Math.abs((a-c)/b.COLLISION_BUCKET_SIZE))+e};a.prototype.findCollisionDelta=function(a){var d=this.bounds.findCollisionDelta(a.bounds),c=this.boxes&&this.boxes.length,f=a.boxes&&a.boxes.length;return Math.abs(d)>b.COLLISION_MAX_ZOOM_DELTA||!c&&!f?d:c&&f?this._boxesToBoxes(a):c?this._boxesToBox(a):this._boxToBoxes(a)};a.prototype.computeOffset=function(a,d){d||f.error("mapview-labeling","Unable to compute label offset. Expected an evaluator function but found "+
d);var c=this.size;this.hasVV&&(a=d(a),c=isNaN(a)||null==a||Infinity===a?this.size:a);this.offsetX=this.directionX*(c/2+b.COLLISION_PLACEMENT_PADDING);this.offsetY=this.directionY*(c/2+b.COLLISION_PLACEMENT_PADDING)};a.prototype.setVV=function(a,b,d){this.hasVV=!0;this.size=a;this.directionX=b;this.directionY=d};a.prototype.clone=function(){var b=new a(this.id,this.range,this.anchor[0],this.anchor[1],this.baseZoom);b.minZoom=this.minZoom;this.bounds&&(b.bounds=this.bounds.clone());this.boxes&&(b.boxes=
this.boxes.map(function(a){return a.clone()}));b.xBucket=this.xBucket;b.yBucket=this.yBucket;b.xOverflow=this.xOverflow;b.yOverflow=this.yOverflow;b.hasVV=this.hasVV;b.size=this.size;b.directionX=this.directionX;b.directionY=this.directionY;b.offsetX=this.offsetX;b.offsetY=this.offsetY;return b};a.prototype._boxToBoxes=function(a){var b=-Infinity,d=0;for(a=a.boxes;d<a.length;d++)var c=this.bounds.findCollisionDelta(a[d]),b=Math.max(c,b);return b};a.prototype._boxesToBox=function(a){for(var b=this.boxes[0].findCollisionDelta(a.bounds),
d=1;d<this.boxes.length;d++)var c=this.boxes[d].findCollisionDelta(a.bounds),b=Math.max(c,b);return b};a.prototype._boxesToBoxes=function(a){for(var b=-Infinity,d=0;d<this.boxes.length;d++)for(var c=this.boxes[d],f=0,g=a.boxes;f<g.length;f++)var e=c.findCollisionDelta(g[f]),b=Math.max(e,b);return b};a.prototype.serialize=function(a){a.push(this.id);this.bounds.serialize(a);a.push(this.range.from);a.push(this.range.count);a.push(this.anchor[0]);a.push(this.anchor[1]);a.push(this.baseZoom);a.push(this.hasVV?
1:0);a.push(this.size);a.push(this.directionX);a.push(this.directionY);a.push(this.offsetX);a.push(this.offsetY);m.serializeList(a,this.boxes);return a};a.deserialize=function(b){var d=b.readInt32(),c=g.default.deserialize(b),f=b.readInt32(),e=b.readInt32(),h={from:f,count:e},l=b.readInt32(),n=b.readInt32(),p=b.readInt32(),f=b.readInt32(),e=b.readInt32(),y=b.readInt32(),k=b.readInt32(),C=b.readInt32(),w=b.readInt32();b=m.deserializeList(b,g.default);d=new a(d,h,l,n,p);d.bounds=c;d.boxes=b;d.computeIndex();
f&&d.setVV(e,y,k);d.offsetX=C;d.offsetY=w;return d};return a}();a.default=e})},"esri/views/2d/engine/webgl/collisions/BoundingBox":function(){define(["require","exports","../../../../../core/mathUtils","../../../../../core/libs/gl-matrix-2/vec2f32"],function(e,a,c,h){Object.defineProperty(a,"__esModule",{value:!0});e=function(){function a(a,b,c,d){this.center=h.vec2f32.fromValues(a,b);this.centerT=h.vec2f32.create();this.halfWidth=c/2;this.halfHeight=d/2;this.width=c;this.height=d}Object.defineProperty(a.prototype,
"x",{get:function(){return this.center[0]},set:function(a){this.center[0]=a},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"y",{get:function(){return this.center[1]},set:function(a){this.center[1]=a},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"blX",{get:function(){return this.center[0]-this.halfWidth},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"blY",{get:function(){return this.center[1]-this.halfHeight},enumerable:!0,configurable:!0});
Object.defineProperty(a.prototype,"trX",{get:function(){return this.center[0]+this.halfWidth},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"trY",{get:function(){return this.center[1]+this.halfHeight},enumerable:!0,configurable:!0});a.prototype.clone=function(){return new a(this.x,this.y,this.width,this.height)};a.prototype.serialize=function(a){a.writeF32(this.center[0]);a.writeF32(this.center[1]);a.push(this.width);a.push(this.height);return a};a.prototype.findCollisionDelta=
function(a){return c.log2(Math.min((a.halfWidth+this.halfWidth)/Math.abs(a.centerT[0]-this.centerT[0]),(a.halfHeight+this.halfHeight)/Math.abs(a.centerT[1]-this.centerT[1])))};a.prototype.extend=function(a){var b=Math.min(this.blX,a.blX),c=Math.min(this.blY,a.blY),d=Math.max(this.trY,a.trY);this.width=Math.max(this.trX,a.trX)-b;this.height=d-c;this.halfWidth=this.width/2;this.halfHeight=this.height/2;this.x=b+this.halfWidth;this.y=c+this.halfHeight};a.deserialize=function(b){var c=b.readF32(),f=b.readF32(),
d=b.readInt32();b=b.readInt32();return new a(c,f,d,b)};return a}();a.default=e})},"esri/views/2d/engine/webgl/util/serializationUtils":function(){define(["require","exports"],function(e,a){Object.defineProperty(a,"__esModule",{value:!0});a.serializeList=function(a,e){if(null===e)a.push(0);else{a.push(e.length);for(var b=0;b<e.length;b++)e[b].serialize(a);return a}};a.deserializeList=function(a,e,b){for(var c=a.readInt32(),c=Array(c),h=0;h<c.length;h++)c[h]=e.deserialize(a,b);return c}})},"esri/views/2d/engine/webgl/mesh/templates/GlyphGroup":function(){define("require exports ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/mathUtils ../../../../../../core/libs/gl-matrix-2/mat2d ../../../../../../core/libs/gl-matrix-2/mat2df32 ../../definitions ../../materialKey/MaterialKey ./ComputedGlyph ./util".split(" "),
function(e,a,c,h,b,g,m,f,d,l,z){Object.defineProperty(a,"__esModule",{value:!0});var v=h.getLogger("esri.views.2d.engine.webgl.GlyphGroup");e=function(){function a(a,b,d,c,f,g,e,h,l,m){void 0===d&&(d=0);void 0===c&&(c=-1);void 0===f&&(f=-1);void 0===g&&(g=-1);void 0===e&&(e=-1);void 0===h&&(h=-1);void 0===l&&(l=0);void 0===m&&(m=-1);this.x=a;this.y=b;this.t=d;this.i=c;this.j=f;this.segmentPosX=g;this.segmentPosY=e;this.segmentLen=h;this.pathLen=l;this.order=m;this._glyphs=new Map;this.minZoom=0}Object.defineProperty(a.prototype,
"glyphs",{get:function(){return this._glyphs},enumerable:!0,configurable:!0});a.prototype.add=function(a,b){var d=this._glyphs.get(b);d?d.push(a):this._glyphs.set(b,[a])};a.prototype.clear=function(){this._glyphs.clear()};a.prototype.place=function(a,b,f,g,e,h,k,m,w,z,A){var n=a.x,p=a.y,q=a.codePoint,u=a.glyphMosaicItem;e=d.MaterialKeyBase.load(e);e.textureBinding=a.glyphMosaicItem.textureBinding;switch(b){case "esriGeometryPoint":case "esriGeometryPolygon":a=l.default.from(n,p,this.x,this.y,-1,z,
A,u,q,e.data,g,h,k);this.add(a,0);break;case "esriGeometryPolyline":b=f.geometry;this._placeGlyphAlongLine(a,e.data,b,g,m,h,k,w,z,A,-1);this._placeGlyphAlongLine(a,e.data,b,g,m,h,k,w,z,A,1);break;case "esriGeometryMultipoint":case "esriGeometryEnvelope":a=void 0,void 0===a&&(a="mapview-labeling"),v.error(new c(a,"Cannot place for unsupported geometryType: "+b))}};a.prototype._findLabelTheta=function(a,b,d,c){b*=c;a=Math.acos((0*b+-1*c*-a)/(1*d));0<b&&(a=2*Math.PI-a);return a};a.prototype._placeGlyphAlongLine=
function(a,d,c,e,h,y,k,v,w,A,E){c=c.paths[this.i];var n=c[this.j],p=n[0],q=n[1],n=a.x,u=a.y,x=a.glyphMosaicItem,C=a.codePoint,B=a.glyphMosaicItem.metrics,B=(a.x+B.left+B.width/2)*y/24;a=E*b.sign(B)||1;var B=Math.abs(B),I=z.len(p,q),R=this._findLabelTheta(p,q,I,E),O=(a+1)/2,I=-a*(-1*O+this.t)*I,N=g.mat2d.rotate(m.mat2df32.create(),e,-R),H=48<h.height;h=0===I?A:Math.max(Math.max(v+b.log2(Math.abs(B/I)),0),w);H&&(h=w);A=l.default.from(n,u,this.x,this.y,R,h,A,x,C,d,N,y,k,H||h<=v&&A>=v&&1===E);this.add(A,
this.j);if(!H)for(A=this.segmentPosX+O*p,p=this.segmentPosY+O*q,N=h,q=this.j+a;0<q&&q<c.length;q+=a){var U=A,da=p,O=c[q];h=O[0];var O=O[1],V=z.len(h,O),H=this._findLabelTheta(h,O,V,E),H=g.mat2d.rotate(m.mat2df32.create(),e,-H),U=U+-a*h/V*I,da=da+-a*O/V*I,I=I+V,V=N-.1,N=0===I?V:Math.max(Math.max(v+b.log2(Math.abs(B/I)),0),w),H=l.default.from(n,u,U,da,R,N,V,x,C,d,H,y,k,N<=v&&V>=v&&1===E);this.add(H,q);if(N<v-f.COLLISION_MAX_ZOOM_DELTA){this.minZoom=Math.max(N,this.minZoom);break}A+=a*h;p+=a*O}};return a}();
a.default=e})},"esri/views/2d/engine/webgl/mesh/templates/ComputedGlyph":function(){define("require exports ../../../../../../core/libs/gl-matrix-2/vec2 ../../../../../../core/libs/gl-matrix-2/vec2f32 ../../definitions ../../number ../../collisions/BoundingBox".split(" "),function(e,a,c,h,b,g,m){Object.defineProperty(a,"__esModule",{value:!0});var f=h.vec2f32.create();e=function(){function a(a,b,d,c,f,e,g,h,m,y,k,C,w,B,E){this.anchorX=a;this.anchorY=b;this.angle=d;this.bounds=c;this.minZoom=f;this.maxZoom=
e;this.materialKey=g;this.vertexOffsetUpperLeft=h;this.vertexOffsetUpperRight=m;this.vertexOffsetLowerLeft=y;this.vertexOffsetLowerRight=k;this.texFontSizeUpperLeft=C;this.texFontSizeUpperRight=w;this.texFontSizeLowerLeft=B;this.texFontSizeLowerRight=E}a.from=function(d,e,h,A,x,u,q,n,p,y,k,C,w,B,E){void 0===B&&(B=!1);void 0===E&&(E=!1);var l=n.rect,v=n.metrics;x=-1===x?255:Math.floor(180*x/Math.PI/360*254);var z=Math.round(l.x/4),J=Math.round(l.y/4);n=z+Math.round(l.width/4);var L=J+Math.round(l.height/
4),K=-24-v.top,Q=v.left,I=-v.top,R=l.width,l=l.height;p||(E||(K=0),Q=4,R=v.width);d+=Q;p=E?e+I:e+K;R=d+R;K=p;e=d;I=p+l;l=R;E=I;var Q=e+v.width,O=I-v.height,N=v.width*C/24,v=v.height*C/24;k&&(c.vec2.transformMat2d(f,c.vec2.set(f,d,p),k),d=f[0],p=f[1],c.vec2.transformMat2d(f,c.vec2.set(f,R,K),k),R=f[0],K=f[1],c.vec2.transformMat2d(f,c.vec2.set(f,e,I),k),e=f[0],I=f[1],c.vec2.transformMat2d(f,c.vec2.set(f,l,E),k),l=f[0],E=f[1],c.vec2.transformMat2d(f,c.vec2.set(f,Q,O),k),Q=f[0],O=f[1]);k=B?new m.default(Q,
O,N+b.COLLISION_BOX_PADDING,v+b.COLLISION_BOX_PADDING):null;B=g.i1616to32(8*d,8*p);v=g.i1616to32(8*R,8*K);d=g.i1616to32(8*e,8*I);e=g.i1616to32(8*l,8*E);l=g.i8888to32(z,J,C,w);J=g.i8888to32(n,J,C,w);z=g.i8888to32(z,L,C,w);C=g.i8888to32(n,L,C,w);return new a(h|0,A|0,x,k,u,q,y,B,v,d,e,l,J,z,C)};return a}();a.default=e})},"esri/views/2d/engine/webgl/mesh/templates/util":function(){define(["require","exports"],function(e,a){function c(a,b){return Math.sqrt(a*a+b*b)}Object.defineProperty(a,"__esModule",
{value:!0});a.sub=function(a,b,c){a[0]=b[0]-c[0];a[1]=b[1]-c[1];return a};a.len=c;a.normalize=function(a){var b=c(a[0],a[1]);a[0]/=b;a[1]/=b};a.dist=function(a,b){return c(a[0]-b[0],a[1]-b[1])};a.isFunction=function(a){return"function"===typeof a};a.getLimitCosine=function(a){return 1/Math.max(a,1)}})},"esri/views/2d/engine/webgl/mesh/templates/WGLTextTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/screenUtils ../../alignmentUtils ../../color ../../fontUtils ../../materialKey/MaterialKey ./WGLBaseTextTemplate ./WGLMeshTemplate ../../util/BidiText".split(" "),
function(e,a,c,h,b,g,m,f,d,l,z){Object.defineProperty(a,"__esModule",{value:!0});e=function(a){function d(d,c,e,g,l,y,k,v,w,z,A,G,F){var n=a.call(this)||this;n._xOffset=h.pt2px(A);n._yOffset=h.pt2px(G);n._decorationTop=m.getFontDecorationTop(v);n._color=g;n._haloColor=l;n._haloSize=Math.min(Math.floor(5*h.pt2px(h.toPt(e))),127);n._size=Math.min(Math.round(h.pt2px(c)),127);c=Math.min(Math.round(h.pt2px(c)),127);n._referenceSize=Math.round(Math.sqrt(256*c));n._scale=n._size/24;n._angle=z;n._justify=
b.getJustification(y||"center");n._xAlignD=b.getXAnchorDirection(y||"center");n._yAlignD=-b.getYAnchorDirection(k||"baseline");n._baseline="baseline"===(k||"baseline");n._bitset=w?1:0;d=f.MaterialKeyBase.load(f.createMaterialKey(n.geometryType,d,!1));d.sdf=!0;n._materialKey=d.data;n.symbolId=F;return n}c(d,a);d.fromText=function(a,b,c){a=new d(a,b.font.size,b.haloSize||0,b.color&&g.premultiplyAlphaRGBA(b.color)||0,b.haloColor&&g.premultiplyAlphaRGBA(b.haloColor)||0,b.horizontalAlignment,b.verticalAlignment,
b.font.decoration,!1,b.angle||0,b.xoffset,b.yoffset,b.id);b=z.bidiText(b.text);a.bindTextInfo(c,b[0],b[1]);a._computeGlyphs(a._shapedGlyphs,a._shapedBox);return a};d.fromCIMText=function(a,b,c,f){a=new d(a,b.size*b.sizeRatio*c,b.outlineSize*b.sizeRatio,g.premultiplyAlphaRGBA(b.color),g.premultiplyAlphaRGBA(b.outlineColor),b.horizontalAlignment,b.verticalAlignment,b.decoration,b.colorLocked,b.angle,b.offsetX*b.sizeRatio*c,b.offsetY*b.sizeRatio*c,b.materialHash);b=z.bidiText(b.text);a.bindTextInfo(f,
b[0],b[1]);a._computeGlyphs(a._shapedGlyphs,a._shapedBox);return a};return d}(d.default(l.default));a.default=e})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseTextTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/libs/gl-matrix-2/mat2d ../../../../../../core/libs/gl-matrix-2/mat2df32 ../../../../../../core/libs/gl-matrix-2/vec2 ../../../../../../core/libs/gl-matrix-2/vec2f32 ../../definitions ../../enums ../../number ../../TextShapingNew ../../WGLDisplayRecord ../../collisions/BoundingBox ../../materialKey/MaterialKey ./ComputedGlyph".split(" "),
function(e,a,c,h,b,g,m,f,d,l,z,v,A,x,u,q,n){Object.defineProperty(a,"__esModule",{value:!0});var p=b.getLogger("esri.views.2d.engine.webgl.WGLTextTemplate"),y=Math.PI/180,k=m.mat2df32.create(),C=d.vec2f32.create();a.default=function(a){return function(a){function b(){for(var b=[],d=0;d<arguments.length;d++)b[d]=arguments[d];b=a.apply(this,b)||this;b.geometryType=z.WGLGeometryType.TEXT;return b}c(b,a);b.prototype.bindTextInfo=function(a,b,d){a=this._computeShaping(a,this._justify).getShaping(b,d);
isNaN(this._decorationTop)||A.TextShaping.addDecoration(a,this._decorationTop);this._shapedGlyphs=a;this._shapedBox=A.TextShaping.getBox(a)};b.prototype.writeMesh=function(a,b,d,c,f){var e=this._computedGlyphs;if(e){var g=v.i8888to32(0,0,this._referenceSize,this._bitset);switch(d){case "esriGeometryPoint":f=f.geometry;d=f.x;f=f.y;for(var k=0;k<e.length;k++){var l=e[k];l.anchorX=d;l.anchorY=f}this._writeVertices(a,b,c,e,g,0,0);break;case "esriGeometryPolygon":if(f.centroid){f=f.centroid;d=f.x;f=f.y;
for(k=0;k<e.length;k++)l=e[k],l.anchorX=d,l.anchorY=f;this._writeVertices(a,b,c,e,g,0,0);break}case "esriGeometryMultipoint":for(var k=f.geometry.points,n=f=d=0;n<k.length;n++){l=k[n];d+=l[0];f+=l[1];for(var w=0,m=e;w<m.length;w++)l=m[w],l.anchorX=d,l.anchorY=f;this._writeVertices(a,b,c,e,g,0,0)}break;default:a=void 0,void 0===a&&(a="mapview-processing"),p.error(new h(a,"Unable to handle geometryType: "+d))}}};b.prototype._computeGlyphs=function(a,b){if(a&&0!==a.length){var d=Array(a.length);b=this._computeGlyphTransform(b);
for(var c=q.MaterialKeyBase.load(this._materialKey),f=0;f<a.length;f++){var e=a[f],g=e.x,k=e.y,h=e.codePoint,e=e.glyphMosaicItem;c.textureBinding=e.textureBinding;d[f]=n.default.from(g,k,0,0,-1,0,25,e,h,c.data,b,this._size,this._haloSize,!1,!0)}this._computedGlyphs=d}};b.prototype._createBounds=function(a,b){var c=a.width/2,e=a.height/2,g=b[4],k=b[5],h;if(this._angle){a=d.vec2f32.fromValues(-c,-e);h=d.vec2f32.fromValues(c,-e);var n=d.vec2f32.fromValues(-c,e),w=d.vec2f32.fromValues(c,e);f.vec2.transformMat2d(a,
a,b);f.vec2.transformMat2d(h,h,b);f.vec2.transformMat2d(n,n,b);f.vec2.transformMat2d(w,w,b);b=e=Infinity;var m=0,p=c=0;for(a=[a,h,n,w];p<a.length;p++)h=a[p],e=Math.min(h[0],e),m=Math.max(h[0],m),b=Math.min(h[1],b),c=Math.max(h[1],c);h=m-e;a=c-b}else h=a.width*this._scale,a=a.height*this._scale;return new u.default(g,k,h+l.COLLISION_BOX_PADDING,a+l.COLLISION_BOX_PADDING)};b.prototype._computeShaping=function(a,b){return new A.TextShaping([a],512,l.TEXT_LINE_HEIGHT,l.TEXT_SPACING,[0,.5*-l.TEXT_LINE_HEIGHT],
.5*(1-this._xAlignD),0,b)};b.prototype._computeGlyphTransform=function(a){var b=this._scale,d=this._angle*y,c=g.mat2d.identity(k);g.mat2d.rotate(c,c,d);g.mat2d.translate(c,c,f.vec2.set(C,this._xOffset,-this._yOffset));g.mat2d.scale(c,c,f.vec2.set(C,b,b));g.mat2d.translate(c,c,f.vec2.set(C,-4,-4-(this._baseline?25:a.y+(1-this._yAlignD)*a.height*.5)));return c};b.prototype._writeVertices=function(a,b,d,c,f,e,g){this._writeHalos(a,b,d,c,f,e,g);this._writeText(a,b,d,c,f,e,g)};b.prototype._writeHalos=
function(a,b,d,c,f,e,g){var h=b.indexVector,k=b.getVector("geometry").vertexCount,l=0;if(this._haloSize)for(var n=0;n<c.length;n++,l+=4){var w=c[n],m=v.i1616to32(2*w.anchorX+1,2*w.anchorY),p=null==e?Math.floor(10*w.minZoom):e,q=null==g?Math.floor(10*w.maxZoom):g,u=new x(d,this.geometryType,w.materialKey,p,q);u.vertexFrom=k+l;u.indexFrom=h.length;this._writeVertex(u,b,d,m,this._haloColor,w,f,p,q);this._writeIndices(u,h,k+l);a.push(u)}};b.prototype._writeText=function(a,b,d,c,f,e,g){for(var h=b.indexVector,
k=b.getVector("geometry").vertexCount,l=0,n=0;n<c.length;n++,l+=4){var w=c[n],m=v.i1616to32(2*w.anchorX,2*w.anchorY),p=null==e?Math.floor(10*w.minZoom):e,q=null==g?Math.floor(10*w.maxZoom):g,u=new x(d,this.geometryType,w.materialKey,p,q);u.vertexFrom=k+l;u.indexFrom=h.length;this._writeVertex(u,b,d,m,this._color,w,f,p,q);this._writeIndices(u,h,k+l);a.push(u)}};b.prototype._writeVertex=function(a,b,d,c,f,e,g,h,k){b=b.get("geometry");b.push(c);b.push(d);b.push(f);b.push(e.vertexOffsetUpperLeft);b.push(e.texFontSizeUpperLeft);
b.push(g);b.push(c);b.push(d);b.push(f);b.push(e.vertexOffsetUpperRight);b.push(e.texFontSizeUpperRight);b.push(g);b.push(c);b.push(d);b.push(f);b.push(e.vertexOffsetLowerLeft);b.push(e.texFontSizeLowerLeft);b.push(g);b.push(c);b.push(d);b.push(f);b.push(e.vertexOffsetLowerRight);b.push(e.texFontSizeLowerRight);b.push(g);a.vertexCount+=4};b.prototype._writeIndices=function(a,b,d){b.push(d+0);b.push(d+1);b.push(d+2);b.push(d+1);b.push(d+3);b.push(d+2);a.indexCount+=6};return b}(a)}})},"esri/views/2d/engine/webgl/TextShapingNew":function(){define(["require",
"exports","./Rect"],function(e,a,c){Object.defineProperty(a,"__esModule",{value:!0});e=function(){function a(a,c,e,f,d,h,z,v){this._glyphItems=a;this._maxWidth=c;this._lineHeight=e;this._letterSpacing=f;this._offset=d;this._hAnchor=h;this._vAnchor=z;this._justify=v}a.prototype.getShaping=function(a,c){for(var b=this._letterSpacing,f=this._lineHeight,d=this._justify,e=this._maxWidth,g=[],h=0,A=0,x=0,u=0,q=-1,n=0,p=-1,y=a.length,k=0;k<y;k++){var C=a.charCodeAt(k);if(10===C){if(k!==y-1){if(q>=u){var h=
g[q],w=h.x+h.glyphMosaicItem.metrics.advance,n=Math.max(w,n);d&&this._applyJustification(g,u,q);u=g.length}A=c?A-f:A+f;h=0;++x}}else{for(var w=void 0,B=0,E=this._glyphItems;B<E.length&&!(w=E[B][C]);B++);if(w){g.push({codePoint:C,x:h,y:A,glyphMosaicItem:w});h+=w.metrics.advance+b;if(0<e&&h>e&&0<=p){B=p+1;w=g[B].x;n=Math.max(w,n);for(E=B;E<g.length;E++)g[E].y=c?g[E].y-f:g[E].y+f,g[E].x-=w;d&&this._applyJustification(g,u,p);A=c?A-f:A+f;h-=w;++x;u=B;p=-1}++q;32===C&&(p=g.length-1)}}}q>=u&&(h=g[q],n=Math.max(n,
h.x+h.glyphMosaicItem.metrics.advance),d&&this._applyJustification(g,u,q));if(0<g.length)for(a=(d-this._hAnchor)*n,b=(-this._vAnchor*(x+1)+.5)*f,c&&x&&(b+=x*f),a+=this._offset[0],b+=this._offset[1],c=0;c<g.length;c++)f=g[c],f.x+=a,f.y+=b;return g};a.prototype.getEstimatedShaping=function(a,c,e){for(var b=this._letterSpacing,d=this._lineHeight,g=this._justify,h=this._maxWidth,m=[],A=0,x=0,u=0,q=0,n=-1,p=0,y=-1,k=a.length,C=0;C<k;C++){var w=a.charCodeAt(C);if(10===w){if(C!==k-1){if(n>=q){var A=m[n],
B=A.x+A.glyphMosaicItem.metrics.advance,p=Math.max(B,p);g&&this._applyJustification(m,q,n);q=m.length}x=c?x-d:x+d;A=0;++u}}else{B=e;m.push({codePoint:w,x:A,y:x,glyphMosaicItem:B});A+=B.metrics.advance+b;if(0<h&&A>h&&0<=y){for(var E=y+1,B=m[E].x,p=Math.max(B,p),G=E;G<m.length;G++)m[G].y=c?m[G].y-d:m[G].y+d,m[G].x-=B;g&&this._applyJustification(m,q,y);x=c?x-d:x+d;A-=B;++u;q=E;y=-1}++n;32===w&&(y=m.length-1)}}n>=q&&(A=m[n],p=Math.max(p,A.x+A.glyphMosaicItem.metrics.advance),g&&this._applyJustification(m,
q,n));if(0<m.length)for(a=(g-this._hAnchor)*p,e=(-this._vAnchor*(u+1)+.5)*d,c&&u&&(e+=u*d),a+=this._offset[0],e+=this._offset[1],c=0;c<m.length;c++)d=m[c],d.x+=a,d.y+=e;return m};a.getBox=function(a){if(!a.length)return null;for(var b=Infinity,c=Infinity,f=-Infinity,d=-Infinity,e=0;e<a.length;e++)var h=a[e],v=h.glyphMosaicItem.metrics,A=h.x+v.left,h=h.y-v.top,x=A+v.width,v=h+v.height,b=Math.min(b,A),f=Math.max(f,x),c=Math.min(c,h),d=Math.max(d,v);return{x:b,y:c,width:f-b,height:d-c}};a.addDecoration=
function(a,e){var b=a.length;if(0!==b){for(var f=a[0].x+a[0].glyphMosaicItem.metrics.left,d=a[0].y,g=1;g<b;g++){var h=a[g];if(h.y!==d){var v=a[g-1].x+a[g-1].glyphMosaicItem.metrics.left+a[g-1].glyphMosaicItem.metrics.width;a.push({codePoint:0,x:f,y:d,glyphMosaicItem:{sdf:!0,rect:new c.default(4,0,4,8),metrics:{width:v-f,height:2,left:0,top:e,advance:0},page:0}});d=h.y;f=h.x+h.glyphMosaicItem.metrics.left}}b=a[b-1].x+a[b-1].glyphMosaicItem.metrics.left+a[b-1].glyphMosaicItem.metrics.width;a.push({codePoint:0,
x:f,y:d,glyphMosaicItem:{sdf:!0,rect:new c.default(4,0,4,8),metrics:{width:b-f,height:2,left:0,top:e,advance:0},page:0}})}};a.prototype._applyJustification=function(a,c,e){for(var b=a[e],b=(b.x+b.glyphMosaicItem.metrics.advance)*this._justify;c<=e;c++)a[c].x-=b};return a}();a.TextShaping=e})},"esri/views/2d/engine/webgl/WGLDisplayRecord":function(){define(["require","exports","./MeshData","./Utils"],function(e,a,c,h){return function(){function a(a,b,c,d,e){void 0===d&&(d=0);void 0===e&&(e=0);this.id=
a;this.geometryType=b;this.materialKey=c;this.minZoom=d;this.maxZoom=e;this.meshData=null;this.indexCount=this.indexFrom=this.vertexCount=this.vertexFrom=this.zOrder=this.symbolLevel=0}Object.defineProperty(a.prototype,"sortKey",{get:function(){void 0===this._sortKey&&this._computeSortKey();return this._sortKey},enumerable:!0,configurable:!0});a.prototype.clone=function(){return this.copy()};a.prototype.copy=function(){var b=new a(this.id,this.geometryType,this.materialKey);b.vertexFrom=this.vertexFrom;
b.vertexCount=this.vertexCount;b.indexFrom=this.indexFrom;b.indexCount=this.indexCount;b.zOrder=this.zOrder;b.symbolLevel=this.symbolLevel;b.meshData=this.meshData;b.minZoom=this.minZoom;b.maxZoom=this.maxZoom;return b};a.prototype.setMeshDataFromBuffers=function(a,b,f){var d=new c,e;for(e in b){for(var g=b[e].stride,m=b[e].data,A=[],x=h.strideToPackingFactor(g),u=0;u<g*a.vertexCount/x;++u)A[u]=m[u+g*a.vertexFrom/x];d.vertexData.set(e,A)}for(u=d.indexData.length=0;u<a.indexCount;++u)d.indexData[u]=
f[u+a.indexFrom]-a.vertexFrom;d.vertexCount=a.vertexCount;this.meshData=d};a.prototype.readMeshDataFromBuffers=function(a,b){this.meshData?this.meshData.clear():this.meshData=new c;for(var f in a){for(var d=a[f].stride,e=a[f].data,g=[],m=h.strideToPackingFactor(d),A=0;A<d*this.vertexCount/m;++A)g[A]=e[A+d*this.vertexFrom/m];this.meshData.vertexData.set(f,g)}for(A=this.meshData.indexData.length=0;A<this.indexCount;++A)this.meshData.indexData[A]=b[A+this.indexFrom]-this.vertexFrom;this.meshData.vertexCount=
this.vertexCount};a.prototype.writeMeshDataToBuffers=function(a,b,c,d){for(var f in b)for(var e=b[f].stride,g=this.meshData.vertexData.get(f),m=b[f].data,x=h.strideToPackingFactor(e),u=0;u<e*this.meshData.vertexCount/x;++u)m[u+e*a/x]=g[u];for(u=0;u<this.meshData.indexData.length;++u)d[u+c]=this.meshData.indexData[u]+a;this.vertexFrom=a;this.vertexCount=this.meshData.vertexCount;this.indexFrom=c;this.indexCount=this.meshData.indexData.length};a.writeAllMeshDataToBuffers=function(a,b,c){for(var d=0,
f=0,e=0;e<a.length;e++){var g=a[e];g.writeMeshDataToBuffers(d,b,f,c);d+=g.vertexCount;f+=g.indexCount}};a.prototype._computeSortKey=function(){this._sortKey=(this.symbolLevel&31)<<12|(this.zOrder&127)<<4|this.geometryType&7};a.prototype.serialize=function(a){a.push(this.geometryType);a.push(this.materialKey);a.push(this.symbolLevel);a.push(this.zOrder);a.push(this.vertexFrom);a.push(this.vertexCount);a.push(this.indexFrom);a.push(this.indexCount);a.push(this.minZoom);a.push(this.maxZoom);return a};
a.deserialize=function(b,c){var f=b.readInt32(),d=b.readInt32();c=new a(c.id,f,d);c.symbolLevel=b.readInt32();c.zOrder=b.readInt32();c.vertexFrom=b.readInt32();c.vertexCount=b.readInt32();c.indexFrom=b.readInt32();c.indexCount=b.readInt32();c.minZoom=b.readInt32();c.maxZoom=b.readInt32();return c};return a}()})},"esri/views/2d/engine/webgl/MeshData":function(){define(["require","exports"],function(e,a){return function(){function a(){this.vertexData=new Map;this.vertexCount=0;this.indexData=[]}a.prototype.clear=
function(){this.vertexData.clear();this.vertexCount=0;this.indexData=[]};a.prototype.update=function(a,b,c){for(var e in a)this.vertexData.set(e,a[e]);for(e in this.vertexData)null===a[e]&&this.vertexData.delete(e);this.vertexCount=b;this.indexData=c};return a}()})},"esri/views/2d/engine/webgl/mesh/templates/WGLMeshTemplate":function(){define(["require","exports","../../../../../../core/tsSupport/extendsHelper"],function(e,a,c){Object.defineProperty(a,"__esModule",{value:!0});e=function(){function a(){}
a.prototype.writeMesh=function(a,c,e,f,d){};a.prototype.bindFeature=function(a,c,e){};return a}();a.default=e})},"esri/views/2d/engine/webgl/util/BidiText":function(){define(["require","exports","dojox/string/BidiEngine"],function(e,a,c){Object.defineProperty(a,"__esModule",{value:!0});var h=new c;a.bidiText=function(a){if(!h.hasBidiChar(a))return[a,!1];var b;b="rtl"===h.checkContextual(a)?"IDNNN":"ICNNN";return[h.bidiTransform(a,b,"VLYSN"),!0]}})},"dojox/string/BidiEngine":function(){define(["dojo/_base/lang",
"dojo/_base/declare","dojo/Stateful"],function(e,a,c){function h(a,d,c,e,k){var l=a;void 0===d&&(d=k.defInFormat);void 0===c&&(c=k.defOutFormat);void 0===e&&(e=k.defSwap);if(d!==c){var n,w=d.substring(0,1);n=d.substring(1,4);var m=c.substring(0,1),p=c.substring(1,4);"C"===n.charAt(0)&&(n=b(l),n="ltr"===n||"rtl"===n?n.toUpperCase():"L"===d.charAt(2)?"LTR":"RTL",d=w+n);"C"===p.charAt(0)&&(n=b(l),"rtl"===n?p="RTL":"ltr"===n?(l=l.split(""),l.reverse(),n=b(l.join("")),p=n.toUpperCase()):p="L"===c.charAt(2)?
"LTR":"RTL",c=m+p)}if(d===c)return a;m=d.substring(0,1);l=d.substring(1,4);w=c.substring(0,1);p=c.substring(1,4);k.inFormat=d;k.outFormat=c;k.swap=e;if("L"===m&&"VLTR"===c){if("LTR"===l)return k.dir=E,g(a,k);if("RTL"===l)return k.dir=G,g(a,k)}if("V"===m&&"V"===w)return k.dir="RTL"===l?G:E,f(a,k);if("L"===m&&"VRTL"===c)return k.dir="LTR"===l?E:G,a=g(a,k),f(a);if("VLTR"===d&&"LLTR"===c)return k.dir=E,g(a,k);if("V"===m&&"L"===w&&l!==p)return a=f(a),"RTL"===l?h(a,"LLTR","VLTR",e,k):h(a,"LRTL","VRTL",
e,k);if("VRTL"===d&&"LRTL"===c)return h(a,"LRTL","VRTL",e,k);if("L"===m&&"L"===w)return d=k.swap,k.swap=d.substr(0,1)+"N","RTL"===l?(k.dir=G,a=g(a,k),k.swap="N"+d.substr(1,2),k.dir=E,a=g(a,k)):(k.dir=E,a=g(a,k),k.swap="N"+d.substr(1,2),a=h(a,"VLTR","LRTL",k.swap,k)),a}function b(a){return(a=/[A-Za-z\u05d0-\u065f\u066a-\u06ef\u06fa-\u07ff\ufb1d-\ufdff\ufe70-\ufefc]/.exec(a))?"z">=a[0]?"ltr":"rtl":""}function g(a,b){a=a.split("");var d=[];m(a,d,b);if(0!==b.hiLevel&&b.swap.substr(0,1)!==b.swap.substr(1,
2))for(var c=0;c<a.length;c++)if(1===d[c]){var f=c,e;b:{e=a[c];for(var g=void 0,h=0,l=J.length-1;h<=l;)if(g=Math.floor((h+l)/2),e<J[g][0])l=g-1;else if(e>J[g][0])h=g+1;else{e=J[g][1];break b}}a[f]=e}z(2,a,d,b);z(1,a,d,b);k=d;return a.join("")}function m(a,b,d){var c=a.length,f=d.dir?ga:W,e=null,g=null,k=null,e=0,g=g=null,h=-1,l=g=null,n=[],m=[];d.hiLevel=d.dir;d.lastArabic=!1;d.hasUbatAl=!1;d.hasUbatB=!1;d.hasUbatS=!1;for(g=0;g<c;g++){var l=g,k=a[g].charCodeAt(0),p=qa[k>>8];n[l]=p<fa?p:ra[p-fa][k&
255]}for(l=0;l<c;l++){m[l]=g=v(a,n,m,l,d);e=f[e][g];g=e&240;e&=15;b[l]=k=f[e][w];if(0<g){if(16===g)for(g=h;g<l;g++)b[g]=1;h=-1}if(g=f[e][B])-1===h&&(h=l);else if(-1<h){for(g=h;g<l;g++)b[g]=k;h=-1}n[l]===ka&&(b[l]=0);d.hiLevel|=k}if(d.hasUbatS)for(a=0;a<c;a++)if(n[a]===aa)for(b[a]=d.dir,f=a-1;0<=f;f--)if(n[f]===ma)b[f]=d.dir;else break}function f(a,b){a=a.split("");if(b){var d=[];m(a,d,b);k=d}a.reverse();p.reverse();return a.join("")}function d(a){for(var b=0;b<V.length;b++)if(a>=V[b]&&a<=Z[b])return!0;
return!1}function l(a,b,c,f){for(;b*c<f&&x(a[b]);)b+=c;return b*c<f&&d(a[b])?!0:!1}function z(a,b,d,c){if(!(c.hiLevel<a))if(1!==a||c.dir!==G||c.hasUbatB){c=b.length;for(var f=0,e,g,k;f<c;){if(d[f]>=a){for(e=f+1;e<c&&d[e]>=a;)e++;for(g=e-1;f<g;f++,g--)k=b[f],b[f]=b[g],b[g]=k,k=p[f],p[f]=p[g],p[g]=k;f=e}f++}}else b.reverse(),p.reverse()}function v(a,b,d,c,f){return{UBAT_L:function(){f.lastArabic=!1;return T},UBAT_R:function(){f.lastArabic=!1;return ha},UBAT_ON:function(){return X},UBAT_AN:function(){return ba},
UBAT_EN:function(){return f.lastArabic?ba:ea},UBAT_AL:function(){f.lastArabic=!0;f.hasUbatAl=!0;return ha},UBAT_WS:function(){return X},UBAT_CS:function(){var a,e;if(1>c||c+1>=b.length||(a=d[c-1])!==ea&&a!==ba||(e=b[c+1])!==ea&&e!==ba)return X;f.lastArabic&&(e=ba);return e===a?e:X},UBAT_ES:function(){return(0<c?d[c-1]:ka)===ea&&c+1<b.length&&b[c+1]===ea?ea:X},UBAT_ET:function(){if(0<c&&d[c-1]===ea)return ea;if(f.lastArabic)return X;for(var a=c+1,e=b.length;a<e&&b[a]===na;)a++;return a<e&&b[a]===ea?
ea:X},UBAT_NSM:function(){if("VLTR"===f.inFormat){for(var e=b.length,g=c+1;g<e&&b[g]===oa;)g++;if(g<e&&(e=a[c],g=b[g],(1425<=e&&2303>=e||64286===e)&&(g===ha||g===ja)))return ha}return 1>c||b[c-1]===ka?X:d[c-1]},UBAT_B:function(){f.lastArabic=!0;f.hasUbatB=!0;return f.dir},UBAT_S:function(){f.hasUbatS=!0;return X},UBAT_LRE:function(){f.lastArabic=!1;return X},UBAT_RLE:function(){f.lastArabic=!1;return X},UBAT_LRO:function(){f.lastArabic=!1;return X},UBAT_RLO:function(){f.lastArabic=!1;return X},UBAT_PDF:function(){f.lastArabic=
!1;return X},UBAT_BN:function(){return X}}[pa[b[c]]]()}function A(a,b){for(var c=0;c<I.length;c++)if(a===I[c])return b[c];return a}function x(a){return"\u064b"<=a&&"\u0655">=a?!0:!1}function u(a){if("L"===a)return"LTR";if("R"===a)return"RTL";if("C"===a)return"CLR";if("D"===a)return"CRL"}function q(a,b){for(var c=0;c<L.length;c++)if(a===L[c])return b[c];return a}function n(a,b,c,d){for(var f=0;f<a.length;f++)if(a[f]>b||!c&&a[f]===b)a[f]+=d}e.getObject("string",!0,dojox);e=a("dojox.string.BidiEngine",
c,{inputFormat:"ILYNN",outputFormat:"VLNNN",sourceToTarget:[],targetToSource:[],levels:[],bidiTransform:function(a,b,c){this.sourceToTarget=[];this.targetToSource=[];if(!a)return"";var f=this.sourceToTarget,e=this.targetToSource,g=a.length;p=[];k=[];for(var w=0;w<g;w++)f[w]=w,e[w]=w,p[w]=w;if(!this.checkParameters(b,c))return a;b=this.inputFormat;c=this.outputFormat;var f=a,f=C,w=u(b.charAt(1)),e=u(c.charAt(1)),m="I"===b.charAt(0)?"L":b.charAt(0),g="I"===c.charAt(0)?"L":c.charAt(0),w=m+w,e=g+e,g=
b.charAt(2)+c.charAt(2);f.defInFormat=w;f.defOutFormat=e;f.defSwap=g;a=h(a,w,e,g,f);f=!1;if("R"===c.charAt(1))f=!0;else if("C"===c.charAt(1)||"D"===c.charAt(1))f=this.checkContextual(a);e=this.sourceToTarget=p;g=Array(e.length);for(w=0;w<e.length;w++)g[e[w]]=w;y=this.targetToSource=g;if(b.charAt(3)===c.charAt(3))f=a;else if("S"===c.charAt(3))if(b=f,c=!0,0===a.length)f=void 0;else{void 0===b&&(b=!0);void 0===c&&(c=!0);a=String(a);a=a.split("");var r=0,e=1,f=a.length;b||(r=a.length-1,e=-1,f=1);for(var g=
f,w=c,t=0,f=[],m=0;r*e<g;r+=e)if(d(a[r])||x(a[r])){var v;if(v="\u0644"===a[r])b:{for(var z=a,B=r+e,F=e,M=g;B*F<M&&x(z[B]);)B+=F;v=" ";if(B*F<M)for(v=z[B],z=0;z<L.length;z++)if(L[z]===v){v=!0;break b}v=!1}if(v){a[r]=0===t?q(a[r+e],K):q(a[r+e],Q);r+=e;t=a;v=r;z=e;for(B=g;v*z<B&&x(t[v]);)v+=z;v*z<B&&(t[v]=" ");w&&(f[m]=r,m++);t=0}else{v=a[r];if(1===t){z=r;if(l(a,r+e,e,g))b:for(B=a[r],F=0;F<I.length;F++){if(B===I[F]){B=N[F];break b}}else B=A(a[r],O);a[z]=B}else!0===l(a,r+e,e,g)?a[r]=A(a[r],H):a[r]=A(a[r],
R);x(v)||(t=1);b:{for(z=0;z<U.length;z++)if(U[z]===v){v=!0;break b}v=!1}!0===v&&(t=0)}}else t=0;e="";for(g=0;g<a.length;g++){if(w=c){b:{for(w=0;w<f.length;w++)if(f[w]===g)break b;w=-1}w=-1<w}w?(n(y,g,!b,-1),p.splice(g,1)):e+=a[g]}f=e}else if(b=a,c=f,a=!0,0===b.length)f=void 0;else for(void 0===a&&(a=!0),void 0===c&&(c=!0),b=String(b),f="",e=[],e=b.split(""),g=0;g<b.length;g++)w=!1,"\ufe70"<=e[g]&&"\ufeff">e[g]?(m=b.charCodeAt(g),"\ufef5"<=e[g]&&"\ufefc">=e[g]?(c?(0<g&&a&&" "===e[g-1]?f=f.substring(0,
f.length-1)+"\u0644":(f+="\u0644",w=!0),f+=L[(m-65269)/2]):(f+=L[(m-65269)/2],f+="\u0644",g+1<b.length&&a&&" "===e[g+1]?g++:w=!0),w&&(n(y,g,!0,1),p.splice(g,0,p[g]))):f+=da[m-65136]):f+=e[g];this.sourceToTarget=p;this.targetToSource=y;this.levels=k;return f},_inputFormatSetter:function(a){if(!F.test(a))throw Error("dojox/string/BidiEngine: the bidi layout string is wrong!");this.inputFormat=a},_outputFormatSetter:function(a){if(!F.test(a))throw Error("dojox/string/BidiEngine: the bidi layout string is wrong!");
this.outputFormat=a},checkParameters:function(a,b){a?this.set("inputFormat",a):a=this.inputFormat;b?this.set("outputFormat",b):b=this.outputFormat;return a===b?!1:!0},checkContextual:function(a){a=b(a);if("ltr"!==a&&"rtl"!==a){try{a=document.dir.toLowerCase()}catch(sa){}"ltr"!==a&&"rtl"!==a&&(a="ltr")}return a},hasBidiChar:function(a){return M.test(a)}});var p=[],y=[],k=[],C={dir:0,defInFormat:"LLTR",defoutFormat:"VLTR",defSwap:"YN",inFormat:"LLTR",outFormat:"VLTR",swap:"YN",hiLevel:0,lastArabic:!1,
hasUbatAl:!1,hasBlockSep:!1,hasSegSep:!1},w=5,B=6,E=0,G=1,F=/^[(I|V)][(L|R|C|D)][(Y|N)][(S|N)][N]$/,M=/[\u0591-\u06ff\ufb1d-\ufefc]/,J=[["(",")"],[")","("],["\x3c","\x3e"],["\x3e","\x3c"],["[","]"],["]","["],["{","}"],["}","{"],["\u00ab","\u00bb"],["\u00bb","\u00ab"],["\u2039","\u203a"],["\u203a","\u2039"],["\u207d","\u207e"],["\u207e","\u207d"],["\u208d","\u208e"],["\u208e","\u208d"],["\u2264","\u2265"],["\u2265","\u2264"],["\u2329","\u232a"],["\u232a","\u2329"],["\ufe59","\ufe5a"],["\ufe5a","\ufe59"],
["\ufe5b","\ufe5c"],["\ufe5c","\ufe5b"],["\ufe5d","\ufe5e"],["\ufe5e","\ufe5d"],["\ufe64","\ufe65"],["\ufe65","\ufe64"]],L=["\u0622","\u0623","\u0625","\u0627"],K=["\ufef5","\ufef7","\ufef9","\ufefb"],Q=["\ufef6","\ufef8","\ufefa","\ufefc"],I="\u0627\u0628\u062a\u062b\u062c\u062d\u062e\u062f\u0630\u0631\u0632\u0633\u0634\u0635\u0636\u0637\u0638\u0639\u063a\u0641\u0642\u0643\u0644\u0645\u0646\u0647\u0648\u064a\u0625\u0623\u0622\u0629\u0649\u0644\u0645\u0646\u0647\u0648\u064a\u0625\u0623\u0622\u0629\u0649\u06cc\u0626\u0624".split(""),
R="\ufe8d\ufe8f\ufe95\ufe99\ufe9d\ufea1\ufea5\ufea9\ufeab\ufead\ufeaf\ufeb1\ufeb5\ufeb9\ufebd\ufec1\ufec5\ufec9\ufecd\ufed1\ufed5\ufed9\ufedd\ufee1\ufee5\ufee9\ufeed\ufef1\ufe87\ufe83\ufe81\ufe93\ufeef\ufbfc\ufe89\ufe85\ufe70\ufe72\ufe74\ufe76\ufe78\ufe7a\ufe7c\ufe7e\ufe80\ufe89\ufe85".split(""),O="\ufe8e\ufe90\ufe96\ufe9a\ufe9e\ufea2\ufea6\ufeaa\ufeac\ufeae\ufeb0\ufeb2\ufeb6\ufeba\ufebe\ufec2\ufec6\ufeca\ufece\ufed2\ufed6\ufeda\ufede\ufee2\ufee6\ufeea\ufeee\ufef2\ufe88\ufe84\ufe82\ufe94\ufef0\ufbfd\ufe8a\ufe86\ufe70\ufe72\ufe74\ufe76\ufe78\ufe7a\ufe7c\ufe7e\ufe80\ufe8a\ufe86".split(""),
N="\ufe8e\ufe92\ufe98\ufe9c\ufea0\ufea4\ufea8\ufeaa\ufeac\ufeae\ufeb0\ufeb4\ufeb8\ufebc\ufec0\ufec4\ufec8\ufecc\ufed0\ufed4\ufed8\ufedc\ufee0\ufee4\ufee8\ufeec\ufeee\ufef4\ufe88\ufe84\ufe82\ufe94\ufef0\ufbff\ufe8c\ufe86\ufe71\ufe72\ufe74\ufe77\ufe79\ufe7b\ufe7d\ufe7f\ufe80\ufe8c\ufe86".split(""),H="\ufe8d\ufe91\ufe97\ufe9b\ufe9f\ufea3\ufea7\ufea9\ufeab\ufead\ufeaf\ufeb3\ufeb7\ufebb\ufebf\ufec3\ufec7\ufecb\ufecf\ufed3\ufed7\ufedb\ufedf\ufee3\ufee7\ufeeb\ufeed\ufef3\ufe87\ufe83\ufe81\ufe93\ufeef\ufbfe\ufe8b\ufe85\ufe70\ufe72\ufe74\ufe76\ufe78\ufe7a\ufe7c\ufe7e\ufe80\ufe8b\ufe85".split(""),
U="\u0621\u0622\u0623\u0624\u0625\u0627\u0629\u062f\u0630\u0631\u0632\u0648\u0649".split(""),da="\u064b\u064b\u064c\u061f\u064d\u061f\u064e\u064e\u064f\u064f\u0650\u0650\u0651\u0651\u0652\u0652\u0621\u0622\u0622\u0623\u0623\u0624\u0624\u0625\u0625\u0626\u0626\u0626\u0626\u0627\u0627\u0628\u0628\u0628\u0628\u0629\u0629\u062a\u062a\u062a\u062a\u062b\u062b\u062b\u062b\u062c\u062c\u062c\u062c\u062d\u062d\u062d\u062d\u062e\u062e\u062e\u062e\u062f\u062f\u0630\u0630\u0631\u0631\u0632\u0632\u0633\u0633\u0633\u0633\u0634\u0634\u0634\u0634\u0635\u0635\u0635\u0635\u0636\u0636\u0636\u0636\u0637\u0637\u0637\u0637\u0638\u0638\u0638\u0638\u0639\u0639\u0639\u0639\u063a\u063a\u063a\u063a\u0641\u0641\u0641\u0641\u0642\u0642\u0642\u0642\u0643\u0643\u0643\u0643\u0644\u0644\u0644\u0644\u0645\u0645\u0645\u0645\u0646\u0646\u0646\u0646\u0647\u0647\u0647\u0647\u0648\u0648\u0649\u0649\u064a\u064a\u064a\u064a\ufef5\ufef6\ufef7\ufef8\ufef9\ufefa\ufefb\ufefc\u061f\u061f\u061f".split(""),
V=["\u0621","\u0641"],Z=["\u063a","\u064a"],W=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],ga=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],T=0,ha=1,ea=2,ba=3,X=4,ka=5,aa=6,ja=7,ma=8,na=11,oa=12,pa="UBAT_L UBAT_R UBAT_EN UBAT_AN UBAT_ON UBAT_B UBAT_S UBAT_AL UBAT_WS UBAT_CS UBAT_ES UBAT_ET UBAT_NSM UBAT_LRE UBAT_RLE UBAT_PDF UBAT_LRO UBAT_RLO UBAT_BN".split(" "),fa=100;a=T;c=ha;var P=ea,Y=ba,r=X,ia=ka,la=aa,t=ja,ca=ma,S=
na,D=oa,qa=[fa+0,a,a,a,a,fa+1,fa+2,fa+3,c,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,fa+4,r,r,r,a,r,a,r,a,r,r,r,a,a,r,r,a,a,a,a,a,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,a,a,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,a,a,a,a,a,a,a,a,a,a,a,a,a,a,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,a,a,r,r,a,a,r,r,a,a,r,r,r,r,r,r,r,r,r,r,r,r,
r,r,r,r,r,r,r,r,r,r,r,a,a,a,fa+5,t,t,fa+6,fa+7],ra=[[18,18,18,18,18,18,18,18,18,la,ia,la,ca,ia,18,18,18,18,18,18,18,18,18,18,18,18,18,18,ia,ia,ia,la,ca,r,r,S,S,S,r,r,r,r,r,10,9,10,9,9,P,P,P,P,P,P,P,P,P,P,9,r,r,r,r,r,r,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,r,r,r,r,r,r,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,r,r,r,r,18,18,18,18,18,18,ia,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,9,r,S,S,S,S,r,r,r,r,a,r,r,18,r,r,S,S,P,P,r,a,r,r,r,P,a,r,r,r,
r,r,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,r,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,r,a,a,a,a,a,a,a,a],[a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,r,r,r,r,r,r,r,r,r,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,r,r,a,a,a,a,a,a,a,r,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,r,a,r,r,r,r,r,r,r,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,
D,D,D,D,D,D,c,D,c,D,D,c,D,D,c,D,r,r,r,r,r,r,r,r,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,r,r,r,r,r,c,c,c,c,c,r,r,r,r,r,r,r,r,r,r,r],[Y,Y,Y,Y,r,r,r,r,t,S,S,t,9,t,r,r,D,D,D,D,D,D,D,D,D,D,D,t,r,r,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,S,Y,Y,t,t,t,D,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,
t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,D,D,D,D,D,D,D,Y,r,D,D,D,D,D,D,t,t,D,D,r,D,D,D,D,t,t,P,P,P,P,P,P,P,P,P,P,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t,r,t,t,D,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,r,r,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,D,D,D,D,D,D,
D,D,D,D,D,t,r,r,r,r,r,r,r,r,r,r,r,r,r,r,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,D,D,D,D,D,D,D,D,D,c,c,r,r,r,r,c,r,r,r,r,r],[ca,ca,ca,ca,ca,ca,ca,ca,ca,ca,ca,18,18,18,a,c,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,ca,ia,13,14,15,16,17,9,S,S,S,S,S,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,9,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,ca,18,18,18,18,18,r,r,r,r,r,18,18,18,18,18,18,P,a,r,r,P,P,P,P,P,P,10,10,r,r,r,a,P,P,P,P,P,P,P,P,P,P,10,10,r,r,r,r,a,a,a,
a,a,a,a,a,a,a,a,a,a,r,r,r,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r],[a,a,a,a,a,a,a,r,r,r,r,r,r,r,r,r,r,r,r,a,a,a,a,a,r,r,r,r,r,c,D,c,c,c,c,c,c,c,c,c,c,10,c,c,c,c,c,c,c,c,c,c,c,c,c,r,c,c,c,c,c,r,c,r,c,c,r,c,c,r,c,c,c,c,c,c,c,c,c,c,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,
t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t],[D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,D,D,D,D,D,D,D,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,9,r,9,r,r,9,r,r,r,r,r,r,r,r,r,S,r,r,10,10,r,r,r,r,r,S,S,r,r,r,r,r,t,t,t,t,t,r,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,
t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,r,r,18],[r,r,r,S,S,S,r,r,r,r,r,10,9,10,9,9,P,P,P,P,P,P,P,P,P,P,9,r,r,r,r,r,r,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,r,r,r,r,r,r,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,r,r,r,r,r,r,r,r,r,r,r,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,
a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,r,r,r,a,a,a,a,a,a,r,r,a,a,a,a,a,a,r,r,a,a,a,a,a,a,r,r,a,a,a,r,r,r,S,S,r,r,r,S,S,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r]];return e})},"dojo/Stateful":function(){define(["./_base/declare","./_base/lang","./_base/array","./when"],function(e,a,c,h){return e("dojo.Stateful",null,{_attrPairNames:{},_getAttrNames:function(a){var b=this._attrPairNames;return b[a]?
b[a]:b[a]={s:"_"+a+"Setter",g:"_"+a+"Getter"}},postscript:function(a){a&&this.set(a)},_get:function(a,c){return"function"===typeof this[c.g]?this[c.g]():this[a]},get:function(a){return this._get(a,this._getAttrNames(a))},set:function(a,c){if("object"===typeof a){for(var b in a)a.hasOwnProperty(b)&&"_watchCallbacks"!=b&&this.set(b,a[b]);return this}b=this._getAttrNames(a);var f=this._get(a,b);b=this[b.s];var d;"function"===typeof b?d=b.apply(this,Array.prototype.slice.call(arguments,1)):this[a]=c;
if(this._watchCallbacks){var e=this;h(d,function(){e._watchCallbacks(a,f,c)})}return this},_changeAttrValue:function(a,c){var b=this.get(a);this[a]=c;this._watchCallbacks&&this._watchCallbacks(a,b,c);return this},watch:function(a,e){var b=this._watchCallbacks;if(!b)var f=this,b=this._watchCallbacks=function(a,c,d,e){var g=function(b){if(b){b=b.slice();for(var e=0,g=b.length;e<g;e++)b[e].call(f,a,c,d)}};g(b["_"+a]);e||g(b["*"])};e||"function"!==typeof a?a="_"+a:(e=a,a="*");var d=b[a];"object"!==typeof d&&
(d=b[a]=[]);d.push(e);a={};a.unwatch=a.remove=function(){var a=c.indexOf(d,e);-1<a&&d.splice(a,1)};return a}})})},"esri/views/2d/engine/webgl/util/vvFlagUtils":function(){define(["require","exports","../enums","../visualVariablesUtils"],function(e,a,c,h){function b(a,b){void 0===b&&(b=!1);var d=c.WGLVVFlag.SIZE_FIELD_STOPS|c.WGLVVFlag.SIZE_MINMAX_VALUE|c.WGLVVFlag.SIZE_SCALE_STOPS|c.WGLVVFlag.SIZE_UNIT_VALUE;a=(a&(c.WGLVVTarget.FIELD_TARGETS_OUTLINE|c.WGLVVTarget.MINMAX_TARGETS_OUTLINE|c.WGLVVTarget.SCALE_TARGETS_OUTLINE|
c.WGLVVTarget.UNIT_TARGETS_OUTLINE))>>>4;return b?d&a:d&~a}function g(a){var f=b(a,!1);return a&(c.WGLVVFlag.COLOR|c.WGLVVFlag.OPACITY|c.WGLVVFlag.ROTATION|f)}Object.defineProperty(a,"__esModule",{value:!0});a.getVVFlags=function(a){if(!a)return c.WGLVVFlag.NONE;for(var b=0,d=0;d<a.length;d++){var e=a[d];if("size"===e.type){var g=h.getTypeOfSizeVisualVariable(e),b=b|g;"outline"===e.target&&(b|=g<<4)}else"color"===e.type?b|=c.WGLVVFlag.COLOR:"opacity"===e.type?b|=c.WGLVVFlag.OPACITY:"rotation"===e.type&&
(b|=c.WGLVVFlag.ROTATION)}return b};a.getSizeFlagsMask=b;a.getMarkerVVFlags=g;a.getFillVVFlags=function(a){return a&(c.WGLVVFlag.COLOR|c.WGLVVFlag.OPACITY)};a.getLineVVFlags=function(a,f){if(f)return f=b(a,!0),a&f;f=b(a,!1);return a&(c.WGLVVFlag.COLOR|c.WGLVVFlag.OPACITY|f)};a.getTextVVFlags=function(a){return g(a)};a.getLabelVVFlags=function(a){var c=b(a,!1);return a&c}})},"esri/views/2d/engine/webgl/visualVariablesUtils":function(){define("require exports ../../../../core/Error ../../../../core/Logger ./enums ./Utils".split(" "),
function(e,a,c,h,b,g){Object.defineProperty(a,"__esModule",{value:!0});var m=h.getLogger("esri.views.2d.engine.webgl");a.getTypeOfSizeVisualVariable=function(a){if(g.isNumber(a.minDataValue)&&g.isNumber(a.maxDataValue)&&null!=a.minSize&&null!=a.maxSize)return b.WGLVVFlag.SIZE_MINMAX_VALUE;if((a.expression&&"view.scale"===a.expression||a.valueExpression&&"$view.scale"===a.valueExpression)&&Array.isArray(a.stops))return b.WGLVVFlag.SIZE_SCALE_STOPS;if((null!=a.field||a.expression&&"view.scale"!==a.expression||
a.valueExpression&&"$view.scale"!==a.valueExpression)&&(Array.isArray(a.stops)||"levels"in a&&a.levels))return b.WGLVVFlag.SIZE_FIELD_STOPS;if((null!=a.field||a.expression&&"view.scale"!==a.expression||a.valueExpression&&"$view.scale"!==a.valueExpression)&&null!=a.valueUnit)return b.WGLVVFlag.SIZE_UNIT_VALUE;m.error(new c("mapview-bad-type","Found invalid size VisualVariable",a));return b.WGLVVFlag.NONE}})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushLabel":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../webgl ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey".split(" "),
function(e,a,c,h,b,g,m,f){Object.defineProperty(a,"__esModule",{value:!0});e=function(a){function d(){return null!==a&&a.apply(this,arguments)||this}c(d,a);d.prototype.dispose=function(){};d.prototype.getGeometryType=function(){return b.WGLGeometryType.LABEL};d.prototype.drawGeometry=function(a,b,c,d,e){var h=a.context,l=a.painter,m=a.state,u=a.rendererInfo,k=c.indexCount,x=c.indexFrom;c=f.LabelMaterialKey.load(c.materialKey);var w=c.mapAligned?1:0;if(w||!(1<=Math.abs(b.key.level-Math.round(100*a.displayLevel)/
100))){var v=g.createProgramDescriptor(c.data,{geometry:[{location:0,name:"a_pos",count:2,type:5122},{location:1,name:"a_id",count:4,type:5121},{location:2,name:"a_color",count:4,type:5121,normalized:!0},{location:3,name:"a_vertexOffset",count:2,type:5122},{location:4,name:"a_texAndSize",count:4,type:5121},{location:5,name:"a_refSymbolAndPlacementOffset",count:4,type:5121},{location:6,name:"a_zoomRangeAndEmpty",count:4,type:5121}]}),z=v.bufferLayouts,v=v.attributes;e=l.materialManager.getMaterialProgram(a,
c,"materials/label",v,e);d=this._getVAO(h,z,v,d);a.context.setStencilFunction(514,0,255);h.bindProgram(e);h.bindVAO(d);this._setSharedUniforms(e,a,b);l.textureManager.bindTextures(h,e,c,4);l=1===w?m.displayViewMat3:m.displayMat3;c.vvSizeMinMaxValue&&e.setUniform4fv("u_vvSizeMinMaxValue",u.vvSizeMinMaxValue);c.vvSizeScaleStops&&e.setUniform1f("u_vvSizeScaleStopsValue",u.vvSizeScaleStopsValue);c.vvSizeFieldStops&&(b=u.getSizeVVFieldStops(b.key.level),e.setUniform1fv("u_vvSizeFieldStopsValues",b.values),
e.setUniform1fv("u_vvSizeFieldStopsSizes",b.sizes));c.vvSizeUnitValue&&e.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",u.vvSizeUnitValueToPixelsRatio);e.setUniform1f("u_mapRotation",Math.floor(m.rotation/360*254));e.setUniform1f("u_mapAligned",w);e.setUniformMatrix3fv("u_displayMat3",l);e.setUniform1f("u_opacity",1);e.setUniform1f("u_zoomLevel",Math.round(10*a.displayLevel));e.setUniform2fv("u_screenSize",a.state.size);h.drawElements(4,k,5125,4*x);h.bindVAO(null);h.setStencilTestEnabled(!0);
h.setBlendingEnabled(!0)}};return d}(m.default);a.default=e})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushLine":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../webgl ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey".split(" "),function(e,a,c,h,b,g,m,f){Object.defineProperty(a,"__esModule",{value:!0});e=function(a){function d(){return null!==a&&a.apply(this,arguments)||this}c(d,a);d.prototype.dispose=function(){};d.prototype.getGeometryType=
function(){return b.WGLGeometryType.LINE};d.prototype.drawGeometry=function(a,b,c,d,e){var h=a.context,l=a.painter,m=a.rendererInfo,u=a.requiredLevel,k=c.indexFrom,x=c.indexCount;c=f.LineMaterialKey.load(c.materialKey);var w=g.createProgramDescriptor(c.data,{geometry:[{location:0,name:"a_pos",count:2,type:5122},{location:1,name:"a_id",count:4,type:5121},{location:2,name:"a_color",count:4,type:5121,normalized:!0},{location:3,name:"a_offsetAndNormal",count:4,type:5120},{location:4,name:"a_accumulatedDistanceAndHalfWidth",
count:2,type:5123},{location:5,name:"a_tlbr",count:4,type:5123},{location:6,name:"a_segmentDirection",count:4,type:5120},{location:7,name:"a_aux",count:2,type:5123}]}),v=w.bufferLayouts,w=w.attributes;e=l.materialManager.getMaterialProgram(a,c,"materials/line",w,e);d=this._getVAO(h,v,w,d);v=1/a.pixelRatio;h.bindProgram(e);h.bindVAO(d);this._setSharedUniforms(e,a,b);c.textureBinding&&l.textureManager.bindTextures(h,e,c);e.setUniform1f("u_zoomFactor",Math.pow(2,u-b.key.level)/a.pixelRatio);e.setUniform1f("u_blur",
0+v);e.setUniform1f("u_antialiasing",v);c.vvSizeMinMaxValue&&e.setUniform4fv("u_vvSizeMinMaxValue",m.vvSizeMinMaxValue);c.vvSizeScaleStops&&e.setUniform1f("u_vvSizeScaleStopsValue",m.vvSizeScaleStopsValue);c.vvSizeFieldStops&&(a=m.getSizeVVFieldStops(b.key.level),e.setUniform1fv("u_vvSizeFieldStopsValues",a.values),e.setUniform1fv("u_vvSizeFieldStopsSizes",a.sizes));c.vvSizeUnitValue&&e.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",m.vvSizeUnitValueToPixelsRatio);c.vvColor&&(e.setUniform1fv("u_vvColorValues",
m.vvColorValues),e.setUniform4fv("u_vvColors",m.vvColors));c.vvOpacity&&(e.setUniform1fv("u_vvOpacityValues",m.vvOpacityValues),e.setUniform1fv("u_vvOpacities",m.vvOpacities));h.setFaceCullingEnabled(!0);h.setFrontFace(2305);h.setCullFace(1029);h.drawElements(4,x,5125,4*k);h.setFaceCullingEnabled(!1);h.bindVAO(null)};return d}(m.default);a.default=e})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushMarker":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/tsSupport/assignHelper ../../../../webgl ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey".split(" "),
function(e,a,c,h,b,g,m,f,d){Object.defineProperty(a,"__esModule",{value:!0});e=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}c(b,a);b.prototype.dispose=function(){};b.prototype.getGeometryType=function(){return g.WGLGeometryType.MARKER};b.prototype.drawGeometry=function(a,b,c,f,e){var g=a.context,h=a.painter,l=a.rendererInfo,k=a.state,q=c.indexCount,w=c.indexFrom;c=d.MarkerMaterialKey.load(c.materialKey);var u=m.createProgramDescriptor(c.data,{geometry:[{location:0,name:"a_pos",
count:2,type:5122},{location:1,name:"a_vertexOffset",count:2,type:5122},{location:2,name:"a_texCoords",count:2,type:5123},{location:3,name:"a_bitSetAndDistRatio",count:4,type:5121},{location:4,name:"a_id",count:4,type:5121},{location:5,name:"a_color",count:4,type:5121,normalized:!0},{location:6,name:"a_outlineColor",count:4,type:5121,normalized:!0},{location:7,name:"a_sizeAndOutlineWidth",count:4,type:5121}]}),x=u.bufferLayouts,u=u.attributes;e=h.materialManager.getMaterialProgram(a,c,"materials/icon",
u,e);f=this._getVAO(g,x,u,f);g.bindProgram(e);g.bindVAO(f);c.textureBinding&&h.textureManager.bindTextures(g,e,c,1);this._setSharedUniforms(e,a,b);e.setUniformMatrix3fv("u_displayMat3",c.vvRotation?k.displayViewMat3:k.displayMat3);c.vvSizeMinMaxValue&&e.setUniform4fv("u_vvSizeMinMaxValue",l.vvSizeMinMaxValue);c.vvSizeScaleStops&&e.setUniform1f("u_vvSizeScaleStopsValue",l.vvSizeScaleStopsValue);c.vvSizeFieldStops&&(a=l.getSizeVVFieldStops(b.key.level),e.setUniform1fv("u_vvSizeFieldStopsValues",a.values),
e.setUniform1fv("u_vvSizeFieldStopsSizes",a.sizes));c.vvSizeUnitValue&&e.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",l.vvSizeUnitValueToPixelsRatio);c.vvColor&&(e.setUniform1fv("u_vvColorValues",l.vvColorValues),e.setUniform4fv("u_vvColors",l.vvColors));c.vvOpacity&&(e.setUniform1fv("u_vvOpacityValues",l.vvOpacityValues),e.setUniform1fv("u_vvOpacities",l.vvOpacities));c.vvRotation&&e.setUniform1f("u_vvRotationType","geographic"===l.vvMaterialParameters.vvRotationType?0:1);g.drawElements(4,
q,5125,4*w);g.bindVAO(null)};return b}(f.default);a.default=e})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushText":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../webgl ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey".split(" "),function(e,a,c,h,b,g,m,f){Object.defineProperty(a,"__esModule",{value:!0});e=function(a){function d(){return null!==a&&a.apply(this,arguments)||this}c(d,a);d.prototype.dispose=function(){};d.prototype.getGeometryType=
function(){return b.WGLGeometryType.TEXT};d.prototype.drawGeometry=function(a,b,c,d,e){var h=a.context,l=a.painter,m=a.rendererInfo,y=a.state,k=c.indexCount,u=c.indexFrom;c=f.TextMaterialKey.load(c.materialKey);var w=g.createProgramDescriptor(c.data,{geometry:[{location:0,name:"a_pos",count:2,type:5122},{location:1,name:"a_id",count:4,type:5121},{location:2,name:"a_color",count:4,type:5121,normalized:!0},{location:3,name:"a_vertexOffset",count:2,type:5122},{location:4,name:"a_texFontSize",count:4,
type:5121},{location:5,name:"a_aux",count:4,type:5120}]}),x=w.bufferLayouts,w=w.attributes;e=l.materialManager.getMaterialProgram(a,c,"materials/text",w,e);d=this._getVAO(h,x,w,d);h.bindProgram(e);h.bindVAO(d);this._setSharedUniforms(e,a,b);l.textureManager.bindTextures(h,e,c,4);e.setUniformMatrix3fv("u_displayMat3",y.displayMat3);c.vvSizeMinMaxValue&&e.setUniform4fv("u_vvSizeMinMaxValue",m.vvSizeMinMaxValue);c.vvSizeScaleStops&&e.setUniform1f("u_vvSizeScaleStopsValue",m.vvSizeScaleStopsValue);c.vvSizeFieldStops&&
(a=m.getSizeVVFieldStops(b.key.level),e.setUniform1fv("u_vvSizeFieldStopsValues",a.values),e.setUniform1fv("u_vvSizeFieldStopsSizes",a.sizes));c.vvSizeUnitValue&&e.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",m.vvSizeUnitValueToPixelsRatio);c.vvColor&&(e.setUniform1fv("u_vvColorValues",m.vvColorValues),e.setUniform4fv("u_vvColors",m.vvColors));c.vvOpacity&&(e.setUniform1fv("u_vvOpacityValues",m.vvOpacityValues),e.setUniform1fv("u_vvOpacities",m.vvOpacities));c.vvRotation&&e.setUniform1f("u_vvRotationType",
"geographic"===m.vvMaterialParameters.vvRotationType?0:1);h.drawElements(4,k,5125,4*u);h.bindVAO(null)};return d}(m.default);a.default=e})},"esri/views/2d/engine/webgl/TileClipper":function(){define(["require","exports","./definitions","./Geometry","./GeometryUtils"],function(e,a,c,h,b){Object.defineProperty(a,"__esModule",{value:!0});var g=function(){return function(a,b,c){this.ratio=a;this.x=b;this.y=c}}();e=function(){function a(a,b,f,e,g){void 0===e&&(e=8);void 0===g&&(g=8);this.lines=[];this.starts=
[];this.pixelRatio=e;this.pixelMargin=g;this.tileSize=c.TILE_SIZE*e;this.dz=a;this.yPos=b;this.xPos=f}a.prototype.setExtent=function(a){this.finalRatio=this.tileSize/a*(1<<this.dz);var b=this.pixelRatio*this.pixelMargin,b=b/this.finalRatio;a>>=this.dz;b>a&&(b=a);this.margin=b;this.xmin=a*this.xPos-b;this.ymin=a*this.yPos-b;this.xmax=this.xmin+a+2*b;this.ymax=this.ymin+a+2*b};a.prototype.reset=function(a){this.type=a;this.lines=[];this.starts=[];this.line=null;this.start=0};a.prototype.moveTo=function(a,
b){this._pushLine();this._prevIsIn=this._isIn(a,b);this._moveTo(a,b,this._prevIsIn);this._prevPt=new h.Point(a,b);this._firstPt=new h.Point(a,b);this._dist=0};a.prototype.lineTo=function(a,b){var c=this._isIn(a,b),d=new h.Point(a,b),f=h.Point.distance(this._prevPt,d),e,l,m;if(c)this._prevIsIn?this._lineTo(a,b,!0):(e=this._prevPt,l=d,a=this._intersect(l,e),this.start=this._dist+f*(1-this._r),this._lineTo(a.x,a.y,!0),this._lineTo(l.x,l.y,!0));else if(this._prevIsIn)l=this._prevPt,e=d,a=this._intersect(l,
e),this._lineTo(a.x,a.y,!0),this._lineTo(e.x,e.y,!1);else{var n=this._prevPt;if(!(n.x<=this.xmin&&d.x<=this.xmin||n.x>=this.xmax&&d.x>=this.xmax||n.y<=this.ymin&&d.y<=this.ymin||n.y>=this.ymax&&d.y>=this.ymax)){a=[];if(n.x<this.xmin&&d.x>this.xmin||n.x>this.xmin&&d.x<this.xmin)b=(this.xmin-n.x)/(d.x-n.x),m=n.y+b*(d.y-n.y),m<=this.ymin?l=!1:m>=this.ymax?l=!0:a.push(new g(b,this.xmin,m));if(n.x<this.xmax&&d.x>this.xmax||n.x>this.xmax&&d.x<this.xmax)b=(this.xmax-n.x)/(d.x-n.x),m=n.y+b*(d.y-n.y),m<=this.ymin?
l=!1:m>=this.ymax?l=!0:a.push(new g(b,this.xmax,m));if(n.y<this.ymin&&d.y>this.ymin||n.y>this.ymin&&d.y<this.ymin)b=(this.ymin-n.y)/(d.y-n.y),m=n.x+b*(d.x-n.x),m<=this.xmin?e=!1:m>=this.xmax?e=!0:a.push(new g(b,m,this.ymin));if(n.y<this.ymax&&d.y>this.ymax||n.y>this.ymax&&d.y<this.ymax)b=(this.ymax-n.y)/(d.y-n.y),m=n.x+b*(d.x-n.x),m<=this.xmin?e=!1:m>=this.xmax?e=!0:a.push(new g(b,m,this.ymax));if(0===a.length)e?l?this._lineTo(this.xmax,this.ymax,!0):this._lineTo(this.xmax,this.ymin,!0):l?this._lineTo(this.xmin,
this.ymax,!0):this._lineTo(this.xmin,this.ymin,!0);else if(1<a.length&&a[0].ratio>a[1].ratio)this.start=this._dist+f*a[1].ratio,this._lineTo(a[1].x,a[1].y,!0),this._lineTo(a[0].x,a[0].y,!0);else for(this.start=this._dist+f*a[0].ratio,e=0;e<a.length;e++)this._lineTo(a[e].x,a[e].y,!0)}this._lineTo(d.x,d.y,!1)}this._dist+=f;this._prevIsIn=c;this._prevPt=d};a.prototype.close=function(){if(2<this.line.length){var a=this._firstPt,b=this._prevPt;a.x===b.x&&a.y===b.y||this.lineTo(a.x,a.y);a=this.line;for(b=
a.length;4<=b;)if(a[0].x===a[1].x&&a[0].x===a[b-2].x||a[0].y===a[1].y&&a[0].y===a[b-2].y)a.pop(),a[0].x=a[b-2].x,a[0].y=a[b-2].y,--b;else break}};a.prototype.result=function(a){void 0===a&&(a=!0);this._pushLine();if(0===this.lines.length)return null;3===this.type&&a&&m.simplify(this.tileSize,this.margin*this.finalRatio,this.lines);return this.lines};a.prototype.resultWithStarts=function(){if(2!==this.type)throw Error("Only valid for lines");this._pushLine();var a=this.lines,b=a.length;if(0===b)return null;
for(var c=[],f=0;f<b;f++)c.push({line:a[f],start:this.starts[f]||0});return c};a.prototype._isIn=function(a,b){return a>=this.xmin&&a<=this.xmax&&b>=this.ymin&&b<=this.ymax};a.prototype._intersect=function(a,b){var c,d,f;if(b.x>=this.xmin&&b.x<=this.xmax)d=b.y<=this.ymin?this.ymin:this.ymax,f=(d-a.y)/(b.y-a.y),c=a.x+f*(b.x-a.x);else if(b.y>=this.ymin&&b.y<=this.ymax)c=b.x<=this.xmin?this.xmin:this.xmax,f=(c-a.x)/(b.x-a.x),d=a.y+f*(b.y-a.y);else{d=b.y<=this.ymin?this.ymin:this.ymax;c=b.x<=this.xmin?
this.xmin:this.xmax;var e=(c-a.x)/(b.x-a.x),g=(d-a.y)/(b.y-a.y);e<g?(f=e,d=a.y+e*(b.y-a.y)):(f=g,c=a.x+g*(b.x-a.x))}this._r=f;return new h.Point(c,d)};a.prototype._pushLine=function(){this.line&&(1===this.type?0<this.line.length&&(this.lines.push(this.line),this.starts.push(this.start)):2===this.type?1<this.line.length&&(this.lines.push(this.line),this.starts.push(this.start)):3===this.type&&3<this.line.length&&(this.lines.push(this.line),this.starts.push(this.start)));this.line=[];this.start=0};
a.prototype._moveTo=function(a,b,c){3!==this.type?c&&(a=Math.round((a-(this.xmin+this.margin))*this.finalRatio),b=Math.round((b-(this.ymin+this.margin))*this.finalRatio),this.line.push(new h.Point(a,b))):(c||(a<this.xmin&&(a=this.xmin),a>this.xmax&&(a=this.xmax),b<this.ymin&&(b=this.ymin),b>this.ymax&&(b=this.ymax)),a=Math.round((a-(this.xmin+this.margin))*this.finalRatio),b=Math.round((b-(this.ymin+this.margin))*this.finalRatio),this.line.push(new h.Point(a,b)),this._is_v=this._is_h=!1)};a.prototype._lineTo=
function(a,b,c){if(3!==this.type)if(c){a=Math.round((a-(this.xmin+this.margin))*this.finalRatio);b=Math.round((b-(this.ymin+this.margin))*this.finalRatio);if(0<this.line.length&&(c=this.line[this.line.length-1],c.equals(a,b)))return;this.line.push(new h.Point(a,b))}else this.line&&0<this.line.length&&this._pushLine();else if(c||(a<this.xmin&&(a=this.xmin),a>this.xmax&&(a=this.xmax),b<this.ymin&&(b=this.ymin),b>this.ymax&&(b=this.ymax)),a=Math.round((a-(this.xmin+this.margin))*this.finalRatio),b=Math.round((b-
(this.ymin+this.margin))*this.finalRatio),this.line&&0<this.line.length){c=this.line[this.line.length-1];var d=c.x===a,f=c.y===b;d&&f||(this._is_h&&d?(c.x=a,c.y=b,c=this.line[this.line.length-2],c.x===a&&c.y===b?(this.line.pop(),1>=this.line.length?this._is_v=this._is_h=!1:(c=this.line[this.line.length-2],this._is_h=c.x===a,this._is_v=c.y===b)):(this._is_h=c.x===a,this._is_v=c.y===b)):this._is_v&&f?(c.x=a,c.y=b,c=this.line[this.line.length-2],c.x===a&&c.y===b?(this.line.pop(),1>=this.line.length?
this._is_v=this._is_h=!1:(c=this.line[this.line.length-2],this._is_h=c.x===a,this._is_v=c.y===b)):(this._is_h=c.x===a,this._is_v=c.y===b)):(this.line.push(new h.Point(a,b)),this._is_h=d,this._is_v=f))}else this.line.push(new h.Point(a,b))};return a}();a.TileClipper=e;e=function(){function a(){}a.prototype.setExtent=function(a){this._ratio=4096===a?1:4096/a};a.prototype.reset=function(a){this.type=a;this.lines=[];this.line=null};a.prototype.moveTo=function(a,b){this.line&&this.lines.push(this.line);
this.line=[];var c=this._ratio;this.line.push(new h.Point(Math.round(a*c),Math.round(b*c)))};a.prototype.lineTo=function(a,b){var c=this._ratio;this.line.push(new h.Point(Math.round(a*c),Math.round(b*c)))};a.prototype.close=function(){var a=this.line;a&&!a[0].isEqual(a[a.length-1])&&a.push(a[0])};a.prototype.result=function(){this.line&&this.lines.push(this.line);if(0===this.lines.length)return null;3===this.type&&1!==this._ratio&&m.simplify(4096,64,this.lines);return this.lines};return a}();a.SimpleBuilder=
e;var m=function(){function a(){}a.simplify=function(b,c,f){if(f){var d=-c,e=b+c,g=-c,h=b+c;b=[];c=[];for(var l=f.length,n=0;n<l;++n){var m=f[n];if(m&&!(2>m.length))for(var y=m[0],k=void 0,z=m.length,w=1;w<z;++w)k=m[w],y.x===k.x&&(y.x<=d&&(y.y>k.y?(b.push(n),b.push(w),b.push(0),b.push(-1)):(c.push(n),c.push(w),c.push(0),c.push(-1))),y.x>=e&&(y.y<k.y?(b.push(n),b.push(w),b.push(1),b.push(-1)):(c.push(n),c.push(w),c.push(1),c.push(-1)))),y.y===k.y&&(y.y<=g&&(y.x<k.x?(b.push(n),b.push(w),b.push(2),b.push(-1)):
(c.push(n),c.push(w),c.push(2),c.push(-1))),y.y>=h&&(y.x>k.x?(b.push(n),b.push(w),b.push(3),b.push(-1)):(c.push(n),c.push(w),c.push(3),c.push(-1)))),y=k}0!==b.length&&0!==c.length&&(a.fillParent(f,c,b),a.fillParent(f,b,c),d=[],a.calcDeltas(d,c,b),a.calcDeltas(d,b,c),a.addDeltas(d,f))}};a.fillParent=function(a,c,f){for(var d=f.length,e=c.length,g=0;g<e;g+=4){for(var h=c[g],l=c[g+1],n=c[g+2],m=a[h][l-1],h=a[h][l],l=8092,y=-1,k=0;k<d;k+=4)if(f[k+2]===n){var z=f[k],w=f[k+1],B=a[z][w-1],z=a[z][w];switch(n){case 0:case 1:b.between(m.y,
B.y,z.y)&&b.between(h.y,B.y,z.y)&&(B=Math.abs(z.y-B.y),B<l&&(l=B,y=k));break;case 2:case 3:b.between(m.x,B.x,z.x)&&b.between(h.x,B.x,z.x)&&(B=Math.abs(z.x-B.x),B<l&&(l=B,y=k))}}c[g+3]=y}};a.calcDeltas=function(b,c,f){for(var d=c.length,e=0;e<d;e+=4){var g=a.calcDelta(e,c,f,[]);b.push(c[e]);b.push(c[e+1]);b.push(c[e+2]);b.push(g)}};a.calcDelta=function(b,c,f,e){b=c[b+3];if(-1===b)return 0;var d=e.length;if(1<d&&e[d-2]===b)return 0;e.push(b);return a.calcDelta(b,f,c,e)+1};a.addDeltas=function(a,b){for(var c=
a.length,d=0,f=0;f<c;f+=4){var e=a[f+3];e>d&&(d=e)}for(f=0;f<c;f+=4){var g=b[a[f]],h=a[f+1],e=d-a[f+3];switch(a[f+2]){case 0:g[h-1].x-=e;g[h].x-=e;1===h&&(g[g.length-1].x-=e);h===g.length-1&&(g[0].x-=e);break;case 1:g[h-1].x+=e;g[h].x+=e;1===h&&(g[g.length-1].x+=e);h===g.length-1&&(g[0].x+=e);break;case 2:g[h-1].y-=e;g[h].y-=e;1===h&&(g[g.length-1].y-=e);h===g.length-1&&(g[0].y-=e);break;case 3:g[h-1].y+=e,g[h].y+=e,1===h&&(g[g.length-1].y+=e),h===g.length-1&&(g[0].y+=e)}}};return a}()})},"esri/views/2d/engine/webgl/TurboLine":function(){define(["require",
"exports","../../../../symbols/cim/enums","./mesh/templates/util"],function(e,a,c,h){function b(){if(k.cosine<v.innerBisectorAutoSplitThreshold){k.splitInner=!0;k.gapInner=!0;var a=Math.max(v.innerBisectorAutoSplitThreshold,k.cosine),a=Math.sqrt(1-a*a)/a;k.leftInner.x=k.nextNormal.x+k.sign*a*k.outbound.x;k.leftInner.y=k.nextNormal.y+k.sign*a*k.outbound.y;k.rightInner.x=k.prevNormal.x-k.sign*a*k.inbound.x;k.rightInner.y=k.prevNormal.y-k.sign*a*k.inbound.y}else v.enableInnerBisectorSplit&&(k.splitInner=
!0,k.gapInner=!1,k.leftInner.x=k.rightInner.x=k.bisector.x/k.cosine,k.leftInner.y=k.rightInner.y=k.bisector.y/k.cosine);k.cosine<v.outerBisectorAutoSplitThreshold?(k.splitOuter=!0,k.gapOuter=!0,a=Math.max(v.outerBisectorAutoSplitThreshold,k.cosine),a=Math.sqrt(1-a*a)/a,k.leftOuter.x=k.prevNormal.x-k.sign*a*k.inbound.x,k.leftOuter.y=k.prevNormal.y-k.sign*a*k.inbound.y,k.rightOuter.x=k.nextNormal.x+k.sign*a*k.outbound.x,k.rightOuter.y=k.nextNormal.y+k.sign*a*k.outbound.y):v.enableOuterBisectorSplit&&
(k.splitOuter=!0,k.gapOuter=!1,k.leftOuter.x=k.rightOuter.x=k.bisector.x/k.cosine,k.leftOuter.y=k.rightOuter.y=k.bisector.y/k.cosine)}function g(){if(n)k.distance=0,n=k.isCap=k.isFirstVertex=k.isLastVertex=!1;else{if(0===u)if(k.isFirstVertex=0===x,y=z[x],0===x){if(u=0,k.closed){k.inbound.x=y.x-z[z.length-2].x;k.inbound.y=y.y-z[z.length-2].y;var a=Math.sqrt(k.inbound.x*k.inbound.x+k.inbound.y*k.inbound.y);k.inbound.x/=a;k.inbound.y/=a}}else k.inbound.x=y.x-p.x,k.inbound.y=y.y-p.y,u=Math.sqrt(k.inbound.x*
k.inbound.x+k.inbound.y*k.inbound.y),k.inbound.x/=u,k.inbound.y/=u;k.distance+u-q<=v.wrapDistance?(x<z.length-1?(k.outbound.x=z[x+1].x-y.x,k.outbound.y=z[x+1].y-y.y,a=Math.sqrt(k.outbound.x*k.outbound.x+k.outbound.y*k.outbound.y),k.outbound.x/=a,k.outbound.y/=a):k.closed?(k.outbound.x=z[1].x-y.x,k.outbound.y=z[1].y-y.y,a=Math.sqrt(k.outbound.x*k.outbound.x+k.outbound.y*k.outbound.y),k.outbound.x/=a,k.outbound.y/=a):(k.outbound.x=k.inbound.x,k.outbound.y=k.inbound.y),0!==x||k.closed||(k.inbound.x=
k.outbound.x,k.inbound.y=k.outbound.y),++x,k.isLastVertex=x===z.length,k.isCap=!k.closed&&(k.isFirstVertex||k.isLastVertex),k.distance+=u-q,q=u=0,n=k.distance+u-q===v.wrapDistance,k.currentVertex.x=y.x,k.currentVertex.y=y.y,p=y,y=null):(k.outbound.x=k.inbound.x,k.outbound.y=k.inbound.y,q+=v.wrapDistance-k.distance,k.distance=v.wrapDistance,n=!0,a=q/u,k.currentVertex.x=(1-a)*p.x+a*y.x,k.currentVertex.y=(1-a)*p.y+a*y.y)}}function m(){k.prevNormal.x=-k.inbound.y;k.prevNormal.y=k.inbound.x;k.nextNormal.x=
-k.outbound.y;k.nextNormal.y=k.outbound.x}function f(){m();k.bisector.x=k.prevNormal.x+k.nextNormal.x;k.bisector.y=k.prevNormal.y+k.nextNormal.y;var a=Math.sqrt(k.bisector.x*k.bisector.x+k.bisector.y*k.bisector.y);.001>a?(k.bisector.x=void 0,k.bisector.y=void 0,k.cosine=0,k.sign=void 0):(k.bisector.x/=a,k.bisector.y/=a,k.cosine=k.bisector.x*k.nextNormal.x+k.bisector.y*k.nextNormal.y,k.sign=0<=k.prevNormal.x*k.nextNormal.y-k.prevNormal.y*k.nextNormal.x?1:-1)}function d(a){A.vertex(k);1===a?(k.leftEntry0=
k.entry0,k.leftEntry1=k.entry1,k.leftEntry2=k.entry2,k.leftExit0=k.exit0,k.leftExit1=k.exit1,k.leftExit2=k.exit2):2===a&&(k.rightEntry0=k.entry0,k.rightEntry1=k.entry1,k.rightEntry2=k.entry2,k.rightExit0=k.exit0,k.rightExit1=k.exit1,k.rightExit2=k.exit2)}function l(a){A.vertex(k);1===a?(k.leftEntry0=k.entry0,k.leftEntry2=k.entry2,k.leftExit0=k.exit0,k.leftExit2=k.exit2):2===a&&(k.rightEntry0=k.entry0,k.rightEntry2=k.entry2,k.rightExit0=k.exit0,k.rightExit2=k.exit2)}Object.defineProperty(a,"__esModule",
{value:!0});e=function(){return function(){this.isCap=this.isLastVertex=this.isFirstVertex=this.closed=void 0;this.currentVertex={x:void 0,y:void 0};this.inbound={x:void 0,y:void 0};this.outbound={x:void 0,y:void 0};this.prevNormal={x:void 0,y:void 0};this.nextNormal={x:void 0,y:void 0};this.bisector={x:void 0,y:void 0};this.leftInner={x:void 0,y:void 0};this.rightInner={x:void 0,y:void 0};this.leftOuter={x:void 0,y:void 0};this.rightOuter={x:void 0,y:void 0}}}();a.TessellationState=e;a.tessellate=
function(a,b,c){v.trackDistance=null!=b.trackDistance?b.trackDistance:!1;v.wrapDistance=null!=b.wrapDistance?b.wrapDistance:65535;v.thin=null!=b.thin?b.thin:!1;v.initialDistance=null!=b.initialDistance?b.initialDistance:0;v.enableOuterBisectorSplit=null!=b.enableOuterBisectorSplit?b.enableOuterBisectorSplit:!1;v.outerBisectorAutoSplitThreshold=null!=b.outerBisectorAutoSplitThreshold?b.outerBisectorAutoSplitThreshold:0;v.enableInnerBisectorSplit=null!=b.enableOuterBisectorSplit?b.enableOuterBisectorSplit:
!1;v.innerBisectorAutoSplitThreshold=null!=b.innerBisectorAutoSplitThreshold?b.innerBisectorAutoSplitThreshold:0;z=a;A=c;q=u=x=0;n=!1;y=p=null;k.currentVertex.x=null;k.currentVertex.y=null;k.distance=v.initialDistance;a=z[0];b=z[z.length-1];k.canSplit=!1;k.closed=a.x===b.x&&a.y===b.y;if(!(2>z.length||2===z.length&&k.closed))if(v.thin)if(v.trackDistance)for(g(),m(),l(1);u-q>v.wrapDistance||x<z.length;)g(),m(),l(2),A.bridge(k),k.leftExit0=k.rightExit0,k.leftExit2=k.rightExit2;else for(;x<z.length;)0<
x&&(k.inbound.x=k.outbound.x,k.inbound.y=k.outbound.y),x<z.length-1?(k.outbound.x=z[x+1].x-z[x].x,k.outbound.y=z[x+1].y-z[x].y,a=Math.sqrt(k.outbound.x*k.outbound.x+k.outbound.y*k.outbound.y),k.distance+=a,k.outbound.x/=a,k.outbound.y/=a):(k.outbound.x=k.inbound.x,k.outbound.y=k.inbound.y),0===x&&(k.inbound.x=k.outbound.x,k.inbound.y=k.outbound.y),k.currentVertex.x=z[x].x,k.currentVertex.y=z[x].y,k.prevNormal.x=-k.inbound.y,k.prevNormal.y=k.inbound.x,k.nextNormal.x=-k.outbound.y,k.nextNormal.y=k.outbound.x,
0===x?(A.vertex(k),k.leftEntry0=k.entry0,k.leftEntry2=k.entry2,k.leftExit0=k.exit0,k.leftExit2=k.exit2):(A.vertex(k),k.rightEntry0=k.entry0,k.rightEntry2=k.entry2,k.rightExit0=k.exit0,k.rightExit2=k.exit2,A.bridge(k),k.leftExit0=k.rightExit0,k.leftExit2=k.rightExit2),++x;else{if(v.enableOuterBisectorSplit||0<v.outerBisectorAutoSplitThreshold||v.enableInnerBisectorSplit||0<v.innerBisectorAutoSplitThreshold)for(k.canSplit=!0,g(),f(),k.splitInner=k.gapInner=k.splitOuter=k.gapOuter=!1,d(1),k.closure0=
k.leftEntry0,k.closure1=k.leftEntry1,k.closure2=k.leftEntry2;u-q>v.wrapDistance||x<z.length-1||x<z.length&&(!k.closed||v.trackDistance);)g(),f(),k.splitInner=k.gapInner=k.splitOuter=k.gapOuter=!1,d(2),A.bridge(k),k.leftExit0=k.rightExit0,k.leftExit1=k.rightExit1,k.leftExit2=k.rightExit2;else for(g(),f(),d(1),k.closure0=k.leftEntry0,k.closure1=k.leftEntry1,k.closure2=k.leftEntry2;u-q>v.wrapDistance||x<z.length-1||x<z.length&&(!k.closed||v.trackDistance);)g(),f(),d(2),A.bridge(k),k.leftExit0=k.rightExit0,
k.leftExit1=k.rightExit1,k.leftExit2=k.rightExit2;k.closed&&!v.trackDistance&&(k.rightEntry0=k.closure0,k.rightEntry1=k.closure1,k.rightEntry2=k.closure2,A.bridge(k),k.leftExit0=k.rightExit0,k.leftExit1=k.rightExit1,k.leftExit2=k.rightExit2)}};a.cleanup=function(){A=z=null};a.splitVertex=b;var z,v={},A,x=void 0,u,q,n,p,y,k=new e;e=function(){function a(a,b){this.writeVertex=a;this.writeTriangle=b;this.capType=c.CapType.BUTT;this.joinType=c.JoinType.MITER;this.miterLimitCosine=h.getLimitCosine(2);
this.roundLimitCosine=Math.cos(23*Math.PI/180);this.almostParallelCosine=.97;this.radsPerSlice=.8;this.joinOnUTurn=this.textured=!1}a.prototype.vertex=function(a){var d=this.joinType===c.JoinType.MITER?this.miterLimitCosine:this.roundLimitCosine,f=a.isCap&&this.capType!==c.CapType.BUTT,e=!1;a.cosine>this.almostParallelCosine?(a.exit0=a.entry0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.bisector.x/a.cosine,a.bisector.y/a.cosine,0,-1,a.distance),a.exit2=a.entry2=this.writeVertex(a.currentVertex.x,
a.currentVertex.y,0,0,-a.bisector.x/a.cosine,-a.bisector.y/a.cosine,0,1,a.distance)):a.cosine<1-this.almostParallelCosine?(e=!a.isCap&&this.joinOnUTurn,a.entry0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.prevNormal.x,a.prevNormal.y,0,-1,a.distance),a.entry2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.prevNormal.x,-a.prevNormal.y,0,1,a.distance),a.exit0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.nextNormal.x,a.nextNormal.y,0,-1,a.distance),a.exit2=this.writeVertex(a.currentVertex.x,
a.currentVertex.y,0,0,-a.nextNormal.x,-a.nextNormal.y,0,1,a.distance)):a.canSplit?(b(),0<a.sign?(a.splitInner?(a.exit0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,a.outbound.x,a.outbound.y,a.leftInner.x,a.leftInner.y,0,-1,a.distance),a.entry0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,a.inbound.x,a.inbound.y,a.rightInner.x,a.rightInner.y,0,-1,a.distance)):a.exit0=a.entry0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,a.inbound.x,a.inbound.y,a.bisector.x/a.cosine,a.bisector.y/
a.cosine,0,-1,a.distance),a.cosine<d?(e=!a.isCap,a.entry2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.prevNormal.x,-a.prevNormal.y,0,1,a.distance),a.exit2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.nextNormal.x,-a.nextNormal.y,0,1,a.distance)):a.splitOuter?(e=e||a.gapOuter,a.entry2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,a.inbound.x,a.inbound.y,-a.leftOuter.x,-a.leftOuter.y,0,1,a.distance),a.exit2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,a.outbound.x,
a.outbound.y,-a.rightOuter.x,-a.rightOuter.y,0,1,a.distance)):a.entry2=a.exit2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.bisector.x/a.cosine,-a.bisector.y/a.cosine,0,1,a.distance)):(a.splitInner?(a.exit2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,a.outbound.x,a.outbound.y,-a.leftInner.x,-a.leftInner.y,0,1,a.distance),a.entry2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,a.inbound.x,a.inbound.y,-a.rightInner.x,-a.rightInner.y,0,1,a.distance)):a.exit2=a.entry2=this.writeVertex(a.currentVertex.x,
a.currentVertex.y,0,0,-a.bisector.x/a.cosine,-a.bisector.y/a.cosine,0,1,a.distance),a.cosine<d?(e=!a.isCap,a.entry0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.prevNormal.x,a.prevNormal.y,0,-1,a.distance),a.exit0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.nextNormal.x,a.nextNormal.y,0,-1,a.distance)):a.splitOuter?(e=e||a.gapOuter,a.entry0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,a.inbound.x,a.inbound.y,a.leftOuter.x,a.leftOuter.y,0,-1,a.distance),a.exit0=
this.writeVertex(a.currentVertex.x,a.currentVertex.y,a.outbound.x,a.outbound.y,a.rightOuter.x,a.rightOuter.y,0,-1,a.distance)):a.exit0=a.entry0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.bisector.x/a.cosine,a.bisector.y/a.cosine,0,-1,a.distance))):0<a.sign?(a.exit0=a.entry0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,a.inbound.x,a.inbound.y,a.bisector.x/a.cosine,a.bisector.y/a.cosine,0,-1,a.distance),a.cosine<d?(e=!a.isCap,a.entry2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,
0,0,-a.prevNormal.x,-a.prevNormal.y,0,1,a.distance),a.exit2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.nextNormal.x,-a.nextNormal.y,0,1,a.distance)):a.entry2=a.exit2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.bisector.x/a.cosine,-a.bisector.y/a.cosine,0,1,a.distance)):(a.exit2=a.entry2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.bisector.x/a.cosine,-a.bisector.y/a.cosine,0,1,a.distance),a.cosine<d?(e=!a.isCap,a.entry0=this.writeVertex(a.currentVertex.x,
a.currentVertex.y,0,0,a.prevNormal.x,a.prevNormal.y,0,-1,a.distance),a.exit0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.nextNormal.x,a.nextNormal.y,0,-1,a.distance)):a.exit0=a.entry0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.bisector.x/a.cosine,a.bisector.y/a.cosine,0,-1,a.distance));d=a.canSplit&&(a.splitInner||a.splitOuter)||e||f?a.entry1=a.exit1=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,0,0,0,0,a.distance):a.entry1=a.exit1=null;if(e&&this.joinType!==
c.JoinType.ROUND)this.writeTriangle(d,0<a.sign?a.exit2:a.entry0,0<a.sign?a.entry2:a.exit0);else if(f&&this.capType===c.CapType.ROUND||e&&this.joinType===c.JoinType.ROUND){var g=e=f=void 0,h=void 0,k=void 0,l=void 0;if(a.isCap){var n=Math.PI,k=Math.ceil(n/this.radsPerSlice),l=n/k;a.isFirstVertex?(f=a.prevNormal.x,e=a.prevNormal.y,g=a.entry0,h=a.entry2):a.isLastVertex&&(f=-a.nextNormal.x,e=-a.nextNormal.y,g=a.exit2,h=a.exit0)}else n=2*Math.acos(a.cosine),k=Math.ceil(n/this.radsPerSlice),l=n/k,f=0<a.sign?
-a.prevNormal.x:a.nextNormal.x,e=0<a.sign?-a.prevNormal.y:a.nextNormal.y,g=0<a.sign?a.entry2:a.exit0,h=0<a.sign?a.exit2:a.entry0;for(var n=Math.cos(l),l=Math.sin(l),m=l*f+n*e,f=n*f-l*e,e=m,p,m=void 0,q=0;q<k;++q)p=m,q<k-1&&(m=a.isCap?this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,f,e,a.isFirstVertex?-1:1,0,a.distance):this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,f,e,0,a.sign,a.distance)),this.writeTriangle(0===q?g:p,d,q===k-1?h:m),p=l*f+n*e,f=n*f-l*e,e=p}else f&&this.capType===
c.CapType.SQUARE&&(f=a.isFirstVertex?1:-1,g=e=void 0,this.textured?(e=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.prevNormal.x-f*a.inbound.x,a.prevNormal.y-f*a.inbound.y,-f,-1,a.distance),g=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.prevNormal.x-f*a.inbound.x,-a.prevNormal.y-f*a.inbound.y,-f,1,a.distance)):(e=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.prevNormal.x-f*a.inbound.x,a.prevNormal.y-f*a.inbound.y,0,-1,a.distance),g=this.writeVertex(a.currentVertex.x,
a.currentVertex.y,0,0,-a.prevNormal.x-f*a.inbound.x,-a.prevNormal.y-f*a.inbound.y,0,1,a.distance)),0<f?(this.writeTriangle(d,a.entry2,g),this.writeTriangle(d,g,e),this.writeTriangle(d,e,a.entry0)):(this.writeTriangle(d,g,a.exit2),this.writeTriangle(d,e,g),this.writeTriangle(d,a.exit0,e)))};a.prototype.bridge=function(a){this.writeTriangle(a.leftExit0,a.rightEntry0,null!=a.leftExit1?a.leftExit1:a.leftExit2);this.writeTriangle(a.rightEntry0,null!=a.rightEntry1?a.rightEntry1:a.rightEntry2,null!=a.leftExit1?
a.leftExit1:a.leftExit2);null!=a.leftExit1&&null!=a.rightEntry1?(this.writeTriangle(a.leftExit1,a.rightEntry1,a.leftExit2),this.writeTriangle(a.rightEntry1,a.rightEntry2,a.leftExit2)):null!=a.leftExit1?this.writeTriangle(a.leftExit1,a.rightEntry2,a.leftExit2):null!=a.rightEntry1&&this.writeTriangle(a.rightEntry1,a.rightEntry2,a.leftExit2)};return a}();a.StandardTessellationCallbacks=e;e=function(){function a(a,b){this.writeVertex=a;this.writeTriangle=b}a.prototype.vertex=function(a){a.entry0=this.writeVertex(a.currentVertex.x,
a.currentVertex.y,0,0,a.prevNormal.x,a.prevNormal.y,0,-1,a.distance);a.entry2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.prevNormal.x,-a.prevNormal.y,0,1,a.distance);a.exit0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.nextNormal.x,a.nextNormal.y,0,-1,a.distance);a.exit2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.nextNormal.x,-a.nextNormal.y,0,1,a.distance)};a.prototype.bridge=function(a){this.writeTriangle(a.leftExit0,a.rightEntry0,a.leftExit2);this.writeTriangle(a.rightEntry0,
a.rightEntry2,a.leftExit2)};return a}();a.ThinTessellationCallbacks=e})},"esri/views/2d/engine/webgl/mesh/factories/matcherUtils":function(){define("require exports ../../../../../../core/tsSupport/generatorHelper ../../../../../../core/tsSupport/awaiterHelper ../../../../../../core/Error ../../../../../../core/Logger ../../util/Matcher".split(" "),function(e,a,c,h,b,g,m){Object.defineProperty(a,"__esModule",{value:!0});var f=g.getLogger("esri/views/2d/engine/webgl/mesh/factories/matcherUtils");a.createMatcher=
function(a,e,g){return h(this,void 0,void 0,function(){return c(this,function(c){switch(a.type){case "simple":case "dot-density":return[2,m.FeatureMatcher.fromBasicRenderer(a,e,g)];case "unique-value":return[2,m.MapMatcher.fromUVRenderer(a,e,g)];case "class-breaks":return[2,m.IntervalMatcher.fromCBRenderer(a,e,g)];case "dictionary":return[2,m.DictionaryMatcher.fromDictionaryRenderer(a,e,g)];default:return f.error(new b("mapview-mesh:invalid-renderer","Unable to handle unknown renderer type")),[2,
null]}})})}})},"esri/views/2d/engine/webgl/util/Matcher":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/tsSupport/generatorHelper ../../../../../core/tsSupport/awaiterHelper ../../../../../core/Logger ../../../../../core/promiseUtils ../../../../../support/arcadeOnDemand ../../../../../symbols/support/cimSymbolUtils ../../../arcade/utils".split(" "),function(e,a,c,h,b,g,m,f,d,l){Object.defineProperty(a,"__esModule",{value:!0});var z=g.getLogger("esri/views/2d/engine/webgl/util/Matcher");
e=function(){function a(){this._defaultResult=null}a.fromBasicRenderer=function(c,f,e){return b(this,void 0,void 0,function(){var b,g,l;return h(this,function(h){switch(h.label){case 0:return[4,d.expandSymbols(c.getSymbols())];case 1:return b=h.sent(),g=new a,b.length?[4,f.createTemplateGroup(b[0],null,c,e)]:[3,3];case 2:l=h.sent(),g.setDefault(l),h.label=3;case 3:return[2,g]}})})};a.prototype.size=function(){return 1};a.prototype.getDefault=function(){return this._defaultResult};a.prototype.setDefault=
function(a){this._defaultResult=a};a.prototype.match=function(a,b,c,d,f){return this.getDefault()};a.prototype.analyze=function(a,c,d,f){return b(this,void 0,void 0,function(){return h(this,function(a){return[2]})})};return a}();a.FeatureMatcher=e;g=function(a){function e(b,c,d,e){var f=a.call(this)||this;f._intervals=[];f._isMaxInclusive=c;e?f._getValue=l.callWithFeature.bind(null,e):b&&b.length?"function"===typeof b?(f._field=null,f._getValue=b):(f._field=b,f._normalizationInfo=d,f._getValue=f._getValueFromField.bind(f)):
f._field=null;return f}c(e,a);e.fromCBRenderer=function(a,c,g){return b(this,void 0,void 0,function(){var b,l,m,k,q,u,x,v,z,A,M,J,L,K,Q,I,R,O,N;return h(this,function(h){switch(h.label){case 0:return b=a.isMaxInclusive,l=a.normalizationField,m=a.normalizationTotal,k=a.normalizationType,q=a.field,u={normalizationField:l,normalizationTotal:m,normalizationType:k},(z=x=a.valueExpression)?[4,f.createRendererExpression(x,g.spatialReference,g.fields)]:[3,2];case 1:z=h.sent(),h.label=2;case 2:return v=z,
A=new e(q,b,u,v),[4,d.expandSymbol(a.backgroundFillSymbol)];case 3:M=h.sent(),J=0,L=a.classBreakInfos,h.label=4;case 4:if(!(J<L.length))return[3,8];K=L[J];return[4,d.expandSymbol(K.symbol)];case 5:return Q=h.sent(),[4,c.createTemplateGroup(Q,M,a,g)];case 6:I=h.sent(),R={min:K.minValue,max:K.maxValue},A.add(R,I),h.label=7;case 7:return J++,[3,4];case 8:return[4,d.expandSymbol(a.defaultSymbol)];case 9:return(O=h.sent())?[4,c.createTemplateGroup(O,M,a,g)]:[3,11];case 10:N=h.sent(),A.setDefault(N),h.label=
11;case 11:return[2,A]}})})};e.prototype.add=function(a,b){this._intervals.push({interval:a,result:b});this._intervals.sort(function(a,b){return a.interval.min-b.interval.min})};e.prototype.size=function(){return a.prototype.size.call(this)+this._intervals.length};e.prototype.match=function(a,b,c,d,f){if(!this._getValue)return this.getDefault();a=this._getValue(b,{$view:f},c,d);if(!a&&(null===a||void 0===a||isNaN(a)))return this.getDefault();for(b=0;b<this._intervals.length;b++)if(d=this._intervals[b],
c=d.interval,d=d.result,f=this._isMaxInclusive?a<=c.max:a<c.max,a>=c.min&&f)return d;return this.getDefault()};e.prototype._needsNormalization=function(){var a=this._normalizationInfo;return a&&(a.normalizationField||a.normalizationTotal||a.normalizationType)};e.prototype._getValueFromField=function(a){var b=a.attributes[this._field];if(!this._needsNormalization())return b;var c=this._normalizationInfo,d=c.normalizationField,f=c.normalizationTotal,c=c.normalizationType;a=!!d&&a.attributes[d];if(c)switch(c){case "field":return(a||
void 0)&&b/a;case "log":return Math.log(b)*Math.LOG10E;case "percent-of-total":return b/f*100;default:z.error("Found unknown normalization type: "+c)}else z.error("Normalization is required, but no type was set!")};return e}(e);a.IntervalMatcher=g;g=function(a){function e(b,c,d){var f=a.call(this)||this;f._nullResult=null;f._resultsMap=new Map;d?f._getValue=l.callWithFeature.bind(null,d):b&&b.length?"function"===typeof b[0]?(f._fields=null,f._getValue=b[0]):(f._fields=b,f._seperator=c||"",f._getValue=
f._getValueFromFields.bind(f)):f._fields=null;return f}c(e,a);e.fromUVRenderer=function(a,c,g){return b(this,void 0,void 0,function(){var b,l,m,k,q,u,x,v,z,A,M,J,L,K,Q;return h(this,function(h){switch(h.label){case 0:return b=a.uniqueValueInfos,l=a.fieldDelimiter,m=[a.field],k=a.valueExpression,a.field2&&m.push(a.field2),a.field3&&m.push(a.field3),[4,d.expandSymbol(a.backgroundFillSymbol)];case 1:return q=h.sent(),(x=k)?[4,f.createRendererExpression(k,g.spatialReference,g.fields)]:[3,3];case 2:x=
h.sent(),h.label=3;case 3:u=x,v=new e(m,l,u),z=0,A=b,h.label=4;case 4:if(!(z<A.length))return[3,8];M=A[z];return[4,d.expandSymbol(M.symbol)];case 5:return J=h.sent(),[4,c.createTemplateGroup(J,q,a,g)];case 6:L=h.sent(),"\x3cNull\x3e"===M.value?v.setNullResult(L):v.add(M.value,L),h.label=7;case 7:return z++,[3,4];case 8:return[4,d.expandSymbol(a.defaultSymbol)];case 9:return(K=h.sent())?[4,c.createTemplateGroup(a.defaultSymbol,q,a,g)]:[3,11];case 10:Q=h.sent(),v.setDefault(Q),h.label=11;case 11:return[2,
v]}})})};e.prototype.setNullResult=function(a){this._nullResult=a};e.prototype.add=function(a,b){this._resultsMap.set(a.toString(),b)};e.prototype.size=function(){return a.prototype.size.call(this)+this._resultsMap.size};e.prototype.match=function(a,b,c,d,f){if(!this._getValue)return this.getDefault();a=this._getValue(b,{$view:f},c,d);if(null!==this._nullResult&&(null==a||""===a||"\x3cNull\x3e"===a))return this._nullResult;if(!a&&null==a)return this.getDefault();a=a.toString();return this._resultsMap.has(a)?
this._resultsMap.get(a):this.getDefault()};e.prototype._getValueFromFields=function(a){for(var b=[],c=0,d=this._fields;c<d.length;c++)b.push(a.attributes[d[c]]);return b.join(this._seperator)};return e}(e);a.MapMatcher=g;e=function(a){function d(b,c,d){var f=a.call(this)||this;f._fidToAttributeHash=new Map;f._attributeHashToGroup=new Map;f._renderer=b;f._fieldMap=b.fieldMap;f._templates=c;f._info=d;return f}c(d,a);d.fromDictionaryRenderer=function(a,c,f){return b(this,void 0,void 0,function(){return h(this,
function(b){a.fetchResources({spatialReference:f.spatialReference,fields:f.fields});return[2,new d(a,c,f)]})})};d.prototype.analyze=function(a,c,d,f){return b(this,void 0,void 0,function(){var b,e,g,l,n,q,u=this;return h(this,function(h){switch(h.label){case 0:b=[];e=function(c){var e=c.attributes[a],h=g._fidToAttributeHash.get(e),k=g._hashAttributes(c);if(h===k)return"continue";g._fidToAttributeHash.set(e,k);g._attributeHashToGroup.has(k)||(c=g._renderer.getSymbolAsync(c,{scale:d&&d.scale,viewingMode:d&&
d.viewingMode,spatialReference:g._info.spatialReference,abortOptions:f,fields:g._info.fields}).then(function(a){return u._templates.createTemplateGroup(a,null,u._renderer,u._info).then(function(a){return u._attributeHashToGroup.set(k,a)})}),b.push(c))};g=this;l=0;for(n=c;l<n.length;l++)q=n[l],e(q);return[4,m.all(b)];case 1:return h.sent(),[2]}})})};d.prototype.match=function(a,b){a=this._fidToAttributeHash.get(b.attributes[a]);return this._attributeHashToGroup.get(a)};d.prototype._hashAttributes=
function(a){var b="",c;for(c in this._fieldMap)b+=". "+a.attributes[this._fieldMap[c]];return b};return d}(e);a.DictionaryMatcher=e})},"esri/views/2d/engine/webgl/mesh/factories/WGLMeshFactory":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/tsSupport/generatorHelper ../../../../../../core/tsSupport/awaiterHelper ../../../../../../core/Error ../../../../../../core/has ../../../../../../core/Logger ../../../../../../core/maybe ../../../../../../core/promiseUtils ../../../../../../geometry/SpatialReference ../../../../../../geometry/support/jsonUtils ../../../../../../symbols/SimpleLineSymbol ../../definitions ../../enums ../../WGLDisplayObject ../MeshData ../VertexVector ../templates/WGLLabelTemplate ../templates/WGLLineTemplate ../templates/WGLMarkerTemplate ../templates/WGLTemplateStore".split(" "),
function(e,a,c,h,b,g,m,f,d,l,z,v,A,x,u,q,n,p,y,k,C,w){function B(a){var b=(a.attributes?Object.keys(a.attributes):[]).map(function(b){return{name:b,alias:b,type:"string"===typeof a.attributes[b]?"esriFieldTypeString":"esriFieldTypeDouble"}});return{geometryType:null!=a.centroid?"esriGeometryPolygon":v.getJsonType(a.geometry),spatialReference:z.fromJSON(a.geometry.spatialReference),fields:b}}Object.defineProperty(a,"__esModule",{value:!0});var E=f.getLogger("esri.views.2d.engine.webgl.WGLMeshFactory"),
G={esriGeometryPoint:"above-right above-center above-left center-center center-left center-right below-center below-left below-right".split(" "),esriGeometryPolygon:["always-horizontal"],esriGeometryPolyline:["center-along"],esriGeometryMultipoint:null,esriGeometryEnvelope:null};e=function(){function a(a,b,c,f,e,g){this._isDD=!1;this._labelsDebugTemplate=null;this._isDD=d.isSome(c)&&"dot-density"===c.type;this._geometryType=a;this._idField=b;this._templateStore=f;this._setLabelTemplates(e,c,g)}a.prototype.update=
function(a,b,c){this._isDD=d.isSome(b)&&"dot-density"===b.type;this._setLabelTemplates(a,b,c)};a.prototype._setLabelTemplates=function(a,b,c){a&&this._validateLabelingInfo(a)&&(this._labelTemplates=a.map(function(a){return y.default.fromLabelClass(b,a,c)}))};Object.defineProperty(a.prototype,"templates",{get:function(){return this._templateStore},enumerable:!0,configurable:!0});a.prototype.createMeshData=function(a){var b=Array(5),c=this._labelTemplates&&0<this._labelTemplates.length,d="esriGeometryPolyline"===
this._geometryType?x.HEURISTIC_GLYPHS_PER_LINE:x.HEURISTIC_GLYPHS_PER_FEATURE;b[u.WGLGeometryType.MARKER]=new p.VertexVectors(u.WGLGeometryType.MARKER,a);b[u.WGLGeometryType.FILL]=new p.VertexVectors(u.WGLGeometryType.FILL,a,this._isDD);b[u.WGLGeometryType.LINE]=new p.VertexVectors(u.WGLGeometryType.LINE,a);b[u.WGLGeometryType.TEXT]=new p.VertexVectors(u.WGLGeometryType.TEXT,a);b[u.WGLGeometryType.LABEL]=new p.VertexVectors(u.WGLGeometryType.LABEL,c?d:0);return new n.MeshData([],b)};a.prototype.analyze=
function(a,c,f,e,g,k){return b(this,void 0,void 0,function(){var b,m,n,p,q,y,u,v,x,z,A;return h(this,function(h){switch(h.label){case 0:return b=a,l.isAborted(k)?[2,[]]:d.isSome(f)?[4,f.analyze(this._idField,a,g,k)]:[3,2];case 1:h.sent(),h.label=2;case 2:m=0,n=b,h.label=3;case 3:if(!(m<n.length))return[3,10];p=n[m];q=-1;if(!c)return[3,7];y=p;if(null==y.symbol)return[3,5];u=null;"cim"===y.symbol.type&&(u=B(p));return[4,this._templateStore.createTemplateGroup(y.symbol,null,null,u)];case 4:return q=
h.sent(),[3,6];case 5:d.isSome(f)&&(q=f.match(this._idField,p,null,null,g)),h.label=6;case 6:return[3,8];case 7:d.isSome(f)&&(q=f.match(this._idField,p,this._geometryType,e,g)),h.label=8;case 8:if(w.isDynamicId(q))for(v=this._templateStore.getDynamicTemplateGroup(q),x=0,z=v;x<z.length;x++)(A=z[x])&&A.analyze&&A.analyze(this._templateStore,p,e,g);p.groupId=q;h.label=9;case 9:return m++,[3,3];case 10:return[2,this._templateStore.finalize(k).then(function(){return b})]}})})};a.prototype.write=function(a,
b,c,d,f,e,g){var h=this._templateStore.getTemplateGroup(b.groupId),k=b.localId;if(null!=k){var l=new q(k),m=!!e&&!!this._labelTemplates&&e.has(k);if(w.isDynamicId(b.groupId))for(var n=0;n<h.length;n++){var p=h[n];p.bindFeature(b,c,d)}if(h&&(b.geometry||b.centroid)){d=l.displayRecords;p=b.insertAfter;void 0!==p&&(l.insertAfter=p);(c=this._geometryType)||(c=null!=b.centroid?"esriGeometryPolygon":v.getJsonType(b.geometry));for(n=0;n<h.length;n++){var p=h[n],y=a.get(p.geometryType);p.writeMesh(d,y,c,
k,b)}m&&(h=this._getLabelReference(h),e=e.get(k),this._writeLabelMesh(l,a,k,b,g,e,h,f,c));a.pushDisplayObject(l)}}};a.prototype._hasBadLabelClass=function(a,b){var c=a.labelPlacement,d=G[b];if(!a.symbol)return E.warn("No LabelClass symbol specified."),!0;if(!d)return E.error(new g("mapview-labeling:unsupported-geometry-type","Unable to create labels for Feature Layer, "+b+" is not supported")),!0;d.some(function(a){return a===c})||(d=d[0],c&&E.warn("Found invalid label placement type "+c+" for "+
b+". Defaulting to "+d),a.labelPlacement=d);return!1};a.prototype._validateLabelingInfo=function(a){var b=this;return!a.some(function(a){return b._hasBadLabelClass(a,b._geometryType)})};a.prototype._getLabelReference=function(a){for(var b=0;b<a.length;b++){var c=a[b];if(c instanceof C.default)return c}return null};a.prototype._writeLabelMesh=function(a,b,c,d,f,e,g,h,k){for(var l=a.displayRecords,m=[],n=0;n<e.length;n++){var p=e[n],q=p.text,y=p.rtl,p=this._labelTemplates[p.id],u=b.get(p.geometryType),
w=f.get(p.symbolId).glyphMosaicItems;p.bindReferenceTemplate(g);p.bindTextInfo(w,q,y);p.writeMesh(l,u,k,c,d,h,m)}a.metrics=m;x.DEBUG_LABELS&&this._debugLabels(a,b)};a.prototype._debugLabels=function(a,b){var c=a.displayRecords,d=a.id,f=0;for(a=a.metrics;f<a.length;f++)for(var e=a[f],g=0,h=e.boxes?e.boxes.concat([e.bounds]):[e.bounds];g<h.length;g++){var k=h[g],k={geometry:{paths:[[[e.anchor[0]+e.offsetX+k.center[0]-k.width/2,e.anchor[1]+e.offsetY+k.center[1]+k.height/2],[0,-k.height],[k.width,0],
[0,k.height],[-k.width,0]]]},attributes:{}},l=this._getLabelDebugTemplate(),m=b.get(l.geometryType);l.writeMesh(c,m,"esriGeometryPolyline",d,k)}};a.prototype._getLabelDebugTemplate=function(){this._labelsDebugTemplate||(this._labelsDebugTemplate=this._createLabelsDebugTemplate());return this._labelsDebugTemplate};a.prototype._createLabelsDebugTemplate=function(){var a=new A({style:"solid",width:1,color:[255,0,0,1]});return k.default.fromSimpleLine(null,!1,a,null,!1)};return a}();a.WGLMeshFactory=
e})},"esri/views/2d/engine/webgl/WGLDisplayObject":function(){define(["require","exports","./WGLDisplayRecord","./collisions/Metric","./util/serializationUtils"],function(e,a,c,h,b){return function(){function a(a){this.insertAfter=null;this.id=a;this.displayRecords=[];this.metrics=[]}a.prototype.copy=function(){var b=new a(this.id);b.set(this);return b};a.prototype.clone=function(){var b=new a(this.id);b.displayRecords=this.displayRecords.map(function(a){return a.clone()});b.metrics=this.metrics.map(function(a){return a.clone()});
b.insertAfter=this.insertAfter;return b};a.prototype.set=function(a){this.id=a.id;this.displayRecords=a.displayRecords;this.metrics=a.metrics;this.insertAfter=a.insertAfter};a.prototype.serialize=function(a){a.push(this.id);b.serializeList(a,this.metrics);b.serializeList(a,this.displayRecords);return a};a.deserialize=function(e){var f=e.readInt32(),d=new a(f),f={id:f},g=b.deserializeList(e,h.default);g.length&&(d.metrics=g);d.displayRecords=b.deserializeList(e,c,f);return d};return a}()})},"esri/views/2d/engine/webgl/mesh/MeshData":function(){define(["require",
"exports","../util/serializationUtils","../util/Writer"],function(e,a,c,h){Object.defineProperty(a,"__esModule",{value:!0});e=function(){function a(a,b){this.displayObjects=a;this.vertexVectorsMap=b}Object.defineProperty(a.prototype,"vertexBuffersMap",{get:function(){if(!this._vertexBuffersMap){this._vertexBuffersMap={};for(var a=0;a<this.vertexVectorsMap.length;a++)this._vertexBuffersMap[a]=this.vertexVectorsMap[a].intoBuffers();this.vertexVectorsMap=null}return this._vertexBuffersMap},enumerable:!0,
configurable:!0});a.prototype.get=function(a){return this.vertexVectorsMap[a]};a.prototype.pushDisplayObject=function(a){this.displayObjects.push(a)};a.prototype.encode=function(a,b){var f=c.serializeList(new h.default(Uint32Array,this._guessSize()),this.displayObjects).buffer(),d={};b.push(f);for(var e=0;e<this.vertexVectorsMap.length;e++){var g=this.vertexVectorsMap[e];d[e]={};g.transfer(d[e],b)}a.displayObjects=f;a.vertexBuffersMap=d;this.destroy()};a.prototype.destroy=function(){this.displayObjects=
this.vertexVectorsMap=null};a.prototype._guessSize=function(){for(var a=this.displayObjects,b=Math.min(a.length,4),c=0,d=0;d<b;d++)c=Math.max(c,a[d].displayRecords.length);return 2*(12*a.length+a.length*c*40)};return a}();a.MeshData=e})},"esri/views/2d/engine/webgl/util/Writer":function(){define(["require","exports"],function(e,a){Object.defineProperty(a,"__esModule",{value:!0});e=function(){function a(a,b){this._pos=0;b=b?this._roundToNearest(b,a.BYTES_PER_ELEMENT):40;this._array=new ArrayBuffer(b);
this._buffer=new a(this._array);this._ctor=a}Object.defineProperty(a.prototype,"length",{get:function(){return this._pos},enumerable:!0,configurable:!0});a.prototype._roundToNearest=function(a,b){a=Math.round(a);return a+(b-a%b)};a.prototype._ensureSize=function(a){if(this._pos+a>=this._buffer.length){a=this._roundToNearest(1.5*(this._array.byteLength+a*this._buffer.BYTES_PER_ELEMENT),this._buffer.BYTES_PER_ELEMENT);a=new ArrayBuffer(a);var b=new this._ctor(a);b.set(this._buffer,0);this._array=a;
this._buffer=b}};a.prototype.writeF32=function(a){this._ensureSize(1);var b=this._pos;(new Float32Array(this._array,4*this._pos,1))[0]=a;this._pos++;return b};a.prototype.push=function(a){this._ensureSize(1);var b=this._pos;this._buffer[this._pos++]=a;return b};a.prototype.writeRegion=function(a){this._ensureSize(a.length);var b=this._pos;this._buffer.set(a,this._pos);this._pos+=a.length;return b};a.prototype.buffer=function(){var a=this._array.slice(0,4*this._pos);this.destroy();return a};a.prototype.seek=
function(a){this._pos=a};a.prototype.destroy=function(){this._buffer=this._array=null};return a}();a.default=e})},"esri/views/2d/engine/webgl/mesh/VertexVector":function(){define(["require","exports","../Utils","./VertexBuffer","../util/Writer"],function(e,a,c,h,b){Object.defineProperty(a,"__esModule",{value:!0});var g=function(){function a(a,b){this.data=a;this.stride=b}Object.defineProperty(a.prototype,"vertexCount",{get:function(){return this.data.length/(this.stride/4)},enumerable:!0,configurable:!0});
a.prototype.transfer=function(a,b){var c=this.data.buffer();a.vertexCount=this.vertexCount;a.data=c;a.stride=this.stride;b.push(c)};return a}();a.default=g;e=function(){function a(a,d,e){void 0===e&&(e=!1);this.geometryType=a;this.indexVector=new b.default(Uint32Array,d);this.namedVectors={};a=c.getStrides(a,e);for(var f in a){e=a[f];var h=void 0;switch(e%4){case 0:case 2:h=new b.default(Uint32Array,e/4*d);break;case 1:case 3:h=new b.default(Uint8Array,e*d)}this.namedVectors[f]=new g(h,e)}}a.prototype.get=
function(a){return this.namedVectors[a].data};a.prototype.getVector=function(a){return this.namedVectors[a]};a.prototype.transfer=function(a,b){var c=this.indexVector.buffer(),d={};b.push(c);for(var e in this.namedVectors){var f=this.namedVectors[e];d[e]={};f.transfer(d[e],b)}a.geometryType=this.geometryType;a.indexBuffer=c;a.namedBuffers=d;this.destroy()};a.prototype.intoBuffers=function(){var a=h.VertexBuffers.fromVertexVectors(this);this.destroy();return a};a.prototype.destroy=function(){this.namedVectors=
this.indexVector=null};return a}();a.VertexVectors=e})},"esri/views/2d/engine/webgl/mesh/VertexBuffer":function(){define(["require","exports","../Utils"],function(e,a,c){Object.defineProperty(a,"__esModule",{value:!0});var h=function(){function a(a,b,c){this.data=a;this.stride=b;this.vertexCount=c}a.decode=function(b){var e=c.allocateTypedArrayBufferwithData(b.data,b.stride);return new a(e,b.stride,b.vertexCount)};a.fromVertexVector=function(b){var e=c.allocateTypedArrayBufferwithData(b.data.buffer(),
b.stride);return new a(e,b.stride,b.vertexCount)};return a}();a.default=h;e=function(){function a(a,b,c){this.geometryType=a;this.indexBuffer=new Uint32Array(b);this.namedBuffers=c}a.decode=function(b){var c=b.geometryType,e=b.indexBuffer,d={},g;for(g in b.namedBuffers)d[g]=h.decode(b.namedBuffers[g]);return new a(c,e,d)};a.fromVertexVectors=function(b){var c=b.geometryType,e=b.indexVector.buffer(),d={},g;for(g in b.namedVectors)d[g]=h.fromVertexVector(b.namedVectors[g]);return new a(c,e,d)};return a}();
a.VertexBuffers=e})},"esri/views/2d/engine/webgl/mesh/templates/WGLLineTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/Logger ../../../../../../core/screenUtils ../../../../../../symbols/cim/enums ../../color ../../number ../../Utils ../../materialKey/MaterialKey ./util ./WGLBaseLineTemplate ./WGLMeshTemplate".split(" "),function(e,a,c,h,b,g,m,f,d,l,z,v,A){Object.defineProperty(a,"__esModule",{value:!0});var x=h.getLogger("esri.views.2d.engine.webgl.WGLLineTemplate");
e=function(a){function e(b,c,d,e,f,g,h,m,q,u,x,v,A,K,Q,I){var k=a.call(this)||this;b=l.LineMaterialKey.load(l.createMaterialKey(k.geometryType,b,A));c&&(b.sdf=c.sdf,b.pattern=!0,b.textureBinding=c.textureBinding);k._capType=e;k._joinType=f;k._miterLimitCosine=z.getLimitCosine(g);k.tessellationProperties._fillColor=h;k.tessellationProperties._tl=m;k.tessellationProperties._br=q;k._hasPattern=u;k._isDashed=x;k._joinOnUTurn=I;k._isColorLocked=v;k._isOutline=A;k._zOrder=Q;k._materialKey=b.data;k.tessellationProperties._bitset=
v?1:0;k.tessellationProperties._halfWidth=.5*d;k.tessellationProperties._halfReferenceWidth=.5*K;k._initializeTessellator(!1);return k}c(e,a);e.fromCIMLine=function(a,c,d,h,l,q){var k=c.color,n=c.isDashed,p=c.cap;n&&p===g.CapType.ROUND&&(p=g.CapType.SQUARE);var y=c.join;q*=b.pt2px(c.width);var u=b.pt2px(c.referenceWidth),w=b.pt2px(c.miterLimit),k=k&&m.premultiplyAlphaRGBA(k)||0;if(!d)return new e(a,d,q,p,y,w,k,0,0,!1,n,c.colorLocked,h,u,c.zOrder,l);var x=d.rect,v=x.x+1+d.width,z=x.y+1+d.height,x=
f.i1616to32(x.x+1,x.y+1),v=f.i1616to32(v,z);return new e(a,d,q,p,y,w,k,x,v,!0,n,c.colorLocked,h,u,c.zOrder,l)};e.fromSimpleLine=function(a,c,g,h,l){var k=g.color,n="solid"!==g.style&&"none"!==g.style,p=d.getCapType(g.cap||"round",n),q=d.getJoinType(g.join||"round"),k=k&&"none"!==g.style&&m.premultiplyAlphaRGBA(k)||0;"none"===g.style&&(k=0);var y=b.pt2px(g.width);g=g.miterLimit;if(!h)return new e(a,h,y,p,q,g,k,0,0,!1,n,!1,c,y,0,l);var u=h.rect,x=u.x+1+h.width,v=u.y+1+h.height,u=f.i1616to32(u.x+1,u.y+
1),x=f.i1616to32(x,v);return new e(a,h,y,p,q,g,k,u,x,!0,n,!1,c,y,0,l)};e.fromPictureLineSymbol=function(a,b,c,d){x.error("PictureLineSymbol support does not exist!");return null};return e}(v.default(A.default));a.default=e})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseLineTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/has ../../../../../../core/Logger ../../definitions ../../enums ../../number ../../TileClipper ../../TurboLine ../../WGLDisplayRecord ../../materialKey/MaterialKey".split(" "),
function(e,a,c,h,b,g,m,f,d,l,z,v){Object.defineProperty(a,"__esModule",{value:!0});var A=b.getLogger("esri.views.2d.engine.webgl.WGLLineTemplateBase"),x=g.TILE_SIZE+16,u=1/3.8,q=new d.TileClipper(0,0,0,1,16);q.setExtent(g.TILE_SIZE);var n=new Uint32Array(9),p=new Uint32Array(36),y=new Uint32Array(3),k=new Uint32Array(6),C=function(a){return function(b){b.entry0=a.offset+a.vertexCount++;var c=f.i1616to32(b.distance,31*a._halfWidth),d=f.i8888to32(Math.round(31*b.prevNormal.x),Math.round(31*b.prevNormal.y),
Math.round(0),Math.round(-31)),e=f.i8888to32(0,0,0,a._bitset);p[0]=f.i1616to32(b.currentVertex.x,b.currentVertex.y);p[1]=a.id;p[2]=a._fillColor;p[3]=d;p[4]=c;p[5]=a._tl;p[6]=a._br;p[7]=e;p[8]=f.i1616to32(31*a._halfReferenceWidth,0);b.entry2=a.offset+a.vertexCount++;c=f.i1616to32(b.distance,31*a._halfWidth);d=f.i8888to32(Math.round(31*-b.prevNormal.x),Math.round(31*-b.prevNormal.y),Math.round(0),Math.round(31));e=f.i8888to32(0,0,0,a._bitset);p[9]=f.i1616to32(b.currentVertex.x,b.currentVertex.y);p[10]=
a.id;p[11]=a._fillColor;p[12]=d;p[13]=c;p[14]=a._tl;p[15]=a._br;p[16]=e;p[17]=f.i1616to32(31*a._halfReferenceWidth,0);b.exit0=a.offset+a.vertexCount++;c=f.i1616to32(b.distance,31*a._halfWidth);d=f.i8888to32(Math.round(31*b.nextNormal.x),Math.round(31*b.nextNormal.y),Math.round(0),Math.round(-31));e=f.i8888to32(0,0,0,a._bitset);p[18]=f.i1616to32(b.currentVertex.x,b.currentVertex.y);p[19]=a.id;p[20]=a._fillColor;p[21]=d;p[22]=c;p[23]=a._tl;p[24]=a._br;p[25]=e;p[26]=f.i1616to32(31*a._halfReferenceWidth,
0);b.exit2=a.offset+a.vertexCount++;c=f.i1616to32(b.distance,31*a._halfWidth);d=f.i8888to32(Math.round(31*-b.nextNormal.x),Math.round(31*-b.nextNormal.y),Math.round(0),Math.round(31));e=f.i8888to32(0,0,0,a._bitset);p[27]=f.i1616to32(b.currentVertex.x,b.currentVertex.y);p[28]=a.id;p[29]=a._fillColor;p[30]=d;p[31]=c;p[32]=a._tl;p[33]=a._br;p[34]=e;p[35]=f.i1616to32(31*a._halfReferenceWidth,0);a.geometryBuf.writeRegion(p)}},w=function(a){return function(b){k[0]=b.leftExit0;k[1]=b.rightEntry0;k[2]=b.leftExit2;
k[3]=b.rightEntry0;k[4]=b.rightEntry2;k[5]=b.leftExit2;a.indexCount+=6;a.indexBuf.writeRegion(k)}},B=function(a){return function(b,c,d,e,g,h,k,l,m){m=f.i1616to32(m,31*a._halfWidth);g=f.i8888to32(Math.round(31*g),Math.round(31*h),Math.round(31*k),Math.round(31*l));d=f.i8888to32(31*d,31*e,0,a._bitset);n[0]=f.i1616to32(b,c);n[1]=a.id;n[2]=a._fillColor;n[3]=g;n[4]=m;n[5]=a._tl;n[6]=a._br;n[7]=d;n[8]=f.i1616to32(31*a._halfReferenceWidth,0);a.geometryBuf.writeRegion(n);return a.offset+a.vertexCount++}},
E=function(a){return function(b,c,d){y[0]=b;y[1]=c;y[2]=d;a.indexCount+=3;a.indexBuf.writeRegion(y)}};a.default=function(a){return function(a){function b(){for(var b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];b=a.apply(this,b)||this;b.tessellationProperties={_fillColor:null,_tl:null,_br:null,_halfWidth:null,_bitset:null,_halfReferenceWidth:null,id:null,indexBuf:null,indexCount:null,geometryBuf:null,vertexCount:null,offset:null};b._tessellationOptions={};b.geometryType=m.WGLGeometryType.LINE;
return b}c(b,a);b.prototype.writeMesh=function(a,b,c,d,e){var f=b.indexVector,g=b.get("geometry"),h=new z(d,this.geometryType,this._materialKey);b=b.getVector("geometry").vertexCount;h.vertexFrom=b;h.indexFrom=f.length;switch(c){case "esriGeometryPolyline":c=this._clipLines(e.geometry.paths);if(0===c.length)break;this._write(h,f,g,b,d,c);a.push(h);break;case "esriGeometryPolygon":c=this._clipLines(e.geometry.rings);if(0===c.length)break;this._write(h,f,g,b,d,c);a.push(h);break;default:A.error("Unable to handle geometryType: "+
c)}};b.prototype._clipLines=function(a){for(var b=[],c=!1,d=0;d<a.length;){var e=[],f=a[d];q.reset(2);var g=f[0],h=g[0],g=g[1];if(c)q.moveTo(h,g);else{if(-16>h||h>x||-16>g||g>x){c=!0;continue}e.push({x:h,y:g})}for(var k=!1,l=f.length,n=1;n<l;++n)if(h+=f[n][0],g+=f[n][1],c)q.lineTo(h,g);else{if(-16>h||h>x||-16>g||g>x){k=!0;break}e.push({x:h,y:g})}if(k)c=!0;else{if(c){if(e=q.resultWithStarts())for(c=0;c<e.length;c++)b.push(e[c])}else b.push({line:e,start:0});d++;c=!1}}return b};b.prototype._write=function(a,
b,c,d,e,f){this.tessellationProperties.id=e;this.tessellationProperties.indexBuf=b;this.tessellationProperties.indexCount=0;this.tessellationProperties.geometryBuf=c;this.tessellationProperties.vertexCount=0;this.tessellationProperties.offset=d;for(b=0;b<f.length;b++)c=f[b],d=c.line,2>d.length||(this._tessellationOptions.initialDistance=c.start%65535,this._tessellationCallbacks instanceof l.StandardTessellationCallbacks&&(this._tessellationCallbacks.capType=this._capType,this._tessellationCallbacks.joinType=
this._joinType),l.tessellate(d,this._tessellationOptions,this._tessellationCallbacks),l.cleanup());a.vertexCount=this.tessellationProperties.vertexCount;a.indexCount=this.tessellationProperties.indexCount;a.zOrder=this._zOrder};b.prototype._initializeTessellator=function(a){var b=v.LineMaterialKey.load(this._materialKey);this._tessellationOptions.trackDistance=this._isDashed||this._hasPattern;this._tessellationOptions.thin=!a&&this.tessellationProperties._halfWidth<g.THIN_LINE_THRESHOLD/2&&!(b.vvSizeFieldStops||
b.vvSizeMinMaxValue||b.vvSizeScaleStops||b.vvSizeUnitValue);this._tessellationOptions.wrapDistance=65535;this._tessellationOptions.outerBisectorAutoSplitThreshold=u;this._tessellationOptions.enableOuterBisectorSplit=this._isDashed||this._hasPattern;this._tessellationOptions.innerBisectorAutoSplitThreshold=u;this._tessellationOptions.enableInnerBisectorSplit=this._isDashed||this._hasPattern;this._tessellationOptions.thin?this._tessellationCallbacks={vertex:C(this.tessellationProperties),bridge:w(this.tessellationProperties)}:
(a=new l.StandardTessellationCallbacks(B(this.tessellationProperties),E(this.tessellationProperties)),a.miterLimitCosine=this._miterLimitCosine,a.textured=this._isDashed||this._hasPattern,a.joinOnUTurn=this._joinOnUTurn,this._tessellationCallbacks=a)};return b}(a)}})},"esri/views/2d/engine/webgl/mesh/templates/WGLMarkerTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/screenUtils ../../../../../../core/libs/gl-matrix-2/mat2d ../../../../../../core/libs/gl-matrix-2/mat2df32 ../../../../../../core/libs/gl-matrix-2/vec2 ../../../../../../core/libs/gl-matrix-2/vec2f32 ../../../../../../symbols/cim/enums ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./WGLBaseMarkerTemplate ./WGLMeshTemplate".split(" "),
function(e,a,c,h,b,g,m,f,d,l,z,v,A,x,u){Object.defineProperty(a,"__esModule",{value:!0});e=function(a){function e(c,e,h,l,n,q,u,x,z,M,J,L,K,Q,I,R,O,N,H){var k=a.call(this)||this;k.height=u;k.width=q;k.xOffset=e*H;k.yOffset=h*H;e=f.vec2f32.create();h=g.mat2df32.create();J=(Q===d.Alignment.MAP?1:0)|(J?1:0)<<1|(K?1:0)<<2|(L?1:0)<<3;L=I&&I.sdf;b.mat2d.translate(h,h,f.vec2f32.fromValues(k.xOffset,-k.yOffset));l&&b.mat2d.rotate(h,h,3.14159265359/180*l);c=A.MarkerMaterialKey.load(A.createMaterialKey(k.geometryType,
c,!1));c.sdf=L;c.pattern=!0;c.textureBinding=I.textureBinding;k._materialKey=c.data;k._fillColor=n;k._outlineColor=z;k._sizeOutlineWidth=v.i8888to32(Math.round(Math.sqrt(256*q)),Math.round(Math.sqrt(256*u)),Math.round(Math.sqrt(256*M)),Math.round(Math.sqrt(256*x)));n=I.rect.x;x=I.rect.y;z=n+I.rect.width;M=x+I.rect.height;R=.5-((.5+R)*I.width+1)/I.rect.width;O=.5-((.5+O)*I.height+1)/I.rect.height;c=Math.round(Math.min(64*N,255));q*=I.rect.width/I.width*N*H;u*=I.rect.height/I.height*N*H;I=(R-.5)*q;
O=(O-.5)*u;k._bitestAndDistRatio=v.i8888to32(0,0,J,c);m.vec2.set(e,I,O);m.vec2.transformMat2d(e,e,h);k._offsetUpperLeft=v.i1616to32(16*e[0],16*e[1]);k._texUpperLeft=v.i1616to32(n,x);m.vec2.set(e,I+q,O);m.vec2.transformMat2d(e,e,h);k._offsetUpperRight=v.i1616to32(16*e[0],16*e[1]);k._texUpperRight=v.i1616to32(z,x);m.vec2.set(e,I,O+u);m.vec2.transformMat2d(e,e,h);k._offsetBottomLeft=v.i1616to32(16*e[0],16*e[1]);k._texBottomLeft=v.i1616to32(n,M);m.vec2.set(e,I+q,O+u);m.vec2.transformMat2d(e,e,h);k._offsetBottomRight=
v.i1616to32(16*e[0],16*e[1]);k._texBottomRight=v.i1616to32(z,M);return k}c(e,a);e.fromCIMMarker=function(a,b,c,f){var g=b.size,k=(c&&c.width||1)/(c&&c.height||1)*b.scaleX,n=b.scaleSymbolsProportionally&&b.frameHeight?g/b.frameHeight:1,m=l.premultiplyAlphaRGBA(b.color),p=l.premultiplyAlphaRGBA(b.outlineColor),q=h.pt2px(g),y=q*k,u=h.pt2px(b.offsetX||0),x=h.pt2px(b.offsetY||0),n=h.pt2px(b.outlineWidth||0)*n,v=b.alignment||d.Alignment.SCREEN,z=h.pt2px(b.referenceSize),A=b.rotation||0;b.rotateClockwise||
(A=-A);var C=0,N=0,H=b.anchorPoint;H&&(b.isAbsoluteAnchorPoint?g&&(C=-H.x/(g*k),N=H.y/g):(C=H.x,N=H.y));return new e(a,u,x,A,m,y,q,z,p,n,b.colorLocked,b.scaleSymbolsProportionally,!1,v,c,C,N,b.sizeRatio,f)};e.fromPictureMarker=function(a,b,c){var f=Math.round(h.pt2px(b.width)),g=Math.round(h.pt2px(b.height)),k=z.PICTURE_FILL_COLOR,l=Math.round(h.pt2px(b.xoffset||0)),n=Math.round(h.pt2px(b.yoffset||0));return new e(a,l,n,b.angle,k,f,g,g,0,0,!1,!1,!1,d.Alignment.SCREEN,c,0,0,1,1)};e.fromSimpleMarker=
function(a,b,c){var f=l.premultiplyAlphaRGBA(b.color),g=Math.round(h.pt2px(b.size)),k=Math.round(h.pt2px(b.xoffset||0)),n=Math.round(h.pt2px(b.yoffset||0)),m=b.style,p=b.outline,q=(p&&p.color&&l.premultiplyAlphaRGBA(p.color))|0,p=(p&&p.width&&Math.round(h.pt2px(p.width)))|0;return new e(a,k,n,b.angle,f,g,g,g,q,p,!1,!1,"cross"===m||"x"===m,d.Alignment.SCREEN,c,0,0,1.96875,1)};return e}(x.default(u.default));a.default=e})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseMarkerTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/Logger ../../enums ../../number ../../WGLDisplayRecord".split(" "),
function(e,a,c,h,b,g,m){Object.defineProperty(a,"__esModule",{value:!0});var f=h.getLogger("esri.views.2d.engine.webgl.WGLMarkerTemplateBase");a.default=function(a){return function(a){function d(){for(var c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];c=a.apply(this,c)||this;c.xOffset=0;c.yOffset=0;c.width=0;c.height=0;c.geometryType=b.WGLGeometryType.MARKER;return c}c(d,a);d.prototype.writeMesh=function(a,b,c,d,e){var g=b.indexVector,h=b.get("geometry"),l=new m(d,this.geometryType,this._materialKey);
b=b.getVector("geometry").vertexCount;a.push(l);l.vertexFrom=b;l.indexFrom=g.length;switch(c){case "esriGeometryPoint":c=e.geometry;a=c.x;c=c.y;this._writeVertices(l,h,d,this._getPos(a,c));this._writeIndices(l,g,b);break;case "esriGeometryPolyline":this._writeMany(l,g,h,b,d,e.geometry.paths[0]);break;case "esriGeometryPolygon":(c=e.centroid)?(a=c.x,c=c.y,this._writeVertices(l,h,d,this._getPos(a,c)),this._writeIndices(l,g,b)):f.error("Tried to render polygon geometries as markers, but found no centroid!");
break;case "esriGeometryMultipoint":this._writeMany(l,g,h,b,d,e.geometry.points);break;default:f.error("Unable to handle geometryType: "+c)}};d.prototype._getPos=function(a,b){return g.i1616to32(a,b)};d.prototype._writeMany=function(a,b,c,d,e,f){for(var g=0,h=0,k=0,l=0;l<f.length;l++){var n=f[l],m=n[0],n=n[1],q=this._getPos(m+g,n+h);this._writeVertices(a,c,e,q);this._writeIndices(a,b,d+k);g+=m;h+=n;k+=4}};d.prototype._writeVertices=function(a,b,c,d){b.push(d);b.push(this._offsetUpperLeft);b.push(this._texUpperLeft);
b.push(this._bitestAndDistRatio);b.push(c);b.push(this._fillColor);b.push(this._outlineColor);b.push(this._sizeOutlineWidth);b.push(d);b.push(this._offsetUpperRight);b.push(this._texUpperRight);b.push(this._bitestAndDistRatio);b.push(c);b.push(this._fillColor);b.push(this._outlineColor);b.push(this._sizeOutlineWidth);b.push(d);b.push(this._offsetBottomLeft);b.push(this._texBottomLeft);b.push(this._bitestAndDistRatio);b.push(c);b.push(this._fillColor);b.push(this._outlineColor);b.push(this._sizeOutlineWidth);
b.push(d);b.push(this._offsetBottomRight);b.push(this._texBottomRight);b.push(this._bitestAndDistRatio);b.push(c);b.push(this._fillColor);b.push(this._outlineColor);b.push(this._sizeOutlineWidth);a.vertexCount+=4};d.prototype._writeIndices=function(a,b,c){b.push(c+0);b.push(c+1);b.push(c+2);b.push(c+1);b.push(c+3);b.push(c+2);a.indexCount+=6};return d}(a)}})},"esri/views/2d/engine/webgl/mesh/templates/WGLTemplateStore":function(){define("require exports ../../../../../../core/tsSupport/awaiterHelper ../../../../../../core/tsSupport/generatorHelper ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/promiseUtils ../../../../../../support/arcadeOnDemand ../../../../../../symbols/cim/cimAnalyzer ../../../../../../symbols/support/defaults ../../../../arcade/utils ./WGLDynamicLineTemplate ./WGLDynamicMarkerTemplate ./WGLDynamicTextTemplate ./WGLFillTemplate ./WGLLineTemplate ./WGLMarkerTemplate ./WGLTextTemplate ../../util/BidiText ../../util/Lock ../../util/Result".split(" "),
function(e,a,c,h,b,g,m,f,d,l,z,v,A,x,u,q,n,p,y,k,C){function w(a,b){var c=a.length;a.push(null);b.then(function(b){return a[c]=b});return a}function B(a){return!!(a&1)}Object.defineProperty(a,"__esModule",{value:!0});var E=g.getLogger("esri.views.2d.engine.webgl.mesh.templates.WGLTemplateStore"),G=[];a.isDynamicId=B;e=function(){function a(a,b){this._templateIdCounter=this._idCounter=0;this._idToTemplateGroup=new Map;this._symbolToTemplate=new Map;this._fetchQueue=[];this._idToResolver=new Map;this._cimTemplateCache=
new Map;this._cimAnalyses=[];this._lock=new k.default;this._fetchResource=a;this._joinOnUTurn=b}Object.defineProperty(a.prototype,"_markerError",{get:function(){return this._errorTemplates.marker[0]},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"_fillError",{get:function(){return this._errorTemplates.fill[0]},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"_lineError",{get:function(){return this._errorTemplates.line[0]},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"_textError",{get:function(){return this._errorTemplates.line[0]},enumerable:!0,configurable:!0});a.prototype.createTemplateGroup=function(a,b,d,e){return c(this,void 0,void 0,function(){var c,f,g;return h(this,function(h){switch(h.label){case 0:return[4,this._initErrorTemplates()];case 1:h.sent();c=JSON.stringify(a);if(this._symbolToTemplate.has(c))return[2,this._symbolToTemplate.get(c)];f=[];return b?[4,this._createMeshTemplates(f,b,d,e,!0)]:[3,3];case 2:h.sent(),h.label=3;case 3:return[4,this._createMeshTemplates(f,
a,d,e,!1)];case 4:return h.sent(),g=this._createGroupId("cim"===a.type),this._idToTemplateGroup.set(g,f),this._symbolToTemplate.set(c,g),[2,g]}})})};a.prototype.getCIMMosaicItem=function(a,b){var c=this,d=this._createTemplateId(),e=m.create(function(a){return c._idToResolver.set(d,a)});this._fetchQueue.push({symbol:a,id:d,glyphIds:b});return e};a.prototype.getTemplateGroup=function(a){return this._idToTemplateGroup.has(a)?this._idToTemplateGroup.get(a):G};a.prototype.getDynamicTemplateGroup=function(a){if(!this._idToTemplateGroup.has(a))return G;
B(a)||E.error("mapview-template-store","Id "+a+" does not refer to a dynamic template");return this._idToTemplateGroup.get(a)};a.prototype.finalize=function(a){return this._fetchQueue.length||this._lock.isHeld()?k.withLock(this._lock,this._fetchAllQueuedResources.bind(this),a):m.resolve()};a.prototype._initErrorTemplates=function(){return c(this,void 0,void 0,function(){var a,b,c,d;return h(this,function(e){switch(e.label){case 0:if(this._errorTemplates)return[2];a=this._createMeshTemplates([],l.errorPolygonSymbol2D,
null,null,!1);b=this._createMeshTemplates([],l.errorPointSymbol2D,null,null,!1);c=this._createMeshTemplates([],l.errorPolylineSymbol2D,null,null,!1);return[4,m.all([a,b,c])];case 1:return d=e.sent(),this._errorTemplates={fill:d[0],marker:d[1],line:d[2]},[2]}})})};a.prototype._fetchAllQueuedResources=function(a){var c=this;if(!this._fetchQueue.length)return m.resolve();var d=this._fetchQueue,e=this._cimAnalyses;this._fetchQueue=[];this._cimAnalyses=[];return m.all(e).then(function(){return c._fetchResource(d,
a).then(function(a){for(var b=0;b<a.length;b++){var d=a[b],e=d.id,d=d.mosaicItem;c._idToResolver.get(e)(d);c._idToResolver.delete(e)}})}).catch(function(a){m.isAbortError(a)?c._fetchQueue=c._fetchQueue.concat(d):E.error(new b("mapview-template-store","Unable to fetch requested texture resources",a))})};a.prototype._createGroupId=function(a){return this._idCounter++<<1|(a?1:0)};a.prototype._createTemplateId=function(){return this._templateIdCounter++};a.prototype._getCodepoints=function(a){a=y.bidiText(a.text)[0];
for(var b=[],c=0;c<a.length;c++)b.push(a.charCodeAt(c));return b};a.prototype._getMosaicItem=function(a){var b=this,c=this._createTemplateId(),d="text"===a.type&&this._getCodepoints(a),e=m.create(function(a){return b._idToResolver.set(c,a)});this._fetchQueue.push({symbol:a.toJSON(),id:c,glyphIds:d});return e};a.prototype._createSMS=function(a,b){return c(this,void 0,void 0,function(){var c;return h(this,function(d){switch(d.label){case 0:return[4,this._getMosaicItem(a)];case 1:return c=d.sent().spriteMosaicItem,
C.ok(c,E)?[2,n.default.fromSimpleMarker(b,a,c)]:[2,this._markerError]}})})};a.prototype._createPMS=function(a,b){return c(this,void 0,void 0,function(){var c;return h(this,function(d){switch(d.label){case 0:return[4,this._getMosaicItem(a)];case 1:return c=d.sent().spriteMosaicItem,C.ok(c,E)?[2,n.default.fromPictureMarker(b,a,c)]:[2,this._markerError]}})})};a.prototype._createSFS=function(a,b,d){return c(this,void 0,void 0,function(){var c,e;return h(this,function(f){switch(f.label){case 0:return[4,
this._getMosaicItem(a)];case 1:return c=f.sent().spriteMosaicItem,e=a,C.ok(c,E)?[2,u.default.fromSimpleFill(b,e,c,d)]:[2,this._fillError]}})})};a.prototype._createPFS=function(a,b,d){return c(this,void 0,void 0,function(){var c,e;return h(this,function(f){switch(f.label){case 0:return[4,this._getMosaicItem(a)];case 1:return c=f.sent().spriteMosaicItem,e=a,C.ok(c,E)?[2,u.default.fromPictureFill(b,e,c,d)]:[2,this._fillError]}})})};a.prototype._createSLS=function(a,b,d){return c(this,void 0,void 0,function(){var c,
e;return h(this,function(f){switch(f.label){case 0:return[4,this._getMosaicItem(a)];case 1:return c=f.sent().spriteMosaicItem,e=a,C.ok(c,E)?[2,q.default.fromSimpleLine(b,d,e,c,this._joinOnUTurn)]:[2,this._lineError]}})})};a.prototype._createTS=function(a,b){return c(this,void 0,void 0,function(){var c;return h(this,function(d){switch(d.label){case 0:return[4,this._getMosaicItem(a)];case 1:return c=d.sent().glyphMosaicItems,[2,p.default.fromText(b,a,c)]}})})};a.prototype._createCIMText=function(a,
b,d){return c(this,void 0,void 0,function(){var c,e,f,g,k,l;return h(this,function(h){switch(h.label){case 0:if("function"===typeof a.materialHash||"function"===typeof d)return[2,m.resolve(x.default.fromCIMText(b,a,d))];c=[];if(e=a.text)for(f=e.length,g=0;g<f;g++)k=e.charCodeAt(g),c.push(k);a.cim.mosaicHash=a.materialHash;return[4,this.getCIMMosaicItem(a.cim,c)];case 1:return l=h.sent().glyphMosaicItems,C.ok(l,E)?[2,p.default.fromCIMText(b,a,d,l)]:[2,this._textError]}})})};a.prototype._createCIMFill=
function(a,b){return c(this,void 0,void 0,function(){var c;return h(this,function(d){switch(d.label){case 0:return a.cim.mosaicHash=a.materialHash,[4,this.getCIMMosaicItem(a.cim)];case 1:return c=d.sent().spriteMosaicItem,C.ok(c,E)?[2,u.default.fromCIMFill(b,a,c,!1)]:[2,this._fillError]}})})};a.prototype._createCIMLine=function(a,b,d){return c(this,void 0,void 0,function(){var c;return h(this,function(e){switch(e.label){case 0:if("function"===typeof a.materialHash||"function"===typeof d)return[2,
m.resolve(v.default.fromCIMLine(b,a,d))];a.cim.mosaicHash=a.materialHash;return[4,this.getCIMMosaicItem(a.cim)];case 1:return c=e.sent().spriteMosaicItem,C.ok(c,E)?[2,q.default.fromCIMLine(b,a,c,!1,this._joinOnUTurn,d)]:[2,this._lineError]}})})};a.prototype._createCIMMarker=function(a,b,d){return c(this,void 0,void 0,function(){var c;return h(this,function(e){switch(e.label){case 0:if("function"===typeof a.materialHash||"function"===typeof d)return[2,m.resolve(A.default.fromCIMMarker(b,a,d))];a.cim.mosaicHash=
a.materialHash;return[4,this.getCIMMosaicItem(a.cim)];case 1:return c=e.sent().spriteMosaicItem,C.ok(c,E)?[2,n.default.fromCIMMarker(b,a,c,d)]:[2,this._markerError]}})})};a.prototype._createCIM=function(a,b,d){return c(this,void 0,void 0,function(){var c,e,f=this;return h(this,function(g){c=a.templateHash;if(this._cimTemplateCache.has(c))return[2,this._cimTemplateCache.get(c)];switch(a.type){case "marker":e=this._createCIMMarker(a,b,d);break;case "line":e=this._createCIMLine(a,b,d);break;case "fill":e=
this._createCIMFill(a,b);break;case "text":e=this._createCIMText(a,b,d)}e.then(function(a){return f._cimTemplateCache.set(c,a)});return[2,e]})})};a.prototype._getCIMSymbolLayers=function(a,b,e){return c(this,void 0,void 0,function(){var c,f;return h(this,function(g){switch(g.label){case 0:return c=[],f=[],c.push(d.analyzeCIMSymbol(a.data,b,e,f)),[4,m.all(c)];case 1:return g.sent(),[2,f]}})})};a.prototype._createCIMMeshTemplates=function(a,b,d,e){return c(this,void 0,void 0,function(){var c,g,k,l,
n,m,p,q,y,u,x;return h(this,function(h){switch(h.label){case 0:g=(c=d)?c.fieldMap:null;k=b;if(!c||!c.scaleExpression)return[3,3];if(!isNaN(c.scaleExpression))return[3,2];m=c.scaleExpression;return[4,f.createRendererExpression(m,e.spatialReference,e.fields)];case 1:return p=h.sent(),l=function(a,b,c){a=z.callWithFeature(p,a,{$view:c},e.geometryType,b);return null!==a?a:1},[3,3];case 2:n=Number(c.scaleExpression),h.label=3;case 3:return[4,this._getCIMSymbolLayers(k,g,e)];case 4:q=h.sent();y=0;for(u=
q;y<u.length;y++)x=u[y],w(a,this._createCIM(x,d,n||l||1));return[2]}})})};a.prototype._createMeshTemplates=function(a,b,d,e,f){return c(this,void 0,void 0,function(){var c,g,k;return h(this,function(h){switch(h.label){case 0:if(-1!==b.type.indexOf("3d"))return E.error("3D symbols are not supported with MapView"),[2,a];c=b.type;switch(c){case "cim":return[3,1];case "simple-marker":return[3,3];case "picture-marker":return[3,4];case "simple-fill":return[3,5];case "picture-fill":return[3,6];case "simple-line":return[3,
7];case "text":return[3,8]}return[3,9];case 1:return[4,this._createCIMMeshTemplates(a,b,d,e)];case 2:return h.sent(),[2,a];case 3:return[2,w(a,this._createSMS(b,d))];case 4:return[2,w(a,this._createPMS(b,d))];case 5:return g=b,w(a,this._createSFS(g,d,f)),g.outline&&w(a,this._createSLS(g.outline,d,!0)),[2,a];case 6:return k=b,w(a,this._createPFS(k,d,f)),k.outline&&w(a,this._createSLS(k.outline,d,!0)),[2,a];case 7:return[2,w(a,this._createSLS(b,d,!1))];case 8:return[2,w(a,this._createTS(b,d))];case 9:return E.error("Unable to create mesh template for unknown symbol type {: $ }{symbol.type}"),
[2,a]}})})};return a}();a.WGLTemplateStore=e})},"esri/symbols/cim/cimAnalyzer":function(){define("require exports ../../core/tsSupport/generatorHelper ../../core/tsSupport/awaiterHelper ../../core/tsSupport/assignHelper ../../Color ../../core/Logger ../../core/promiseUtils ../../core/string ../../support/arcadeOnDemand ./CIMSymbolHelper ./enums ./SDFHelper ../../views/2d/arcade/utils".split(" "),function(e,a,c,h,b,g,m,f,d,l,z,v,A,x){function u(a){return a?{r:a[0],g:a[1],b:a[2],a:a[3]/255}:{r:0,g:0,
b:0,a:0}}function q(a){switch(a){case "Butt":return v.CapType.BUTT;case "Square":return v.CapType.SQUARE;default:return v.CapType.ROUND}}function n(a){switch(a){case "Bevel":return v.JoinType.BEVEL;case "Miter":return v.JoinType.MITER;default:return v.JoinType.ROUND}}function p(a){switch(a){default:return"left";case "Right":return"right";case "Center":return"center";case "Justify":return"justify"}}function y(a){switch(a){default:return"top";case "Center":return"middle";case "Baseline":return"baseline";
case "Bottom":return"bottom"}}function k(a){var b="normal",c="normal";a&&(a=a.toLowerCase(),-1!==a.indexOf("italic")?b="italic":-1!==a.indexOf("oblique")&&(b="oblique"),-1!==a.indexOf("bold")?c="bold":-1!==a.indexOf("light")&&(c="lighter"));return{style:b,weight:c}}function C(a,b,d,e,f,g){return h(this,void 0,void 0,function(){var h,k,l,n,m,p,q;return c(this,function(c){switch(c.label){case 0:if(!a)return[2];h=a.symbolLayers;if(!h)return[2];l=z.CIMSymbolHelper.getSize(a);"CIMPointSymbol"===a.type&&
"Map"===a.angleAlignment&&(k=v.Alignment.MAP);n=h.length;c.label=1;case 1:if(!n--)return[3,23];m=h[n];if(!m||!1===m.enable)return[3,1];p=[];z.OverrideHelper.findApplicableOverrides(m,b,p);q=m.type;switch(q){case "CIMSolidFill":return[3,2];case "CIMPictureFill":return[3,4];case "CIMHatchFill":return[3,6];case "CIMGradientFill":return[3,8];case "CIMSolidStroke":return[3,10];case "CIMPictureStroke":return[3,12];case "CIMGradientStroke":return[3,14];case "CIMCharacterMarker":return[3,16];case "CIMPictureMarker":return[3,
17];case "CIMVectorMarker":return[3,19]}return[3,21];case 2:return[4,w(m,p,e,f)];case 3:return c.sent(),[3,22];case 4:return[4,B(m,p,e,f)];case 5:return c.sent(),[3,22];case 6:return[4,E(m,p,e,f)];case 7:return c.sent(),[3,22];case 8:return[4,G(m,p,e,f)];case 9:return c.sent(),[3,22];case 10:return[4,F(m,p,e,f,"CIMPolygonSymbol"===a.type,l)];case 11:return c.sent(),[3,22];case 12:return[4,M(m,p,e,f,"CIMPolygonSymbol"===a.type,l)];case 13:return c.sent(),[3,22];case 14:return[4,J(m,p,e,f,"CIMPolygonSymbol"===
a.type,l)];case 15:return c.sent(),[3,22];case 16:return[3,22];case 17:return[4,L(m,p,e,f,k,l)];case 18:return c.sent(),[3,22];case 19:return[4,K(m,p,d,e,f,k,l,g)];case 20:return c.sent(),[3,22];case 21:Z.error("Cannot analyze CIM layer",m.type),c.label=22;case 22:return[3,1];case 23:return[2]}})})}function w(a,b,e,f){return h(this,void 0,void 0,function(){var g,h,k,l,n,m;return c(this,function(c){switch(c.label){case 0:return g=a.primitiveName,h=u(a.color),k=d.numericHash(JSON.stringify(a)).toString(),
n=(l=f).push,m={type:"fill",templateHash:k,materialHash:0===b.length?k:function(){return k},cim:a,materialOverrides:null,colorLocked:a.colorLocked},[4,H(g,"Color",b,e,h,N)];case 1:return n.apply(l,[(m.color=c.sent(),m.height=0,m.angle=0,m.offsetX=0,m.offsetY=0,m.scaleX=1,m)]),[2]}})})}function B(a,b,e,f){return h(this,void 0,void 0,function(){var g,h,k,l,n,m,p;return c(this,function(c){switch(c.label){case 0:return g=a.primitiveName,h=u(a.tintColor),k=d.numericHash(JSON.stringify(a)).toString(),l=
d.numericHash(""+a.url+JSON.stringify(a.colorSubstitutions)).toString(),m=(n=f).push,p={type:"fill",templateHash:k,materialHash:0===b.length?l:function(){return l},cim:a,materialOverrides:null,colorLocked:a.colorLocked},[4,H(g,"TintColor",b,e,h,N)];case 1:return p.color=c.sent(),[4,H(g,"Height",b,e,a.height)];case 2:return p.height=c.sent(),[4,H(g,"ScaleX",b,e,a.scaleX)];case 3:return p.scaleX=c.sent(),[4,H(g,"Rotation",b,e,a.rotation)];case 4:return p.angle=c.sent(),[4,H(g,"OffsetX",b,e,a.offsetX)];
case 5:return p.offsetX=c.sent(),[4,H(g,"OffsetY",b,e,a.offsetY)];case 6:return m.apply(n,[(p.offsetY=c.sent(),p)]),[2]}})})}function E(a,b,e,f){return h(this,void 0,void 0,function(){var g,h,k,l,n,m,p,q;return c(this,function(c){switch(c.label){case 0:g=["Rotation","OffsetX","OffsetY"];h=b.filter(function(b){return b.primitiveName!==a.primitiveName&&-1===g.indexOf(b.propertyName)});k=a.primitiveName;l=d.numericHash(JSON.stringify(a)).toString();m=(n=f).push;p={type:"fill",templateHash:l};if(0!==
b.length)return[3,1];q=l;return[3,3];case 1:return[4,V(l,h,e)];case 2:q=c.sent(),c.label=3;case 3:return p.materialHash=q,p.cim=a,p.materialOverrides=h,p.colorLocked=a.colorLocked,p.color={r:128,g:128,b:128,a:1},p.height=0,p.scaleX=1,[4,H(k,"Rotation",b,e,a.rotation)];case 4:return p.angle=c.sent(),[4,H(k,"OffsetX",b,e,a.offsetX)];case 5:return p.offsetX=c.sent(),[4,H(k,"OffsetY",b,e,a.offsetY)];case 6:return m.apply(n,[(p.offsetY=c.sent(),p)]),[2]}})})}function G(a,b,e,f){return h(this,void 0,void 0,
function(){var g,h,k,l,n;return c(this,function(c){switch(c.label){case 0:g=d.numericHash(JSON.stringify(a)).toString();k=(h=f).push;l={type:"fill",templateHash:g};if(0!==b.length)return[3,1];n=g;return[3,3];case 1:return[4,V(g,b,e)];case 2:n=c.sent(),c.label=3;case 3:return k.apply(h,[(l.materialHash=n,l.cim=a,l.materialOverrides=null,l.colorLocked=a.colorLocked,l.color={r:128,g:128,b:128,a:1},l.height=0,l.angle=0,l.offsetX=0,l.offsetY=0,l.scaleX=1,l)]),[2]}})})}function F(a,b,e,f,g,k){return h(this,
void 0,void 0,function(){var h,l,m,p,y,w,x,v,z,A;return c(this,function(c){switch(c.label){case 0:return h=d.numericHash(JSON.stringify(a)).toString(),l=a.primitiveName,m=u(a.color),p=void 0!==a.width?a.width:4,y=q(a.capStyle),w=n(a.joinStyle),x=a.miterLimit,z=(v=f).push,A={type:"line",templateHash:h,materialHash:0===b.length?h:function(){return h},cim:a,materialOverrides:null,isOutline:g,colorLocked:a.colorLocked},[4,H(l,"Color",b,e,m,N)];case 1:return A.color=c.sent(),[4,H(l,"Width",b,e,p)];case 2:return A.width=
c.sent(),[4,H(l,"CapStyle",b,e,y)];case 3:return A.cap=c.sent(),[4,H(l,"JoinStyle",b,e,w)];case 4:return A.join=c.sent(),[4,H(l,"MiterLimit",b,e,x)];case 5:return z.apply(v,[(A.miterLimit=c.sent(),A.referenceWidth=k,A.zOrder=O(a.name),A.isDashed=!1,A)]),[2]}})})}function M(a,b,e,f,g,k){return h(this,void 0,void 0,function(){var h,l,m,p,y,w,x,v,z,A,B;return c(this,function(c){switch(c.label){case 0:return h=d.numericHash(""+a.url+JSON.stringify(a.colorSubstitutions)).toString(),l=a.primitiveName,m=
u(a.tintColor),p=void 0!==a.width?a.width:4,y=q(a.capStyle),w=n(a.joinStyle),x=a.miterLimit,v=d.numericHash(JSON.stringify(a)).toString(),A=(z=f).push,B={type:"line",templateHash:v,materialHash:0===b.length?h:function(){return h},cim:a,materialOverrides:null,isOutline:g,colorLocked:a.colorLocked},[4,H(l,"TintColor",b,e,m,N)];case 1:return B.color=c.sent(),[4,H(l,"Width",b,e,p)];case 2:return B.width=c.sent(),[4,H(l,"CapStyle",b,e,y)];case 3:return B.cap=c.sent(),[4,H(l,"JoinStyle",b,e,w)];case 4:return B.join=
c.sent(),[4,H(l,"MiterLimit",b,e,x)];case 5:return A.apply(z,[(B.miterLimit=c.sent(),B.referenceWidth=k,B.zOrder=O(a.name),B.isDashed=!1,B)]),[2]}})})}function J(a,b,e,f,g,k){return h(this,void 0,void 0,function(){var h,l,m,p,y,u,w,x,v,z;return c(this,function(c){switch(c.label){case 0:h=a.primitiveName;l=void 0!==a.width?a.width:4;m=q(a.capStyle);p=n(a.joinStyle);y=a.miterLimit;u=d.numericHash(JSON.stringify(a)).toString();x=(w=f).push;v={type:"line",templateHash:u};if(0!==b.length)return[3,1];z=
u;return[3,3];case 1:return[4,V(u,b,e)];case 2:z=c.sent(),c.label=3;case 3:return v.materialHash=z,v.cim=a,v.materialOverrides=null,v.isOutline=g,v.colorLocked=a.colorLocked,v.color={r:128,g:128,b:128,a:1},[4,H(h,"Width",b,e,l)];case 4:return v.width=c.sent(),[4,H(h,"CapStyle",b,e,m)];case 5:return v.cap=c.sent(),[4,H(h,"JoinStyle",b,e,p)];case 6:return v.join=c.sent(),[4,H(h,"MiterLimit",b,e,y)];case 7:return x.apply(w,[(v.miterLimit=c.sent(),v.referenceWidth=k,v.zOrder=O(a.name),v.isDashed=!1,v)]),
[2]}})})}function L(a,b,e,f,g,k){return h(this,void 0,void 0,function(){var h,l,n,m,p,q,y,w,x,v,z,r,A,B,t,C;return c(this,function(c){switch(c.label){case 0:h=a.primitiveName;l=a.size;n=a.scaleX;m=a.rotation;p=a.offsetX;q=a.offsetY;y=u(a.tintColor);w=d.numericHash(""+a.url+JSON.stringify(a.colorSubstitutions)).toString();x=!1;v="";z=0;for(r=b;z<r.length;z++)A=r[z],A.primitiveName===h&&(void 0!==A.value?v+="|"+A.primitiveName+"|"+A.propertyName+"|"+JSON.stringify(A.value):A.valueExpressionInfo&&(x=
!0));t=(B=f).push;C={type:"marker",templateHash:d.numericHash(JSON.stringify(a)+v).toString(),materialHash:x?function(){return w}:w,cim:a,materialOverrides:null,colorLocked:a.colorLocked,scaleSymbolsProportionally:!1,alignment:g,anchorPoint:a.anchorPoint,isAbsoluteAnchorPoint:"Relative"!==a.anchorPointUnits};return[4,H(h,"Size",b,e,l)];case 1:return C.size=c.sent(),[4,H(h,"ScaleX",b,e,n)];case 2:return C.scaleX=c.sent(),[4,H(h,"Rotation",b,e,m)];case 3:return C.rotation=c.sent(),[4,H(h,"OffsetX",
b,e,p)];case 4:return C.offsetX=c.sent(),[4,H(h,"OffsetY",b,e,q)];case 5:return C.offsetY=c.sent(),[4,H(h,"TintColor",b,e,y,N)];case 6:return t.apply(B,[(C.color=c.sent(),C.outlineColor={r:0,g:0,b:0,a:0},C.outlineWidth=0,C.frameHeight=0,C.rotateClockwise=a.rotateClockwise,C.referenceSize=k,C.sizeRatio=1,C)]),[2]}})})}function K(a,b,d,e,g,k,l,n){return h(this,void 0,void 0,function(){var h,m,p,q,y,u,w,x;return c(this,function(c){switch(c.label){case 0:h=a.markerGraphics;if(!h)return[2];m=0;a.scaleSymbolsProportionally&&
(p=a.frame)&&(m=p.ymax-p.ymin);q=[];y=0;for(u=h;y<u.length;y++)if(w=u[y])if(x=w.symbol)switch(x.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":q.push(I(a,w,b,e,g,k,l,m,n));break;case "CIMTextSymbol":q.push(Q(a,w,b,d,e,g,k,l,m))}return[4,f.all(q)];case 1:return c.sent(),[2]}})})}function Q(a,e,f,g,l,m,n,q,w){return h(this,void 0,void 0,function(){var h,x,v,A,B,C,E,F,r,G,J,t,L,M,D,K,I,Q,W,O,R,N,U,T;return c(this,function(c){switch(c.label){case 0:h=[];z.OverrideHelper.findApplicableOverrides(e,
f,h);x=e.geometry;if(!("x"in x&&"y"in x))return[2];v=e.symbol;A=v.underline?"underline":v.strikethrough?"line-through":"none";B=k(v.fontStyleName);v.font=b({family:v.fontFamilyName,decoration:A},B);C=a.frame;E=x.x-.5*(C.xmin+C.xmax);F=x.y-.5*(C.ymin+C.ymax);r=a.size/w;G=a.primitiveName;J=(v.height||0)*r;t=v.angle||0;L=((v.offsetX||0)+E)*r;M=((v.offsetY||0)+F)*r;D=u(z.CIMSymbolHelper.getFillColor(v));K=u(z.CIMSymbolHelper.getStrokeColor(v));I=z.CIMSymbolHelper.getStrokeWidth(v);I||(K=u(z.CIMSymbolHelper.getFillColor(v.haloSymbol)),
I=v.haloSize*r);Q="";W=0;for(O=f;W<O.length;W++)R=O[W],R.primitiveName===G&&void 0!==R.value&&(Q+="|"+R.primitiveName+"|"+R.propertyName+"|"+JSON.stringify(R.value));U=(N=m).push;T={type:"text",templateHash:d.numericHash(JSON.stringify(e)+Q).toString(),materialHash:function(){return d.numericHash(JSON.stringify(v.font)).toString()},cim:v,materialOverrides:null,colorLocked:a.colorLocked,alignment:n,anchorPoint:{x:a.anchorPoint?a.anchorPoint.x:0,y:a.anchorPoint?a.anchorPoint.y:0},isAbsoluteAnchorPoint:"Relative"!==
a.anchorPointUnits,fontName:v.fontFamilyName,decoration:"none",weight:"normal",style:"normal"};return[4,H(G,"Height",f,l,J)];case 1:return T.size=c.sent(),[4,H(G,"Rotation",f,l,t)];case 2:return T.angle=c.sent(),[4,H(G,"OffsetX",f,l,L)];case 3:return T.offsetX=c.sent(),[4,H(G,"OffsetY",f,l,M)];case 4:return U.apply(N,[(T.offsetY=c.sent(),T.horizontalAlignment=p(v.horizontalAlignment),T.verticalAlignment=y(v.verticalAlignment),T.text=da(g,e.textString,v.textCase),T.color=D,T.outlineColor=K,T.outlineSize=
I,T.referenceSize=q,T.sizeRatio=1,T)]),[2]}})})}function I(a,b,e,f,g,k,l,m,n){return h(this,void 0,void 0,function(){var h,p,q,y,w,v;return c(this,function(x){switch(x.label){case 0:h=b.symbol;p=b.geometry;if(!p)return[2];q=A.getExtent(p);if("CIMTextSymbol"===h.type)return[2];y=h.symbolLayers;if(!y)return[2];w=y.length;v=function(){var h,r,v,x,t,B,C,E,F,G,J,L,M,K,I,Q,O,W,U,T,P,ba,X,ga,V,ea,aa,ja,da;return c(this,function(c){switch(c.label){case 0:return(h=y[w])&&!1!==h.enable?n?[4,R(a,b,e,f,g,k,l,
m)]:[3,2]:[2,"continue"];case 1:return c.sent(),[2,"continue"];case 2:r=h.type;switch(r){case "CIMSolidFill":return[3,3];case "CIMSolidStroke":return[3,3]}return[3,15];case 3:v=A.getSDFMetrics(q,a.frame,a.size,a.anchorPoint,"Relative"!==a.anchorPointUnits);x=v[0];t=v[1];B=v[2];C="CIMSolidFill"===h.type;E={type:"sdf",geom:p,asFill:C};F=a.primitiveName;G=a.size;J=a.rotation;L=a.offsetX;M=a.offsetY;K=h.primitiveName;I=C?u(z.CIMSymbolHelper.getFillColor(h)):u(z.CIMSymbolHelper.getStrokeColor(h));Q=C?
{r:0,g:0,b:0,a:0}:u(z.CIMSymbolHelper.getStrokeColor(h));O=z.CIMSymbolHelper.getStrokeWidth(h);if(!C&&!O)return[3,16];W=!1;U="";T=0;for(P=e;T<P.length;T++)if(ba=P[T],ba.primitiveName===K||ba.primitiveName===F)void 0!==ba.value?U+="|"+ba.primitiveName+"|"+ba.propertyName+"|"+JSON.stringify(ba.value):ba.valueExpressionInfo&&(W=!0);X=d.numericHash(JSON.stringify(E)).toString();ga=d.numericHash(JSON.stringify(h)+JSON.stringify(b)+U).toString();ea=(V=g).push;aa={type:"marker",templateHash:ga,materialHash:W?
function(){return X}:X,cim:E,materialOverrides:null,colorLocked:a.colorLocked,scaleSymbolsProportionally:a.scaleSymbolsProportionally,alignment:k,anchorPoint:{x:t,y:B},isAbsoluteAnchorPoint:!1};return[4,H(F,"Size",e,f,G)];case 4:return aa.size=c.sent(),aa.scaleX=1,[4,H(F,"Rotation",e,f,J)];case 5:return aa.rotation=c.sent(),[4,H(F,"OffsetX",e,f,L)];case 6:return aa.offsetX=c.sent(),[4,H(F,"OffsetY",e,f,M)];case 7:return aa.offsetY=c.sent(),[4,H(K,"Color",e,f,I,N)];case 8:aa.color=c.sent();if(!C)return[3,
9];ja={r:0,g:0,b:0,a:0};return[3,11];case 9:return[4,H(K,"Color",e,f,Q,N)];case 10:ja=c.sent(),c.label=11;case 11:aa.outlineColor=ja;if(!C)return[3,12];da=0;return[3,14];case 12:return[4,H(K,"Width",e,f,O)];case 13:da=c.sent(),c.label=14;case 14:return ea.apply(V,[(aa.outlineWidth=da,aa.frameHeight=m,aa.rotateClockwise=a.rotateClockwise,aa.referenceSize=l,aa.sizeRatio=x,aa)]),[3,16];case 15:return R(a,b,e,f,g,k,l,m),[3,16];case 16:return[2]}})};x.label=1;case 1:return w--?[5,v()]:[3,3];case 2:return x.sent(),
[3,1];case 3:return[2]}})})}function R(a,b,e,f,g,k,l,m){return h(this,void 0,void 0,function(){var h,n,p,q,y,u,w,v,x,r,A,B,t,C,E,F;return c(this,function(c){switch(c.label){case 0:h={type:a.type,enable:!0,name:a.name,colorLocked:a.colorLocked,primitiveName:a.primitiveName,anchorPoint:a.anchorPoint,anchorPointUnits:a.anchorPointUnits,offsetX:0,offsetY:0,rotateClockwise:a.rotateClockwise,rotation:0,size:a.size,billboardMode3D:a.billboardMode3D,depth3D:a.depth3D,frame:a.frame,markerGraphics:[b],scaleSymbolsProportionally:a.scaleSymbolsProportionally,
respectFrame:a.respectFrame,clippingPath:a.clippingPath};n=[];p=["Rotation","OffsetX","OffsetY"];n=e.filter(function(b){return b.primitiveName!==a.primitiveName||-1===p.indexOf(b.propertyName)});q=z.CIMSymbolHelper.getTextureAnchor(h);y=q[0];u=q[1];w=JSON.stringify(h);v=a.primitiveName;x=a.rotation;r=a.offsetX;A=a.offsetY;B=d.numericHash(JSON.stringify(h)).toString();C=(t=g).push;E={type:"marker",templateHash:B};if(0!==n.length)return[3,1];F=B;return[3,3];case 1:return[4,V(w,n,f)];case 2:F=c.sent(),
c.label=3;case 3:return E.materialHash=F,E.cim=h,E.materialOverrides=n,E.colorLocked=a.colorLocked,E.scaleSymbolsProportionally=a.scaleSymbolsProportionally,E.alignment=k,E.anchorPoint={x:y,y:u},E.isAbsoluteAnchorPoint=!1,E.size=a.size,E.scaleX=1,[4,H(v,"Rotation",e,f,x)];case 4:return E.rotation=c.sent(),[4,H(v,"OffsetX",e,f,r)];case 5:return E.offsetX=c.sent(),[4,H(v,"OffsetY",e,f,A)];case 6:return C.apply(t,[(E.offsetY=c.sent(),E.color={r:0,g:0,b:0,a:0},E.outlineColor={r:0,g:0,b:0,a:0},E.outlineWidth=
0,E.frameHeight=m,E.rotateClockwise=a.rotateClockwise,E.referenceSize=l,E.sizeRatio=1,E)]),[2]}})})}function O(a){return a&&0===a.indexOf("Level_")?parseInt(a.substr(6),10):0}function N(a){if(!a||0===a.length)return null;a=(new g(a)).toRgba();return{r:a[0],g:a[1],b:a[2],a:a[3]}}function H(a,b,d,e,f,g){return h(this,void 0,void 0,function(){var h,k,n,m,p;return c(this,function(q){switch(q.label){case 0:if(!a)return[3,4];h=function(d){var h,k,n;return c(this,function(c){switch(c.label){case 0:if(d.primitiveName!==
a||d.propertyName!==b)return[3,2];if(void 0!==d.value)return[2,{value:g?g(d.value):d.value}];h=d.valueExpressionInfo;if(!h)return[3,2];k=h.expression;return[4,l.createRendererExpression(k,e.spatialReference,e.fields)];case 1:return n=c.sent(),[2,{value:function(a,b,c){a=x.callWithFeature(n,a,{$view:c},e.geometryType,b);null!==a&&g&&(a=g(a));return null!==a?a:f}}];case 2:return[2]}})};k=0;n=d;q.label=1;case 1:if(!(k<n.length))return[3,4];m=n[k];return[5,h(m)];case 2:p=q.sent();if("object"===typeof p)return[2,
p.value];q.label=3;case 3:return k++,[3,1];case 4:return[2,f]}})})}function U(a,b){switch(b){case "LowerCase":return a.toLowerCase();case "Allcaps":return a.toUpperCase();default:return a}}function da(a,b,c){if(!a||-1===b.indexOf("["))return U(b,c);var d=function(a){for(var b=a.length;b--;)if(-1===" /-,\n".indexOf(a.charAt(b)))return!1;return!0},e=[],f=0,g=-1;do g=b.indexOf("[",f),g>=f&&(g>f&&(f=b.substr(f,g-f),e.push([f,null,d(f)])),f=g+1,g=b.indexOf("]",f),g>=f&&(g>f&&(f=b.substr(f,g-f),(f=a[f])&&
e.push([null,f,!1])),f=g+1));while(-1!==g);f<b.length-1&&(f=b.substr(f),e.push([f,null,d(f)]));return function(a){for(var b="",d=null,f=0;f<e.length;f++){var g=e[f],h=g[0],k=g[1],g=g[2];if(h)g?d=h:(d&&(b+=d,d=null),b+=h);else if(h=a.attributes[k])d&&(b+=d,d=null),b+=h}return U(b,c)}}function V(a,b,e){return h(this,void 0,void 0,function(){var f,g,h,k;return c(this,function(n){switch(n.label){case 0:f=function(a){var b,d,f;return c(this,function(c){switch(c.label){case 0:b=a.valueExpressionInfo;if(!b)return[3,
2];d=b.expression;return[4,l.createRendererExpression(d,e.spatialReference,e.fields)];case 1:f=c.sent(),a.fn=function(a,b,c){return x.callWithFeature(f,a,{$view:c},e.geometryType,b)},c.label=2;case 2:return[2]}})},g=0,h=b,n.label=1;case 1:if(!(g<h.length))return[3,4];k=h[g];return[5,f(k)];case 2:n.sent(),n.label=3;case 3:return g++,[3,1];case 4:return[2,function(c,e,f){for(var g=0;g<b.length;g++){var h=b[g];h.fn&&(h.value=h.fn(c,e,f))}return d.numericHash(a+z.OverrideHelper.buildOverrideKey(b)).toString()}]}})})}
Object.defineProperty(a,"__esModule",{value:!0});var Z=m.getLogger("esri.symbols.cim.cimAnalyzer");a.analyzeCIMSymbol=function(a,b,d,e,f){return h(this,void 0,void 0,function(){var g,h,k,l;return c(this,function(c){switch(c.label){case 0:g=e?e:[];if(!a)return[2,g];"CIMSymbolReference"===a.type?(h=a.symbol,k=a.primitiveOverrides):(h=a,k=null);l=h.type;switch(l){case "CIMPointSymbol":return[3,1];case "CIMLineSymbol":return[3,1];case "CIMPolygonSymbol":return[3,1];case "CIMTextSymbol":return[3,3]}return[3,
4];case 1:return[4,C(h,k,b,d,g,f)];case 2:return c.sent(),[3,4];case 3:return[3,4];case 4:return[2,g]}})})};a.analyzeCIMResource=function(a,b){if(!b||0===b.length)return a;a=JSON.parse(JSON.stringify(a));z.OverrideHelper.applyOverrides(a,b);return a}})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicLineTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/screenUtils ../../color ../../number ../../materialKey/MaterialKey ./util ./WGLBaseLineTemplate ./WGLDynamicMeshTemplate ../../util/Result".split(" "),
function(e,a,c,h,b,g,m,f,d,l,z){Object.defineProperty(a,"__esModule",{value:!0});e=function(a){function d(c,d,e){var g=a.call(this,d)||this;g._cimLineLayer=d;var l=0;f.isFunction(d.width)||(l=.5*h.pt2px(d.width));g._dynamicPropertyMap.set("_halfWidth",function(a,b,c){return f.isFunction(d.width)?.5*h.pt2px(d.width(a,b,c)):l});f.isFunction(d.cap)?g._dynamicPropertyMap.set("_capType",d.cap):g._capType=d.cap;f.isFunction(d.join)?g._dynamicPropertyMap.set("_joinType",d.join):g._joinType=d.join;if(f.isFunction(d.color))g._dynamicPropertyMap.set("_fillColor",
function(a,c,e){return(a=d.color(a,c,e))&&b.premultiplyAlphaRGBA(a)||0});else{var q=d.color;g._fillColor=q&&b.premultiplyAlphaRGBA(q)||0}f.isFunction(d.miterLimit)?g._dynamicPropertyMap.set("_miterLimitCosine",function(a,b,c){return f.getLimitCosine(d.miterLimit(a,b,c))}):g._miterLimitCosine=f.getLimitCosine(d.miterLimit);f.isFunction(e)?g._dynamicPropertyMap.set("_scaleFactor",e):g._scaleFactor=e;g._isDashed=d.isDashed;g.tessellationProperties._bitset=d.colorLocked?1:0;g._materialKey=m.createMaterialKey(g.geometryType,
c,d.isOutline);g._initializeTessellator(!0);return g}c(d,a);d.fromCIMLine=function(a,b,c){return new d(a,b,c)};d.prototype.bindFeature=function(a,b,c){var d=this;this._dynamicPropertyMap.forEach(function(e,f){d[f]=e(a,b,c)});this._halfWidth*=this._scaleFactor;var e=this._materialCache,f=this._cimLineLayer.materialHash,f=f(a,b,c),f=e.get(f),e=null;f&&z.ok(f.spriteMosaicItem)&&(e=f.spriteMosaicItem);if(e){this._hasPattern=!0;var f=e.rect,h=f.x+1+e.width,l=f.y+1+e.height;this.tessellationProperties._tl=
g.i1616to32(f.x+1,f.y+1);this.tessellationProperties._br=g.i1616to32(h,l)}else this._hasPattern=!1,this.tessellationProperties._tl=0,this.tessellationProperties._br=0;this.tessellationProperties._fillColor=this._fillColor;this.tessellationProperties._halfWidth=this._halfWidth;this.tessellationProperties._halfReferenceWidth=this.tessellationProperties._halfWidth;f=m.LineMaterialKey.load(this._materialKey);e&&(f.sdf=e.sdf,f.pattern=!0,f.textureBinding=e.textureBinding);this._materialKey=f.data};return d}(d.default(l.default));
a.default=e})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicMeshTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/Logger ../../../../../../core/promiseUtils ../../../../../../symbols/cim/cimAnalyzer ./WGLMeshTemplate".split(" "),function(e,a,c,h,b,g,m){Object.defineProperty(a,"__esModule",{value:!0});var f=h.getLogger("esri.views.2d.engine.webgl.WGLDynamicMeshTemplate");e=function(a){function d(b){var c=a.call(this)||this;c._ongoingMaterialRequestMap=
new Map;c._materialCache=new Map;c._dynamicPropertyMap=new Map;c._cimLayer=b;return c}c(d,a);d.prototype.analyze=function(a,c,d,e){var h=this,l=this._materialCache,m=this._cimLayer.materialHash;if(!m)return f.error("A Dynamic mesh template must have a material hash value or function!"),b.reject(null);var p="function"===typeof m?m(c,d,e):m;if(l.has(p))return a=l.get(p),b.resolve(a);if(this._ongoingMaterialRequestMap.has(p))return this._ongoingMaterialRequestMap.get(p);c=g.analyzeCIMResource(this._cimLayer.cim,
this._cimLayer.materialOverrides);c.mosaicHash=p;a=a.getCIMMosaicItem(c).then(function(a){h._ongoingMaterialRequestMap.delete(p);l.set(p,a);return a}).catch(function(a){h._ongoingMaterialRequestMap.delete(p);f.error(".analyze()",a.message);return null});this._ongoingMaterialRequestMap.set(p,a);return a};return d}(m.default);a.default=e})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicMarkerTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/screenUtils ../../../../../../core/libs/gl-matrix-2/mat2d ../../../../../../core/libs/gl-matrix-2/mat2df32 ../../../../../../core/libs/gl-matrix-2/vec2 ../../../../../../core/libs/gl-matrix-2/vec2f32 ../../../../../../symbols/cim/enums ../../color ../../number ../../materialKey/MaterialKey ./util ./WGLBaseMarkerTemplate ./WGLDynamicMeshTemplate ../../util/Result".split(" "),
function(e,a,c,h,b,g,m,f,d,l,z,v,A,x,u,q,n,p){Object.defineProperty(a,"__esModule",{value:!0});var y=3.14159265359/180,k=l.vec2f32.create(),C=f.mat2df32.create(),w=b.getLogger("esri.views.2d.engine.webgl.WGLDynamicMarkerTemplate");e=function(a){function b(b,c,d){var e=a.call(this,c)||this;e._cimMarkerLayer=c;u.isFunction(c.color)?e._dynamicPropertyMap.set("_fillColor",function(a,b,d){return v.premultiplyAlphaRGBA(c.color(a,b,d))}):e._fillColor=v.premultiplyAlphaRGBA(c.color);u.isFunction(c.outlineColor)?
e._dynamicPropertyMap.set("_outlineColor",function(a,b,d){return v.premultiplyAlphaRGBA(c.outlineColor(a,b,d))}):e._outlineColor=v.premultiplyAlphaRGBA(c.outlineColor);u.isFunction(c.size)?e._dynamicPropertyMap.set("_size",function(a,b,d){return g.pt2px(c.size(a,b,d))}):e._size=g.pt2px(c.size);u.isFunction(c.scaleX)?e._dynamicPropertyMap.set("_scaleX",c.scaleX):e._scaleX=c.scaleX;u.isFunction(c.offsetX)?e._dynamicPropertyMap.set("xOffset",function(a,b,d){return g.pt2px(c.offsetX(a,b,d))}):e.xOffset=
g.pt2px(c.offsetX);u.isFunction(c.offsetY)?e._dynamicPropertyMap.set("yOffset",function(a,b,d){return g.pt2px(c.offsetY(a,b,d))}):e.yOffset=g.pt2px(c.offsetY);u.isFunction(c.outlineWidth)?e._dynamicPropertyMap.set("_outlineWidth",function(a,b,d){return g.pt2px(c.outlineWidth(a,b,d))}):e._outlineWidth=g.pt2px(c.outlineWidth);u.isFunction(c.rotation)?e._dynamicPropertyMap.set("_angle",c.rotation):e._angle=c.rotation;u.isFunction(d)?e._dynamicPropertyMap.set("_scaleFactor",d):e._scaleFactor=d;e._bitSet=
(c.alignment===z.Alignment.MAP?1:0)|(c.colorLocked?1:0)<<1|(c.scaleSymbolsProportionally?1:0)<<3;e._materialKey=x.createMaterialKey(e.geometryType,b,!1);return e}c(b,a);b.fromCIMMarker=function(a,c,d){return new b(a,c,d)};b.prototype.bindFeature=function(a,b,c){var e=this;this._dynamicPropertyMap.forEach(function(d,f){e[f]=d(a,b,c)});var f=this._cimMarkerLayer.materialHash,f="function"===typeof f?f(a,b,c):f;if((f=this._materialCache.get(f))&&p.ok(f.spriteMosaicItem)&&f.spriteMosaicItem){var f=f.spriteMosaicItem,
n=this._cimMarkerLayer.sizeRatio,q=f.width/f.height*this._scaleX,u=this._cimMarkerLayer.rotateClockwise?this._angle:-this._angle,v=this._size,z=v*q,B=this.xOffset*this._scaleFactor,E=this.yOffset*this._scaleFactor,G=this._cimMarkerLayer.scaleSymbolsProportionally&&this._cimMarkerLayer.frameHeight?this._size/g.pt2px(this._cimMarkerLayer.frameHeight):1,F=this._outlineWidth*G,M=g.pt2px(this._cimMarkerLayer.referenceSize),Z=0,G=0,W=this._cimMarkerLayer.anchorPoint;W&&(this._cimMarkerLayer.isAbsoluteAnchorPoint?
this._size&&(Z=-W.x/(this._size*q),G=W.y/this._size):(Z=W.x,G=W.y));this._sizeOutlineWidth=A.i8888to32(Math.round(Math.sqrt(256*z)),Math.round(Math.sqrt(256*v)),Math.round(Math.sqrt(256*F)),Math.round(Math.sqrt(256*M)));m.mat2d.identity(C);m.mat2d.translate(C,C,l.vec2f32.fromValues(B,-E));u&&m.mat2d.rotate(C,C,y*u);q=f.rect.x;u=f.rect.y;B=q+f.rect.width;E=u+f.rect.height;Z=.5-((.5+Z)*f.width+1)/f.rect.width;G=.5-((.5+G)*f.height+1)/f.rect.height;z=z*n*this._scaleFactor;v=v*n*this._scaleFactor;n=Math.round(64*
n);z*=f.rect.width/f.width;v*=f.rect.height/f.height;Z=(Z-.5)*z;G=(G-.5)*v;this._bitestAndDistRatio=A.i8888to32(0,0,this._bitSet,n);d.vec2.set(k,Z,G);d.vec2.transformMat2d(k,k,C);this._offsetUpperLeft=A.i1616to32(16*k[0],16*k[1]);this._texUpperLeft=A.i1616to32(q,u);d.vec2.set(k,Z+z,G);d.vec2.transformMat2d(k,k,C);this._offsetUpperRight=A.i1616to32(16*k[0],16*k[1]);this._texUpperRight=A.i1616to32(B,u);d.vec2.set(k,Z,G+v);d.vec2.transformMat2d(k,k,C);this._offsetBottomLeft=A.i1616to32(16*k[0],16*k[1]);
this._texBottomLeft=A.i1616to32(q,E);d.vec2.set(k,Z+z,G+v);d.vec2.transformMat2d(k,k,C);this._offsetBottomRight=A.i1616to32(16*k[0],16*k[1]);this._texBottomRight=A.i1616to32(B,E);v=x.MarkerMaterialKey.load(this._materialKey);v.sdf=f.sdf;v.pattern=!0;v.textureBinding=f.textureBinding;this._materialKey=v.data}else w.error(new h("mapview-cim","Encountered an error when binding feature"))};return b}(q.default(n.default));a.default=e})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicTextTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/screenUtils ../../alignmentUtils ../../color ../../fontUtils ../../materialKey/MaterialKey ./util ./WGLBaseTextTemplate ./WGLDynamicMeshTemplate ../../util/BidiText".split(" "),
function(e,a,c,h,b,g,m,f,d,l,z,v){Object.defineProperty(a,"__esModule",{value:!0});var A=new Set;e=function(a){function e(b,c,e){var l=a.call(this,c)||this;l._horizontalAlignment="center";l._verticalAlignment="middle";l._glyphs=[];l._cimTextLayer=c;d.isFunction(c.color)?l._dynamicPropertyMap.set("_color",function(a,b,d){return g.premultiplyAlphaRGBA(c.color(a,b,d))}):l._color=g.premultiplyAlphaRGBA(c.color);d.isFunction(c.color)?l._dynamicPropertyMap.set("_haloColor",function(a,b,d){return g.premultiplyAlphaRGBA(c.outlineColor(a,
b,d))}):l._haloColor=g.premultiplyAlphaRGBA(c.outlineColor);var k;d.isFunction(c.size)||(k=Math.min(Math.round(h.pt2px(c.size*c.sizeRatio)),127));l._dynamicPropertyMap.set("_size",function(a,b,e){return d.isFunction(c.size)?Math.min(Math.round(h.pt2px(c.size(a,b,e)*c.sizeRatio)),127):k});d.isFunction(c.outlineSize)?l._dynamicPropertyMap.set("_haloSize",function(a,b,d){return Math.min(Math.floor(5*h.pt2px(c.outlineSize(a,b,d)*c.sizeRatio)),127)}):l._haloSize=Math.min(Math.floor(5*h.pt2px(c.outlineSize*
c.sizeRatio)),127);var n;d.isFunction(c.offsetX)||(n=Math.round(h.pt2px(c.offsetX*c.sizeRatio)));l._dynamicPropertyMap.set("_xOffset",function(a,b,e){return d.isFunction(c.offsetX)?Math.round(h.pt2px(c.offsetX(a,b,e)*c.sizeRatio)):n});var p;d.isFunction(c.offsetY)||(p=Math.round(h.pt2px(c.offsetY*c.sizeRatio)));l._dynamicPropertyMap.set("_yOffset",function(a,b,e){return d.isFunction(c.offsetY)?Math.round(h.pt2px(c.offsetY(a,b,e)*c.sizeRatio)):p});d.isFunction(c.decoration)?l._dynamicPropertyMap.set("_decorationTop",
function(a,b,d){return m.getFontDecorationTop(c.decoration(a,b,d))}):l._decorationTop=m.getFontDecorationTop(c.decoration);d.isFunction(c.angle)?l._dynamicPropertyMap.set("_angle",c.angle):l._angle=c.angle;d.isFunction(c.horizontalAlignment)?l._dynamicPropertyMap.set("_horizontalAlignment",c.horizontalAlignment):l._horizontalAlignment=c.horizontalAlignment;d.isFunction(c.verticalAlignment)?l._dynamicPropertyMap.set("_verticalAlignment",c.verticalAlignment):l._verticalAlignment=c.verticalAlignment;
d.isFunction(e)?l._dynamicPropertyMap.set("_scaleFactor",e):l._scaleFactor=e;d.isFunction(c.text)?l._dynamicPropertyMap.set("_text",c.text):l._text=c.text;e=Math.min(Math.round(h.pt2px(c.referenceSize*c.sizeRatio)),127);l._referenceSize=Math.round(Math.sqrt(256*e));l._materialKey=f.createMaterialKey(l.geometryType,b,!1);b=f.TextMaterialKey.load(l._materialKey);b.sdf=!0;l._bitset=c.colorLocked?1:0;l._materialKey=b.data;return l}c(e,a);e.fromCIMText=function(a,b,c){return new e(a,b,c)};e.prototype.analyze=
function(a,b,c,d){var e=this._cimTextLayer;b="string"===typeof e.text?e.text:"function"===typeof e.text?e.text(b,c,d):"";var f=this._glyphs;A.clear();for(c=0;c<b.length;c++)A.add(b.charCodeAt(c));var g=[];A.forEach(function(a){if(f.length<a||void 0===f[a])g[a]=a});return a.getCIMMosaicItem(e.cim,g).then(function(a){if(a.glyphMosaicItems&&0<a.glyphMosaicItems.length)for(var b=a.glyphMosaicItems,c=0;c<b.length;c++)void 0!==b[c]&&(f[c]=b[c]);return a})};e.prototype.bindFeature=function(a,c,d){var e=
this;this._dynamicPropertyMap.forEach(function(b,f){e[f]=b(a,c,d)});if(this._text&&0!==this._text.length){this._size*=this._scaleFactor;this._scale=this._size/24;this._xOffset*=this._scaleFactor;this._yOffset*=this._scaleFactor;this._justify=b.getJustification(this._horizontalAlignment||"center");this._xAlignD=b.getXAnchorDirection(this._horizontalAlignment||"center");this._yAlignD=-b.getYAnchorDirection(this._verticalAlignment||"baseline");this._baseline="baseline"===(this._verticalAlignment||"baseline");
for(var f=this._glyphs,g=v.bidiText(this._text),h=g[0],g=g[1],l=[],m=0;m<h.length;m++)l[h.charCodeAt(m)]=f[h.charCodeAt(m)];this.bindTextInfo(l,h,g);this._computeGlyphs(this._shapedGlyphs,this._shapedBox)}else this._shapedBox=this._shapedGlyphs=this._computedGlyphs=null};return e}(l.default(z.default));a.default=e})},"esri/views/2d/engine/webgl/mesh/templates/WGLFillTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/Logger ../../../../../../core/mathUtils ../../../../../../core/screenUtils ../../../../../../core/libs/earcut/earcut ../../color ../../definitions ../../enums ../../number ../../TileClipper ../../WGLDisplayRecord ../../materialKey/MaterialKey ../Tesselator ./WGLMeshTemplate".split(" "),
function(e,a,c,h,b,g,m,f,d,l,z,v,A,x,u,q){Object.defineProperty(a,"__esModule",{value:!0});var n=h.getLogger("esri.views.2d.engine.webgl.mesh.templates.WGLFillTemplate"),p=[],y=[];e=function(a){function e(b,c,e,f,g,h,k,m,n){var p=a.call(this)||this;p.fillColor=e;p.tl=f;p.br=g;p.aux1=h;p.aux2=k;p.aux3=m;p.isBFS=n;p.geometryType=l.WGLGeometryType.FILL;p.forceLibtess=!1;b=x.FillMaterialKey.load(x.createMaterialKey(p.geometryType,b,!1));c&&(b.sdf=c.sdf,b.pattern=!0,b.textureBinding=c.textureBinding);
p._materialKey=b.data;p._tesselator=new u.default;p._tileClipper=new v.TileClipper(0,0,0,1,8);p._tileClipper.setExtent(d.TILE_SIZE);return p}c(e,a);e.fromCIMFill=function(a,c,d,h){void 0===h&&(h=!1);var k=c.color,k=k&&f.premultiplyAlphaRGBA(k)||0,l=z.i8888to32(0,0,0,c.colorLocked?1:0);if(!d)return new e(a,null,k,0,0,0,0,l,h);var l=d.rect,m=d.width,n=d.height,p=l.x+1,q=l.y+1,u=p+m,y=q+n,l=b.nextHighestPowerOfTwo(g.pt2px(c.height||0));255<l?l=255:0>=l&&(l=b.nextHighestPowerOfTwo(y-q));m=b.nextHighestPowerOfTwo(g.pt2px(c.height/
n*m||0));255<m?m=255:0>=m&&(m=b.nextHighestPowerOfTwo(u-p));n=g.pt2px(c.offsetX||0)+128;255<n&&(n=255);var w=g.pt2px(-c.offsetY||0)+128;255<w&&(w=255);c=c.scaleX||1;p=z.i1616to32(p,q);u=z.i1616to32(u,y);l=z.i8888to32(m,l,n,w);c=z.i1616to32(128*c,128);return new e(a,d,k,p,u,l,c,0,h)};e.fromSimpleFill=function(a,c,d,g){void 0===g&&(g=!1);var h=c.color;c=h&&"none"!==c.style&&f.premultiplyAlphaRGBA(h)||0;h=z.i8888to32(0,0,0,g?255:0);if(!d)return new e(a,null,c,0,0,0,0,h,g);var k=d.rect,l=k.x+1,m=k.y+
1,n=k.x+1+d.width,p=k.y+1+d.height,k=z.i1616to32(l,m),q=z.i1616to32(n,p),l=z.i8888to32(b.nextHighestPowerOfTwo(n-l),b.nextHighestPowerOfTwo(p-m),0,0),m=z.i1616to32(128,128);return new e(a,d,c,k,q,l,m,h,g)};e.fromPictureFill=function(a,c,f,h){void 0===h&&(h=!1);var k=d.PICTURE_FILL_COLOR,l=f.rect,m=l.x+1,n=l.y+1,l=m+f.width,p=n+f.height,m=z.i1616to32(m,n),l=z.i1616to32(l,p),p=b.nextHighestPowerOfTwo(g.pt2px(c.width));255<p&&(p=255);n=b.nextHighestPowerOfTwo(g.pt2px(c.height));255<n&&(n=255);var q=
g.pt2px(c.xoffset)+128;255<q&&(q=255);var u=g.pt2px(-c.yoffset)+128;255<u&&(u=255);p=z.i8888to32(p,n,q,u);c=z.i1616to32(128*c.xscale,128*c.yscale);n=z.i8888to32(0,0,0,h?255:0);return new e(a,f,k,m,l,p,c,n,h)};e.prototype.writeMesh=function(a,b,c,d,e){p.length=0;if("esriGeometryPolygon"!==c)"esriGeometryPolyline"!==c&&n.error("Unable to handle geometryType: "+c);else{var f=e.geometry;c=x.FillMaterialKey.load(this._materialKey);var g=(e=this._isClippingRequired(f))?this._clip(f,!1):f.rings;if(c.dotDensity){for(var f=
f.rings,h=0,k=0;k<f.length;k++)for(var l=f[k],m=l[0],q=m[0],m=m[1],u=1;u<l.length;u++)var y=l[u],w=q+y[0],y=m+y[1],h=h-(w-q)*(y+m)/2,q=w,m=y;f=h}else f=0;this.forceLibtess?this._writeMeshLibtess(a,b,d,g,e,c,f):this._writeMeshEarcut(a,b,d,g,e,c,f)||this._writeMeshLibtess(a,b,d,g,e,c,f)}};e.prototype._isClippingRequired=function(a){var b=d.TILE_SIZE+8,c=0;for(a=a.rings;c<a.length;c++){var e=a[c],f=e.length;if(!(3>f)){var g=e[0][0],h=e[0][1];if(-8>g||g>b||-8>h||h>b)return!0;for(var k=1;k<f;++k)if(g+=
e[k][0],h+=e[k][1],-8>g||g>b||-8>h||h>b)return!0}}return!1};e.prototype._clip=function(a,b){var c;this._tileClipper.reset(3);for(var d=0,e=a.rings;d<e.length;d++){var f=e[d],g=f.length;if(!(3>g)){a=f[0][0];c=f[0][1];this._tileClipper.moveTo(a,c);for(var h=1;h<g;++h)a+=f[h][0],c+=f[h][1],this._tileClipper.lineTo(a,c);this._tileClipper.close()}}return this._tileClipper.result(b)};e.prototype._writeMeshLibtess=function(a,b,c,d,e,f,g){if(d&&d.length){var h=[],k=b.indexVector;b=b.getVector("geometry");
var l=new A(c,this.geometryType,this._materialKey),m=b.vertexCount;l.vertexFrom=m;l.indexFrom=k.length;this._tesselator.beginPolygon(p,h);for(var n=0;n<d.length;n++){var q=d[n];if(!(3>q.length)){this._tesselator.beginContour();var u=void 0,y=void 0;e?(u=q[0].x,y=q[0].y):(u=q[0][0],y=q[0][1]);var w=[u,y,0];this._tesselator.addVertex(w,w);for(w=1;w<q.length-1;w++){var v=void 0,x=void 0;e?(u=q[w].x,y=q[w].y):(v=q[w][0],x=q[w][1],u+=v,y+=x);v=[u,y,0];this._tesselator.addVertex(v,v)}this._tesselator.endContour()}}this._tesselator.endPolygon();
this._writeVerticesLibTess(l,b,c,p,f,g);this._writeIndicesLibTess(l,k,m,h);0<l.indexCount&&a.push(l)}};e.prototype._writeMeshEarcut=function(a,b,c,d,e,f,g){if(d&&d.length){var h=b.indexVector;b=b.getVector("geometry");var k=new A(c,this.geometryType,this._materialKey),l=h.length,m=b.data.length;k.vertexFrom=b.vertexCount;k.indexFrom=h.length;for(var n=0,q=0,u=0;u<d.length;u++){var w=d[u],v=q,x=void 0,z=void 0;e?(x=w[0].x,z=w[0].y):(x=w[0][0],z=w[0][1]);p[q++]=x;p[q++]=z;for(var C=0,B=1;B<w.length;++B){var E=
void 0,F=void 0;e?(E=x,F=z,x=w[B].x,z=w[B].y,E=x-E,F=z-F):(E=w[B][0],F=w[B][1],x+=E,z+=F);C-=E*(z+z-F);p[q++]=x;p[q++]=z}if(0<C){if(0<v-n){if(!this._write(k,h,b,c,p,y,n,v,f,g))return h.seek(l),b.data.seek(m),p.length=y.length=0,!1;n=v}y.length=0}else 0>C?0<v-n?y.push(.5*(v-n)):q=v:q=v}if(0<q-n&&!this._write(k,h,b,c,p,y,n,q,f,g))return h.seek(l),b.data.seek(m),p.length=y.length=0,!1;p.length=y.length=0;a.push(k);return!0}};e.prototype._write=function(a,b,c,d,e,f,g,h,k,l){e=e.slice(g,h);g=m(e,f,2);
if(m.deviation(e,f,2,g))return!1;if(g.length)return f=c.vertexCount,this._writeVertices(a,c,d,e,k,l),this._writeIndices(a,b,f,g),!0};e.prototype._writeVertices=function(a,b,c,d,e,f){for(var g=0;g<d.length;g+=2){var h=z.i1616to32(d[g],d[g+1]);b.data.push(h);b.data.push(c);e.dotDensity?b.data.writeF32(1/f):(b.data.push(this.fillColor),b.data.push(this.tl),b.data.push(this.br),b.data.push(this.aux1),b.data.push(this.aux2),b.data.push(this.aux3));a.vertexCount++}};e.prototype._writeIndices=function(a,
b,c,d){for(var e=0;e<d.length;e+=3)b.push(c+d[e]),b.push(c+d[e+1]),b.push(c+d[e+2]),a.indexCount+=3};e.prototype._writeVerticesLibTess=function(a,b,c,d,e,f){for(var g=0;g<d.length;g+=2){var h=z.i1616to32(d[g],d[g+1]);b.data.push(h);b.data.push(c);e.dotDensity?b.data.writeF32(1/f):(b.data.push(this.fillColor),b.data.push(this.tl),b.data.push(this.br),b.data.push(this.aux1),b.data.push(this.aux2),b.data.push(this.aux3));a.vertexCount++}};e.prototype._writeIndicesLibTess=function(a,b,c,d){for(var e=
0;e<d.length;e++)b.push(c+d[e]),a.indexCount++};return e}(q.default);a.default=e})},"esri/views/2d/engine/webgl/mesh/Tesselator":function(){define(["require","exports","../../../../../core/Logger","../../../../../core/libs/libtess/libtess"],function(e,a,c,h){Object.defineProperty(a,"__esModule",{value:!0});var b=c.getLogger("esri.views.2d.engine.webgl.mesh.templates.Tesselator");e=function(){function a(){this._indexCounter=this._currentVertexIndex=0;this._triangleIndices=[-1,-1,-1];this.glu=new h.GluTesselator;
this.glu.gluTessCallback(h.gluEnum.GLU_TESS_BEGIN,this._begincallback.bind(this));this.glu.gluTessCallback(h.gluEnum.GLU_TESS_VERTEX_DATA,this._vertexCallback.bind(this));this.glu.gluTessCallback(h.gluEnum.GLU_TESS_END,this._endcallback.bind(this));this.glu.gluTessCallback(h.gluEnum.GLU_TESS_COMBINE,this._combinecallback.bind(this));this.glu.gluTessCallback(h.gluEnum.GLU_TESS_ERROR,this._errorcallback.bind(this));this.glu.gluTessCallback(h.gluEnum.GLU_TESS_EDGE_FLAG,this._edgeCallback.bind(this));
this.glu.gluTessProperty(h.gluEnum.GLU_TESS_WINDING_RULE,h.windingRule.GLU_TESS_WINDING_ODD)}a.prototype.beginPolygon=function(a,b){this._triangleIndices[0]=-1;this._triangleIndices[1]=-1;this._triangleIndices[2]=-1;this._indexCounter=this._currentVertexIndex=0;this.glu.gluTessBeginPolygon(a);this._indices=b};a.prototype.endPolygon=function(){this.glu.gluTessEndPolygon()};a.prototype.beginContour=function(){this.glu.gluTessBeginContour()};a.prototype.endContour=function(){this.glu.gluTessEndContour()};
a.prototype.addVertex=function(a,b){this.glu.gluTessVertex(a,b)};a.prototype._vertexCallback=function(a,b){b[b.length]=a[0];b[b.length]=a[1];this._triangleIndices[this._currentVertexIndex]=-1;if(2<=this._currentVertexIndex){for(a=0;3>a;a++)-1===this._triangleIndices[a]&&(this._triangleIndices[a]=this._indexCounter++),this._indices[this._indices.length]=this._triangleIndices[a];this._currentVertexIndex=0}else this._currentVertexIndex++};a.prototype._begincallback=function(){this._triangleIndices[0]=
-1;this._triangleIndices[1]=-1;this._triangleIndices[2]=-1;this._currentVertexIndex=0};a.prototype._endcallback=function(){this._currentVertexIndex=0};a.prototype._errorcallback=function(a){b.error("Encountered error during tesselation: "+a)};a.prototype._combinecallback=function(a){return[a[0],a[1],a[2]]};a.prototype._edgeCallback=function(){};return a}();a.default=e})},"esri/core/libs/libtess/libtess":function(){define([],function(){var e={DEBUG:!1,assert:function(a,c){if(e.DEBUG&&!a)throw Error("Assertion failed"+
(c?": "+c:""));},GLU_TESS_MAX_COORD:1E150,TRUE_PROJECT:!1,GLU_TESS_DEFAULT_TOLERANCE:0,windingRule:{GLU_TESS_WINDING_ODD:100130,GLU_TESS_WINDING_NONZERO:100131,GLU_TESS_WINDING_POSITIVE:100132,GLU_TESS_WINDING_NEGATIVE:100133,GLU_TESS_WINDING_ABS_GEQ_TWO:100134},primitiveType:{GL_LINE_LOOP:2,GL_TRIANGLES:4,GL_TRIANGLE_STRIP:5,GL_TRIANGLE_FAN:6},errorType:{GLU_TESS_MISSING_BEGIN_POLYGON:100151,GLU_TESS_MISSING_END_POLYGON:100153,GLU_TESS_MISSING_BEGIN_CONTOUR:100152,GLU_TESS_MISSING_END_CONTOUR:100154,
GLU_TESS_COORD_TOO_LARGE:100155,GLU_TESS_NEED_COMBINE_CALLBACK:100156},gluEnum:{GLU_TESS_BEGIN:100100,GLU_TESS_VERTEX:100101,GLU_TESS_END:100102,GLU_TESS_ERROR:100103,GLU_TESS_EDGE_FLAG:100104,GLU_TESS_COMBINE:100105,GLU_TESS_BEGIN_DATA:100106,GLU_TESS_VERTEX_DATA:100107,GLU_TESS_END_DATA:100108,GLU_TESS_ERROR_DATA:100109,GLU_TESS_EDGE_FLAG_DATA:100110,GLU_TESS_COMBINE_DATA:100111,GLU_TESS_MESH:100112,GLU_TESS_TOLERANCE:100142,GLU_TESS_WINDING_RULE:100140,GLU_TESS_BOUNDARY_ONLY:100141,GLU_INVALID_ENUM:100900,
GLU_INVALID_VALUE:100901},geom:{}};e.geom.vertEq=function(a,c){return a.s===c.s&&a.t===c.t};e.geom.vertLeq=function(a,c){return a.s<c.s||a.s===c.s&&a.t<=c.t};e.geom.edgeEval=function(a,c,h){e.assert(e.geom.vertLeq(a,c)&&e.geom.vertLeq(c,h));var b=c.s-a.s,g=h.s-c.s;return 0<b+g?b<g?c.t-a.t+b/(b+g)*(a.t-h.t):c.t-h.t+g/(b+g)*(h.t-a.t):0};e.geom.edgeSign=function(a,c,h){e.assert(e.geom.vertLeq(a,c)&&e.geom.vertLeq(c,h));var b=c.s-a.s,g=h.s-c.s;return 0<b+g?(c.t-h.t)*b+(c.t-a.t)*g:0};e.geom.transLeq=function(a,
c){return a.t<c.t||a.t===c.t&&a.s<=c.s};e.geom.transEval=function(a,c,h){e.assert(e.geom.transLeq(a,c)&&e.geom.transLeq(c,h));var b=c.t-a.t,g=h.t-c.t;return 0<b+g?b<g?c.s-a.s+b/(b+g)*(a.s-h.s):c.s-h.s+g/(b+g)*(h.s-a.s):0};e.geom.transSign=function(a,c,h){e.assert(e.geom.transLeq(a,c)&&e.geom.transLeq(c,h));var b=c.t-a.t,g=h.t-c.t;return 0<b+g?(c.s-h.s)*b+(c.s-a.s)*g:0};e.geom.edgeGoesLeft=function(a){return e.geom.vertLeq(a.dst(),a.org)};e.geom.edgeGoesRight=function(a){return e.geom.vertLeq(a.org,
a.dst())};e.geom.vertL1dist=function(a,c){return Math.abs(a.s-c.s)+Math.abs(a.t-c.t)};e.geom.vertCCW=function(a,c,e){return 0<=a.s*(c.t-e.t)+c.s*(e.t-a.t)+e.s*(a.t-c.t)};e.geom.interpolate_=function(a,c,e,b){a=0>a?0:a;e=0>e?0:e;return a<=e?0===e?(c+b)/2:c+a/(a+e)*(b-c):b+e/(a+e)*(c-b)};e.geom.edgeIntersect=function(a,c,h,b,g){var m,f;e.geom.vertLeq(a,c)||(m=a,a=c,c=m);e.geom.vertLeq(h,b)||(m=h,h=b,b=m);e.geom.vertLeq(a,h)||(m=a,a=h,h=m,m=c,c=b,b=m);e.geom.vertLeq(h,c)?e.geom.vertLeq(c,b)?(m=e.geom.edgeEval(a,
h,c),f=e.geom.edgeEval(h,c,b),0>m+f&&(m=-m,f=-f),g.s=e.geom.interpolate_(m,h.s,f,c.s)):(m=e.geom.edgeSign(a,h,c),f=-e.geom.edgeSign(a,b,c),0>m+f&&(m=-m,f=-f),g.s=e.geom.interpolate_(m,h.s,f,b.s)):g.s=(h.s+c.s)/2;e.geom.transLeq(a,c)||(m=a,a=c,c=m);e.geom.transLeq(h,b)||(m=h,h=b,b=m);e.geom.transLeq(a,h)||(m=a,a=h,h=m,m=c,c=b,b=m);e.geom.transLeq(h,c)?e.geom.transLeq(c,b)?(m=e.geom.transEval(a,h,c),f=e.geom.transEval(h,c,b),0>m+f&&(m=-m,f=-f),g.t=e.geom.interpolate_(m,h.t,f,c.t)):(m=e.geom.transSign(a,
h,c),f=-e.geom.transSign(a,b,c),0>m+f&&(m=-m,f=-f),g.t=e.geom.interpolate_(m,h.t,f,b.t)):g.t=(h.t+c.t)/2};e.mesh={};e.mesh.makeEdge=function(a){var c=e.mesh.makeEdgePair_(a.eHead);e.mesh.makeVertex_(c,a.vHead);e.mesh.makeVertex_(c.sym,a.vHead);e.mesh.makeFace_(c,a.fHead);return c};e.mesh.meshSplice=function(a,c){var h=!1,b=!1;a!==c&&(c.org!==a.org&&(b=!0,e.mesh.killVertex_(c.org,a.org)),c.lFace!==a.lFace&&(h=!0,e.mesh.killFace_(c.lFace,a.lFace)),e.mesh.splice_(c,a),b||(e.mesh.makeVertex_(c,a.org),
a.org.anEdge=a),h||(e.mesh.makeFace_(c,a.lFace),a.lFace.anEdge=a))};e.mesh.deleteEdge=function(a){var c=a.sym,h=!1;a.lFace!==a.rFace()&&(h=!0,e.mesh.killFace_(a.lFace,a.rFace()));a.oNext===a?e.mesh.killVertex_(a.org,null):(a.rFace().anEdge=a.oPrev(),a.org.anEdge=a.oNext,e.mesh.splice_(a,a.oPrev()),h||e.mesh.makeFace_(a,a.lFace));c.oNext===c?(e.mesh.killVertex_(c.org,null),e.mesh.killFace_(c.lFace,null)):(a.lFace.anEdge=c.oPrev(),c.org.anEdge=c.oNext,e.mesh.splice_(c,c.oPrev()));e.mesh.killEdge_(a)};
e.mesh.addEdgeVertex=function(a){var c=e.mesh.makeEdgePair_(a),h=c.sym;e.mesh.splice_(c,a.lNext);c.org=a.dst();e.mesh.makeVertex_(h,c.org);c.lFace=h.lFace=a.lFace;return c};e.mesh.splitEdge=function(a){var c=e.mesh.addEdgeVertex(a).sym;e.mesh.splice_(a.sym,a.sym.oPrev());e.mesh.splice_(a.sym,c);a.sym.org=c.org;c.dst().anEdge=c.sym;c.sym.lFace=a.rFace();c.winding=a.winding;c.sym.winding=a.sym.winding;return c};e.mesh.connect=function(a,c){var h=!1,b=e.mesh.makeEdgePair_(a),g=b.sym;c.lFace!==a.lFace&&
(h=!0,e.mesh.killFace_(c.lFace,a.lFace));e.mesh.splice_(b,a.lNext);e.mesh.splice_(g,c);b.org=a.dst();g.org=c.org;b.lFace=g.lFace=a.lFace;a.lFace.anEdge=g;h||e.mesh.makeFace_(b,a.lFace);return b};e.mesh.zapFace=function(a){var c=a.anEdge,h=c.lNext,b;do if(b=h,h=b.lNext,b.lFace=null,null===b.rFace()){b.oNext===b?e.mesh.killVertex_(b.org,null):(b.org.anEdge=b.oNext,e.mesh.splice_(b,b.oPrev()));var g=b.sym;g.oNext===g?e.mesh.killVertex_(g.org,null):(g.org.anEdge=g.oNext,e.mesh.splice_(g,g.oPrev()));e.mesh.killEdge_(b)}while(b!==
c);c=a.prev;a=a.next;a.prev=c;c.next=a};e.mesh.meshUnion=function(a,c){var e=a.fHead,b=a.vHead,g=a.eHead,m=c.fHead,f=c.vHead;c=c.eHead;m.next!==m&&(e.prev.next=m.next,m.next.prev=e.prev,m.prev.next=e,e.prev=m.prev);f.next!==f&&(b.prev.next=f.next,f.next.prev=b.prev,f.prev.next=b,b.prev=f.prev);c.next!==c&&(g.sym.next.sym.next=c.next,c.next.sym.next=g.sym.next,c.sym.next.sym.next=g,g.sym.next=c.sym.next);return a};e.mesh.deleteMesh=function(a){};e.mesh.makeEdgePair_=function(a){var c=new e.GluHalfEdge,
h=new e.GluHalfEdge,b=a.sym.next;h.next=b;b.sym.next=c;c.next=a;a.sym.next=h;c.sym=h;c.oNext=c;c.lNext=h;h.sym=c;h.oNext=h;return h.lNext=c};e.mesh.splice_=function(a,c){var e=a.oNext,b=c.oNext;e.sym.lNext=c;b.sym.lNext=a;a.oNext=b;c.oNext=e};e.mesh.makeVertex_=function(a,c){var h=c.prev,b=new e.GluVertex(c,h);h.next=b;c.prev=b;c=b.anEdge=a;do c.org=b,c=c.oNext;while(c!==a)};e.mesh.makeFace_=function(a,c){var h=c.prev,b=new e.GluFace(c,h);h.next=b;c.prev=b;b.anEdge=a;b.inside=c.inside;c=a;do c.lFace=
b,c=c.lNext;while(c!==a)};e.mesh.killEdge_=function(a){var c=a.next;a=a.sym.next;c.sym.next=a;a.sym.next=c};e.mesh.killVertex_=function(a,c){var e=a.anEdge,b=e;do b.org=c,b=b.oNext;while(b!==e);c=a.prev;a=a.next;a.prev=c;c.next=a};e.mesh.killFace_=function(a,c){var e=a.anEdge,b=e;do b.lFace=c,b=b.lNext;while(b!==e);c=a.prev;a=a.next;a.prev=c;c.next=a};e.normal={};e.normal.S_UNIT_X_=1;e.normal.S_UNIT_Y_=0;e.normal.projectPolygon=function(a,c,h,b){var g=!1,m=[c,h,b];0===c&&0===h&&0===b&&(e.normal.computeNormal_(a,
m),g=!0);h=e.normal.longAxis_(m);c=a.mesh.vHead;if(e.TRUE_PROJECT){e.normal.normalize_(m);b=[0,0,0];var f=[0,0,0];b[h]=0;b[(h+1)%3]=e.normal.S_UNIT_X_;b[(h+2)%3]=e.normal.S_UNIT_Y_;h=e.normal.dot_(b,m);b[0]-=h*m[0];b[1]-=h*m[1];b[2]-=h*m[2];e.normal.normalize_(b);f[0]=m[1]*b[2]-m[2]*b[1];f[1]=m[2]*b[0]-m[0]*b[2];f[2]=m[0]*b[1]-m[1]*b[0];e.normal.normalize_(f);for(m=c.next;m!==c;m=m.next)m.s=e.normal.dot_(m.coords,b),m.t=e.normal.dot_(m.coords,f)}else for(b=(h+1)%3,f=(h+2)%3,h=0<m[h]?1:-1,m=c.next;m!==
c;m=m.next)m.s=m.coords[b],m.t=h*m.coords[f];g&&e.normal.checkOrientation_(a)};e.normal.dot_=function(a,c){return a[0]*c[0]+a[1]*c[1]+a[2]*c[2]};e.normal.normalize_=function(a){var c=a[0]*a[0]+a[1]*a[1]+a[2]*a[2];e.assert(0<c);c=Math.sqrt(c);a[0]/=c;a[1]/=c;a[2]/=c};e.normal.longAxis_=function(a){var c=0;Math.abs(a[1])>Math.abs(a[0])&&(c=1);Math.abs(a[2])>Math.abs(a[c])&&(c=2);return c};e.normal.computeNormal_=function(a,c){var h=[-2*e.GLU_TESS_MAX_COORD,-2*e.GLU_TESS_MAX_COORD,-2*e.GLU_TESS_MAX_COORD],
b=[2*e.GLU_TESS_MAX_COORD,2*e.GLU_TESS_MAX_COORD,2*e.GLU_TESS_MAX_COORD],g=[],m=[],f;a=a.mesh.vHead;for(f=a.next;f!==a;f=f.next)for(var d=0;3>d;++d){var l=f.coords[d];l<b[d]&&(b[d]=l,m[d]=f);l>h[d]&&(h[d]=l,g[d]=f)}f=0;h[1]-b[1]>h[0]-b[0]&&(f=1);h[2]-b[2]>h[f]-b[f]&&(f=2);if(b[f]>=h[f])c[0]=0,c[1]=0,c[2]=1;else{h=0;b=m[f];g=g[f];m=[0,0,0];b=[b.coords[0]-g.coords[0],b.coords[1]-g.coords[1],b.coords[2]-g.coords[2]];d=[0,0,0];for(f=a.next;f!==a;f=f.next)d[0]=f.coords[0]-g.coords[0],d[1]=f.coords[1]-
g.coords[1],d[2]=f.coords[2]-g.coords[2],m[0]=b[1]*d[2]-b[2]*d[1],m[1]=b[2]*d[0]-b[0]*d[2],m[2]=b[0]*d[1]-b[1]*d[0],l=m[0]*m[0]+m[1]*m[1]+m[2]*m[2],l>h&&(h=l,c[0]=m[0],c[1]=m[1],c[2]=m[2]);0>=h&&(c[0]=c[1]=c[2]=0,c[e.normal.longAxis_(b)]=1)}};e.normal.checkOrientation_=function(a){for(var c=0,e=a.mesh.fHead,b=e.next;b!==e;b=b.next){var g=b.anEdge;if(!(0>=g.winding)){do c+=(g.org.s-g.dst().s)*(g.org.t+g.dst().t),g=g.lNext;while(g!==b.anEdge)}}if(0>c)for(a=a.mesh.vHead,c=a.next;c!==a;c=c.next)c.t=-c.t};
e.render={};e.render.renderMesh=function(a,c,h){for(var b=!1,g=-1,m=c.fHead.prev;m!==c.fHead;m=m.prev)if(m.inside){b||(a.callBeginCallback(e.primitiveType.GL_TRIANGLES),b=!0);var f=m.anEdge;e.assert(f.lNext.lNext.lNext===f,"renderMesh called with non-triangulated mesh");do{if(h){var d=f.rFace().inside?0:1;g!==d&&(g=d,a.callEdgeFlagCallback(!!g))}a.callVertexCallback(f.org.data);f=f.lNext}while(f!==m.anEdge)}b&&a.callEndCallback()};e.render.renderBoundary=function(a,c){for(var h=c.fHead.next;h!==c.fHead;h=
h.next)if(h.inside){a.callBeginCallback(e.primitiveType.GL_LINE_LOOP);var b=h.anEdge;do a.callVertexCallback(b.org.data),b=b.lNext;while(b!==h.anEdge);a.callEndCallback()}};e.sweep={};e.sweep.SENTINEL_COORD_=4*e.GLU_TESS_MAX_COORD;e.sweep.TOLERANCE_NONZERO_=!1;e.sweep.computeInterior=function(a){a.fatalError=!1;e.sweep.removeDegenerateEdges_(a);e.sweep.initPriorityQ_(a);e.sweep.initEdgeDict_(a);for(var c;null!==(c=a.pq.extractMin());){for(;;){var h=a.pq.minimum();if(null===h||!e.geom.vertEq(h,c))break;
h=a.pq.extractMin();e.sweep.spliceMergeVertices_(a,c.anEdge,h.anEdge)}e.sweep.sweepEvent_(a,c)}c=a.dict.getMin().getKey();a.event=c.eUp.org;e.sweep.doneEdgeDict_(a);e.sweep.donePriorityQ_(a);e.sweep.removeDegenerateFaces_(a.mesh);a.mesh.checkMesh()};e.sweep.addWinding_=function(a,c){a.winding+=c.winding;a.sym.winding+=c.sym.winding};e.sweep.edgeLeq_=function(a,c,h){a=a.event;c=c.eUp;h=h.eUp;if(c.dst()===a)return h.dst()===a?e.geom.vertLeq(c.org,h.org)?0>=e.geom.edgeSign(h.dst(),c.org,h.org):0<=e.geom.edgeSign(c.dst(),
h.org,c.org):0>=e.geom.edgeSign(h.dst(),a,h.org);if(h.dst()===a)return 0<=e.geom.edgeSign(c.dst(),a,c.org);c=e.geom.edgeEval(c.dst(),a,c.org);a=e.geom.edgeEval(h.dst(),a,h.org);return c>=a};e.sweep.deleteRegion_=function(a,c){c.fixUpperEdge&&e.assert(0===c.eUp.winding);c.eUp.activeRegion=null;a.dict.deleteNode(c.nodeUp);c.nodeUp=null};e.sweep.fixUpperEdge_=function(a,c){e.assert(a.fixUpperEdge);e.mesh.deleteEdge(a.eUp);a.fixUpperEdge=!1;a.eUp=c;c.activeRegion=a};e.sweep.topLeftRegion_=function(a){var c=
a.eUp.org;do a=a.regionAbove();while(a.eUp.org===c);a.fixUpperEdge&&(c=e.mesh.connect(a.regionBelow().eUp.sym,a.eUp.lNext),e.sweep.fixUpperEdge_(a,c),a=a.regionAbove());return a};e.sweep.topRightRegion_=function(a){var c=a.eUp.dst();do a=a.regionAbove();while(a.eUp.dst()===c);return a};e.sweep.addRegionBelow_=function(a,c,h){var b=new e.ActiveRegion;b.eUp=h;b.nodeUp=a.dict.insertBefore(c.nodeUp,b);return h.activeRegion=b};e.sweep.isWindingInside_=function(a,c){switch(a.windingRule){case e.windingRule.GLU_TESS_WINDING_ODD:return 0!==
(c&1);case e.windingRule.GLU_TESS_WINDING_NONZERO:return 0!==c;case e.windingRule.GLU_TESS_WINDING_POSITIVE:return 0<c;case e.windingRule.GLU_TESS_WINDING_NEGATIVE:return 0>c;case e.windingRule.GLU_TESS_WINDING_ABS_GEQ_TWO:return 2<=c||-2>=c}e.assert(!1);return!1};e.sweep.computeWinding_=function(a,c){c.windingNumber=c.regionAbove().windingNumber+c.eUp.winding;c.inside=e.sweep.isWindingInside_(a,c.windingNumber)};e.sweep.finishRegion_=function(a,c){var h=c.eUp,b=h.lFace;b.inside=c.inside;b.anEdge=
h;e.sweep.deleteRegion_(a,c)};e.sweep.finishLeftRegions_=function(a,c,h){var b=c;for(c=c.eUp;b!==h;){b.fixUpperEdge=!1;var g=b.regionBelow(),m=g.eUp;if(m.org!==c.org){if(!g.fixUpperEdge){e.sweep.finishRegion_(a,b);break}m=e.mesh.connect(c.lPrev(),m.sym);e.sweep.fixUpperEdge_(g,m)}c.oNext!==m&&(e.mesh.meshSplice(m.oPrev(),m),e.mesh.meshSplice(c,m));e.sweep.finishRegion_(a,b);c=g.eUp;b=g}return c};e.sweep.addRightEdges_=function(a,c,h,b,g,m){var f=!0;do e.assert(e.geom.vertLeq(h.org,h.dst())),e.sweep.addRegionBelow_(a,
c,h.sym),h=h.oNext;while(h!==b);for(null===g&&(g=c.regionBelow().eUp.rPrev());;){b=c.regionBelow();h=b.eUp.sym;if(h.org!==g.org)break;h.oNext!==g&&(e.mesh.meshSplice(h.oPrev(),h),e.mesh.meshSplice(g.oPrev(),h));b.windingNumber=c.windingNumber-h.winding;b.inside=e.sweep.isWindingInside_(a,b.windingNumber);c.dirty=!0;!f&&e.sweep.checkForRightSplice_(a,c)&&(e.sweep.addWinding_(h,g),e.sweep.deleteRegion_(a,c),e.mesh.deleteEdge(g));f=!1;c=b;g=h}c.dirty=!0;e.assert(c.windingNumber-h.winding===b.windingNumber);
m&&e.sweep.walkDirtyRegions_(a,c)};e.sweep.callCombine_=function(a,c,h,b,g){var m=[c.coords[0],c.coords[1],c.coords[2]];c.data=null;c.data=a.callCombineCallback(m,h,b);null===c.data&&(g?a.fatalError||(a.callErrorCallback(e.errorType.GLU_TESS_NEED_COMBINE_CALLBACK),a.fatalError=!0):c.data=h[0])};e.sweep.spliceMergeVertices_=function(a,c,h){var b=[null,null,null,null];b[0]=c.org.data;b[1]=h.org.data;e.sweep.callCombine_(a,c.org,b,[.5,.5,0,0],!1);e.mesh.meshSplice(c,h)};e.sweep.vertexWeights_=function(a,
c,h,b,g){var m=e.geom.vertL1dist(c,a),f=e.geom.vertL1dist(h,a),d=g+1;b[g]=.5*f/(m+f);b[d]=.5*m/(m+f);a.coords[0]+=b[g]*c.coords[0]+b[d]*h.coords[0];a.coords[1]+=b[g]*c.coords[1]+b[d]*h.coords[1];a.coords[2]+=b[g]*c.coords[2]+b[d]*h.coords[2]};e.sweep.getIntersectData_=function(a,c,h,b,g,m){var f=[0,0,0,0],d=[h.data,b.data,g.data,m.data];c.coords[0]=c.coords[1]=c.coords[2]=0;e.sweep.vertexWeights_(c,h,b,f,0);e.sweep.vertexWeights_(c,g,m,f,2);e.sweep.callCombine_(a,c,d,f,!0)};e.sweep.checkForRightSplice_=
function(a,c){var h=c.regionBelow(),b=c.eUp,g=h.eUp;if(e.geom.vertLeq(b.org,g.org)){if(0<e.geom.edgeSign(g.dst(),b.org,g.org))return!1;e.geom.vertEq(b.org,g.org)?b.org!==g.org&&(a.pq.remove(b.org.pqHandle),e.sweep.spliceMergeVertices_(a,g.oPrev(),b)):(e.mesh.splitEdge(g.sym),e.mesh.meshSplice(b,g.oPrev()),c.dirty=h.dirty=!0)}else{if(0>e.geom.edgeSign(b.dst(),g.org,b.org))return!1;c.regionAbove().dirty=c.dirty=!0;e.mesh.splitEdge(b.sym);e.mesh.meshSplice(g.oPrev(),b)}return!0};e.sweep.checkForLeftSplice_=
function(a,c){var h=c.regionBelow();a=c.eUp;var b=h.eUp;e.assert(!e.geom.vertEq(a.dst(),b.dst()));if(e.geom.vertLeq(a.dst(),b.dst())){if(0>e.geom.edgeSign(a.dst(),b.dst(),a.org))return!1;c.regionAbove().dirty=c.dirty=!0;h=e.mesh.splitEdge(a);e.mesh.meshSplice(b.sym,h);h.lFace.inside=c.inside}else{if(0<e.geom.edgeSign(b.dst(),a.dst(),b.org))return!1;c.dirty=h.dirty=!0;h=e.mesh.splitEdge(b);e.mesh.meshSplice(a.lNext,b.sym);h.rFace().inside=c.inside}return!0};e.sweep.checkForIntersect_=function(a,c){var h=
c.regionBelow(),b=c.eUp,g=h.eUp,m=b.org,f=g.org,d=b.dst(),l=g.dst(),z=new e.GluVertex;e.assert(!e.geom.vertEq(l,d));e.assert(0>=e.geom.edgeSign(d,a.event,m));e.assert(0<=e.geom.edgeSign(l,a.event,f));e.assert(m!==a.event&&f!==a.event);e.assert(!c.fixUpperEdge&&!h.fixUpperEdge);if(m===f||Math.min(m.t,d.t)>Math.max(f.t,l.t))return!1;if(e.geom.vertLeq(m,f)){if(0<e.geom.edgeSign(l,m,f))return!1}else if(0>e.geom.edgeSign(d,f,m))return!1;e.geom.edgeIntersect(d,m,l,f,z);e.assert(Math.min(m.t,d.t)<=z.t);
e.assert(z.t<=Math.max(f.t,l.t));e.assert(Math.min(l.s,d.s)<=z.s);e.assert(z.s<=Math.max(f.s,m.s));e.geom.vertLeq(z,a.event)&&(z.s=a.event.s,z.t=a.event.t);var v=e.geom.vertLeq(m,f)?m:f;e.geom.vertLeq(v,z)&&(z.s=v.s,z.t=v.t);if(e.geom.vertEq(z,m)||e.geom.vertEq(z,f))return e.sweep.checkForRightSplice_(a,c),!1;if(!e.geom.vertEq(d,a.event)&&0<=e.geom.edgeSign(d,a.event,z)||!e.geom.vertEq(l,a.event)&&0>=e.geom.edgeSign(l,a.event,z)){if(l===a.event)return e.mesh.splitEdge(b.sym),e.mesh.meshSplice(g.sym,
b),c=e.sweep.topLeftRegion_(c),b=c.regionBelow().eUp,e.sweep.finishLeftRegions_(a,c.regionBelow(),h),e.sweep.addRightEdges_(a,c,b.oPrev(),b,b,!0),!0;if(d===a.event)return e.mesh.splitEdge(g.sym),e.mesh.meshSplice(b.lNext,g.oPrev()),h=c,c=e.sweep.topRightRegion_(c),m=c.regionBelow().eUp.rPrev(),h.eUp=g.oPrev(),g=e.sweep.finishLeftRegions_(a,h,null),e.sweep.addRightEdges_(a,c,g.oNext,b.rPrev(),m,!0),!0;0<=e.geom.edgeSign(d,a.event,z)&&(c.regionAbove().dirty=c.dirty=!0,e.mesh.splitEdge(b.sym),b.org.s=
a.event.s,b.org.t=a.event.t);0>=e.geom.edgeSign(l,a.event,z)&&(c.dirty=h.dirty=!0,e.mesh.splitEdge(g.sym),g.org.s=a.event.s,g.org.t=a.event.t);return!1}e.mesh.splitEdge(b.sym);e.mesh.splitEdge(g.sym);e.mesh.meshSplice(g.oPrev(),b);b.org.s=z.s;b.org.t=z.t;b.org.pqHandle=a.pq.insert(b.org);e.sweep.getIntersectData_(a,b.org,m,d,f,l);c.regionAbove().dirty=c.dirty=h.dirty=!0;return!1};e.sweep.walkDirtyRegions_=function(a,c){for(var h=c.regionBelow();;){for(;h.dirty;)c=h,h=h.regionBelow();if(!c.dirty&&
(h=c,c=c.regionAbove(),null===c||!c.dirty))break;c.dirty=!1;var b=c.eUp,g=h.eUp;b.dst()!==g.dst()&&e.sweep.checkForLeftSplice_(a,c)&&(h.fixUpperEdge?(e.sweep.deleteRegion_(a,h),e.mesh.deleteEdge(g),h=c.regionBelow(),g=h.eUp):c.fixUpperEdge&&(e.sweep.deleteRegion_(a,c),e.mesh.deleteEdge(b),c=h.regionAbove(),b=c.eUp));if(b.org!==g.org)if(b.dst()===g.dst()||c.fixUpperEdge||h.fixUpperEdge||b.dst()!==a.event&&g.dst()!==a.event)e.sweep.checkForRightSplice_(a,c);else if(e.sweep.checkForIntersect_(a,c))break;
b.org===g.org&&b.dst()===g.dst()&&(e.sweep.addWinding_(g,b),e.sweep.deleteRegion_(a,c),e.mesh.deleteEdge(b),c=h.regionAbove())}};e.sweep.connectRightVertex_=function(a,c,h){var b=h.oNext,g=c.regionBelow(),m=c.eUp,f=g.eUp,d=!1;m.dst()!==f.dst()&&e.sweep.checkForIntersect_(a,c);e.geom.vertEq(m.org,a.event)&&(e.mesh.meshSplice(b.oPrev(),m),c=e.sweep.topLeftRegion_(c),b=c.regionBelow().eUp,e.sweep.finishLeftRegions_(a,c.regionBelow(),g),d=!0);e.geom.vertEq(f.org,a.event)&&(e.mesh.meshSplice(h,f.oPrev()),
h=e.sweep.finishLeftRegions_(a,g,null),d=!0);d?e.sweep.addRightEdges_(a,c,h.oNext,b,b,!0):(b=e.geom.vertLeq(f.org,m.org)?f.oPrev():m,b=e.mesh.connect(h.lPrev(),b),e.sweep.addRightEdges_(a,c,b,b.oNext,b.oNext,!1),b.sym.activeRegion.fixUpperEdge=!0,e.sweep.walkDirtyRegions_(a,c))};e.sweep.connectLeftDegenerate_=function(a,c,h){var b=c.eUp;if(e.geom.vertEq(b.org,h))e.assert(e.sweep.TOLERANCE_NONZERO_),e.sweep.TOLERANCE_NONZERO_&&e.sweep.spliceMergeVertices_(a,b,h.anEdge);else if(e.geom.vertEq(b.dst(),
h)){if(e.assert(e.sweep.TOLERANCE_NONZERO_),e.sweep.TOLERANCE_NONZERO_){c=e.sweep.topRightRegion_(c);var b=c.regionBelow(),g=b.eUp.sym,m=g.oNext,f=m;b.fixUpperEdge&&(e.assert(m!==g),e.sweep.deleteRegion_(a,b),e.mesh.deleteEdge(g),g=m.oPrev());e.mesh.meshSplice(h.anEdge,g);e.geom.edgeGoesLeft(m)||(m=null);e.sweep.addRightEdges_(a,c,g.oNext,f,m,!0)}}else e.mesh.splitEdge(b.sym),c.fixUpperEdge&&(e.mesh.deleteEdge(b.oNext),c.fixUpperEdge=!1),e.mesh.meshSplice(h.anEdge,b),e.sweep.sweepEvent_(a,h)};e.sweep.connectLeftVertex_=
function(a,c){var h=new e.ActiveRegion;h.eUp=c.anEdge.sym;var h=a.dict.search(h).getKey(),b=h.regionBelow(),g=h.eUp,m=b.eUp;0===e.geom.edgeSign(g.dst(),c,g.org)?e.sweep.connectLeftDegenerate_(a,h,c):(b=e.geom.vertLeq(m.dst(),g.dst())?h:b,h.inside||b.fixUpperEdge?(g=b===h?e.mesh.connect(c.anEdge.sym,g.lNext):e.mesh.connect(m.dNext(),c.anEdge).sym,b.fixUpperEdge?e.sweep.fixUpperEdge_(b,g):e.sweep.computeWinding_(a,e.sweep.addRegionBelow_(a,h,g)),e.sweep.sweepEvent_(a,c)):e.sweep.addRightEdges_(a,h,
c.anEdge,c.anEdge,null,!0))};e.sweep.sweepEvent_=function(a,c){a.event=c;for(var h=c.anEdge;null===h.activeRegion;)if(h=h.oNext,h===c.anEdge){e.sweep.connectLeftVertex_(a,c);return}c=e.sweep.topLeftRegion_(h.activeRegion);var b=c.regionBelow(),h=b.eUp,b=e.sweep.finishLeftRegions_(a,b,null);b.oNext===h?e.sweep.connectRightVertex_(a,c,b):e.sweep.addRightEdges_(a,c,b.oNext,h,h,!0)};e.sweep.addSentinel_=function(a,c){var h=new e.ActiveRegion,b=e.mesh.makeEdge(a.mesh);b.org.s=e.sweep.SENTINEL_COORD_;b.org.t=
c;b.dst().s=-e.sweep.SENTINEL_COORD_;b.dst().t=c;a.event=b.dst();h.eUp=b;h.windingNumber=0;h.inside=!1;h.fixUpperEdge=!1;h.sentinel=!0;h.dirty=!1;h.nodeUp=a.dict.insert(h)};e.sweep.initEdgeDict_=function(a){a.dict=new e.Dict(a,e.sweep.edgeLeq_);e.sweep.addSentinel_(a,-e.sweep.SENTINEL_COORD_);e.sweep.addSentinel_(a,e.sweep.SENTINEL_COORD_)};e.sweep.doneEdgeDict_=function(a){for(var c=0,h;null!==(h=a.dict.getMin().getKey());)h.sentinel||(e.assert(h.fixUpperEdge),e.assert(1===++c)),e.assert(0===h.windingNumber),
e.sweep.deleteRegion_(a,h);a.dict=null};e.sweep.removeDegenerateEdges_=function(a){for(var c=a.mesh.eHead,h,b=c.next;b!==c;b=h){h=b.next;var g=b.lNext;e.geom.vertEq(b.org,b.dst())&&b.lNext.lNext!==b&&(e.sweep.spliceMergeVertices_(a,g,b),e.mesh.deleteEdge(b),b=g,g=b.lNext);if(g.lNext===b){if(g!==b){if(g===h||g===h.sym)h=h.next;e.mesh.deleteEdge(g)}if(b===h||b===h.sym)h=h.next;e.mesh.deleteEdge(b)}}};e.sweep.initPriorityQ_=function(a){var c=new e.PriorityQ;a.pq=c;a=a.mesh.vHead;var h;for(h=a.next;h!==
a;h=h.next)h.pqHandle=c.insert(h);c.init()};e.sweep.donePriorityQ_=function(a){a.pq.deleteQ();a.pq=null};e.sweep.removeDegenerateFaces_=function(a){for(var c,h=a.fHead.next;h!==a.fHead;h=c)c=h.next,h=h.anEdge,e.assert(h.lNext!==h),h.lNext.lNext===h&&(e.sweep.addWinding_(h.oNext,h),e.mesh.deleteEdge(h))};e.tessmono={};e.tessmono.tessellateMonoRegion_=function(a){a=a.anEdge;for(e.assert(a.lNext!==a&&a.lNext.lNext!==a);e.geom.vertLeq(a.dst(),a.org);a=a.lPrev());for(;e.geom.vertLeq(a.org,a.dst());a=a.lNext);
for(var c=a.lPrev(),h;a.lNext!==c;)if(e.geom.vertLeq(a.dst(),c.org)){for(;c.lNext!==a&&(e.geom.edgeGoesLeft(c.lNext)||0>=e.geom.edgeSign(c.org,c.dst(),c.lNext.dst()));)h=e.mesh.connect(c.lNext,c),c=h.sym;c=c.lPrev()}else{for(;c.lNext!==a&&(e.geom.edgeGoesRight(a.lPrev())||0<=e.geom.edgeSign(a.dst(),a.org,a.lPrev().org));)h=e.mesh.connect(a,a.lPrev()),a=h.sym;a=a.lNext}for(e.assert(c.lNext!==a);c.lNext.lNext!==a;)h=e.mesh.connect(c.lNext,c),c=h.sym};e.tessmono.tessellateInterior=function(a){for(var c,
h=a.fHead.next;h!==a.fHead;h=c)c=h.next,h.inside&&e.tessmono.tessellateMonoRegion_(h)};e.tessmono.discardExterior=function(a){for(var c,h=a.fHead.next;h!==a.fHead;h=c)c=h.next,h.inside||e.mesh.zapFace(h)};e.tessmono.setWindingNumber=function(a,c,h){for(var b,g=a.eHead.next;g!==a.eHead;g=b)b=g.next,g.rFace().inside!==g.lFace.inside?g.winding=g.lFace.inside?c:-c:h?e.mesh.deleteEdge(g):g.winding=0};e.Dict=function(a,c){this.head_=new e.DictNode;this.frame_=a;this.leq_=c};e.Dict.prototype.deleteDict_=
function(){};e.Dict.prototype.insertBefore=function(a,c){do a=a.prev;while(null!==a.key&&!this.leq_(this.frame_,a.key,c));c=new e.DictNode(c,a.next,a);a.next.prev=c;return a.next=c};e.Dict.prototype.insert=function(a){return this.insertBefore(this.head_,a)};e.Dict.prototype.deleteNode=function(a){a.next.prev=a.prev;a.prev.next=a.next};e.Dict.prototype.search=function(a){var c=this.head_;do c=c.next;while(null!==c.key&&!this.leq_(this.frame_,a,c.key));return c};e.Dict.prototype.getMin=function(){return this.head_.next};
e.Dict.prototype.getMax=function(){return this.head_.prev};e.DictNode=function(a,c,e){this.key=a||null;this.next=c||this;this.prev=e||this};e.DictNode.prototype.getKey=function(){return this.key};e.DictNode.prototype.getSuccessor=function(){return this.next};e.DictNode.prototype.getPredecessor=function(){return this.prev};e.GluTesselator=function(){this.state_=e.GluTesselator.tessState_.T_DORMANT;this.errorCallback_=this.mesh=this.lastEdge_=null;this.normal_=[0,0,0];this.windingRule=e.windingRule.GLU_TESS_WINDING_ODD;
this.fatalError=!1;this.combineCallback_=this.event=this.pq=this.dict=null;this.boundaryOnly_=!1;this.polygonData_=this.meshCallback_=this.endCallback_=this.vertexCallback_=this.edgeFlagCallback_=this.beginCallback_=null};e.GluTesselator.tessState_={T_DORMANT:0,T_IN_POLYGON:1,T_IN_CONTOUR:2};e.GluTesselator.prototype.gluDeleteTess=function(){this.requireState_(e.GluTesselator.tessState_.T_DORMANT)};e.GluTesselator.prototype.gluTessProperty=function(a,c){switch(a){case e.gluEnum.GLU_TESS_TOLERANCE:return;
case e.gluEnum.GLU_TESS_WINDING_RULE:switch(c){case e.windingRule.GLU_TESS_WINDING_ODD:case e.windingRule.GLU_TESS_WINDING_NONZERO:case e.windingRule.GLU_TESS_WINDING_POSITIVE:case e.windingRule.GLU_TESS_WINDING_NEGATIVE:case e.windingRule.GLU_TESS_WINDING_ABS_GEQ_TWO:this.windingRule=c;return}break;case e.gluEnum.GLU_TESS_BOUNDARY_ONLY:this.boundaryOnly_=!!c;return;default:this.callErrorCallback(e.gluEnum.GLU_INVALID_ENUM);return}this.callErrorCallback(e.gluEnum.GLU_INVALID_VALUE)};e.GluTesselator.prototype.gluGetTessProperty=
function(a){switch(a){case e.gluEnum.GLU_TESS_TOLERANCE:return 0;case e.gluEnum.GLU_TESS_WINDING_RULE:return a=this.windingRule,e.assert(a===e.windingRule.GLU_TESS_WINDING_ODD||a===e.windingRule.GLU_TESS_WINDING_NONZERO||a===e.windingRule.GLU_TESS_WINDING_POSITIVE||a===e.windingRule.GLU_TESS_WINDING_NEGATIVE||a===e.windingRule.GLU_TESS_WINDING_ABS_GEQ_TWO),a;case e.gluEnum.GLU_TESS_BOUNDARY_ONLY:return e.assert(!0===this.boundaryOnly_||!1===this.boundaryOnly_),this.boundaryOnly_;default:this.callErrorCallback(e.gluEnum.GLU_INVALID_ENUM)}return!1};
e.GluTesselator.prototype.gluTessNormal=function(a,c,e){this.normal_[0]=a;this.normal_[1]=c;this.normal_[2]=e};e.GluTesselator.prototype.gluTessCallback=function(a,c){c=c?c:null;switch(a){case e.gluEnum.GLU_TESS_BEGIN:case e.gluEnum.GLU_TESS_BEGIN_DATA:this.beginCallback_=c;break;case e.gluEnum.GLU_TESS_EDGE_FLAG:case e.gluEnum.GLU_TESS_EDGE_FLAG_DATA:this.edgeFlagCallback_=c;break;case e.gluEnum.GLU_TESS_VERTEX:case e.gluEnum.GLU_TESS_VERTEX_DATA:this.vertexCallback_=c;break;case e.gluEnum.GLU_TESS_END:case e.gluEnum.GLU_TESS_END_DATA:this.endCallback_=
c;break;case e.gluEnum.GLU_TESS_ERROR:case e.gluEnum.GLU_TESS_ERROR_DATA:this.errorCallback_=c;break;case e.gluEnum.GLU_TESS_COMBINE:case e.gluEnum.GLU_TESS_COMBINE_DATA:this.combineCallback_=c;break;case e.gluEnum.GLU_TESS_MESH:this.meshCallback_=c;break;default:this.callErrorCallback(e.gluEnum.GLU_INVALID_ENUM)}};e.GluTesselator.prototype.gluTessVertex=function(a,c){var h=!1,b=[0,0,0];this.requireState_(e.GluTesselator.tessState_.T_IN_CONTOUR);for(var g=0;3>g;++g){var m=a[g];m<-e.GLU_TESS_MAX_COORD&&
(m=-e.GLU_TESS_MAX_COORD,h=!0);m>e.GLU_TESS_MAX_COORD&&(m=e.GLU_TESS_MAX_COORD,h=!0);b[g]=m}h&&this.callErrorCallback(e.errorType.GLU_TESS_COORD_TOO_LARGE);this.addVertex_(b,c)};e.GluTesselator.prototype.gluTessBeginPolygon=function(a){this.requireState_(e.GluTesselator.tessState_.T_DORMANT);this.state_=e.GluTesselator.tessState_.T_IN_POLYGON;this.mesh=new e.GluMesh;this.polygonData_=a};e.GluTesselator.prototype.gluTessBeginContour=function(){this.requireState_(e.GluTesselator.tessState_.T_IN_POLYGON);
this.state_=e.GluTesselator.tessState_.T_IN_CONTOUR;this.lastEdge_=null};e.GluTesselator.prototype.gluTessEndContour=function(){this.requireState_(e.GluTesselator.tessState_.T_IN_CONTOUR);this.state_=e.GluTesselator.tessState_.T_IN_POLYGON};e.GluTesselator.prototype.gluTessEndPolygon=function(){this.requireState_(e.GluTesselator.tessState_.T_IN_POLYGON);this.state_=e.GluTesselator.tessState_.T_DORMANT;e.normal.projectPolygon(this,this.normal_[0],this.normal_[1],this.normal_[2]);e.sweep.computeInterior(this);
if(!this.fatalError){var a=this.mesh;this.boundaryOnly_?e.tessmono.setWindingNumber(a,1,!0):e.tessmono.tessellateInterior(a);this.mesh.checkMesh();if(this.beginCallback_||this.endCallback_||this.vertexCallback_||this.edgeFlagCallback_)this.boundaryOnly_?e.render.renderBoundary(this,this.mesh):e.render.renderMesh(this,this.mesh,!!this.edgeFlagCallback_);if(this.meshCallback_){e.tessmono.discardExterior(this.mesh);this.meshCallback_(this.mesh);this.polygonData_=this.mesh=null;return}}e.mesh.deleteMesh(this.mesh);
this.mesh=this.polygonData_=null};e.GluTesselator.prototype.requireState_=function(a){this.state_!==a&&this.gotoState_(a)};e.GluTesselator.prototype.gotoState_=function(a){for(;this.state_!==a;)if(this.state_<a)switch(this.state_){case e.GluTesselator.tessState_.T_DORMANT:this.callErrorCallback(e.errorType.GLU_TESS_MISSING_BEGIN_POLYGON);this.gluTessBeginPolygon(null);break;case e.GluTesselator.tessState_.T_IN_POLYGON:this.callErrorCallback(e.errorType.GLU_TESS_MISSING_BEGIN_CONTOUR),this.gluTessBeginContour()}else switch(this.state_){case e.GluTesselator.tessState_.T_IN_CONTOUR:this.callErrorCallback(e.errorType.GLU_TESS_MISSING_END_CONTOUR);
this.gluTessEndContour();break;case e.GluTesselator.tessState_.T_IN_POLYGON:this.callErrorCallback(e.errorType.GLU_TESS_MISSING_END_POLYGON),this.gluTessEndPolygon()}};e.GluTesselator.prototype.addVertex_=function(a,c){var h=this.lastEdge_;null===h?(h=e.mesh.makeEdge(this.mesh),e.mesh.meshSplice(h,h.sym)):(e.mesh.splitEdge(h),h=h.lNext);h.org.data=c;h.org.coords[0]=a[0];h.org.coords[1]=a[1];h.org.coords[2]=a[2];h.winding=1;h.sym.winding=-1;this.lastEdge_=h};e.GluTesselator.prototype.callBeginCallback=
function(a){this.beginCallback_&&this.beginCallback_(a,this.polygonData_)};e.GluTesselator.prototype.callVertexCallback=function(a){this.vertexCallback_&&this.vertexCallback_(a,this.polygonData_)};e.GluTesselator.prototype.callEdgeFlagCallback=function(a){this.edgeFlagCallback_&&this.edgeFlagCallback_(a,this.polygonData_)};e.GluTesselator.prototype.callEndCallback=function(){this.endCallback_&&this.endCallback_(this.polygonData_)};e.GluTesselator.prototype.callCombineCallback=function(a,c,e){return this.combineCallback_?
this.combineCallback_(a,c,e,this.polygonData_)||null:null};e.GluTesselator.prototype.callErrorCallback=function(a){this.errorCallback_&&this.errorCallback_(a,this.polygonData_)};e.GluFace=function(a,c){this.next=a||this;this.prev=c||this;this.anEdge=null;this.inside=!1};e.GluHalfEdge=function(a){this.next=a||this;this.activeRegion=this.lFace=this.org=this.lNext=this.oNext=this.sym=null;this.winding=0};e.GluHalfEdge.prototype.rFace=function(){return this.sym.lFace};e.GluHalfEdge.prototype.dst=function(){return this.sym.org};
e.GluHalfEdge.prototype.oPrev=function(){return this.sym.lNext};e.GluHalfEdge.prototype.lPrev=function(){return this.oNext.sym};e.GluHalfEdge.prototype.dPrev=function(){return this.lNext.sym};e.GluHalfEdge.prototype.rPrev=function(){return this.sym.oNext};e.GluHalfEdge.prototype.dNext=function(){return this.rPrev().sym};e.GluHalfEdge.prototype.rNext=function(){return this.oPrev().sym};e.GluMesh=function(){this.vHead=new e.GluVertex;this.fHead=new e.GluFace;this.eHead=new e.GluHalfEdge;this.eHeadSym=
new e.GluHalfEdge;this.eHead.sym=this.eHeadSym;this.eHeadSym.sym=this.eHead};e.GluMesh.prototype.checkMesh=function(){if(e.DEBUG){var a=this.fHead,c=this.vHead,h=this.eHead,b,g;for(b=b=a;(g=b.next)!==a;b=g){e.assert(g.prev===b);b=g.anEdge;do e.assert(b.sym!==b),e.assert(b.sym.sym===b),e.assert(b.lNext.oNext.sym===b),e.assert(b.oNext.sym.lNext===b),e.assert(b.lFace===g),b=b.lNext;while(b!==g.anEdge)}e.assert(g.prev===b&&null===g.anEdge);for(b=b=c;(a=b.next)!==c;b=a){e.assert(a.prev===b);b=a.anEdge;
do e.assert(b.sym!==b),e.assert(b.sym.sym===b),e.assert(b.lNext.oNext.sym===b),e.assert(b.oNext.sym.lNext===b),e.assert(b.org===a),b=b.oNext;while(b!==a.anEdge)}e.assert(a.prev===b&&null===a.anEdge&&null===a.data);for(c=c=h;(b=c.next)!==h;c=b)e.assert(b.sym.next===c.sym),e.assert(b.sym!==b),e.assert(b.sym.sym===b),e.assert(null!==b.org),e.assert(null!==b.dst()),e.assert(b.lNext.oNext.sym===b),e.assert(b.oNext.sym.lNext===b);e.assert(b.sym.next===c.sym&&b.sym===this.eHeadSym&&b.sym.sym===b&&null===
b.org&&null===b.dst()&&null===b.lFace&&null===b.rFace())}};e.GluVertex=function(a,c){this.next=a||this;this.prev=c||this;this.data=this.anEdge=null;this.coords=[0,0,0];this.pqHandle=this.t=this.s=0};e.PriorityQ=function(){this.verts_=[];this.order_=null;this.size_=0;this.initialized_=!1;this.heap_=new e.PriorityQHeap};e.PriorityQ.prototype.deleteQ=function(){this.verts_=this.order_=this.heap_=null};e.PriorityQ.prototype.init=function(){this.order_=[];for(var a=0;a<this.size_;a++)this.order_[a]=a;
a=function(a){return function(b,c){return e.geom.vertLeq(a[b],a[c])?1:-1}}(this.verts_);this.order_.sort(a);this.initialized_=!0;this.heap_.init();if(e.DEBUG)for(var c=0+this.size_-1,a=0;a<c;++a)e.assert(e.geom.vertLeq(this.verts_[this.order_[a+1]],this.verts_[this.order_[a]]))};e.PriorityQ.prototype.insert=function(a){if(this.initialized_)return this.heap_.insert(a);var c=this.size_++;this.verts_[c]=a;return-(c+1)};e.PriorityQ.prototype.extractMin=function(){if(0===this.size_)return this.heap_.extractMin();
var a=this.verts_[this.order_[this.size_-1]];if(!this.heap_.isEmpty()){var c=this.heap_.minimum();if(e.geom.vertLeq(c,a))return this.heap_.extractMin()}do--this.size_;while(0<this.size_&&null===this.verts_[this.order_[this.size_-1]]);return a};e.PriorityQ.prototype.minimum=function(){if(0===this.size_)return this.heap_.minimum();var a=this.verts_[this.order_[this.size_-1]];if(!this.heap_.isEmpty()){var c=this.heap_.minimum();if(e.geom.vertLeq(c,a))return c}return a};e.PriorityQ.prototype.remove=function(a){if(0<=
a)this.heap_.remove(a);else for(a=-(a+1),e.assert(a<this.verts_.length&&null!==this.verts_[a]),this.verts_[a]=null;0<this.size_&&null===this.verts_[this.order_[this.size_-1]];)--this.size_};e.PriorityQHeap=function(){this.heap_=e.PriorityQHeap.reallocNumeric_([0],e.PriorityQHeap.INIT_SIZE_+1);this.verts_=[null,null];this.handles_=[0,0];this.size_=0;this.max_=e.PriorityQHeap.INIT_SIZE_;this.freeList_=0;this.initialized_=!1;this.heap_[1]=1};e.PriorityQHeap.INIT_SIZE_=32;e.PriorityQHeap.reallocNumeric_=
function(a,c){for(var e=Array(c),b=0;b<a.length;b++)e[b]=a[b];for(;b<c;b++)e[b]=0;return e};e.PriorityQHeap.prototype.init=function(){for(var a=this.size_;1<=a;--a)this.floatDown_(a);this.initialized_=!0};e.PriorityQHeap.prototype.insert=function(a){var c=++this.size_;2*c>this.max_&&(this.max_*=2,this.handles_=e.PriorityQHeap.reallocNumeric_(this.handles_,this.max_+1));var h;0===this.freeList_?h=c:(h=this.freeList_,this.freeList_=this.handles_[this.freeList_]);this.verts_[h]=a;this.handles_[h]=c;
this.heap_[c]=h;this.initialized_&&this.floatUp_(c);return h};e.PriorityQHeap.prototype.isEmpty=function(){return 0===this.size_};e.PriorityQHeap.prototype.minimum=function(){return this.verts_[this.heap_[1]]};e.PriorityQHeap.prototype.extractMin=function(){var a=this.heap_,c=this.verts_,e=this.handles_,b=a[1],g=c[b];0<this.size_&&(a[1]=a[this.size_],e[a[1]]=1,c[b]=null,e[b]=this.freeList_,this.freeList_=b,0<--this.size_&&this.floatDown_(1));return g};e.PriorityQHeap.prototype.remove=function(a){var c=
this.heap_,h=this.verts_,b=this.handles_;e.assert(1<=a&&a<=this.max_&&null!==h[a]);var g=b[a];c[g]=c[this.size_];b[c[g]]=g;g<=--this.size_&&(1>=g?this.floatDown_(g):e.geom.vertLeq(h[c[g>>1]],h[c[g]])?this.floatDown_(g):this.floatUp_(g));h[a]=null;b[a]=this.freeList_;this.freeList_=a};e.PriorityQHeap.prototype.floatDown_=function(a){for(var c=this.heap_,h=this.verts_,b=this.handles_,g=c[a];;){var m=a<<1;m<this.size_&&e.geom.vertLeq(h[c[m+1]],h[c[m]])&&(m+=1);e.assert(m<=this.max_);var f=c[m];if(m>
this.size_||e.geom.vertLeq(h[g],h[f])){c[a]=g;b[g]=a;break}c[a]=f;b[f]=a;a=m}};e.PriorityQHeap.prototype.floatUp_=function(a){for(var c=this.heap_,h=this.verts_,b=this.handles_,g=c[a];;){var m=a>>1,f=c[m];if(0===m||e.geom.vertLeq(h[f],h[g])){c[a]=g;b[g]=a;break}c[a]=f;b[f]=a;a=m}};e.ActiveRegion=function(){this.nodeUp=this.eUp=null;this.windingNumber=0;this.fixUpperEdge=this.dirty=this.sentinel=this.inside=!1};e.ActiveRegion.prototype.regionBelow=function(){return this.nodeUp.getPredecessor().getKey()};
e.ActiveRegion.prototype.regionAbove=function(){return this.nodeUp.getSuccessor().getKey()};return e})},"esri/views/2d/engine/webgl/util/Lock":function(){define(["require","exports","../../../../../core/promiseUtils"],function(e,a,c){Object.defineProperty(a,"__esModule",{value:!0});e=function(){function a(){this._resolver=null}a.prototype.isHeld=function(){return!!this._resolver};a.prototype.acquire=function(){var a=this;return this._resolver?this._resolver.promise.then(function(){return a.acquire()}):
(this._resolver=c.createResolver(),c.resolve())};a.prototype.release=function(){var a=this._resolver;this._resolver=null;a.resolve()};return a}();a.default=e;a.withLock=function(a,b,c){return a.acquire().then(function(){return b(c)}).then(function(){return a.release()}).catch(function(b){a.release();throw b;})}})},"esri/views/2d/engine/webgl/TileData":function(){define("require exports ./MemoryRequirements ./TileBufferData ./TileDisplayData ./Utils ./Utils ./WGLDisplayObject ./WGLDisplayRecord ./mesh/VertexBuffer ./util/Reader ./util/serializationUtils ./util/Writer".split(" "),
function(e,a,c,h,b,g,m,f,d,l,z,v,A){Object.defineProperty(a,"__esModule",{value:!0});var x=new c.default,u=new c.default;e=function(){function a(){this.tileBufferData=this.tileDisplayData=null}a.prototype.reshuffle=function(){x.reset();for(var c=b.groupRecordsByGeometryType(this.tileDisplayData.displayObjects),d=0;d<c.length;d++)for(var e=c[d],f=0,l=e;f<l.length;f++){var q=l[f];q&&x.needMore(q.geometryType,q.meshData?q.meshData.vertexCount:q.vertexCount,q.meshData?q.meshData.indexData.length:q.indexCount)}f=
c.length;d=new h;for(l=0;l<f;++l){d.geometries[l].indexBuffer=new Uint32Array(Math.round(1.15*x.indicesFor(l)));var q=[],v;for(v in this.tileBufferData.geometries[l].vertexBuffer)q.push(this.tileBufferData.geometries[l].vertexBuffer[v].stride);var q=a._computeVertexAlignment(q),e=Math.round(1.15*x.verticesFor(l)),q=a._align(e,q),z;for(z in this.tileBufferData.geometries[l].vertexBuffer)e=this.tileBufferData.geometries[l].vertexBuffer[z].stride,d.geometries[l].vertexBuffer[z]={stride:e,data:m.allocateTypedArrayBuffer(q,
e)}}u.reset();this.tileDisplayData.displayList.clear();for(l=0;l<f;++l){e=c[l];v=0;for(z=e;v<z.length;v++){q=z[v];if(q.meshData)q.writeMeshDataToBuffers(u.verticesFor(l),d.geometries[l].vertexBuffer,u.indicesFor(l),d.geometries[l].indexBuffer),q.meshData=null;else{var A=this.tileBufferData.geometries[l].vertexBuffer,F=this.tileBufferData.geometries[l].indexBuffer,M=d.geometries[l].vertexBuffer,J=d.geometries[l].indexBuffer,L=u.verticesFor(l),K=u.indicesFor(l);g.copyMeshData(L,K,M,J,q,A,F);q.vertexFrom=
L;q.indexFrom=K}u.needMore(l,q.vertexCount,q.indexCount)}this.tileDisplayData.displayList.unified||this.tileDisplayData.displayList.addToList(e)}if(this.tileDisplayData.displayList.unified)for(c=0,f=this.tileDisplayData.displayObjects;c<f.length;c++)this.tileDisplayData.displayList.addToList(f[c].displayRecords);this.tileBufferData=d};a.prototype.getStrides=function(){for(var a=[],b=0;b<this.tileBufferData.geometries.length;++b){var c=this.tileBufferData.geometries[b];a[b]={};for(var d in c.vertexBuffer)a[b][d]=
c.vertexBuffer[d].stride}return a};a.prototype.clone=function(){var b=new a;b.tileBufferData=this.tileBufferData.clone();b.tileDisplayData=this.tileDisplayData.clone();return b};a.prototype._guessSize=function(){for(var a=this.tileDisplayData.displayObjects,b=Math.min(a.length,4),c=0,d=0;d<b;d++)c=Math.max(c,a[d].displayRecords.length);return 2*(12*a.length+a.length*c*40)};a.prototype.serialize=function(){var a=this.tileBufferData.serialize(),b=this.tileBufferData.getBuffers(),c=this.tileDisplayData.serialize(new A.default(Int32Array,
this._guessSize())).buffer();b.push(c);return{result:{displayData:c,bufferData:a},transferList:b}};a.decode=function(b){var c=v.deserializeList(new z.default(b.displayObjects),f),d={},e;for(e in b.vertexBuffersMap)d[e]=l.VertexBuffers.decode(b.vertexBuffersMap[e]);return a.fromMeshData({displayObjects:c,vertexBuffersMap:d})};a.fromMeshData=function(c){var d=new a,e=new b.default,f=new h;e.displayObjects=c.displayObjects;for(var g in c.vertexBuffersMap){var l=c.vertexBuffersMap[g];f.geometries[g].indexBuffer=
l.indexBuffer;f.geometries[g].vertexBuffer=l.namedBuffers}d.tileDisplayData=e;d.tileBufferData=f;return d};a.bind=function(b,c){var d=new a;d.tileDisplayData=b;d.tileBufferData=c;return d};a.create=function(c,e){var f=new a;f.tileDisplayData=new b.default;f.tileDisplayData.displayObjects=c;for(var g=[0,0,0,0,0],l=[0,0,0,0,0],n=[[],[],[],[],[]],p=0;p<c.length;p++)for(var q=0,u=c[p].displayRecords;q<u.length;q++){var v=u[q];n[v.geometryType].push(v);g[v.geometryType]+=v.meshData.vertexCount;l[v.geometryType]+=
v.meshData.indexData.length}c=new h;e=[e.fill||{},e.line||{},e.icon||{},e.text||{},e.label||{}];for(p=0;5>p;p++){var q=new Uint32Array(l[p]),u=e[p],v=g[p],x={},z=void 0;for(z in u){var A={data:m.allocateTypedArrayBuffer(v,u[z]),stride:u[z]};x[z]=A}u=x;d.writeAllMeshDataToBuffers(n[p],u,q);c.geometries[p]={indexBuffer:q,vertexBuffer:u}}f.tileBufferData=c;return f};a._align=function(a,b){var c=a%b;return 0===c?a:a+(b-c)};a._computeVertexAlignment=function(a){for(var b=!1,c=!1,d=0;d<a.length;d++){var e=
a[d];2===e%4?b=!0:0!==e%4&&(c=!0)}return c?4:b?2:1};return a}();a.TileData=e})},"esri/views/2d/engine/webgl/MemoryRequirements":function(){define(["require","exports"],function(e,a){Object.defineProperty(a,"__esModule",{value:!0});e=function(){function a(){this._byGeometryType=null}Object.defineProperty(a.prototype,"satisfied",{get:function(){return!this._byGeometryType},enumerable:!0,configurable:!0});a.prototype.reset=function(){this._byGeometryType=null};a.prototype.verticesFor=function(a){return this._byGeometryType?
this._byGeometryType[a].vertices:0};a.prototype.indicesFor=function(a){return this._byGeometryType?this._byGeometryType[a].indices:0};a.prototype.needMore=function(a,b,c){if(b||c)this._byGeometryType||(this._byGeometryType=[{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0}]),a=this._byGeometryType[a],a.vertices+=b,a.indices+=c};return a}();a.default=e})},"esri/views/2d/engine/webgl/TileBufferData":function(){define(["require","exports",
"./Utils"],function(e,a,c){return function(){function a(){this.geometries=[{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}}]}a.prototype.clone=function(){for(var b=new a,c=0;c<this.geometries.length;c++){var e=this.geometries[c],f=b.geometries[c];f.indexBuffer=e.indexBuffer.slice();f.vertexBuffer={};for(var d in e.vertexBuffer){var h=e.vertexBuffer[d],z=h.stride;
f.vertexBuffer[d]={data:h.data.slice(),stride:z}}}return b};a.deserialize=function(b){for(var e=new a,h=0;5>h;++h){e.geometries[h].indexBuffer=new Uint32Array(b.geometries[h].indexBuffer);e.geometries[h].vertexBuffer={};for(var f in b.geometries[h].vertexBuffer)e.geometries[h].vertexBuffer[f]={data:c.allocateTypedArrayBufferwithData(b.geometries[h].vertexBuffer[f].data,b.geometries[h].vertexBuffer[f].stride),stride:b.geometries[h].vertexBuffer[f].stride}}return e};a.prototype.serialize=function(){for(var a=
{geometries:[{indexBuffer:this.geometries[0].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[1].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[2].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[3].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[4].indexBuffer.buffer,vertexBuffer:{}}]},c=0;5>c;++c)for(var e in this.geometries[c].vertexBuffer)a.geometries[c].vertexBuffer[e]={data:this.geometries[c].vertexBuffer[e].data.buffer,stride:this.geometries[c].vertexBuffer[e].stride};
return a};a.prototype.getBuffers=function(){for(var a=[],c=0;5>c;++c){a.push(this.geometries[c].indexBuffer.buffer);for(var e in this.geometries[c].vertexBuffer)a.push(this.geometries[c].vertexBuffer[e].data.buffer)}return a};return a}()})},"esri/views/2d/engine/webgl/TileDisplayData":function(){define(["require","exports","./WGLDisplayList","./WGLDisplayObject","./util/serializationUtils"],function(e,a,c,h,b){function g(a){for(var b=[[],[],[],[],[]],c=0;c<a.length;c++)for(var e=0,g=a[c].displayRecords;e<
g.length;e++){var h=g[e];b[h.geometryType].push(h)}return b}Object.defineProperty(a,"__esModule",{value:!0});a.groupRecordsByGeometryType=g;e=function(){function a(){}Object.defineProperty(a.prototype,"displayObjectRegistry",{get:function(){if(!this._displayObjectRegistry){this._displayObjectRegistry=new Map;for(var a=0,b=this.displayObjects;a<b.length;a++){var c=b[a];this._displayObjectRegistry.set(c.id,c)}}return this._displayObjectRegistry},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"displayList",{get:function(){return this._displayList},enumerable:!0,configurable:!0});a.prototype.computeDisplayList=function(a){this._displayList=new c(a);if(a){a=0;for(var b=this.displayObjects;a<b.length;a++)for(var e=0,f=b[a].displayRecords;e<f.length;e++)this._displayList.addToList(f[e])}else for(a=g(this.displayObjects),b=a.length,e=0;e<b;++e)this._displayList.addToList(a[e])};a.prototype.clone=function(){var b=new a;this.displayObjects&&(b.displayObjects=this.displayObjects.map(function(a){return a.clone()}));
return b};a.prototype.serialize=function(a){b.serializeList(a,this.displayObjects);return a};a.prototype._deserializeObjects=function(a){for(var b=a.readInt32(),b=Array(b),c=new Map,e=0;e<b.length;++e){var f=h.deserialize(a);b[e]=f;c.set(f.id,f)}this.displayObjects=b;this._displayList=null;this._displayObjectRegistry=c};a.deserialize=function(b){var c=new a;c._deserializeObjects(b);return c};return a}();a.default=e})},"esri/views/2d/engine/webgl/WGLDisplayList":function(){define(["require","exports",
"../../../../core/tsSupport/generatorHelper","../../../../core/Logger","./enums"],function(e,a,c,h,b){function g(a,b,c){for(var d=[],e=3;e<arguments.length;e++)d[e-3]=arguments[e];b<a.length?a.splice.apply(a,[b,c].concat(d)):a.push.apply(a,d)}var m=h.getLogger("esri.views.2d.engine.webgl.WGLDisplayList");e=new Map;e.set(b.WGLDrawPhase.MAP,[b.WGLGeometryType.FILL,b.WGLGeometryType.LINE,b.WGLGeometryType.MARKER,b.WGLGeometryType.TEXT]);e.set(b.WGLDrawPhase.LABEL,[b.WGLGeometryType.LABEL]);e.set(b.WGLDrawPhase.LABEL_ALPHA,
[b.WGLGeometryType.LABEL]);e=function(){function a(a){void 0===a&&(a=!1);this.symbolLevels=[];this.unified=a}a.prototype.replay=function(a,b,c){if(this.unified)for(var d=0,e=this.symbolLevels;d<e.length;d++)for(var f=0,g=e[d].zLevels;f<g.length;f++){var h=g[f].geometryDPInfo,l;for(l in h)if(h[l])for(var m=0,u=h[l];m<u.length;m++){var v=u[m],x=a.painter.getGeometryBrush(v.geometryType),z=b.getGeometry(v.geometryType);x.prepareState(a,b);x.drawGeometry(a,b,v,z,c)}}};Object.defineProperty(a.prototype,
"empty",{get:function(){return!this.symbolLevels||0===this.symbolLevels.length},enumerable:!0,configurable:!0});a.prototype.clear=function(){this.symbolLevels.length=0};a.prototype.addToList=function(a,b){if(Array.isArray(a))for(var c=0;c<a.length;c++)this._addToList(a[c],b);else this._addToList(a,b)};a.prototype.removeFromList=function(a){Array.isArray(a)||(a=[a]);for(var b=null,c=0;c<a.length;c++)b=this._removeFromList(a[c]);return b};a.prototype.byType=function(a,b){for(var c=0,d=this.symbolLevels;c<
d.length;c++)for(var e=0,f=d[c].zLevels;e<f.length;e++){var g=f[e].geometryDPInfo,h=this.getDPInfoType(a);if(g[h])for(var l=0,g=g[h];l<g.length;l++)b(g[l])}};a.prototype.clone=function(){for(var b=new a(this.unified),c=0,d=this.symbolLevels;c<d.length;c++)b.symbolLevels.push(d[c].clone());return b};a.prototype.splitAfter=function(a){for(var b=this._getDisplayList(a.symbolLevel,a.zOrder,a.geometryType),c=b.length,d=a.indexFrom+a.indexCount,e=0;e<c;++e){var g=b[e];if(g.geometryType===a.geometryType&&
d>g.indexFrom&&d<=g.indexFrom+g.indexCount)return d<g.indexFrom+g.indexCount&&(a=new f,a.geometryType=g.geometryType,a.materialKey=g.materialKey,a.indexFrom=d,a.indexCount=g.indexFrom+g.indexCount-d,b.splice(e+1,0,a),g.indexCount=d-g.indexFrom),e}};a.prototype._addToList=function(a,b){var c=this._getDisplayList(a.symbolLevel,a.zOrder,a.geometryType);b=null!=b?b:c.length-1;var d=0<=b&&b<c.length?c[b]:null;null===d||d.materialKey!==a.materialKey||d.indexFrom+d.indexCount!==a.indexFrom||this.unified&&
d.geometryType!==a.geometryType?(d=new f,d.indexFrom=a.indexFrom,d.indexCount=a.indexCount,d.materialKey=a.materialKey,d.geometryType=a.geometryType,g(c,b+1,0,d)):d.indexCount+=a.indexCount};a.prototype._removeFromList=function(a){for(var b=this._getDisplayList(a.symbolLevel,a.zOrder,a.geometryType),c=b.length,d=void 0,e=0;e<c;++e){var h=b[e];if(a.indexFrom+a.indexCount>h.indexFrom&&a.indexFrom<h.indexFrom+h.indexCount&&(!this.unified||h.geometryType===a.geometryType)){d=e;break}}if(void 0!==d){h=
b[d];if(a.indexFrom===h.indexFrom)return h.indexCount-=a.indexCount,h.indexFrom+=a.indexCount,0===h.indexCount&&g(b,d,1),d-1;if(a.indexFrom+a.indexCount===h.indexFrom+h.indexCount)return h.indexCount-=a.indexCount,0===h.indexCount?(g(b,d,1),d-1):d;var c=h.indexFrom,e=a.indexFrom-h.indexFrom,l=a.indexCount;a=h.indexFrom+h.indexCount-(a.indexFrom+a.indexCount);h.indexCount=e;var k=new f;k.geometryType=h.geometryType;k.materialKey=h.materialKey;k.indexFrom=c+e+l;k.indexCount=a;g(b,d+1,0,k);return d}return null};
a.prototype._getDisplayList=function(a,c,e){for(var f,g=this.symbolLevels.length,h=0;h<g;h++)if(this.symbolLevels[h].symbolLevel===a){f=this.symbolLevels[h];break}f||(f=new z,f.symbolLevel=a,this.symbolLevels.push(f));var m;a=f.zLevels.length;for(g=0;g<a;g++)if(f.zLevels[g].zLevel===c){m=f.zLevels[g];break}m||(m=new l,m.geometryDPInfo=new d,m.zLevel=c,f.zLevels.push(m));var k;if(this.unified)m.geometryDPInfo.unified||(m.geometryDPInfo.unified=[]),k=m.geometryDPInfo.unified;else switch(e){case b.WGLGeometryType.FILL:m.geometryDPInfo.fill||
(m.geometryDPInfo.fill=[]);k=m.geometryDPInfo.fill;break;case b.WGLGeometryType.LINE:m.geometryDPInfo.line||(m.geometryDPInfo.line=[]);k=m.geometryDPInfo.line;break;case b.WGLGeometryType.MARKER:m.geometryDPInfo.marker||(m.geometryDPInfo.marker=[]);k=m.geometryDPInfo.marker;break;case b.WGLGeometryType.TEXT:m.geometryDPInfo.text||(m.geometryDPInfo.text=[]);k=m.geometryDPInfo.text;break;case b.WGLGeometryType.LABEL:m.geometryDPInfo.label||(m.geometryDPInfo.label=[]);k=m.geometryDPInfo.label;break;
default:console.error("Trying to add a record with geometry type '"+e+"'.")}return k};a.prototype.getDPInfoType=function(a){if(this.unified)return"unified";switch(a){case b.WGLGeometryType.FILL:return"fill";case b.WGLGeometryType.LINE:return"line";case b.WGLGeometryType.MARKER:return"marker";case b.WGLGeometryType.TEXT:return"text";case b.WGLGeometryType.LABEL:return"label";default:m.error("DisplayList: Tried to convert unknown geometryType: "+a)}};return a}();var f=function(){function a(){this.materialKey=
null;this.indexCount=this.indexFrom=0}a.prototype.clone=function(){var b=new a;b.geometryType=this.geometryType;b.materialKey=this.materialKey;b.indexFrom=this.indexFrom;b.indexCount=this.indexCount;return b};return a}(),d=function(){function a(){this.unified=this.label=this.text=this.marker=this.line=this.fill=null}a.prototype.clone=function(){var b=new a;b.fill=this.fill&&this.fill.map(function(a){return a.clone()});b.line=this.line&&this.line.map(function(a){return a.clone()});b.marker=this.marker&&
this.marker.map(function(a){return a.clone()});b.text=this.text&&this.text.map(function(a){return a.clone()});b.label=this.label&&this.label.map(function(a){return a.clone()});b.unified=this.unified&&this.unified.map(function(a){return a.clone()});return b};return a}(),l=function(){function a(){this.geometryDPInfo=new d}a.prototype.clone=function(){var b=new a;b.zLevel=this.zLevel;b.geometryDPInfo=this.geometryDPInfo.clone();return b};return a}(),z=function(){function a(){this.zLevels=[]}a.prototype.clone=
function(){var b=new a;b.symbolLevel=this.symbolLevel;for(var c=0,d=this.zLevels;c<d.length;c++)b.zLevels.push(d[c].clone());return b};return a}();return e})},"esri/views/2d/engine/webgl/util/Reader":function(){define(["require","exports"],function(e,a){Object.defineProperty(a,"__esModule",{value:!0});e=function(){function a(a){this._pos=0;this._buffer=a;this._i32View=new Int32Array(this._buffer);this._f32View=new Float32Array(this._buffer)}a.prototype.readInt32=function(){return this._i32View[this._pos++]};
a.prototype.readF32=function(){return this._f32View[this._pos++]};return a}();a.default=e})},"esri/views/2d/engine/webgl/WGLRendererInfo":function(){define("require exports ../../../../core/tsSupport/assignHelper ../../../../Color ../../../../core/has ../../../../core/maybe ../../../../core/screenUtils ../../../../core/unitUtils ../../../../core/libs/gl-matrix-2/mat4f32 ../../../../renderers/support/utils ./definitions ./Utils".split(" "),function(e,a,c,h,b,g,m,f,d,l,z,v){function A(a,b){var c=b.length;
if(a<b[0].value||1===c)return b[0].size;for(var d=1;d<c;d++)if(a<b[d].value)return b[d-1].size+(a-b[d-1].value)/(b[d].value-b[d-1].value)*(b[d].size-b[d-1].size);return b[c-1].size}function x(a,b,c){void 0===c&&(c=0);if(g.isNone(b))a[c+0]=0,a[c+1]=0,a[c+2]=0,a[c+3]=0;else{var d=b.g,e=b.b,f=b.a;a[c+0]=b.r*f/255;a[c+1]=d*f/255;a[c+2]=e*f/255;a[c+3]=f}}Object.defineProperty(a,"__esModule",{value:!0});var u=function(a,b,c){for(var d=c*=16,e=0;d<Math.min(c+16,a.length);d++,e++)a[d]=b[e]},q=d.mat4f32.create();
e=function(){function a(){this.symbolLevels=[];this.vvColorValues=new Float32Array(8);this.vvColors=new Float32Array(32);this.vvOpacityValues=new Float32Array(8);this.vvOpacities=new Float32Array(8);this.vvSizeMinMaxValue=new Float32Array(4);this.ddColors=new Float32Array(32);this.ddBackgroundColor=new Float32Array(4);this.ddActiveDots=new Float32Array(8);this.insideEffect=new Float32Array(16*z.MAX_FILTERS);this.insideOpacity=1;this.outsideEffect=new Float32Array(16*z.MAX_FILTERS);this.outsideOpacity=
1;this.effectCount=0;this._vvMaterialParameters={vvSizeEnabled:!1,vvColorEnabled:!1,vvRotationEnabled:!1,vvRotationType:"geographic",vvOpacityEnabled:!1};this._buf0=new Float32Array(2);this._buf1=new Float32Array(2);this.symbolLevels.push(0);for(var a=0;a<z.MAX_FILTERS;a++)u(this.insideEffect,q,a),u(this.outsideEffect,q,a)}Object.defineProperty(a.prototype,"insideOpacities",{get:function(){this._buf0[0]=1;this._buf0[1]=this.insideOpacity;return this._buf0},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"outsideOpacities",{get:function(){this._buf1[0]=0;this._buf1[1]=this.outsideOpacity;return this._buf1},enumerable:!0,configurable:!0});a.prototype.getSizeVVFieldStops=function(a){var b=this._vvSizeFieldStops;switch(b.type){case "static":return b;case "level-dependent":return g.unwrapOr(b.levels[a],function(){var c=Infinity,d=0,e;for(e in b.levels){var f=parseFloat(e),h=Math.abs(a-f);h<c&&(c=h,d=f)}if(Infinity===c)return{sizes:new Float32Array([0,0,0,0,0,0]),values:new Float32Array([0,0,0,0,0,0])};
c=Math.pow(2,(a-d)/2);d=g.expect(b.levels[d]);e=new Float32Array(d.values);e[2]*=c;e[3]*=c;return{sizes:g.unwrap(d.sizes),values:e}})}};Object.defineProperty(a.prototype,"vvMaterialParameters",{get:function(){return this._vvMaterialParameters},enumerable:!0,configurable:!0});a.prototype.update=function(a){g.isSome(this._vvInfo)&&this._updateVisualVariables(this._vvInfo.vvRanges,a)};a.prototype.setInfo=function(a,b,c){var d=this;g.isSome(c)?(c.forEach(function(a,b){return d._updateEffects(b,a)}),this.effectCount=
c.length):this.effectCount=0;this._vvInfo=b;switch(a.type){case "dot-density":this._updateDotDensityInfo(a)}};a.prototype.getVariation=function(){return{ddDotBlending:this.ddDotBlending,outsideLabelsVisible:this.outsideLabelsVisible,effectCount:this.effectCount,oesTextureFloat:b("esri-webgl-texture-float")}};a.prototype.getVariationHash=function(){return(this.ddDotBlending?1:0)|(this.outsideLabelsVisible?1:0)<<1|this.effectCount<<2};a.prototype._updateEffects=function(a,b){a+=1;if(g.isSome(b)&&b.filter&&
b.filter.enabled){this.outsideLabelsVisible=b.excludedLabelsVisible;var c=b.parsedIncludedEffect;b=b.parsedExcludedEffect;g.isSome(c)?(u(this.insideEffect,c.getColorMatrix(),a),this.insideOpacity=c.getOpacity()):(u(this.insideEffect,q,a),this.insideOpacity=1);g.isSome(b)?(u(this.outsideEffect,b.getColorMatrix(),a),this.outsideOpacity=b.getOpacity()):(u(this.outsideEffect,q,a),this.outsideOpacity=1)}else u(this.insideEffect,q,a),u(this.outsideEffect,q,a),this.outsideOpacity=this.insideOpacity=1};a.prototype._updateVisualVariables=
function(a,b){var c=this._vvMaterialParameters;c.vvOpacityEnabled=!1;c.vvSizeEnabled=!1;c.vvColorEnabled=!1;c.vvRotationEnabled=!1;if(a){var d=a.size;if(d){c.vvSizeEnabled=!0;if(d.minMaxValue){var e=d.minMaxValue,g=void 0,h=void 0;v.isDefined(e.minSize)&&v.isDefined(e.maxSize)&&(v.isNumber(e.minSize)&&v.isNumber(e.maxSize)?(g=m.pt2px(e.minSize),h=m.pt2px(e.maxSize)):(h=b.scale,g=m.pt2px(A(h,e.minSize.stops)),h=m.pt2px(A(h,e.maxSize.stops))));this.vvSizeMinMaxValue.set([e.minDataValue,e.maxDataValue,
g,h])}d.scaleStops&&(this.vvSizeScaleStopsValue=m.pt2px(A(b.scale,d.scaleStops.stops)));d.unitValue&&(this.vvSizeUnitValueToPixelsRatio=f.getMetersPerUnitForSR(b.spatialReference)/l.meterIn[d.unitValue.unit]/b.resolution);d.fieldStops&&(this._vvSizeFieldStops=d.fieldStops)}if(b=a.color)c.vvColorEnabled=!0,this.vvColorValues.set(b.values),this.vvColors.set(b.colors);if(b=a.opacity)c.vvOpacityEnabled=!0,this.vvOpacityValues.set(b.values),this.vvOpacities.set(b.opacities);if(a=a.rotation)c.vvRotationEnabled=
!0,c.vvRotationType=a.type}};a.prototype._updateDotDensityInfo=function(a){var b=a.attributes;this.ddDotValue=a.dotValue;this.ddDotScale=a.referenceScale;this.ddDotSize=a.dotSize;this.ddDotBlending=a.dotBlendingEnabled;this.ddSeed=a.seed;for(var c=0;c<z.DOT_DENSITY_MAX_FIELDS;c++){var d=c>=b.length?new h([0,0,0,0]):b[c].color;x(this.ddColors,d,4*c)}for(c=0;8>c;c++)this.ddActiveDots[c]=c<a.attributes.length?1:0;x(this.ddBackgroundColor,a.backgroundColor)};return a}();a.WGLRendererInfo=e})},"esri/views/2d/engine/webgl/WGLTile":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/libs/gl-matrix-2/mat2d ../../../../core/libs/gl-matrix-2/mat2df32 ../../../../core/libs/gl-matrix-2/vec2 ../../../../core/libs/gl-matrix-2/vec2f32 ./definitions ./DirtyMap ./DisplayRecordStore ./Fader ./TiledDisplayObject ./WGLBuffers".split(" "),
function(e,a,c,h,b,g,m,f,d,l,z,v,A){Object.defineProperty(a,"__esModule",{value:!0});var x=new Set;e=function(a){function e(c,e,g){void 0===g&&(g=!1);c=a.call(this,c,e,[f.TILE_SIZE,f.TILE_SIZE])||this;c._data=null;c._displayList=null;c._wglBuffers=null;c._dirtyMap=new d.default;c._labelIndex=null;c._dirty=!0;c.fader=new z.default;c._ensureCorrectZOrder=g;c.transforms.labelMat2d=b.mat2df32.create();return c}c(e,a);e.prototype.destroy=function(){this.clear()};Object.defineProperty(e.prototype,"displayObjects",
{get:function(){return this._data.tileDisplayData.displayObjects},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"canDisplay",{get:function(){return!!this.attached},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"isDirty",{get:function(){return this._dirty},set:function(a){(this._dirty=a)||this.isReady||this.ready();this.requestRender()},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"hasData",{get:function(){return!!this._data},enumerable:!0,
configurable:!0});Object.defineProperty(e.prototype,"labelIndex",{get:function(){return this._labelIndex},enumerable:!0,configurable:!0});e.prototype.getGeometry=function(a){return this._wglBuffers&&this._wglBuffers.has(a)?this._wglBuffers.get(a):null};e.prototype.getDisplayList=function(){return this._data&&this._displayList};Object.defineProperty(e.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0});e.prototype.setTransform=function(b,c){a.prototype.setTransform.call(this,
b,c);var d=this.transforms.labelMat2d;c=b.getScreenTransform(d,c);var e=m.vec2f32.create();g.vec2.transformMat2d(e,this.coords,c);h.mat2d.identity(d);h.mat2d.translate(d,d,e);h.mat2d.multiply(d,b.viewMat2d,d)};e.prototype.setData=function(a,b,c){var e=a.addOrUpdate,f=a.remove;!a.clear&&this.hasData||a.addOrUpdate?!a.clear&&this.hasData||!a.addOrUpdate?this.hasData&&this._doPatchData({addOrUpdate:e,remove:f},b,c):(e.tileDisplayData.computeDisplayList(this._ensureCorrectZOrder),this._dirtyMap=new d.default,
this._dispRecStore=l.default.fromTileData(e,this._dirtyMap),this._data=e,this._readyTileIfNoLabels(b,c),this._dirtyMap.markAllDirty(),this._displayList||(this._displayList=e.tileDisplayData.displayList.clone())):(this.clear(),this.ready());this.emit("change")};e.prototype.commitChanges=function(){this.fader.step()||this.requestRender();this._wglBuffers||(this._wglBuffers=new A.default(this.stage.context));this._wglBuffers.upload(this._data.tileBufferData,this._dirtyMap);this._displayList=this._data.tileDisplayData.displayList.clone();
this._dirtyMap.markAllClean()};e.prototype.clear=function(){this._dispRecStore=this._displayList=this._data=null;this._wglBuffers&&(this._wglBuffers.dispose(),this._wglBuffers=null)};e.prototype.attach=function(){return!0};e.prototype._readyTileIfNoLabels=function(a,b){a&&this._rebuildLabelIndex();this.isDirty=a&&b?!0:!1};e.prototype._doPatchData=function(a,b,c){this._patchData(a)||(this._dirtyMap.markAllDirty(),this._data.reshuffle(),this._dispRecStore=l.default.fromTileData(this._data,this._dirtyMap));
this._readyTileIfNoLabels(b,c);this.requestRender()};e.prototype._rebuildLabelIndex=function(){this._labelIndex=this._initLabelIndex();for(var a=0,b=this.displayObjects;a<b.length;a++)for(var c=0,d=b[a].metrics;c<d.length;c++)this._insertIntoLabelIndex(d[c])};e.prototype._insertIntoLabelIndex=function(a){-1!==a.xBucket&&this.labelIndex[a.yBucket][a.xBucket].push(a)};e.prototype._initLabelIndex=function(){for(var a=[],b=0;b<f.TILE_SIZE/f.COLLISION_BUCKET_SIZE;b++){a.push([]);for(var c=0;c<f.TILE_SIZE/
f.COLLISION_BUCKET_SIZE;c++)a[b].push([])}return a};e.prototype._patchData=function(a){for(var b=!0,c=a.addOrUpdate&&a.addOrUpdate.tileDisplayData&&a.addOrUpdate.tileDisplayData.displayObjects||[],d=(a.remove||[]).slice(),e=0;e<c.length;e++){var f=c[e];null!=f.insertAfter&&d.push(f.id)}for(f=0;f<d.length;f++){var g=d[f];if(e=this._data.tileDisplayData.displayObjectRegistry.get(g)){this._data.tileDisplayData.displayList.removeFromList(e.displayRecords);for(var h=0,l=e.displayRecords;h<l.length;h++)this._dispRecStore.delete(l[h]);
this._data.tileDisplayData.displayObjectRegistry.delete(g);e=this._data.tileDisplayData.displayObjects.indexOf(e);this._data.tileDisplayData.displayObjects.splice(e,1)}}for(d=0;d<c.length;d++){f=c[d];e=this._data.tileDisplayData.displayObjectRegistry.get(f.id);g=void 0;if(e){h=e.displayRecords;e.set(f);e.displayRecords=h;h=e.displayRecords.length;for(l=0;l<h;++l){var m=e.displayRecords[l],n=f.displayRecords[l];if(l>=f.displayRecords.length||m.geometryType!==n.geometryType||m.symbolLevel!==n.symbolLevel||
m.zOrder!==n.zOrder||m.materialKey!==n.materialKey)this._dispRecStore.delete(e.displayRecords[l]),l<f.displayRecords.length&&(e.displayRecords[l]=void 0)}e.displayRecords.length=f.displayRecords.length;e.metrics=f.metrics}else if(e=f.copy(),e.displayRecords=[],this._data.tileDisplayData.displayObjectRegistry.set(f.id,e),l=void 0,m=this._data.tileDisplayData.displayObjects,null!=e.insertAfter?(g={},0<=e.insertAfter?(h=this._data.tileDisplayData.displayObjectRegistry.get(e.insertAfter))?(l=m.indexOf(h)+
1,l<m.length?m.splice(l,0,e):(m.push(e),l=m.length)):(m.push(e),l=m.length):(m.unshift(e),l=0)):(m.push(e),l=m.length),g){n=void 0;if(this._data.tileDisplayData.displayList.unified)n=0<f.displayRecords.length?1:0;else{x.clear();for(var n=0,q=f.displayRecords;n<q.length;n++)h=this._data.tileDisplayData.displayList.getDPInfoType(q[n].geometryType),x.add(h);n=x.size}q=0;for(--l;0<=l&&q<n;--l)for(var u=m[l].displayRecords.length-1;0<=u&&q<n;--u){var v=m[l].displayRecords[u],h=this._data.tileDisplayData.displayList.getDPInfoType(v.geometryType);
g[h]||(g[h]=v,++q)}}q=f.displayRecords.length;for(l=0;l<q;++l){n=f.displayRecords[l];(m=e.displayRecords[l])?(m.meshData=n.meshData,m.materialKey=n.materialKey):(m=n.copy(),m.vertexFrom=void 0,m.indexFrom=void 0,e.displayRecords[l]=m);var u=n.geometryType,h=this._data.tileDisplayData.displayList.getDPInfoType(u),v=a.addOrUpdate.tileBufferData.geometries[u],u=v.vertexBuffer,v=v.indexBuffer,z=void 0;g&&(z=g[h]?this._data.tileDisplayData.displayList.splitAfter(g[h]):-1);b=this._dispRecStore.setMeshData(m,
n,u,v,z)&&b;g&&null!=m.indexFrom&&null!=m.indexFrom&&(g[h]=m)}}return b};return e}(v.TiledDisplayObject);a.WGLTile=e})},"esri/views/2d/engine/webgl/DirtyMap":function(){define(["require","exports","./Utils"],function(e,a,c){function h(a,c,e){if(!a.allDirty)if(null!=a.from&&null!=a.count){var b=Math.min(a.from,c);c=Math.max(a.from+a.count,c+e)-b;a.from=b;a.count=c}else a.from=c,a.count=e}Object.defineProperty(a,"__esModule",{value:!0});e=function(){function a(){this._dirties=c.createGeometryData(function(){return{indices:{from:null,
count:null,allDirty:!1}}},function(){return{vertices:{from:null,count:null,allDirty:!1}}})}a.prototype.hasDirty=function(){for(var a=0,b=this._dirties;a<b.length;a++){var c=b[a];if(null!==c.data.indices.count||c.data.indices.allDirty)return!0}return!1};a.prototype.markAllClean=function(){for(var a=0,b=this._dirties;a<b.length;a++){var c=b[a];c.data.indices.from=null;c.data.indices.count=null;c.data.indices.allDirty=!1;for(var d in c.buffers)c.buffers[d].data.vertices.from=null,c.buffers[d].data.vertices.count=
null,c.buffers[d].data.vertices.allDirty=!1}};a.prototype.markAllDirty=function(){for(var a=0,b=this._dirties;a<b.length;a++){var c=b[a];c.data.indices.allDirty=!0;for(var d in c.buffers)c.buffers[d].data.vertices.allDirty=!0}};a.prototype.forEach=function(a){for(var b=0;b<this._dirties.length;++b){var c=this._dirties[b],d={},e;for(e in c.buffers){var g=c.buffers[e].data.vertices;if(g.allDirty||null!=g.from&&null!=g.count&&0<g.count)d[e]=g}c=c.data.indices;g=void 0;g=c.allDirty||null!=c.from&&null!=
c.count&&0<c.count?{indices:c,vertices:d}:{indices:null,vertices:d};(g.indices||0<Object.keys(g).length)&&a(g,b)}};a.prototype.markDirtyIndices=function(a,b,c){h(this._dirties[a].data.indices,b,c)};a.prototype.markDirtyVertices=function(a,b,c,d){h(this._dirties[a].buffers[b].data.vertices,c,d)};return a}();a.default=e})},"esri/views/2d/engine/webgl/DisplayRecordStore":function(){define(["require","exports","../../../../core/has","./FreeList","./Utils"],function(e,a,c,h,b){function g(a){a=a.getStrides();
for(var b={},c=0;c<a.length;c++)b[m[c]]=a[c];return b}Object.defineProperty(a,"__esModule",{value:!0});var m=["FILL","LINE","MARKER","TEXT","LABEL"];e=function(){function a(a,c,e,f){this._strides=a;this._displayList=c;this._freeListsAndStorage={};this._dirtyMap=null;this._dirtyMap=e;for(var d in a){this._freeListsAndStorage[d]={vtxFreeList:f?new h.FreeList(f):null,idxFreeList:f?new h.FreeList(f):null,vertexBuffers:{},indexBuffer:f?new Uint32Array(f):null};for(var g in a[d])this._freeListsAndStorage[d].vertexBuffers[g]=
{data:f?b.allocateTypedArrayBuffer(f,a[d][g]):null,stride:a[d][g]}}}a.fromTileData=function(c,e){var d=g(c),f=[0,0,0,0,0],l=[0,0,0,0,0],x=[];c.tileDisplayData.displayObjectRegistry.forEach(function(a){x.push(a)});for(var u=0;u<x.length;u++)for(var q=0,n=x[u].displayRecords;q<n.length;q++){var p=n[q];f[p.geometryType]=Math.max(f[p.geometryType],p.vertexFrom+p.vertexCount);l[p.geometryType]=Math.max(l[p.geometryType],p.indexFrom+p.indexCount)}e=new a(d,c.tileDisplayData.displayList,e,null);for(d=0;d<
c.tileBufferData.geometries.length;++d){var u=f[d],n=l[d],p=c.tileBufferData.geometries[d],q=e._storageFor(m[d]),y=c.tileBufferData.geometries[d].indexBuffer;q.indexBuffer=y;q.idxFreeList=new h.FreeList(y.length);q.idxFreeList.allocate(n);var n=void 0,k;for(k in p.vertexBuffer)p=c.tileBufferData.geometries[d].vertexBuffer[k],q.vertexBuffers[k].data=p.data,q.vertexBuffers[k].stride=p.stride,y=b.strideToPackingFactor(p.stride),p=p.data.length*y/p.stride,n||(n=p);q.vtxFreeList=new h.FreeList(n);q.vtxFreeList.allocate(u)}return e};
a.prototype.delete=function(a){var b=m[a.geometryType];this._freeVertices(b,a.vertexFrom,a.vertexCount);this._freeIndices(b,a.indexFrom,a.indexCount);this._displayList.removeFromList(a);a.vertexFrom=void 0;a.indexFrom=void 0};a.prototype.setMeshData=function(a,c,e,f,g){var d=m[a.geometryType];a.meshData=null;var h=void 0,l=void 0;void 0===a.vertexFrom?(l=c.vertexCount,h=this._allocateVertices(d,l)):c.vertexCount>a.vertexCount?(this._freeVertices(d,a.vertexFrom,a.vertexCount),l=c.vertexCount,h=this._allocateVertices(d,
l)):c.vertexCount===a.vertexCount?(h=a.vertexFrom,l=a.vertexCount):(this._freeVertices(d,a.vertexFrom+c.vertexCount,a.vertexCount-c.vertexCount),h=a.vertexFrom,l=c.vertexCount);var n=!0,p=void 0,v=void 0,k=void 0;void 0===a.indexFrom?(p=g,k=c.indexCount,v=this._allocateIndices(d,k)):c.indexCount>a.indexCount?(p=this._displayList.removeFromList(a),this._freeIndices(d,a.indexFrom,a.indexCount),k=c.indexCount,v=this._allocateIndices(d,k)):c.indexCount===a.indexCount?(n=!1,v=a.indexFrom,k=a.indexCount):
(p=this._displayList.removeFromList(a),this._freeIndices(d,a.indexFrom+c.indexCount,a.indexCount-c.indexCount),v=a.indexFrom,k=c.indexCount);if(-1!==h&&-1!==v){g=this._storageFor(d);b.copyMeshData(h,v,g.vertexBuffers,g.indexBuffer,c,e,f);a.vertexFrom=h;a.indexFrom=v;a.vertexCount=c.vertexCount;a.indexCount=c.indexCount;if(this._dirtyMap){this._dirtyMap.markDirtyIndices(a.geometryType,a.indexFrom,a.indexCount);for(var z in e)this._dirtyMap.markDirtyVertices(a.geometryType,z,a.vertexFrom,a.vertexCount)}n&&
this._displayList.addToList(a,p);return!0}-1!==h&&this._freeVertices(d,h,l);-1!==v&&this._freeIndices(d,v,k);a.setMeshDataFromBuffers(c,e,f);a.vertexFrom=void 0;a.vertexCount=0;a.indexFrom=void 0;a.indexCount=0;return!1};a.prototype._allocateVertices=function(a,b){a=this._storageFor(a);b=a.vtxFreeList.allocate(b);return-1===b||.5<a.vtxFreeList.fragmentation?-1:b};a.prototype._freeVertices=function(a,b,c){this._storageFor(a).vtxFreeList.free(b,c)};a.prototype._freeIndices=function(a,b,c){this._storageFor(a).idxFreeList.free(b,
c)};a.prototype._allocateIndices=function(a,b){a=this._storageFor(a);b=a.idxFreeList.allocate(b);return-1===b||.5<a.idxFreeList.fragmentation?-1:b};a.prototype._storageFor=function(a){return this._freeListsAndStorage[a]};a.prototype._stridesFor=function(a,b){return this._strides[a][b]};return a}();a.default=e})},"esri/views/2d/engine/webgl/FreeList":function(){define(["require","exports"],function(e,a){Object.defineProperty(a,"__esModule",{value:!0});var c=function(){function a(a){this._largestRange=
null;this._parent=a;this._updateLargestRange()}Object.defineProperty(a.prototype,"largestRange",{get:function(){return this._largestRange},enumerable:!0,configurable:!0});a.prototype.rangeCreated=function(a){if(!this._largestRange||a.count>this._largestRange.count)this._largestRange=a};a.prototype.rangeResized=function(a,c){if(a===this._largestRange)a.count<c&&this._updateLargestRange();else if(!this._largestRange||a.count>this._largestRange.count)this._largestRange=a};a.prototype.findBestRange=function(a){for(var b=
this._parent._freeHead,c=null;null!==b;)b.count>=a&&(!c||b.count-a<c.count-a)&&(c=b),b=b.next;return c};a.prototype.findAdjacentRanges=function(a,c){for(var b=!0,e=!1,d=null,g=this._parent._freeHead;b&&!e;){var h=null!==g?g.from:this._parent._size;a>=(null!==d?d.from+d.count:0)&&a+c<=h?(b=!1,e=!0):null!==g?(d=g,g=g.next):b=!1}return[d,g]};a.prototype._updateLargestRange=function(){for(var a=null,c=this._parent._freeHead;null!==c;){if(!a||c.count>a.count)a=c;c=c.next}this._largestRange=a};return a}();
e=function(){function a(a,e){this._allocated=0;this._size=a;this._freeHead=0<a?{from:0,count:a,prev:null,next:null}:null;this._bookKeeper=e||new c(this);this._freeHead&&this._bookKeeper.rangeCreated(this._freeHead)}a.prototype.allocate=function(b){var c=this._bookKeeper.findBestRange(b);if(null===c)return-1;var e=c.from,f=c.count;c.from+=b;c.count-=b;this._bookKeeper.rangeResized(c,e,f);this._allocated+=b;0===c.count&&(b=null!==c.prev?this._freeHead:c.next,a._removeRange(c),this._freeHead=b);return e};
a.prototype.free=function(b,c){var e=this._bookKeeper.findAdjacentRanges(b,c),f=e[0],e=e[1];b={from:b,count:c,prev:f,next:e};null!==f&&(f.next=b);null!==e&&(e.prev=b);this._bookKeeper.rangeCreated(b);this._allocated-=c;if(null!==e&&b.from+b.count===e.from){c=b.from;var d=b.count;a._fuse(b,e);a._removeRange(e);this._bookKeeper.rangeResized(b,c,d);this._bookKeeper.rangeResized(e,void 0,0)}null!==f&&f.from+f.count===b.from&&(c=f.from,d=f.count,a._fuse(f,b),a._removeRange(b),this._bookKeeper.rangeResized(f,
c,d),this._bookKeeper.rangeResized(b,void 0,0));this._freeHead=null!==b.prev?this._freeHead:b};Object.defineProperty(a.prototype,"fragmentation",{get:function(){var a=this._size-this._allocated;return 0===a?0:1-this._bookKeeper.largestRange.count/a},enumerable:!0,configurable:!0});a._removeRange=function(a){null!==a.prev?null!==a.next?(a.prev.next=a.next,a.next.prev=a.prev):a.prev.next=null:null!==a.next&&(a.next.prev=null)};a._fuse=function(a,c){a.count+=c.count;a.next=c.next;c.from+=c.count;c.count=
0;null!==c.next&&(c.next.prev=a)};return a}();a.FreeList=e})},"esri/views/2d/engine/webgl/Fader":function(){define(["require","exports"],function(e,a){Object.defineProperty(a,"__esModule",{value:!0});e=function(){function a(a){void 0===a&&(a=400);this.duration=a;this._value=this._elapsed=this._lastTime=0;this._finished=!1}Object.defineProperty(a.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0});a.prototype.reset=function(){this._value=this._elapsed=this._lastTime=
0};a.prototype.step=function(){var a=performance.now();if(0===this._lastTime)return this._lastTime=a,this._value=0,!0;if(this._elapsed>=this.duration)return!0;this._elapsed+=a-this._lastTime;this._lastTime=a;this._value=Math.min(this._elapsed/this.duration,1);return!1};return a}();a.default=e})},"esri/views/2d/engine/webgl/WGLBuffers":function(){define(["require","exports","../../../webgl","./Utils"],function(e,a,c,h){Object.defineProperty(a,"__esModule",{value:!0});e=function(){function a(a){this.geometryMap=
h.createGeometryData(function(){return{indexBuffer:c.BufferObject.createIndex(a,35044),vao:null}},function(b,e){return{vertexBuffer:c.BufferObject.createVertex(a,h.C_VBO_INFO[e])}})}a.prototype.dispose=function(){for(var a=0;5>a;a++){var b=this.geometryMap[a];if(b){b.data.vao&&b.data.vao.dispose(!1);b.data.indexBuffer&&b.data.indexBuffer.dispose();for(var c in b.buffers)b.buffers[c]&&b.buffers[c].data.vertexBuffer.dispose()}}};a.prototype.get=function(a){var b=this.geometryMap[a];a={};for(var c in b.buffers)a[c]=
b.buffers[c].data.vertexBuffer;return{indexBuffer:b.data.indexBuffer,get vao(){return b.data.vao},set vao(a){b.data.vao=a},vertexBufferMap:a}};a.prototype.has=function(a){return null!=this.geometryMap[a]};a.prototype.upload=function(a,b){var c=this;b.forEach(function(b,e){c._upload(b,e,a)})};a.prototype._upload=function(a,b,c){a.indices&&(a.indices.allDirty?this._uploadIndices(c,b):null!=a.indices.from&&null!=a.indices.count&&this._uploadIndices(c,b,a.indices.from,a.indices.count));if(a.vertices){a=
a.vertices;for(var d in a){var e=a[d];e.allDirty?this._uploadVertices(c,b,d):null!=e.from&&null!=e.count&&this._uploadVertices(c,b,d,e.from,e.count)}}};a.prototype._uploadVertices=function(a,b,c,d,e){var f=this.geometryMap[b];f&&(b=a.geometries[b].vertexBuffer[c])&&(a=b.stride,b=b.data.buffer,f.buffers[c]&&0<b.byteLength&&(null!=d&&null!=e?f.buffers[c].data.vertexBuffer.setSubData(b,d*a,d*a,(d+e)*a):f.buffers[c].data.vertexBuffer.setData(b)))};a.prototype._uploadIndices=function(a,b,c,d){var e=this.geometryMap[b];
e&&(a=a.geometries[b].indexBuffer.buffer,e.data.indexBuffer&&0<a.byteLength&&(null!=c&&null!=d?e.data.indexBuffer.setSubData(a,4*c,4*c,4*(c+d)):e.data.indexBuffer.setData(a)))};return a}();a.default=e})},"esri/views/2d/engine/webgl/shaders/MagnifierPrograms":function(){define(["require","exports","../../../../webgl","./sources/resolver"],function(e,a,c,h){Object.defineProperty(a,"__esModule",{value:!0});a.magnifier={name:"magnifier",shaders:{vertexShader:h.resolveIncludes("magnifier/magnifier.vert"),
fragmentShader:h.resolveIncludes("magnifier/magnifier.frag")},attributes:{a_pos:0}};a.createMagnifierProgram=function(b){return c.createProgram(b,a.magnifier)}})},"esri/views/2d/engine/BitmapTileContainer":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/decorateHelper ../../../geometry/support/aaBoundingRect ../engine ./BitmapTile ./webgl/enums ./webgl/TileContainer".split(" "),function(e,a,c,h,b,g,m,f,d){Object.defineProperty(a,"__esModule",{value:!0});
e=function(a){function d(){return null!==a&&a.apply(this,arguments)||this}c(d,a);d.prototype.createTile=function(a){var c=this._tileInfoView.getTileBounds(b.create(),a);return new m.BitmapTile(a,c,this._tileInfoView.tileInfo.size)};d.prototype.destroyTile=function(){};d.prototype.prepareRenderPasses=function(b){var c=this,d=b.registerRenderPass({name:"bitmap (tile)",brushes:[g.brushes.Bitmap],target:function(){return c.children.map(function(a){return a.bitmap})},drawPhase:f.WGLDrawPhase.MAP});return a.prototype.prepareRenderPasses.call(this,
b).concat([d])};d.prototype.doRender=function(b){this.visible&&b.drawPhase===f.WGLDrawPhase.MAP&&a.prototype.doRender.call(this,b)};return d}(d.default);a.BitmapTileContainer=e})},"esri/views/2d/engine/LevelDependentSizeVariable":function(){define("require exports ../../../core/tsSupport/decorateHelper ../../../core/tsSupport/declareExtendsHelper ../../../core/lang ../../../core/accessorSupport/decorators ../../../renderers/visualVariables/SizeVariable ../../../renderers/visualVariables/support/sizeVariableUtils".split(" "),
function(e,a,c,h,b,g,m,f){Object.defineProperty(a,"__esModule",{value:!0});e=function(a){function d(){return null!==a&&a.apply(this,arguments)||this}h(d,a);e=d;d.prototype.writeLevels=function(a,b,c){for(var d in a){b.stops=this.levels[d];break}};d.prototype.clone=function(){return new e({axis:this.axis,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,maxDataValue:this.maxDataValue,maxSize:f.isSizeVariable(this.maxSize)?this.maxSize.clone():this.maxSize,
minDataValue:this.minDataValue,minSize:f.isSizeVariable(this.minSize)?this.minSize.clone():this.minSize,normalizationField:this.normalizationField,stops:this.stops&&this.stops.map(function(a){return a.clone()}),target:this.target,useSymbolValue:this.useSymbolValue,valueRepresentation:this.valueRepresentation,valueUnit:this.valueUnit,legendOptions:this.legendOptions&&this.legendOptions.clone(),levels:b.clone(this.levels)})};var e;c([g.property()],d.prototype,"levels",void 0);c([g.writer("levels")],
d.prototype,"writeLevels",null);return d=e=c([g.subclass("esri.views.2d.engine.LevelDependentSizeVariable")],d)}(g.declared(m));a.LevelDependentSizeVariable=e})},"*noref":1}});
define("require exports ./engine/Bitmap ./engine/BitmapContainer ./engine/BitmapTile ./engine/Container ./engine/webgl/TileContainer ./engine/DisplayObject ./engine/RasterTile ./engine/RasterTileContainer ./engine/Stage ./engine/webgl/AttributeStoreView ./engine/webgl/collisions/CollisionGrid ./engine/webgl/collisions/CollisionEngine ./engine/webgl/collisions/LayerViewSorter ./engine/webgl/Geometry ./engine/webgl/alignmentUtils ./engine/webgl/color ./engine/webgl/definitions ./engine/webgl/enums ./engine/webgl/fontUtils ./engine/webgl/Utils ./engine/webgl/brushes/BrushBitmap ./engine/webgl/brushes/BrushClip ./engine/webgl/brushes/BrushRasterBitmap ./engine/webgl/brushes/WGLBrushInfo ./engine/webgl/brushes/WGLBrushStencil ./engine/webgl/brushes/WGLBrushVTLBackground ./engine/webgl/brushes/WGLBrushVTLCircle ./engine/webgl/brushes/WGLBrushVTLFill ./engine/webgl/brushes/WGLBrushVTLLine ./engine/webgl/brushes/WGLBrushVTLSymbol ./engine/webgl/brushes/WGLGeometryBrush ./engine/webgl/brushes/WGLGeometryBrushFill ./engine/webgl/brushes/WGLGeometryBrushLabel ./engine/webgl/brushes/WGLGeometryBrushLine ./engine/webgl/brushes/WGLGeometryBrushMarker ./engine/webgl/brushes/WGLGeometryBrushText ./engine/webgl/util/debug ./engine/webgl/TileClipper ./engine/webgl/TurboLine ./engine/webgl/mesh/factories/matcherUtils ./engine/webgl/mesh/factories/WGLMeshFactory ./engine/webgl/mesh/MeshData ./engine/webgl/mesh/templates/WGLTemplateStore ./engine/webgl/Painter ./engine/webgl/TextShaping ./engine/webgl/TextShapingNew ./engine/webgl/TileData ./engine/webgl/util/BidiText ./engine/webgl/util/Matcher ./engine/webgl/util/vvFlagUtils ./engine/webgl/visualVariablesUtils ./engine/webgl/WGLRendererInfo ./engine/webgl/WGLTile ./engine/webgl/BitBlitRenderer ./engine/webgl/shaders/MagnifierPrograms ../../symbols/cim/CIMSymbolHelper ./engine/webgl/Rect ./engine/webgl/mesh/templates/util ./engine/webgl/painter/RenderPass ./engine/webgl/TiledDisplayObject ./engine/BitmapTileContainer ./engine/LevelDependentSizeVariable".split(" "),function(e,
a,c,h,b,g,m,f,d,l,z,v,A,x,u,q,n,p,y,k,C,w,B,E,G,F,M,J,L,K,Q,I,R,O,N,H,U,da,V,Z,W,ga,T,ha,ea,ba,X,ka,aa,ja,ma,na,oa,pa,fa,P,Y,r,ia,la,t,ca,S,D){Object.defineProperty(a,"__esModule",{value:!0});a.Bitmap=c.Bitmap;a.BitmapContainer=h.BitmapContainer;a.BitmapTile=b.BitmapTile;a.Container=g.Container;a.TileContainer=m.default;a.DisplayObject=f.DisplayObject;a.RasterTile=d.RasterTile;a.RasterTileContainer=l.RasterTileContainer;a.Stage=z.Stage;a.AttributeStoreView=v.AttributeStoreView;a.CollisionGrid=A.CollisionGrid;
a.CollisionEngine=x.CollisionEngine;a.LayerViewSorter=u.LayerViewSorter;a.Point=q.Point;a.alignmentUtils=n;a.color=p;a.definitions=y;a.enums=k;a.fontUtils=C;a.Utils=w;a.debug=V;a.TileClipper=Z.TileClipper;a.SimpleBuilder=Z.SimpleBuilder;a.tessellate=W.tessellate;a.TessellationState=W.TessellationState;a.splitVertex=W.splitVertex;a.createMatcher=ga.createMatcher;a.WGLMeshFactory=T.WGLMeshFactory;a.MeshData=ha.MeshData;a.WGLTemplateStore=ea.WGLTemplateStore;a.Painter=ba.default;a.PainterOptions=ba.PainterOptions;
a.TextShaping=X.TextShaping;a.TextShapingNew=ka.TextShaping;a.TileData=aa.TileData;a.bidiText=ja.bidiText;a.FeatureMatcher=ma.FeatureMatcher;a.getVVFlags=na.getVVFlags;a.getTypeOfSizeVisualVariable=oa.getTypeOfSizeVisualVariable;a.WGLRendererInfo=pa.WGLRendererInfo;a.WGLTile=fa.WGLTile;a.BitBlitRenderer=P.BitBlitRenderer;a.createMagnifierProgram=Y.createMagnifierProgram;a.magnifier=Y.magnifier;a.CIMSymbolHelper=r.CIMSymbolHelper;a.Rect=ia.default;a.getLimitCosine=la.getLimitCosine;e=a.brushes||(a.brushes=
{});e.Geometry=R.default;e.Marker=U.default;e.Line=H.default;e.Fill=O.default;e.Text=da.default;e.Label=N.default;e.Clip=E.default;e.Stencil=M.default;e.Bitmap=B.default;e.Raster=G.default;e.TileInfo=F.default;e.VTLBackground=J.WGLBrushVTLBackground;e.VTLFill=K.WGLBrushVTLFill;e.VTLLine=Q.WGLBrushVTLLine;e.VTLCircle=L.WGLBrushVTLCircle;e.VTLSymbol=I.WGLBrushVTLSymbol;a.RenderPass=t.default;a.TiledDisplayObject=ca.TiledDisplayObject;a.BitmapTileContainer=S.BitmapTileContainer;a.LevelDependentSizeVariable=
D.LevelDependentSizeVariable});