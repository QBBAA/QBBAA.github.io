// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.15/esri/copyright.txt for details.
//>>built
require({cache:{"esri/AggregateGraphic":function(){define("require exports ./core/tsSupport/decorateHelper ./core/tsSupport/declareExtendsHelper ./core/tsSupport/assignHelper ./Graphic ./core/accessorSupport/decorators".split(" "),function(y,a,u,m,r,t,q){return function(a){function c(){return null!==a&&a.apply(this,arguments)||this}m(c,a);g=c;c.prototype.getEffectivePopupTemplate=function(a){void 0===a&&(a=!1);return this.popupTemplate?this.popupTemplate:(a=this.sourceLayer&&this.sourceLayer.featureReduction)&&
"popupTemplate"in a?a.popupTemplate:null};c.prototype.getObjectId=function(){return this.objectId};c.prototype.clone=function(){return new g(r({objectId:this.objectId},this.cloneProperties()))};var g;u([q.property({type:Number,json:{read:!0}})],c.prototype,"objectId",void 0);return c=g=u([q.subclass("esri.AggregateGraphic")],c)}(q.declared(t))})},"esri/layers/graphics/data/projectionSupport":function(){define("require exports ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../core/Error ../../../core/promiseUtils ../../../geometry/projection ../../../geometry/support/spatialReferenceUtils ../../../geometry/support/webMercatorUtils".split(" "),
function(y,a,u,m,r,t,q,c,d){function g(a,c){var b;if(!c)return null;if("x"in c){var k={x:0,y:0};a=a(c.x,c.y,e);k.x=a[0];k.y=a[1];null!=c.z&&(k.z=c.z);null!=c.m&&(k.m=c.m);return k}if("xmin"in c)return k={xmin:0,ymin:0,xmax:0,ymax:0},b=a(c.xmin,c.ymin,e),k.xmin=b[0],k.ymin=b[1],a=a(c.xmax,c.ymax,e),k.xmax=a[0],k.ymax=a[1],c.hasZ&&(k.zmin=c.zmin,k.zmax=c.zmax,k.hasZ=!0),c.hasM&&(k.mmin=c.mmin,k.mmax=c.mmax,k.hasM=!0),k;if("rings"in c)return{rings:l(c.rings,a),hasM:c.hasM,hasZ:c.hasZ};if("paths"in c)return{paths:l(c.paths,
a),hasM:c.hasM,hasZ:c.hasZ};if("points"in c)return{points:h(c.points,a),hasM:c.hasM,hasZ:c.hasZ}}function l(a,c){for(var b=[],k=0;k<a.length;k++)b.push(h(a[k],c));return b}function h(a,c){for(var b=[],k=0;k<a.length;k++){var d=a[k],w=c(d[0],d[1],[0,0]);b.push(w);2<d.length&&w.push(d[2]);3<d.length&&w.push(d[3])}return b}function p(a,k){return!c.isValid(a)||!c.isValid(k)||c.equals(a,k)||d.canProject(a,k)?!1:!0}Object.defineProperty(a,"__esModule",{value:!0});var e=[0,0];a.doesBrowserSupportProjection=
function(a,c){return p(a,c)?q.isSupported():!0};a.checkProjectionSupport=function(a,c){return m(this,void 0,void 0,function(){var b,k,d;return u(this,function(w){if(!c)return[2];if(Array.isArray(a)){b=0;for(k=a;b<k.length;b++)if(d=k[b],p(d.geometry&&d.geometry.spatialReference,c)){if(q.isSupported())return[2,q.load()];throw new r("feature-store:unsupported-query","projection not supported",{inSpatialReference:a,outSpatialReference:c});}return[2]}if(!p(a,c))return[2];if(q.isSupported())return[2,q.load()];
throw new r("feature-store:unsupported-query","projection not supported",{inSpatialReference:a,outSpatialReference:c});})})};var E=g.bind(null,d.lngLatToXY),x=g.bind(null,d.xyToLngLat);a.project=function(a,k,b){if(!a)return a;b||(b=k,k=a.spatialReference);return c.isValid(k)&&c.isValid(b)&&!c.equals(k,b)?d.canProject(k,b)?c.isWebMercator(b)?E(a):x(a):q.projectMany([a],k,b,null,!0)[0]:a};var w=new (function(){function a(){this._jobs=[];this._timer=null;this._process=this._process.bind(this)}a.prototype.push=
function(a,b,d){return m(this,void 0,void 0,function(){var k,w=this;return u(this,function(h){a&&a.length&&b&&d&&!c.equals(b,d)||t.resolve(a);k={geometries:a,inSpatialReference:b,outSpatialReference:d,resolve:null};this._jobs.push(k);return[2,t.create(function(b){k.resolve=b;null===w._timer&&(w._timer=setTimeout(w._process,10))},function(){var b=w._jobs.indexOf(k);-1<b&&w._jobs.splice(b,1)})]})})};a.prototype._process=function(){this._timer=null;var a=this._jobs.shift();if(a){var b=a.geometries,w=
a.inSpatialReference,h=a.outSpatialReference,a=a.resolve;d.canProject(w,h)?c.isWebMercator(h)?a(b.map(E)):a(b.map(x)):a(q.projectMany(b,w,h,null,!0));0<this._jobs.length&&(this._timer=setTimeout(this._process,10))}};return a}());a.projectMany=function(a,c,b){return m(this,void 0,void 0,function(){return u(this,function(d){return[2,w.push(a,c,b)]})})}})},"esri/geometry/projection":function(){define("require exports ../core/promiseUtils ./pe ./SpatialReference ./support/GeographicTransformation".split(" "),
function(y,a,u,m,r,t){function q(a,p,e,g,x){void 0===g&&(g=null);void 0===x&&(x=!1);if(null===g){var w=t.cacheKey(p,e);void 0!==l[w]?g=l[w]:(g=c(p,e,null),null===g&&(g=new t),l[w]=g)}return d._project(a,p,e instanceof r||!1===x?e:new r(e),g,x)}function c(a,c,e){void 0===e&&(e=null);a=d._getTransformation(a,c,e);return null!==a?t.fromGE(a):null}Object.defineProperty(a,"__esModule",{value:!0});var d=null;a.isLoaded=function(){return!!d&&m.isLoaded()};a.isSupported=function(){return m.isSupported()};
var g=null;a.load=function(){return g?g:g=u.create(function(a,c){var h=m.load();y(["./geometryEngine"],function(e){d=e;h.then(function(){d._enableProjection(m);a()},function(a){c(a)})})})};a.project=function(a,c,d){void 0===d&&(d=null);return a instanceof Array?0===a.length?[]:q(a,a[0].spatialReference,c,d):q([a],a.spatialReference,c,d)[0]};var l={};a.projectMany=q;a.getTransformation=c;a.getTransformations=function(a,c,e){void 0===e&&(e=null);a=d._getTransformationBySuitability(a,c,e);if(null!==
a){c=[];for(e=0;e<a.length;e++)c.push(t.fromGE(a[e]));return c}return[]}})},"esri/geometry/pe":function(){define(["require","exports","../core/tsSupport/extendsHelper","../core/has","../core/promiseUtils"],function(y,a,u,m,r){function t(c){function d(b,a,c){b[a]=c(b[a])}a._pe=c;h.init();p.init();e.init();E.init();x.init();a.PeGCSExtent=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}u(c,b);c.prototype.destroy=function(){a._pe.destroy(this)};return c}(a._pe.PeGCSExtent);for(var k=
0,b=[a._pe.PeDatum,a._pe.PeGeogcs,a._pe.PeGeogtran,a._pe.PeObject,a._pe.PeParameter,a._pe.PePrimem,a._pe.PeProjcs,a._pe.PeSpheroid,a._pe.PeUnit];k<b.length;k++)c=b[k],d(c.prototype,"getName",function(b){return function(){return b.call(this,Array(h.PE_NAME_MAX))}});k=0;for(b=[a._pe.PeGeogtran,a._pe.PeProjcs];k<b.length;k++)c=b[k],d(c.prototype,"getParameters",function(b){return function(){for(var c=Array(h.PE_PARM_MAX),d=b.call(this),k=0;k<c.length;k++){var w=a._pe.getValue(d,"*");c[k]=w?a._pe.wrapPointer(w,
a._pe.PeParameter):null;d+=Int32Array.BYTES_PER_ELEMENT}return c}});d(a._pe.PeHorizon.prototype,"getCoord",function(b){return function(){var a=this.getSize();if(!a)return null;var c=[],d=b.call(this);g(c,a,d);return c}});d(a._pe.PeGTlistExtendedEntry.prototype,"getEntries",function(b){var c=a._pe._pe_getPeGTlistExtendedGTsSize();return function(){var d=null,k=b.call(this);if(!a._pe.compare(k,a._pe.NULL)){var d=[k],w=this.getSteps();if(1<w)for(var k=a._pe.getPointer(k),h=1;h<w;h++)d.push(a._pe.wrapPointer(k+
c*h,a._pe.PeGTlistExtendedGTs))}return d}});var w=a._pe._pe_getPeHorizonSize();c=function(b){return function(){var c=this._cache;c||(this._cache=c=new Map);if(c.has(b))return c.get(b);var d=null,k=b.call(this);if(!a._pe.compare(k,a._pe.NULL)){var d=[k],h=k.getNump();if(1<h)for(var k=a._pe.getPointer(k),e=1;e<h;e++)d.push(a._pe.wrapPointer(k+w*e,a._pe.PeHorizon))}c.set(b,d);return d}};d(a._pe.PeProjcs.prototype,"horizonGcsGenerate",c);d(a._pe.PeProjcs.prototype,"horizonPcsGenerate",c);a._pe.PeObject.prototype.toString=
function(b){void 0===b&&(b=h.PE_STR_OPTS_NONE);a._pe.ensureCache.prepare();var c=a._pe.getPointer(this),d=a._pe.ensureInt8(Array(h.PE_BUFFER_MAX));return a._pe.UTF8ToString(a._pe._pe_object_to_string_ext(c,b,d))}}function q(c){if(c){var d=a._pe.getClass(c);d&&(d=a._pe.getCache(d))&&(c=a._pe.getPointer(c))&&delete d[c]}}function c(c,d){var k=[];d=Array(d);for(var b=0;b<c;b++)k.push(a._pe.ensureInt8(d));return k}function d(a){var c;Array.isArray(a[0])?(c=[],a.forEach(function(a){c.push(a[0],a[1])})):
c=a;return c}function g(c,d,k,b){void 0===b&&(b=!1);if(b)for(b=0;b<2*d;b++)c[b]=a._pe.getValue(k+b*Float64Array.BYTES_PER_ELEMENT,"double");else{var w=0===c.length;for(b=0;b<d;b++)w&&(c[b]=Array(2)),c[b][0]=a._pe.getValue(k,"double"),c[b][1]=a._pe.getValue(k+Float64Array.BYTES_PER_ELEMENT,"double"),k+=2*Float64Array.BYTES_PER_ELEMENT}}Object.defineProperty(a,"__esModule",{value:!0});var l;a._pe=null;a.isLoaded=function(){return!!a._pe};a.isSupported=function(){return!!m("esri-wasm")};a.load=function(){return l?
l:l=r.create(function(a,c){y(["./support/pe-wasm"],function(d){d({locateFile:function(b){return y.toUrl("./support/"+b)},onAbort:function(b){c(Error(b))}}).then(function(b){t(b);a()})})})};(function(c){function w(b,c,k){a._pe.ensureCache.prepare();var w=d(k),h=k===w,w=a._pe.ensureFloat64(w);(b=a._pe._pe_geog_to_proj(a._pe.getPointer(b),c,w))&&g(k,c,w,h);return b}function k(a,c,d){return b(a,c,d,0)}function b(b,c,k,w){a._pe.ensureCache.prepare();var h=d(k),e=k===h,h=a._pe.ensureFloat64(h);(b=a._pe._pe_proj_to_geog_center(a._pe.getPointer(b),
c,h,w))&&g(k,c,h,e);return b}c.geogToProj=w;c.projGeog=function(b,a,c,d){switch(d){case h.PE_TRANSFORM_P_TO_G:return k(b,a,c);case h.PE_TRANSFORM_G_TO_P:return w(b,a,c)}return 0};c.projToGeog=k;c.projToGeogCenter=b})(a.PeCSTransformations||(a.PeCSTransformations={}));var h;(function(c){c.init=function(){c.PE_BUFFER_MAX=a._pe.PeDefs.prototype.PE_BUFFER_MAX;c.PE_NAME_MAX=a._pe.PeDefs.prototype.PE_NAME_MAX;c.PE_MGRS_MAX=a._pe.PeDefs.prototype.PE_MGRS_MAX;c.PE_USNG_MAX=a._pe.PeDefs.prototype.PE_USNG_MAX;
c.PE_DD_MAX=a._pe.PeDefs.prototype.PE_DD_MAX;c.PE_DDM_MAX=a._pe.PeDefs.prototype.PE_DDM_MAX;c.PE_DMS_MAX=a._pe.PeDefs.prototype.PE_DMS_MAX;c.PE_UTM_MAX=a._pe.PeDefs.prototype.PE_UTM_MAX;c.PE_PARM_MAX=a._pe.PeDefs.prototype.PE_PARM_MAX;c.PE_TYPE_NONE=a._pe.PeDefs.prototype.PE_TYPE_NONE;c.PE_TYPE_GEOGCS=a._pe.PeDefs.prototype.PE_TYPE_GEOGCS;c.PE_TYPE_PROJCS=a._pe.PeDefs.prototype.PE_TYPE_PROJCS;c.PE_TYPE_GEOGTRAN=a._pe.PeDefs.prototype.PE_TYPE_GEOGTRAN;c.PE_TYPE_COORDSYS=a._pe.PeDefs.prototype.PE_TYPE_COORDSYS;
c.PE_TYPE_UNIT=a._pe.PeDefs.prototype.PE_TYPE_UNIT;c.PE_STR_OPTS_NONE=a._pe.PeDefs.prototype.PE_STR_OPTS_NONE;c.PE_STR_AUTH_NONE=a._pe.PeDefs.prototype.PE_STR_AUTH_NONE;c.PE_STR_AUTH_TOP=a._pe.PeDefs.prototype.PE_STR_AUTH_TOP;c.PE_STR_NAME_CANON=a._pe.PeDefs.prototype.PE_STR_NAME_CANON;c.PE_PARM_X0=a._pe.PeDefs.prototype.PE_PARM_X0;c.PE_PARM_ND=a._pe.PeDefs.prototype.PE_PARM_ND;c.PE_TRANSFORM_1_TO_2=a._pe.PeDefs.prototype.PE_TRANSFORM_1_TO_2;c.PE_TRANSFORM_2_TO_1=a._pe.PeDefs.prototype.PE_TRANSFORM_2_TO_1;
c.PE_TRANSFORM_P_TO_G=a._pe.PeDefs.prototype.PE_TRANSFORM_P_TO_G;c.PE_TRANSFORM_G_TO_P=a._pe.PeDefs.prototype.PE_TRANSFORM_G_TO_P;c.PE_HORIZON_RECT=a._pe.PeDefs.prototype.PE_HORIZON_RECT;c.PE_HORIZON_POLY=a._pe.PeDefs.prototype.PE_HORIZON_POLY;c.PE_HORIZON_LINE=a._pe.PeDefs.prototype.PE_HORIZON_LINE;c.PE_HORIZON_DELTA=a._pe.PeDefs.prototype.PE_HORIZON_DELTA}})(h=a.PeDefs||(a.PeDefs={}));(function(c){function d(c,d){var h=null,e=b[c];e||(e={},b[c]=e);e.hasOwnProperty(String(d))?h=e[d]:(c=a._pe.PeFactory.prototype.factoryByType(c,
d),a._pe.compare(c,a._pe.NULL)||(h=c,e[d]=h));return h=k(h)}function k(b){if(b){var c=b.getType();switch(c){case h.PE_TYPE_GEOGCS:b=a._pe.castObject(b,a._pe.PeGeogcs);break;case h.PE_TYPE_PROJCS:b=a._pe.castObject(b,a._pe.PeProjcs);break;case h.PE_TYPE_GEOGTRAN:b=a._pe.castObject(b,a._pe.PeGeogtran);break;default:c&h.PE_TYPE_UNIT&&(b=a._pe.castObject(b,a._pe.PeUnit))}}return b}var b={},e={};c.initialize=function(){a._pe.PeFactory.prototype.initialize(null)};c.coordsys=function(b){return d(h.PE_TYPE_COORDSYS,
b)};c.factoryByType=d;c.fromString=function(b,c){var d=null,h=e[b];h||(h={},e[b]=h);h.hasOwnProperty(c)?d=h[c]:(b=a._pe.PeFactory.prototype.fromString(b,c),a._pe.compare(b,a._pe.NULL)||(d=b,h[c]=d));return d=k(d)};c.geogcs=function(b){return d(h.PE_TYPE_GEOGCS,b)};c.geogtran=function(b){return d(h.PE_TYPE_GEOGTRAN,b)};c.getCode=function(b){return a._pe.PeFactory.prototype.getCode(b)};c.projcs=function(b){return d(h.PE_TYPE_PROJCS,b)};c.unit=function(b){return d(h.PE_TYPE_UNIT,b)}})(a.PeFactory||(a.PeFactory=
{}));a.PeGCSExtent=null;var p;(function(c){var d;c.init=function(){c.PE_GTLIST_OPTS_COMMON=a._pe.PeGTlistExtended.prototype.PE_GTLIST_OPTS_COMMON;d=a._pe._pe_getPeGTlistExtendedEntrySize()};c.getGTlist=function(c,b,h,e,w,l){var k=null,g=new a._pe.PeInteger(l);try{var p=a._pe.PeGTlistExtended.prototype.getGTlist(c,b,h,e,w,g);if(l=g.val)if(k=[p],1<l){var x=a._pe.getPointer(p);for(c=1;c<l;c++)k.push(a._pe.wrapPointer(x+d*c,a._pe.PeGTlistExtendedEntry))}}finally{a._pe.destroy(g)}return k}})(p=a.PeGTlistExtended||
(a.PeGTlistExtended={}));(function(c){c.destroy=function(c){if(c&&c.length){for(var d=0;d<c.length;d++){var b=c[d];q(b);b.getEntries().forEach(function(b){q(b);b=b.getGeogtran();q(b);b.getParameters().forEach(q);[b.getGeogcs1(),b.getGeogcs2()].forEach(function(b){q(b);var c=b.getDatum();q(c);q(c.getSpheroid());q(b.getPrimem());q(b.getUnit())})})}a._pe.PeGTlistExtendedEntry.prototype.Delete(c[0])}}})(a.PeGTlistExtendedEntry||(a.PeGTlistExtendedEntry={}));(function(c){c.geogToGeog=function(c,k,b,h,
e){a._pe.ensureCache.prepare();var l=d(b),w=b===l,l=a._pe.ensureFloat64(l),p=0;h&&(p=a._pe.ensureFloat64(h));(c=a._pe._pe_geog_to_geog(a._pe.getPointer(c),k,l,p,e))&&g(b,k,l,w);return c}})(a.PeGTTransformations||(a.PeGTTransformations={}));(function(e){function l(b,k,e,l,w,g){a._pe.ensureCache.prepare();var p,x;switch(b){case "dd":p=a._pe._pe_geog_to_dd;x=h.PE_DD_MAX;break;case "ddm":p=a._pe._pe_geog_to_ddm;x=h.PE_DDM_MAX;break;case "dms":p=a._pe._pe_geog_to_dms,x=h.PE_DMS_MAX}b=0;k&&(b=a._pe.getPointer(k));
k=d(l);k=a._pe.ensureFloat64(k);x=c(e,x);l=a._pe.ensureInt32(x);if(w=p(b,e,k,w,l))for(p=0;p<e;p++)g[p]=a._pe.UTF8ToString(x[p]);return w}function k(b,c,d,k,h){a._pe.ensureCache.prepare();var e;switch(b){case "dd":e=a._pe._pe_dd_to_geog;break;case "ddm":e=a._pe._pe_ddm_to_geog;break;case "dms":e=a._pe._pe_dms_to_geog}b=0;c&&(b=a._pe.getPointer(c));c=k.map(function(b){return a._pe.ensureString(b)});k=a._pe.ensureInt32(c);c=a._pe.ensureFloat64(Array(2*d));(e=e(b,d,k,c))&&g(h,d,c);return e}e.geog_to_dms=
function(b,c,a,d,k){return l("dms",b,c,a,d,k)};e.dms_to_geog=function(b,c,a,d){return k("dms",b,c,a,d)};e.geog_to_ddm=function(b,c,a,d,k){return l("ddm",b,c,a,d,k)};e.ddm_to_geog=function(b,c,a,d){return k("ddm",b,c,a,d)};e.geog_to_dd=function(b,c,a,d,k){return l("dd",b,c,a,d,k)};e.dd_to_geog=function(b,c,a,d){return k("dd",b,c,a,d)}})(a.PeNotationDms||(a.PeNotationDms={}));var e;(function(e){e.init=function(){e.PE_MGRS_STYLE_NEW=a._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_NEW;e.PE_MGRS_STYLE_OLD=
a._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_OLD;e.PE_MGRS_STYLE_AUTO=a._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_AUTO;e.PE_MGRS_180_ZONE_1_PLUS=a._pe.PeNotationMgrs.prototype.PE_MGRS_180_ZONE_1_PLUS;e.PE_MGRS_ADD_SPACES=a._pe.PeNotationMgrs.prototype.PE_MGRS_ADD_SPACES};e.geog_to_mgrs_extended=function(e,k,b,l,g,p,w){a._pe.ensureCache.prepare();var x=0;e&&(x=a._pe.getPointer(e));e=d(b);b=a._pe.ensureFloat64(e);e=c(k,h.PE_MGRS_MAX);var t=a._pe.ensureInt32(e);if(l=a._pe._pe_geog_to_mgrs_extended(x,
k,b,l,g,p,t))for(g=0;g<k;g++)w[g]=a._pe.UTF8ToString(e[g]);return l};e.mgrs_to_geog_extended=function(c,d,b,e,h){a._pe.ensureCache.prepare();var k=0;c&&(k=a._pe.getPointer(c));c=b.map(function(b){return a._pe.ensureString(b)});b=a._pe.ensureInt32(c);c=a._pe.ensureFloat64(Array(2*d));(e=a._pe._pe_mgrs_to_geog_extended(k,d,b,e,c))&&g(h,d,c);return e}})(e=a.PeNotationMgrs||(a.PeNotationMgrs={}));(function(e){e.geog_to_usng=function(e,k,b,l,g,p,w){a._pe.ensureCache.prepare();var x=0;e&&(x=a._pe.getPointer(e));
e=d(b);b=a._pe.ensureFloat64(e);e=c(k,h.PE_MGRS_MAX);var t=a._pe.ensureInt32(e);if(l=a._pe._pe_geog_to_usng(x,k,b,l,g,p,t))for(g=0;g<k;g++)w[g]=a._pe.UTF8ToString(e[g]);return l};e.usng_to_geog=function(c,d,b,e){a._pe.ensureCache.prepare();var k=0;c&&(k=a._pe.getPointer(c));c=b.map(function(b){return a._pe.ensureString(b)});b=a._pe.ensureInt32(c);c=a._pe.ensureFloat64(Array(2*d));(k=a._pe._pe_usng_to_geog(k,d,b,c))&&g(e,d,c);return k}})(a.PeNotationUsng||(a.PeNotationUsng={}));var E;(function(e){e.init=
function(){e.PE_UTM_OPTS_NONE=a._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NONE;e.PE_UTM_OPTS_ADD_SPACES=a._pe.PeNotationUtm.prototype.PE_UTM_OPTS_ADD_SPACES;e.PE_UTM_OPTS_NS=a._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NS};e.geog_to_utm=function(e,k,b,l,g){a._pe.ensureCache.prepare();var p=0;e&&(p=a._pe.getPointer(e));e=d(b);b=a._pe.ensureFloat64(e);e=c(k,h.PE_UTM_MAX);var x=a._pe.ensureInt32(e);if(l=a._pe._pe_geog_to_utm(p,k,b,l,x))for(p=0;p<k;p++)g[p]=a._pe.UTF8ToString(e[p]);return l};e.utm_to_geog=
function(c,d,b,e,h){a._pe.ensureCache.prepare();var k=0;c&&(k=a._pe.getPointer(c));c=b.map(function(b){return a._pe.ensureString(b)});b=a._pe.ensureInt32(c);c=a._pe.ensureFloat64(Array(2*d));(e=a._pe._pe_utm_to_geog(k,d,b,e,c))&&g(h,d,c);return e}})(E=a.PeNotationUtm||(a.PeNotationUtm={}));var x;(function(c){var d=new Map;c.init=function(){c.PE_PCSINFO_OPTION_NONE=a._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_NONE;c.PE_PCSINFO_OPTION_DOMAIN=a._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_DOMAIN;c.PE_POLE_OUTSIDE_BOUNDARY=
a._pe.PePCSInfo.prototype.PE_POLE_OUTSIDE_BOUNDARY;c.PE_POLE_POINT=a._pe.PePCSInfo.prototype.PE_POLE_POINT};c.generate=function(e,b){void 0===b&&(b=c.PE_PCSINFO_OPTION_DOMAIN);var k,h;d.has(e)&&(h=d.get(e),h[b]&&(k=h[b]));k||(k=a._pe.PePCSInfo.prototype.generate(e,b),h||(h=[],d.set(e,h)),h[b]=k);return k}})(x=a.PePCSInfo||(a.PePCSInfo={}));(function(c){c.version_string=function(){return a._pe.PeVersion.prototype.version_string()}})(a.PeVersion||(a.PeVersion={}));a._init=t})},"esri/geometry/support/GeographicTransformation":function(){define(["require",
"exports","./GeographicTransformationStep"],function(y,a,u){return function(){function a(a){this.steps=[];this._cached_projection={};this._chain="";this._gtlistentry=null;if(a&&a.steps){var t=0;for(a=a.steps;t<a.length;t++){var q=a[t];q instanceof u?this.steps.push(q):this.steps.push(new u({wkid:q.wkid,wkt:q.wkt,isInverse:q.isInverse}))}}}a.cacheKey=function(a,t){return[void 0!==a.wkid&&null!==a.wkid?a.wkid.toString():"-1",void 0!==a.wkt&&null!==a.wkt?a.wkt.toString():"",void 0!==t.wkid&&null!==t.wkid?
t.wkid.toString():"-1",void 0!==t.wkt&&null!==t.wkt?t.wkt.toString():""].join()};a.fromGE=function(m){var t=new a,q="",c=0;for(m=m.steps;c<m.length;c++){var d=u.fromGE(m[c]);t.steps.push(d);q+=d.uid.toString()+","}t._cached_projection={};t._gtlistentry=null;t._chain=q;return t};a.prototype.getInverse=function(){var m=new a;m.steps=[];for(var t=this.steps.length-1;0<=t;t--)m.steps.push(this.steps[t].getInverse());return m};a.prototype.getGTListEntry=function(){for(var a="",t=0,q=this.steps;t<q.length;t++)a+=
q[t].uid.toString()+",";a!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=a);return this._gtlistentry};a.prototype.assignCachedGe=function(m,t,q){this._cached_projection[a.cacheKey(m,t)]=q};a.prototype.getCachedGeTransformation=function(m,t){for(var q="",c=0,d=this.steps;c<d.length;c++)q+=d[c].uid.toString()+",";q!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=q);m=this._cached_projection[a.cacheKey(m,t)];return void 0===m?null:m};return a}()})},
"esri/geometry/support/GeographicTransformationStep":function(){define(["require","exports"],function(y,a){var u=0;return function(){function a(a){void 0===a&&(a=null);this.uid=u++;a?(this._wkt=void 0!==a.wkt?a.wkt:null,this._wkid=void 0!==a.wkid?a.wkid:-1,this._isInverse=void 0!==a.isInverse?!0===a.isInverse:!1):(this._wkt=null,this._wkid=-1,this._isInverse=!1)}a.fromGE=function(m){var t=new a;t._wkt=m.wkt;t._wkid=m.wkid;t._isInverse=m.isInverse;return t};Object.defineProperty(a.prototype,"wkt",
{get:function(){return this._wkt},set:function(a){this._wkt=a;this.uid=u++},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"wkid",{get:function(){return this._wkid},set:function(a){this._wkid=a;this.uid=u++},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"isInverse",{get:function(){return this._isInverse},set:function(a){this._isInverse=a;this.uid=u++},enumerable:!0,configurable:!0});a.prototype.getInverse=function(){var m=new a;m._wkt=this.wkt;m._wkid=this._wkid;
m._isInverse=!this.isInverse;return m};return a}()})},"esri/renderers/support/clickToleranceUtils":function(){define(["require","exports"],function(y,a){function u(a,q){return q&&q.xoffset?Math.max(a,Math.abs(q.xoffset)):q&&q.yoffset?Math.max(a,Math.abs(q.yoffset)):a}function m(a,q){if("number"===typeof a)return a;if(a&&a.stops&&a.stops.length){a=a.stops;for(var c=q=0,d=0;d<a.length;d++){var g=a[d].size;"number"===typeof g&&(q+=g,c++)}return q/c}return q}function r(a,q){if(!q)return a;q=q.filter(function(a){return"size"===
a.type}).map(function(c){var d=c.minSize;return(m(c.maxSize,a)+m(d,a))/2});var c=0,d=q.length;if(0===d)return a;for(var g=0;g<d;g++)c+=q[g];return Math.max(Math.floor(c/d),a)}Object.defineProperty(a,"__esModule",{value:!0});a.calculateTolerance=function(a){if(!a)return 6;var q="visualVariables"in a?r(6,a.visualVariables):6;if("simple"===a.type)return u(q,a.symbol);if("unique-value"===a.type){var c=q;a.uniqueValueInfos.forEach(function(a){c=u(c,a.symbol)});return c}if("class-breaks"===a.type){var d=
q;a.classBreakInfos.forEach(function(a){d=u(d,a.symbol)});return d}return q}})},"esri/views/2d/layers/LayerView2D":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/Collection ../../../core/collectionUtils ../../../core/watchUtils ../../../core/accessorSupport/decorators ../../layers/support/ClipArea ../../layers/support/ClipRect ../../layers/support/Geometry ../../layers/support/Path".split(" "),function(y,a,u,m,r,
t,q,c,d,g,l,h){Object.defineProperty(a,"__esModule",{value:!0});var p=r.ofType({key:"type",base:d,typeMap:{rect:g,path:h,geometry:l}});a.LayerView2D=function(a){return function(a){function d(){var c=null!==a&&a.apply(this,arguments)||this;c.clips=new p;c.moving=!1;c.attached=!1;c.lastUpdateId=-1;c.updateRequested=!1;return c}u(d,a);d.prototype.initialize=function(){var a=this;this.when(function(){a.requestUpdate()},function(){});var c=function(){return a.notifyChange("rendering")};this.handles.add([q.init(this,
"suspended",function(c){a.container&&(a.container.visible=!c);a.view&&!c&&a.updateRequested&&a.view.requestLayerViewUpdate(a)},!0),q.init(this,["fullOpacity","container"],function(){a.container&&(a.container.opacity=a.fullOpacity)},!0),q.on(this,"container","post-render",c),q.on(this,"container","will-render",c)])};d.prototype.destroy=function(){this.attached&&(this.attached=!1,this.detach());this.handles.remove("initialize");this.updateRequested=!1;this.view=this.layer=null};Object.defineProperty(d.prototype,
"rendering",{get:function(){return this.attached&&!this.suspended&&(this.moving||this.container.renderRequested||this.isRendering())},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"updating",{get:function(){return!this.suspended&&(!this.attached||this.updateRequested||this.isUpdating())},enumerable:!0,configurable:!0});d.prototype.isVisibleAtScale=function(a){var c=!0,d=this.layer,b=d.minScale,d=d.maxScale;if(null!=b&&null!=d){var c=!b,e=!d;!c&&a<=b&&(c=!0);!e&&a>=d&&(e=!0);c=
c&&e}return c};d.prototype.requestUpdate=function(){this.updateRequested||(this.updateRequested=!0,this.suspended||this.view.requestLayerViewUpdate(this))};d.prototype.processUpdate=function(a){this.isFulfilled()&&!this.isResolved()?this.updateRequested=!1:(this._set("updateParameters",a),this.updateRequested&&!this.suspended&&(this.updateRequested=!1,this.update(a)))};d.prototype.isUpdating=function(){return!1};d.prototype.isRendering=function(){return!1};d.prototype.canResume=function(){var a=this.inherited(arguments);
a&&(a=this.isVisibleAtScale(this.view.scale));return a};m([c.property({type:p,set:function(a){a=t.referenceSetter(a,this._get("clips"),p);this._set("clips",a)}})],d.prototype,"clips",void 0);m([c.property()],d.prototype,"moving",void 0);m([c.property({dependsOn:["attached","suspended","moving"]})],d.prototype,"rendering",null);m([c.property()],d.prototype,"attached",void 0);m([c.property()],d.prototype,"container",void 0);m([c.property({dependsOn:["view.scale","layer.minScale","layer.maxScale"]})],
d.prototype,"suspended",void 0);m([c.property({readOnly:!0})],d.prototype,"updateParameters",void 0);m([c.property()],d.prototype,"updateRequested",void 0);m([c.property({dependsOn:["updateRequested","attached","suspended"]})],d.prototype,"updating",null);m([c.property()],d.prototype,"view",void 0);return d=m([c.subclass("esri.views.2d.layers.LayerView2D")],d)}(c.declared(a))}})},"esri/views/layers/support/ClipArea":function(){define("require exports ../../../core/tsSupport/decorateHelper ../../../core/tsSupport/declareExtendsHelper ../../../core/JSONSupport ../../../core/accessorSupport/decorators".split(" "),
function(y,a,u,m,r,t){return function(a){function c(){return null!==a&&a.apply(this,arguments)||this}m(c,a);return c=u([t.subclass("esri.views.layers.support.ClipArea")],c)}(t.declared(r.JSONSupport))})},"esri/views/layers/support/ClipRect":function(){define("require exports ../../../core/tsSupport/decorateHelper ../../../core/tsSupport/declareExtendsHelper ../../../core/accessorSupport/decorators ./ClipArea".split(" "),function(y,a,u,m,r,t){return function(a){function c(){var c=null!==a&&a.apply(this,
arguments)||this;c.type="rect";c.left=null;c.right=null;c.top=null;c.bottom=null;return c}m(c,a);d=c;c.prototype.clone=function(){return new d({left:this.left,right:this.right,top:this.top,bottom:this.bottom})};Object.defineProperty(c.prototype,"version",{get:function(){return(this._get("version")||0)+1},enumerable:!0,configurable:!0});var d;u([r.property({type:[Number,String],json:{write:!0}})],c.prototype,"left",void 0);u([r.property({type:[Number,String],json:{write:!0}})],c.prototype,"right",
void 0);u([r.property({type:[Number,String],json:{write:!0}})],c.prototype,"top",void 0);u([r.property({type:[Number,String],json:{write:!0}})],c.prototype,"bottom",void 0);u([r.property({readOnly:!0,dependsOn:["left","right","top","bottom"]})],c.prototype,"version",null);return c=d=u([r.subclass("esri.views.layers.support.ClipRect")],c)}(r.declared(t))})},"esri/views/layers/support/Geometry":function(){define("require exports ../../../core/tsSupport/decorateHelper ../../../core/tsSupport/declareExtendsHelper ../../../geometry ../../../core/accessorSupport/decorators ../../../geometry/Geometry ../../../geometry/support/jsonUtils ./ClipArea".split(" "),
function(y,a,u,m,r,t,q,c,d){var g={base:q,key:"type",typeMap:{extent:r.Extent,polygon:r.Polygon}};return function(a){function d(){var c=null!==a&&a.apply(this,arguments)||this;c.type="geometry";c.geometry=null;return c}m(d,a);l=d;Object.defineProperty(d.prototype,"version",{get:function(){return(this._get("version")||0)+1},enumerable:!0,configurable:!0});d.prototype.clone=function(){return new l({geometry:this.geometry.clone()})};var l;u([t.property({types:g,json:{read:c.fromJSON,write:!0}})],d.prototype,
"geometry",void 0);u([t.property({readOnly:!0,dependsOn:["geometry"]})],d.prototype,"version",null);return d=l=u([t.subclass("esri.views.layers.support.Geometry")],d)}(t.declared(d))})},"esri/views/layers/support/Path":function(){define("require exports ../../../core/tsSupport/decorateHelper ../../../core/tsSupport/declareExtendsHelper ../../../core/accessorSupport/decorators ./ClipArea".split(" "),function(y,a,u,m,r,t){return function(a){function c(){var c=null!==a&&a.apply(this,arguments)||this;
c.type="path";c.path=[];return c}m(c,a);Object.defineProperty(c.prototype,"version",{get:function(){return(this._get("version")||0)+1},enumerable:!0,configurable:!0});u([r.property({type:[[[Number]]],json:{write:!0}})],c.prototype,"path",void 0);u([r.property({readOnly:!0,dependsOn:["path"]})],c.prototype,"version",null);return c=u([r.subclass("esri.views.layers.support.Path")],c)}(r.declared(t))})},"esri/views/2d/layers/features/tileRenderers":function(){define(["require","exports","../../../../core/nextTick",
"../../../../core/promiseUtils"],function(y,a,u,m){Object.defineProperty(a,"__esModule",{value:!0});a.createOrReuseTileRenderer=function(a,t){if(!a)return m.resolve(null);switch(a.type){case "class-breaks":case "simple":case "unique-value":case "dot-density":case "dictionary":return m.create(function(a){u(function(){return y(["./tileRenderers/SymbolTileRenderer"],a)})}).then(function(a){return a.default}).then(function(a){return new a(t)});case "heatmap":return m.create(function(a){u(function(){return y(["./tileRenderers/HeatmapTileRenderer"],
a)})}).then(function(a){return a.default}).then(function(a){return new a(t)})}return m.resolve(null)}})},"esri/views/2d/layers/features/support/rendererUtils":function(){define(["require","exports","../../../../../core/Logger","../../../../../core/screenUtils","../../../engine"],function(y,a,u,m,r){Object.defineProperty(a,"__esModule",{value:!0});var t=r.definitions.WEBGL_MAX_INNER_STOPS,q=r.definitions.WEBGL_MAX_STOPS,c=u.getLogger("esri.renderers.visualVariables.support.utils");a.simplifyVVRenderer=
function(a){if(!("visualVariables"in a&&a.visualVariables&&a.visualVariables.length))return a;a=a.clone();var d=a.visualVariables.map(function(a){if(("size"===a.type||"color"===a.type||"opacity"===a.type)&&null!=a.stops){var d;var l=a.type;d=a.stops;if(!(d.length<=q))if(c.warn("Found "+d.length+" Visual Variable stops, but MapView only supports "+q+". Displayed stops will be simplified."),d.length>2*q){for(var e=d[0],g=d.slice(1),x=g.pop(),w=g[0].value,u=g[g.length-1].value,k=(u-w)/t,b=[];w<u;w+=
k){for(var r=0;w>=g[r].value;)r++;var B=g[r],y=d[r-1],I=w-y.value,B=B.value===y.value?1:I/(B.value-y.value);"color"===l?(y=g[r],r=d[r-1],I=y.color.clone(),I.r=(1-B)*r.color.r+B*I.r,I.g=(1-B)*r.color.g+B*I.g,I.b=(1-B)*r.color.b+B*I.b,I.a=(1-B)*r.color.a+B*I.a,b.push({value:w,color:I,label:y.label})):"size"===l?(y=g[r],I=d[r-1],r=m.toPt(y.size),I=m.toPt(I.size),b.push({value:w,size:(1-B)*I+B*r,label:y.label})):(y=g[r],b.push({value:w,opacity:(1-B)*d[r-1].opacity+B*y.opacity,label:y.label}))}d=[e].concat(b,
[x])}else{l=d[0];d=d.slice(1);for(e=d.pop();d.length>t;){x=g=0;for(u=1;u<d.length;u++)k=Math.abs(d[u].value-d[u-1].value),k>x&&(x=k,g=u);d.splice(g,1)}d=[l].concat(d,[e])}a.stops=d}return a});a.visualVariables=d;return a}})},"esri/views/2d/layers/support/clusterUtils":function(){define("require exports ../../../../core/tsSupport/generatorHelper ../../../../core/tsSupport/awaiterHelper ../../../../core/tsSupport/assignHelper ../../../../core/Error ../../../../core/Logger ../../../../core/maybe ../../../../core/MD5 ../../../../renderers/visualVariables/SizeVariable ../../../../renderers/visualVariables/support/SizeStop ../../engine".split(" "),
function(y,a,u,m,r,t,q,c,d,g,l,h){function p(a,c,e){switch(a){case "avg":case "avg_angle":return"cluster_avg_"+c;case "mode":return"cluster_type_"+c;case "norm":return a=c.toLowerCase()+",norm:field,"+e.toLowerCase(),"cluster_avg_"+d.createMD5Hash(a)}}function e(a,c,d,b){var e=p(d,c,b);a.some(function(b){return b.name===e})||("norm"===d?a.push({name:e,outStatistic:{onStatisticField:c,onStatisticNormalizationField:b,statisticType:d}}):a.push({name:e,outStatistic:{onStatisticField:c,statisticType:d}}));
return e}var E=this;Object.defineProperty(a,"__esModule",{value:!0});var x=q.getLogger("esri.views.2d.layers.support.clusterUtils");a.createClusterRenderer=function(d,h,k,b,l){return m(E,void 0,void 0,function(){var h,g,p;return u(this,function(x){h=k.clone();if(!a.isClusterCompatibleRenderer(h))return[2,h];g="visualVariables"in h&&h.visualVariables||[];p=a.findSizeVV(g);g.forEach(function(b){"rotation"===b.type?b.field=e(d,b.field,"avg_angle"):b.normalizationField?(b.field=e(d,b.field,"norm",b.normalizationField),
b.normalizationField=null):b.field&&(b.field=e(d,b.field,"avg"))});c.isNone(p)&&g.push(a.createClusterCountSizeVariable(b,l));switch(h.type){case "unique-value":h.field&&(h.field=e(d,h.field,"mode"));break;case "class-breaks":h.normalizationField?(h.field=e(d,h.field,"norm",h.normalizationField),h.normalizationField=null):h.field=e(d,h.field,"avg")}h.visualVariables=g;return[2,h]})})};a.findSizeVV=function(a){for(var c=0;c<a.length;c++){var d=a[c];if("size"===d.type)return d}return null};a.getActiveSizeStops=
function(a,c){a=a.featuresTilingScheme.getClosestInfoForScale(a.scale).level;return c.levels?c.levels[a]:null};a.createClusterCountSizeVariable=function(a,d){var e=[new l({value:0,size:0}),new l({value:1})];if(c.isNone(d))return new g({field:"cluster_count",stops:e.concat([new l({value:2,size:0})])});a=Object.keys(d).reduce(function(b,a){var c;return r({},b,(c={},c[a]=e.concat([new l({value:Math.max(2,d[a].minValue),size:"12px"}),new l({value:Math.max(3,d[a].maxValue),size:"50px"})]),c))},{});return new h.LevelDependentSizeVariable({field:"cluster_count",
levels:a})};a.isClusterCompatibleRenderer=function(a){var c=function(b){return x.error(new t("Unsupported-renderer",b,{renderer:a}))};if("valueExpression"in a&&a.valueExpression)return c("FeatureReductionCluster does not currently support renderer.valueExpression. Support will be added in a future release"),!1;if("unique-value"===a.type){if(a.field2||a.field3)return c("FeatureReductionCluster does not support multi-field UniqueValueRenderers"),!1}else if("class-breaks"===a.type){if(a.normalizationField){var d=
a.normalizationType;if("field"!==d)return c("FeatureReductionCluster does not support a normalizationType of "+d),!1}}else if("simple"!==a.type)return c("FeatureReductionCluster does not support renderers of type "+a.type),!1;return("visualVariables"in a&&a.visualVariables||[]).some(function(b){return!!("valueExpression"in b&&b.valueExpression)})?(c("FeatureReductionCluster does not currently support visualVariables with a valueExpression. Support will be added in a future release"),!1):!0}})},"esri/core/MD5":function(){define(["require",
"exports"],function(y,a){function u(a,d){var c=(a&65535)+(d&65535);return(a>>16)+(d>>16)+(c>>16)<<16|c&65535}function m(a,d,g,l,h,p){a=u(u(d,a),u(l,p));return u(a<<h|a>>>32-h,g)}function r(a,d,g,l,h,p,e){return m(d&g|~d&l,a,d,h,p,e)}function t(a,d,g,l,h,p,e){return m(d&l|g&~l,a,d,h,p,e)}function q(a,d,g,l,h,p,e){return m(g^(d|~l),a,d,h,p,e)}Object.defineProperty(a,"__esModule",{value:!0});a.outputTypes={Base64:0,Hex:1,String:2,Raw:3};a.createMD5Hash=function(c,d){void 0===d&&(d=a.outputTypes.Hex);
d=d||a.outputTypes.Base64;for(var g=[],l=0,h=8*c.length;l<h;l+=8)g[l>>5]|=(c.charCodeAt(l/8)&255)<<l%32;c=8*c.length;g[c>>5]|=128<<c%32;g[(c+64>>>9<<4)+14]=c;c=1732584193;for(var l=-271733879,h=-1732584194,p=271733878,e=0;e<g.length;e+=16){var E=c,x=l,w=h,z=p;c=r(c,l,h,p,g[e+0],7,-680876936);p=r(p,c,l,h,g[e+1],12,-389564586);h=r(h,p,c,l,g[e+2],17,606105819);l=r(l,h,p,c,g[e+3],22,-1044525330);c=r(c,l,h,p,g[e+4],7,-176418897);p=r(p,c,l,h,g[e+5],12,1200080426);h=r(h,p,c,l,g[e+6],17,-1473231341);l=r(l,
h,p,c,g[e+7],22,-45705983);c=r(c,l,h,p,g[e+8],7,1770035416);p=r(p,c,l,h,g[e+9],12,-1958414417);h=r(h,p,c,l,g[e+10],17,-42063);l=r(l,h,p,c,g[e+11],22,-1990404162);c=r(c,l,h,p,g[e+12],7,1804603682);p=r(p,c,l,h,g[e+13],12,-40341101);h=r(h,p,c,l,g[e+14],17,-1502002290);l=r(l,h,p,c,g[e+15],22,1236535329);c=t(c,l,h,p,g[e+1],5,-165796510);p=t(p,c,l,h,g[e+6],9,-1069501632);h=t(h,p,c,l,g[e+11],14,643717713);l=t(l,h,p,c,g[e+0],20,-373897302);c=t(c,l,h,p,g[e+5],5,-701558691);p=t(p,c,l,h,g[e+10],9,38016083);
h=t(h,p,c,l,g[e+15],14,-660478335);l=t(l,h,p,c,g[e+4],20,-405537848);c=t(c,l,h,p,g[e+9],5,568446438);p=t(p,c,l,h,g[e+14],9,-1019803690);h=t(h,p,c,l,g[e+3],14,-187363961);l=t(l,h,p,c,g[e+8],20,1163531501);c=t(c,l,h,p,g[e+13],5,-1444681467);p=t(p,c,l,h,g[e+2],9,-51403784);h=t(h,p,c,l,g[e+7],14,1735328473);l=t(l,h,p,c,g[e+12],20,-1926607734);c=m(l^h^p,c,l,g[e+5],4,-378558);p=m(c^l^h,p,c,g[e+8],11,-2022574463);h=m(p^c^l,h,p,g[e+11],16,1839030562);l=m(h^p^c,l,h,g[e+14],23,-35309556);c=m(l^h^p,c,l,g[e+
1],4,-1530992060);p=m(c^l^h,p,c,g[e+4],11,1272893353);h=m(p^c^l,h,p,g[e+7],16,-155497632);l=m(h^p^c,l,h,g[e+10],23,-1094730640);c=m(l^h^p,c,l,g[e+13],4,681279174);p=m(c^l^h,p,c,g[e+0],11,-358537222);h=m(p^c^l,h,p,g[e+3],16,-722521979);l=m(h^p^c,l,h,g[e+6],23,76029189);c=m(l^h^p,c,l,g[e+9],4,-640364487);p=m(c^l^h,p,c,g[e+12],11,-421815835);h=m(p^c^l,h,p,g[e+15],16,530742520);l=m(h^p^c,l,h,g[e+2],23,-995338651);c=q(c,l,h,p,g[e+0],6,-198630844);p=q(p,c,l,h,g[e+7],10,1126891415);h=q(h,p,c,l,g[e+14],15,
-1416354905);l=q(l,h,p,c,g[e+5],21,-57434055);c=q(c,l,h,p,g[e+12],6,1700485571);p=q(p,c,l,h,g[e+3],10,-1894986606);h=q(h,p,c,l,g[e+10],15,-1051523);l=q(l,h,p,c,g[e+1],21,-2054922799);c=q(c,l,h,p,g[e+8],6,1873313359);p=q(p,c,l,h,g[e+15],10,-30611744);h=q(h,p,c,l,g[e+6],15,-1560198380);l=q(l,h,p,c,g[e+13],21,1309151649);c=q(c,l,h,p,g[e+4],6,-145523070);p=q(p,c,l,h,g[e+11],10,-1120210379);h=q(h,p,c,l,g[e+2],15,718787259);l=q(l,h,p,c,g[e+9],21,-343485551);c=u(c,E);l=u(l,x);h=u(h,w);p=u(p,z)}g=[c,l,h,
p];switch(d){case a.outputTypes.Raw:return g;case a.outputTypes.Hex:d=[];c=0;for(l=4*g.length;c<l;c++)d.push("0123456789abcdef".charAt(g[c>>2]>>c%4*8+4&15)+"0123456789abcdef".charAt(g[c>>2]>>c%4*8&15));return d.join("");case a.outputTypes.String:d=[];c=0;for(l=32*g.length;c<l;c+=8)d.push(String.fromCharCode(g[c>>5]>>>c%32&255));return d.join("");case a.outputTypes.Base64:d=[];c=0;for(l=4*g.length;c<l;c+=3)for(h=(g[c>>2]>>c%4*8&255)<<16|(g[c+1>>2]>>(c+1)%4*8&255)<<8|g[c+2>>2]>>(c+2)%4*8&255,p=0;4>
p;p++)8*c+6*p>32*g.length?d.push("\x3d"):d.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(h>>6*(3-p)&63));return d.join("")}}})},"esri/views/2d/layers/support/FeatureLayerProxy":function(){define("require exports ../../../../core/tsSupport/declareExtendsHelper ../../../../core/tsSupport/decorateHelper ../../../../core/tsSupport/assignHelper ../../../../core/tsSupport/generatorHelper ../../../../core/tsSupport/awaiterHelper ../../../../core/Promise ../../../../core/promiseUtils ../../../../core/workers ../../../../core/accessorSupport/decorators".split(" "),
function(y,a,u,m,r,t,q,c,d,g,l){Object.defineProperty(a,"__esModule",{value:!0});y=function(a){function c(c){c=a.call(this,c)||this;c._startupResolver=d.createResolver();c.isReady=!1;return c}u(c,a);c.prototype.initialize=function(){this._controller=d.createAbortController();this.addResolvingPromise(this._startWorker(this._controller.signal))};c.prototype.destroy=function(){this._connection.close();this._controller.abort()};Object.defineProperty(c.prototype,"tileRenderer",{set:function(a){this.client.tileRenderer=
a},enumerable:!0,configurable:!0});c.prototype.startup=function(a,c,d,h){return q(this,void 0,void 0,function(){var e,k,b,l;return t(this,function(g){switch(g.label){case 0:return e=this._controller.signal,k=Array.isArray(d.source)?{transferList:d.source,signal:e}:void 0,b=a.tileInfo.toJSON(),l={service:d,config:c,tileInfo:b,options:h},[4,this._connection.invoke("startup",l,k)];case 1:return g.sent(),this._startupResolver.resolve(),this._set("isReady",!0),[2]}})})};c.prototype.update=function(a,c){return q(this,
void 0,void 0,function(){var d;return t(this,function(e){switch(e.label){case 0:return d={config:a,options:c},[4,this._startupResolver.promise];case 1:return e.sent(),[2,this._connection.invoke("update",d)]}})})};c.prototype.setHighlight=function(a){return q(this,void 0,void 0,function(){return t(this,function(c){switch(c.label){case 0:return[4,this._startupResolver.promise];case 1:return c.sent(),[2,this._connection.invoke("controller.setHighlight",a)]}})})};c.prototype.refresh=function(){return q(this,
void 0,void 0,function(){return t(this,function(a){switch(a.label){case 0:return[4,this._startupResolver.promise];case 1:return a.sent(),[2,this._connection.invoke("controller.refresh")]}})})};c.prototype.setViewState=function(a){return q(this,void 0,void 0,function(){return t(this,function(c){switch(c.label){case 0:return[4,this._startupResolver.promise];case 1:return c.sent(),[2,this._connection.invoke("setViewState",a.toJSON())]}})})};c.prototype.queryFeatures=function(a,c){return q(this,void 0,
void 0,function(){return t(this,function(d){switch(d.label){case 0:return[4,this._startupResolver.promise];case 1:return d.sent(),[2,this._connection.invoke("controller.queryFeatures",a.toJSON(),c)]}})})};c.prototype.queryObjectIds=function(a,c){return q(this,void 0,void 0,function(){return t(this,function(d){switch(d.label){case 0:return[4,this._startupResolver.promise];case 1:return d.sent(),[2,this._connection.invoke("controller.queryObjectIds",a.toJSON(),c)]}})})};c.prototype.queryFeatureCount=
function(a,c){return q(this,void 0,void 0,function(){return t(this,function(d){switch(d.label){case 0:return[4,this._startupResolver.promise];case 1:return d.sent(),[2,this._connection.invoke("controller.queryFeatureCount",a.toJSON(),c)]}})})};c.prototype.queryExtent=function(a,c){return q(this,void 0,void 0,function(){return t(this,function(d){return[2,this._connection.invoke("controller.queryExtent",a.toJSON(),c)]})})};c.prototype.queryLatestObservations=function(a,c){return q(this,void 0,void 0,
function(){return t(this,function(d){switch(d.label){case 0:return[4,this._startupResolver.promise];case 1:return d.sent(),[2,this._connection.invoke("controller.queryLatestObservations",a.toJSON(),c)]}})})};c.prototype.queryStatistics=function(a){return q(this,void 0,void 0,function(){return t(this,function(c){switch(c.label){case 0:return[4,this._startupResolver.promise];case 1:return c.sent(),[2,this._connection.invoke("controller.queryStatistics",a)]}})})};c.prototype.getObjectId=function(a){return q(this,
void 0,void 0,function(){return t(this,function(c){switch(c.label){case 0:return[4,this._startupResolver.promise];case 1:return c.sent(),[2,this._connection.invoke("controller.getObjectId",a)]}})})};c.prototype.getLocalId=function(a){return q(this,void 0,void 0,function(){return t(this,function(c){switch(c.label){case 0:return[4,this._startupResolver.promise];case 1:return c.sent(),[2,this._connection.invoke("controller.getLocalId",a)]}})})};c.prototype.getAggregate=function(a){return q(this,void 0,
void 0,function(){return t(this,function(c){switch(c.label){case 0:return[4,this._startupResolver.promise];case 1:return c.sent(),[2,this._connection.invoke("controller.getAggregate",a)]}})})};c.prototype.getAggregateValueRanges=function(){return q(this,void 0,void 0,function(){return t(this,function(a){switch(a.label){case 0:return[4,this._startupResolver.promise];case 1:return a.sent(),[2,this._connection.invoke("controller.getAggregateValueRanges")]}})})};c.prototype.mapValidLocalIds=function(a){return q(this,
void 0,void 0,function(){return t(this,function(c){switch(c.label){case 0:return[4,this._startupResolver.promise];case 1:return c.sent(),[2,this._connection.invoke("controller.mapValidLocalIds",a)]}})})};c.prototype.onEdits=function(a){return q(this,void 0,void 0,function(){var c,d,e;return t(this,function(h){switch(h.label){case 0:return[4,this._startupResolver.promise];case 1:return h.sent(),c=a.addedFeatures,d=a.deletedFeatures,e=a.updatedFeatures,[2,this._connection.invoke("controller.onEdits",
{addedFeatures:c,deletedFeatures:d,updatedFeatures:e})]}})})};c.prototype.enableEvent=function(a,c){return q(this,void 0,void 0,function(){return t(this,function(d){switch(d.label){case 0:return[4,this._startupResolver.promise];case 1:return d.sent(),[2,this._connection.invoke("controller.enableEvent",{name:a,value:c})]}})})};c.prototype._startWorker=function(a){return q(this,void 0,void 0,function(){var c;return t(this,function(d){switch(d.label){case 0:return c=this,[4,g.open("Pipeline",{client:this.client,
strategy:"dedicated",signal:a})];case 1:return c._connection=d.sent(),[2]}})})};m([l.property()],c.prototype,"isReady",void 0);m([l.property()],c.prototype,"client",void 0);m([l.property()],c.prototype,"tileRenderer",null);return c=m([l.subclass("esri.views.2d.layers.support.FeatureLayerProxy")],c)}(l.declared(c.EsriPromise));a.default=y})},"esri/views/2d/layers/support/popupUtils2D":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper","../../../../core/tsSupport/decorateHelper",
"../../../../geometry/Extent"],function(y,a,u,m,r){Object.defineProperty(a,"__esModule",{value:!0});a.createQueryGeometry=function(a,m,c){var d=c.get("state.resolution"),d=m*("number"===typeof d?d:1);m=a.clone().offset(-d,-d);a=a.clone().offset(d,d);return new r({xmin:Math.min(m.x,a.x),ymin:Math.min(m.y,a.y),xmax:Math.max(m.x,a.x),ymax:Math.max(m.y,a.y),spatialReference:c.spatialReference})}})},"esri/views/2d/layers/support/util":function(){define(["require","exports","../../../../core/jsonMap"],
function(y,a,u){Object.defineProperty(a,"__esModule",{value:!0});var m=new u.default({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch"});a.toJSONGeometryType=function(a){return m.toJSON(a)};a.analyzeRings=function(a,m,q){for(var c=[],d=[],g=0,l=0,h=0;h<a.length;h++){var p=a[h],e=l,t=p[0][0],x=p[0][1];c[l++]=t;c[l++]=x;for(var u=0,r=1;r<p.length;++r){var k=t,b=x,t=p[r][0],x=p[r][1],u=u+(x*
k-t*b);c[l++]=t;c[l++]=x}m(u/2);0<u?(0<e-g&&(q(g,e,c,d),g=e),d.length=0):0>u?0<e-g?d.push(.5*(e-g)):l=e:l=e}0<l-g&&q(g,l,c,d)}})},"esri/views/layers/FeatureLayerView":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/tsSupport/assignHelper ../../core/tsSupport/generatorHelper ../../core/tsSupport/awaiterHelper ../../core/Error ../../core/iteratorUtils ../../core/Logger ../../core/maybe ../../core/promiseUtils ../../core/watchUtils ../../core/accessorSupport/decorators ../../layers/support/fieldUtils ../../layers/support/timeUtils ../../support/arcadeOnDemand ../../tasks/support/Query ./support/FeatureEffect ./support/FeatureFilter ./support/popupUtils".split(" "),
function(y,a,u,m,r,t,q,c,d,g,l,h,p,e,E,x,w,z,k,b,H){Object.defineProperty(a,"__esModule",{value:!0});var B=g.getLogger("esri.views.layers.FeatureLayerView");a.FeatureLayerView=function(a){return function(a){function g(){for(var b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];b=a.apply(this,b)||this;b._updatingRequiredFieldsPromise=null;b.effect=null;b.filter=null;b.layer=null;b.requiredFields=null;b.view=null;return b}u(g,a);g.prototype.initialize=function(){var b=this;p.init(this,"layer.renderer layer.labelingInfo layer.elevationInfo.featureExpressionInfo filter effect layer.timeInfo timeExtent".split(" "),
function(){return b._handleRequiredFieldsChange()},!0)};Object.defineProperty(g.prototype,"availableFields",{get:function(){var b=this.layer,a=this.layer.fields,c=this.requiredFields;return"outFields"in b&&b.outFields?E.fixFields(a,E.unpackFieldNames(a,b.outFields).concat(c)):E.fixFields(a,c)},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"maximumNumberOfFeatures",{get:function(){return 0},set:function(b){B.error("#maximumNumberOfFeatures\x3d","Setting maximum number of features is not supported")},
enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"maximumNumberOfFeaturesExceeded",{get:function(){return!1},enumerable:!0,configurable:!0});g.prototype.highlight=function(b,a){void 0===a&&(a={});return this.inherited(arguments,[b,a])};g.prototype.createQuery=function(){var b={outFields:["*"],returnGeometry:!0,outSpatialReference:this.view.spatialReference},b=l.isSome(this.filter)?this.filter.createQuery(b):new z(b);this.timeExtent&&(b.timeExtent=b.timeExtent?b.timeExtent.intersection(this.timeExtent):
this.timeExtent.clone());return b};g.prototype.queryFeatures=function(b,a){return this.inherited(arguments,[b,a])};g.prototype.queryObjectIds=function(b,a){return this.inherited(arguments,[b,a])};g.prototype.queryFeatureCount=function(b,a){return this.inherited(arguments,[b,a])};g.prototype.queryExtent=function(b,a){return this.inherited(arguments,[b,a])};g.prototype._loadArcadeModules=function(b){if(b.get("expressionInfos.length"))return w.loadArcade()};g.prototype._handleRequiredFieldsChange=function(){var b=
this,a=this._updateRequiredFields();this._set("_updatingRequiredFieldsPromise",a);a.then(function(){b._updatingRequiredFieldsPromise===a&&b._set("_updatingRequiredFieldsPromise",null)})};g.prototype._updateRequiredFields=function(){return q(this,void 0,void 0,function(){var b,a,c,e,k,g,p,m,q,x,u,w,r;return t(this,function(t){switch(t.label){case 0:if(!this.layer||!this.view)return[2];b="3d"===this.view.type;a=this;e=c=a.layer;k=e.fields;g=e.objectIdField;p=e.renderer;m=new Set;return[4,h.eachAlways([p?
p.collectRequiredFields(m,k):null,E.collectLabelingFields(m,c),b?E.collectElevationFields(m,c):null,l.isSome(this.filter)?E.collectFilterFields(m,c,this.filter):null,this.effect?E.collectFilterFields(m,c,this.effect.filter):null])];case 1:q=t.sent();c.timeInfo&&this.timeExtent&&E.collectFields(m,c.fields,[c.timeInfo.startField,c.timeInfo.endField]);x=0;for(u=q;x<u.length;x++)w=u[x],w.error&&B.error(w.error);E.collectField(m,k,g);r=d.valuesOfSet(m).sort();this._set("requiredFields",r);return[2]}})})};
g.prototype.validateFetchPopupFeatures=function(b){var a=this.layer;if(!this.layer.popupEnabled)return new c("featurelayerview:fetchPopupFeatures","Popups are disabled",{layer:a});if(!H.getFetchPopupTemplate(this.layer,b))return new c("featurelayerview:fetchPopupFeatures","Layer does not define a popup template",{layer:a})};g.prototype.fetchClientPopupFeatures=function(b){return q(this,void 0,void 0,function(){var a,c,d,e,k,g,m,p,x,q,u,w;return t(this,function(t){switch(t.label){case 0:a=l.isSome(b)?
b.clientGraphics:null;if(!a||0===a.length)return[2,h.resolve([])];c=[];d=[];e=this.layer;k=H.getFetchPopupTemplate(e,b);return l.isSome(k)?[4,this._loadArcadeModules(k)]:[2,h.resolve([])];case 1:return m=(g=t.sent())&&g.arcadeUtils.hasGeometryOperations(k),[4,this.createPopupQuery(b)];case 2:p=t.sent();x=E.unpackFieldNames(e.fields,p.outFields);q=0;for(u=a;q<u.length;q++)w=u[q],m||!E.featureHasFields(x,w)?d.push(w):c.push(w);if(0===d.length)return[2,h.resolve(c)];p.objectIds=d.map(function(b){return b.attributes[e.objectIdField]});
return[2,e.queryFeatures(p).then(function(b){return c.concat(b.features)}).catch(function(){return d})]}})})};g.prototype.createPopupQuery=function(b){return q(this,void 0,void 0,function(){var a,c,d;return t(this,function(e){switch(e.label){case 0:return a=this.layer,c=a.createQuery(),c.returnGeometry=!0,c.returnZ=!0,c.returnM=!0,d=c,[4,H.getRequiredFields(this.layer,H.getFetchPopupTemplate(this.layer,b))];case 1:return d.outFields=e.sent(),c.outSpatialReference=this.view.spatialReference,[2,c]}})})};
m([e.property()],g.prototype,"_updatingRequiredFieldsPromise",void 0);m([e.property({readOnly:!0,dependsOn:["layer.outFields?","requiredFields"]})],g.prototype,"availableFields",null);m([e.property({type:k})],g.prototype,"effect",void 0);m([e.property({type:b})],g.prototype,"filter",void 0);m([e.property(x.combinedViewLayerTimeExtentProperty)],g.prototype,"timeExtent",void 0);m([e.property()],g.prototype,"layer",void 0);m([e.property({type:Number})],g.prototype,"maximumNumberOfFeatures",null);m([e.property({readOnly:!0,
type:Boolean})],g.prototype,"maximumNumberOfFeaturesExceeded",null);m([e.property({readOnly:!0})],g.prototype,"requiredFields",void 0);m([e.property()],g.prototype,"view",void 0);return g=m([e.subclass("esri.views.layers.FeatureLayerView")],g)}(e.declared(a))}})},"esri/views/layers/support/FeatureEffect":function(){define("require exports ../../../core/tsSupport/decorateHelper ../../../core/tsSupport/declareExtendsHelper ../../../core/JSONSupport ../../../core/Logger ../../../core/maybe ../../../core/accessorSupport/decorators ./FeatureFilter ./ParsedFeatureEffect ./Transition".split(" "),
function(y,a,u,m,r,t,q,c,d,g,l){var h=t.getLogger("esri.views.layers.support.FeatureEffect");return function(a){function e(){var c=null!==a&&a.apply(this,arguments)||this;c.filter=null;c.includedEffect=null;c.excludedEffect=null;c.excludedLabelsVisible=!1;return c}m(e,a);p=e;Object.defineProperty(e.prototype,"insideEffect",{get:function(){h.warn("insideEffect is a temporary interface that will be removed. Use includedEffect instead");return this.includedEffect},set:function(a){h.warn("insideEffect is a temporary interface that will be removed. Use includedEffect instead");
this.includedEffect=a},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"outsideEffect",{get:function(){h.warn("outsideEffect is a temporary interface that will be removed. Use excludedEffect instead");return this.excludedEffect},set:function(a){h.warn("outsideEffect is a temporary interface that will be removed. Use excludedEffect instead");this.excludedEffect=a},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"parsedIncludedEffect",{get:function(){return q.isSome(this.includedEffect)?
"string"===typeof this.includedEffect?g.fromString(this.includedEffect):new l({from:g.fromString(this.includedEffect.from),to:g.fromString(this.includedEffect.to),duration:this.includedEffect.duration}):null},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"parsedExcludedEffect",{get:function(){return q.isSome(this.excludedEffect)?"string"===typeof this.excludedEffect?g.fromString(this.excludedEffect):new l({from:g.fromString(this.excludedEffect.from),to:g.fromString(this.excludedEffect.to),
duration:this.excludedEffect.duration}):null},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"renderingHash",{get:function(){return this.excludedLabelsVisible+"-"+this.includedEffect+"-"+this.excludedEffect},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"done",{get:function(){return(!q.isSome(this.parsedIncludedEffect)||this.parsedIncludedEffect.done)&&(!q.isSome(this.parsedExcludedEffect)||this.parsedExcludedEffect.done)},enumerable:!0,configurable:!0});e.prototype.clone=
function(){return new p({filter:this.filter&&this.filter.clone(),includedEffect:this.includedEffect,excludedEffect:this.excludedEffect,excludedLabelsVisible:this.excludedLabelsVisible})};var p;u([c.property({type:d,json:{write:!0}})],e.prototype,"filter",void 0);u([c.property({type:String,json:{write:!0}})],e.prototype,"includedEffect",void 0);u([c.property({type:String,json:{write:!0}})],e.prototype,"excludedEffect",void 0);u([c.property({type:Boolean,json:{write:!0}})],e.prototype,"excludedLabelsVisible",
void 0);u([c.property({dependsOn:["includedEffect"]})],e.prototype,"parsedIncludedEffect",null);u([c.property({dependsOn:["excludedEffect"]})],e.prototype,"parsedExcludedEffect",null);u([c.property({dependsOn:["includedEffect","excludedEffect"]})],e.prototype,"renderingHash",null);return e=p=u([c.subclass("esri.views.layers.support.FeatureEffect")],e)}(c.declared(r.JSONSupport))})},"esri/views/layers/support/FeatureFilter":function(){define("require exports ../../../core/tsSupport/decorateHelper ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/assignHelper ../../../geometry ../../../TimeExtent ../../../core/iteratorUtils ../../../core/jsonMap ../../../core/JSONSupport ../../../core/lang ../../../core/accessorSupport/decorators ../../../geometry/support/jsonUtils ../../../tasks/support/Query".split(" "),
function(y,a,u,m,r,t,q,c,d,g,l,h,p,e){var E=new d.default({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"}),x=new d.default({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",
esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});return function(a){function d(b){b=a.call(this,b)||this;b.where=null;b.geometry=null;b.spatialRelationship="intersects";b.hiddenIds=new Set;b.distance=void 0;b.objectIds=null;b.units=null;b.timeExtent=null;b.enabled=!1;return b}m(d,a);k=d;d.prototype.writeWhere=function(b,a){a.where=b||"1\x3d1"};d.prototype.enable=function(){this._set("enabled",!0)};d.prototype.createQuery=
function(b){void 0===b&&(b={});var a=this.where,c=this.spatialRelationship,d=this.timeExtent,k=this.objectIds,h=this.units,g=this.distance;return new e(r({geometry:l.clone(this.geometry),objectIds:l.clone(k),spatialRelationship:c,timeExtent:l.clone(d),where:a,units:h,distance:g},b))};d.prototype.clone=function(){var b=this.where,a=this.geometry,c=this.spatialRelationship,d=this.hiddenIds,e=this.timeExtent,h=this.objectIds,g=this.units,m=this.distance,p=new Set;d.forEach(function(b){return p.add(b)});
return new k({geometry:l.clone(a),hiddenIds:p,objectIds:l.clone(h),spatialRelationship:c,timeExtent:l.clone(e),where:b,units:g,distance:m})};var k;u([h.property({type:String})],d.prototype,"where",void 0);u([h.writer("where")],d.prototype,"writeWhere",null);u([h.property({types:t.geometryTypes,json:{read:p.fromJSON,write:!0}})],d.prototype,"geometry",void 0);u([h.property({type:String,json:{read:{source:"spatialRel",reader:E.read},write:{target:"spatialRel",writer:E.write}}})],d.prototype,"spatialRelationship",
void 0);u([h.property({json:{write:function(b,a,d){return a[d]=c.valuesOfSet(b)},read:function(b){return c.createSetFromValues(b)}}})],d.prototype,"hiddenIds",void 0);u([h.property({type:Number,json:{write:{overridePolicy:function(b){return{enabled:0<b}}}}})],d.prototype,"distance",void 0);u([h.property({type:[Number],json:{write:!0}})],d.prototype,"objectIds",void 0);u([h.property({type:String,json:{read:x.read,write:{writer:x.write,overridePolicy:function(b){return{enabled:b&&0<this.distance}}}}})],
d.prototype,"units",void 0);u([h.property({type:q,json:{write:!0}})],d.prototype,"timeExtent",void 0);u([h.property({readOnly:!0})],d.prototype,"enabled",void 0);return d=k=u([h.subclass("esri.views.layers.support.FeatureFilter")],d)}(h.declared(g.JSONSupport))})},"esri/views/layers/support/ParsedFeatureEffect":function(){define("require exports ../../../core/tsSupport/decorateHelper ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/assignHelper ../../../core/Error ../../../core/JSONSupport ../../../core/Logger ../../../core/maybe ../../../core/accessorSupport/decorators ../../../core/libs/gl-matrix-2/mat4 ../../../core/libs/gl-matrix-2/mat4f32 ./cssFilterParser".split(" "),
function(y,a,u,m,r,t,q,c,d,g,l,h,p){var e=c.getLogger("esri.views.layers.support.ParsedFeatureEffect"),E={grayscale:function(a){a=1-a.amount;a=h.mat4f32.fromValues(.2126+.7874*a,.7152-.7152*a,.0722-.0722*a,0,.2126-.2126*a,.7152+.2848*a,.0722-.0722*a,0,.2126-.2126*a,.7152-.7152*a,.0722+.9278*a,0,0,0,0,1);return l.mat4.transpose(a,a)},sepia:function(a){a=1-a.amount;a=h.mat4f32.fromValues(.393+.607*a,.769-.769*a,.189-.189*a,0,.349-.349*a,.686+.314*a,.168-.168*a,0,.272-.272*a,.534-.534*a,.131+.869*a,
0,0,0,0,1);return l.mat4.transpose(a,a)},saturate:function(a){a=a.amount;a=h.mat4f32.fromValues(.213+.787*a,.715-.715*a,.072-.072*a,0,.213-.213*a,.715+.285*a,.072-.072*a,0,.213-.213*a,.715-.715*a,.072+.928*a,0,0,0,0,1);return l.mat4.transpose(a,a)},"hue-rotate":function(a){var c=Math.sin(a.angle*Math.PI/180);a=Math.cos(a.angle*Math.PI/180);c=h.mat4f32.fromValues(.213+.787*a-.213*c,.715-.715*a-.715*c,.072-.072*a+.928*c,0,.213-.213*a+.143*c,.715+.285*a+.14*c,.072-.072*a-.283*c,0,.213-.213*a-.787*c,
.715-.715*a+.715*c,.072+.928*a+.072*c,0,0,0,0,1);return l.mat4.transpose(c,c)},invert:function(a){var c=1-2*a.amount;a=a.amount;c=h.mat4f32.fromValues(c,0,0,a,0,c,0,a,0,0,c,a,0,0,0,1);return l.mat4.transpose(c,c)},brightness:function(a){a=a.amount;a=h.mat4f32.fromValues(a,0,0,0,0,a,0,0,0,0,a,0,0,0,0,1);return l.mat4.transpose(a,a)},contrast:function(a){a=a.amount;a=h.mat4f32.fromValues(a,0,0,.5-.5*a,0,a,0,.5-.5*a,0,0,a,.5-.5*a,0,0,0,1);return l.mat4.transpose(a,a)}};return function(a){function c(){var c=
null!==a&&a.apply(this,arguments)||this;c.customTransforms=null;c.done=!0;return c}m(c,a);q=c;c.fromString=function(a){var b=[],c=null;try{for(var d=0,k=p.parse(a);d<k.length;d++){var h=k[d];"opacity"===h.type?c=h:b.push(h)}}catch(ga){e.error(new t("invalid-type","Encountered an error when parsing css",ga))}return new q({transforms:b,opacity:c})};c.prototype.getOpacity=function(){return d.isSome(this.opacity)?this.opacity.amount:1};c.prototype.getColorMatrix=function(){var a=this;return(this.transforms||
[]).map(function(a){return r({},a)}).reverse().reduce(function(b,c){return l.mat4.multiply(b,b,a._getFactory(c)(c))},h.mat4f32.create())};c.prototype.clone=function(){return new q({transforms:this.transforms&&this.transforms.map(function(a){return r({},a)}),customTransforms:this.customTransforms&&this.customTransforms.map(function(a){return r({},a)})})};c.prototype._getFactory=function(a){var b=E[a.type];if(b)return b;if(this.customTransforms)for(var b=function(b){if(b.type===a.type){b=h.mat4f32.fromValues.apply(h.mat4f32,
b.matrix);var c=l.mat4.transpose(b,b);return{value:function(){return c}}}},c=0,d=this.customTransforms;c<d.length;c++){var k=b(d[c]);if("object"===typeof k)return k.value}e.error("invalid-type","No effect "+a.type+" exists");return function(){return h.mat4f32.create()}};var q;u([g.property()],c.prototype,"opacity",void 0);u([g.property()],c.prototype,"transforms",void 0);u([g.property()],c.prototype,"customTransforms",void 0);return c=q=u([g.subclass("esri.views.layers.support.ParsedFeatureEffect")],
c)}(g.declared(q.JSONSupport))})},"esri/views/layers/support/cssFilterParser":function(){define([],function(){function y(a,u,m,r){this.message=a;this.expected=u;this.found=m;this.location=r;this.name="SyntaxError";"function"===typeof Error.captureStackTrace&&Error.captureStackTrace(this,y)}(function(a,u){function m(){this.constructor=a}m.prototype=u.prototype;a.prototype=new m})(y,Error);y.buildMessage=function(a,u){function m(a){return a.charCodeAt(0).toString(16).toUpperCase()}function r(a){return a.replace(/\\/g,
"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(a){return"\\x0"+m(a)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(a){return"\\x"+m(a)})}function t(a){return a.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(a){return"\\x0"+m(a)}).replace(/[\x10-\x1F\x7F-\x9F]/g,
function(a){return"\\x"+m(a)})}var q={literal:function(a){return'"'+r(a.text)+'"'},"class":function(a){var c="",g;for(g=0;g<a.parts.length;g++)c+=a.parts[g]instanceof Array?t(a.parts[g][0])+"-"+t(a.parts[g][1]):t(a.parts[g]);return"["+(a.inverted?"^":"")+c+"]"},any:function(a){return"any character"},end:function(a){return"end of input"},other:function(a){return a.description}};return"Expected "+function(a){var c=Array(a.length),g;for(g=0;g<a.length;g++){var l=g,h;h=a[g];h=q[h.type](h);c[l]=h}c.sort();
if(0<c.length){for(a=g=1;g<c.length;g++)c[g-1]!==c[g]&&(c[a]=c[g],a++);c.length=a}switch(c.length){case 1:return c[0];case 2:return c[0]+" or "+c[1];default:return c.slice(0,-1).join(", ")+", or "+c[c.length-1]}}(a)+" but "+(u?'"'+r(u)+'"':"end of input")+" found."};return{SyntaxError:y,parse:function(a,u){function m(a,b){return{type:"literal",text:a,ignoreCase:b}}function r(a,b,c){return{type:"class",parts:a,inverted:b,ignoreCase:c}}function t(a){return{type:"other",description:a}}function q(b){var c=
oa[b],d;if(!c){for(d=b-1;!oa[d];)d--;c=oa[d];for(c={line:c.line,column:c.column};d<b;)10===a.charCodeAt(d)?(c.line++,c.column=1):c.column++,d++;oa[b]=c}return c}function c(a,b){var c=q(a),d=q(b);return{start:{offset:a,line:c.line,column:c.column},end:{offset:b,line:d.line,column:d.column}}}function d(a){f<da||(f>da&&(da=f,pa=[]),pa.push(a))}function g(){var c,e;v++;c=f;e=k();e!==b?(a.substr(f,4)===I?(e=I,f+=4):(e=b,0===v&&d(ga)),e!==b?(e=k(),e!==b?(A=c,c=null):(f=c,c=b)):(f=c,c=b)):(f=c,c=b);v--;
c===b&&(e=b,0===v&&d(ua));if(c===b)if(c=[],e=l(),e!==b)for(;e!==b;)c.push(e),e=l();else c=b;return c}function l(){var g,l,m,q,t,u,r,w,H;v++;l=f;m=k();m!==b?(a.substr(f,5)===Qa?(q=Qa,f+=5):(q=b,0===v&&d(fb)),q!==b?(t=k(),t!==b?(u=x(),u!==b?(r=k(),r!==b?(41===a.charCodeAt(f)?(w=T,f++):(w=b,0===v&&d(L)),w!==b?(H=k(),H!==b?(A=l,l=m={type:"blur",radius:u}):(f=l,l=b)):(f=l,l=b)):(f=l,l=b)):(f=l,l=b)):(f=l,l=b)):(f=l,l=b)):(f=l,l=b);v--;l===b&&(m=b,0===v&&d(xa));g=l;if(g===b){var B,I,Fa,da,ha,ja,Da,cb;v++;
B=f;I=k();I!==b?(a.substr(f,11)===Ra?(Fa=Ra,f+=11):(Fa=b,0===v&&d(hb)),Fa!==b?(da=k(),da!==b?(ha=h(),ha!==b?(ja=k(),ja!==b?(41===a.charCodeAt(f)?(Da=T,f++):(Da=b,0===v&&d(L)),Da!==b?(cb=k(),cb!==b?(A=B,B=I={type:"brightness",amount:ha}):(f=B,B=b)):(f=B,B=b)):(f=B,B=b)):(f=B,B=b)):(f=B,B=b)):(f=B,B=b)):(f=B,B=b);v--;B===b&&(I=b,0===v&&d(gb));g=B;if(g===b){var M,ga,Ea,oa,na,ua,pa,Ga;v++;M=f;ga=k();ga!==b?(a.substr(f,9)===Sa?(Ea=Sa,f+=9):(Ea=b,0===v&&d(jb)),Ea!==b?(oa=k(),oa!==b?(na=h(),na!==b?(ua=k(),
ua!==b?(41===a.charCodeAt(f)?(pa=T,f++):(pa=b,0===v&&d(L)),pa!==b?(Ga=k(),Ga!==b?(A=M,M=ga={type:"contrast",amount:na}):(f=M,M=b)):(f=M,M=b)):(f=M,M=b)):(f=M,M=b)):(f=M,M=b)):(f=M,M=b)):(f=M,M=b);v--;M===b&&(ga=b,0===v&&d(ib));g=M;if(g===b){var F,Ta,nb,Ha,ob,Ia,pb,Ja,za,Ka,Aa,La,qb,Ma;v++;F=f;Ta=k();if(Ta!==b)if(a.substr(f,12)===ya?(nb=ya,f+=12):(nb=b,0===v&&d(lb)),nb!==b)if(Ha=k(),Ha!==b)if(ob=x(),ob!==b)if(Ia=k(),Ia!==b)if(pb=x(),pb!==b)if(Ja=k(),Ja!==b)if(za=x(),za===b&&(za=null),za!==b)if(Ka=
k(),Ka!==b){var n,D,K,C,G,J,Y,U,ea,V,fa,W,Z,aa,Ba,va,Na,rb;n=f;35===a.charCodeAt(f)?(D=Mb,f++):(D=b,0===v&&d(Nb));if(D!==b)if(K=f,C=z(),C!==b?(G=z(),G!==b?K=C=[C,G]:(f=K,K=b)):(f=K,K=b),K!==b)if(C=f,G=z(),G!==b?(J=z(),J!==b?C=G=[G,J]:(f=C,C=b)):(f=C,C=b),C!==b)if(G=f,J=z(),J!==b?(Y=z(),Y!==b?G=J=[J,Y]:(f=G,G=b)):(f=G,G=b),G!==b){A=n;var db=C,eb=G;n=D=[parseInt(K.join(""),16),parseInt(db.join(""),16),parseInt(eb.join(""),16)]}else f=n,n=b;else f=n,n=b;else f=n,n=b;else f=n,n=b;if(n===b){n=f;35===a.charCodeAt(f)?
(D=Mb,f++):(D=b,0===v&&d(Nb));if(D!==b)if(K=z(),K!==b)if(C=z(),C!==b)if(G=z(),G!==b){A=n;var Oa=C,Pa=G;n=D=[parseInt([K,K].join(""),16),parseInt([Oa,Oa].join(""),16),parseInt([Pa,Pa].join(""),16)]}else f=n,n=b;else f=n,n=b;else f=n,n=b;else f=n,n=b;if(n===b&&(n=f,a.substr(f,5)===ka?(D=ka,f+=5):(D=b,0===v&&d(Ua)),D!==b?(K=k(),K!==b?(C=e(),C!==b?(G=k(),G!==b?(44===a.charCodeAt(f)?(J=ba,f++):(J=b,0===v&&d(ca)),J!==b?(Y=k(),Y!==b?(U=e(),U!==b?(ea=k(),ea!==b?(44===a.charCodeAt(f)?(V=ba,f++):(V=b,0===v&&
d(ca)),V!==b?(fa=k(),fa!==b?(W=e(),W!==b?(Z=k(),Z!==b?(44===a.charCodeAt(f)?(aa=ba,f++):(aa=b,0===v&&d(ca)),aa!==b?(Ba=k(),Ba!==b?(va=h(),va!==b?(Na=k(),Na!==b?(41===a.charCodeAt(f)?(rb=T,f++):(rb=b,0===v&&d(L)),rb!==b?(A=n,n=D=[255*C,255*U,255*W,va]):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b),n===b&&(n=f,a.substr(f,5)===ka?(D=ka,f+=5):(D=b,0===v&&d(Ua)),D!==
b?(K=k(),K!==b?(C=p(),C!==b?(G=k(),G!==b?(44===a.charCodeAt(f)?(J=ba,f++):(J=b,0===v&&d(ca)),J!==b?(Y=k(),Y!==b?(U=p(),U!==b?(ea=k(),ea!==b?(44===a.charCodeAt(f)?(V=ba,f++):(V=b,0===v&&d(ca)),V!==b?(fa=k(),fa!==b?(W=p(),W!==b?(44===a.charCodeAt(f)?(Z=ba,f++):(Z=b,0===v&&d(ca)),Z!==b?(aa=k(),aa!==b?(Ba=h(),Ba!==b?(41===a.charCodeAt(f)?(va=T,f++):(va=b,0===v&&d(L)),va!==b?(A=n,n=D=[C,U,W,Ba]):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):
(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b),n===b&&(n=f,a.substr(f,5)===ka?(D=ka,f+=5):(D=b,0===v&&d(Ua)),D!==b?(K=k(),K!==b?(C=e(),C!==b?(G=k(),G!==b?(44===a.charCodeAt(f)?(J=ba,f++):(J=b,0===v&&d(ca)),J!==b?(Y=k(),Y!==b?(U=e(),U!==b?(ea=k(),ea!==b?(44===a.charCodeAt(f)?(V=ba,f++):(V=b,0===v&&d(ca)),V!==b?(fa=k(),fa!==b?(W=e(),W!==b?(Z=k(),Z!==b?(41===a.charCodeAt(f)?(aa=T,f++):(aa=b,0===v&&d(L)),aa!==b?(A=n,n=D=[255*C,255*U,255*W,1]):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=
b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b),n===b&&(n=f,a.substr(f,5)===ka?(D=ka,f+=5):(D=b,0===v&&d(Ua)),D!==b?(K=k(),K!==b?(C=p(),C!==b?(G=k(),G!==b?(44===a.charCodeAt(f)?(J=ba,f++):(J=b,0===v&&d(ca)),J!==b?(Y=k(),Y!==b?(U=p(),U!==b?(ea=k(),ea!==b?(44===a.charCodeAt(f)?(V=ba,f++):(V=b,0===v&&d(ca)),V!==b?(fa=k(),fa!==b?(W=p(),W!==b?(41===a.charCodeAt(f)?(Z=T,f++):(Z=b,0===v&&d(L)),Z!==b?(A=n,n=D=[C,U,W,1]):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):
(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b),n===b&&(n=f,a.substr(f,4)===Va?(D=Va,f+=4):(D=b,0===v&&d(Ob)),D!==b?(K=k(),K!==b?(C=e(),C!==b?(G=k(),G!==b?(44===a.charCodeAt(f)?(J=ba,f++):(J=b,0===v&&d(ca)),J!==b?(Y=k(),Y!==b?(U=e(),U!==b?(ea=k(),ea!==b?(44===a.charCodeAt(f)?(V=ba,f++):(V=b,0===v&&d(ca)),V!==b?(fa=k(),fa!==b?(W=e(),W!==b?(Z=k(),Z!==b?(41===a.charCodeAt(f)?(aa=T,f++):(aa=b,0===v&&d(L)),aa!==b?(A=n,n=D=[255*C,255*U,255*W,1]):(f=n,n=b)):(f=n,n=
b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b),n===b&&(n=f,a.substr(f,4)===Va?(D=Va,f+=4):(D=b,0===v&&d(Ob)),D!==b?(K=k(),K!==b?(C=p(),C!==b?(G=k(),G!==b?(44===a.charCodeAt(f)?(J=ba,f++):(J=b,0===v&&d(ca)),J!==b?(Y=k(),Y!==b?(U=p(),U!==b?(ea=k(),ea!==b?(44===a.charCodeAt(f)?(V=ba,f++):(V=b,0===v&&d(ca)),V!==b?(fa=k(),fa!==b?(W=p(),W!==b?(Z=k(),Z!==b?(41===a.charCodeAt(f)?(aa=T,f++):(aa=b,0===v&&d(L)),aa!==b?(A=n,n=D=[C,U,
W,1]):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b)):(f=n,n=b),n===b))))))){var Ca,qa,ra;v++;Ca=f;qa=[];Pb.test(a.charAt(f))?(ra=a.charAt(f),f++):(ra=b,0===v&&d(Qb));if(ra!==b)for(;ra!==b;)qa.push(ra),Pb.test(a.charAt(f))?(ra=a.charAt(f),f++):(ra=b,0===v&&d(Qb));else qa=b;if(qa!==b){A=Ca;var sb=a.substring(A,f);if(!qc.has(sb)){var Lb='unknown color "'+sb+'"',Wa=void 0,Wa=void 0!==Wa?Wa:c(A,f);throw new y(Lb,null,
null,Wa);}qa=Rb[sb].concat(1)}Ca=qa;v--;Ca===b&&(qa=b,0===v&&d(rc));n=Ca}}Aa=n;Aa===b&&(Aa=null);Aa!==b?(La=k(),La!==b?(41===a.charCodeAt(f)?(qb=T,f++):(qb=b,0===v&&d(L)),qb!==b?(Ma=k(),Ma!==b?(A=F,F=Ta={type:"drop-shadow",offsetX:ob,offsetY:pb,blurRadius:za,color:Aa}):(f=F,F=b)):(f=F,F=b)):(f=F,F=b)):(f=F,F=b)}else f=F,F=b;else f=F,F=b;else f=F,F=b;else f=F,F=b;else f=F,F=b;else f=F,F=b;else f=F,F=b;else f=F,F=b;else f=F,F=b;v--;F===b&&(Ta=b,0===v&&d(kb));g=F;if(g===b){var N,Xa,tb,Sb,ub,Tb,vb,Ub;
v++;N=f;Xa=k();Xa!==b?(a.substr(f,10)===la?(tb=la,f+=10):(tb=b,0===v&&d(sc)),tb!==b?(Sb=k(),Sb!==b?(ub=h(),ub!==b?(Tb=k(),Tb!==b?(41===a.charCodeAt(f)?(vb=T,f++):(vb=b,0===v&&d(L)),vb!==b?(Ub=k(),Ub!==b?(A=N,N=Xa={type:"grayscale",amount:ub}):(f=N,N=b)):(f=N,N=b)):(f=N,N=b)):(f=N,N=b)):(f=N,N=b)):(f=N,N=b)):(f=N,N=b);v--;N===b&&(Xa=b,0===v&&d(mb));g=N;if(g===b){var O,Ya,wb,Vb,xb,Wb,yb,Xb;v++;O=f;Ya=k();if(Ya!==b)if(a.substr(f,11)===wa?(wb=wa,f+=11):(wb=b,0===v&&d(tc)),wb!==b)if(Vb=k(),Vb!==b){var X,
ma,sa;v++;X=f;var ia,ta,Yb;v++;ia=f;uc.test(a.charAt(f))?(ta=a.charAt(f),f++):(ta=b,0===v&&d(vc));ta===b&&(ta=null);ta!==b?(Yb=p(),Yb!==b?(A=ia,ia=ta=parseFloat(a.substring(A,f))):(f=ia,ia=b)):(f=ia,ia=b);v--;ia===b&&(ta=b,0===v&&d(wc));ma=ia;ma!==b?(sa=E(),sa!==b?(A=X,X=ma*=sa):(f=X,X=b)):(f=X,X=b);X===b&&(X=f,48===a.charCodeAt(f)?(ma=Zb,f++):(ma=b,0===v&&d($b)),ma!==b?(sa=E(),sa===b&&(sa=null),sa!==b?(A=X,X=ma=0):(f=X,X=b)):(f=X,X=b));v--;X===b&&(ma=b,0===v&&d(xc));xb=X;xb!==b?(Wb=k(),Wb!==b?(41===
a.charCodeAt(f)?(yb=T,f++):(yb=b,0===v&&d(L)),yb!==b?(Xb=k(),Xb!==b?(A=O,O=Ya={type:"hue-rotate",angle:xb}):(f=O,O=b)):(f=O,O=b)):(f=O,O=b)):(f=O,O=b)}else f=O,O=b;else f=O,O=b;else f=O,O=b;v--;O===b&&(Ya=b,0===v&&d(yc));g=O;if(g===b){var P,Za,zb,ac,Ab,bc,Bb,cc;v++;P=f;Za=k();Za!==b?(a.substr(f,7)===dc?(zb=dc,f+=7):(zb=b,0===v&&d(zc)),zb!==b?(ac=k(),ac!==b?(Ab=h(),Ab!==b?(bc=k(),bc!==b?(41===a.charCodeAt(f)?(Bb=T,f++):(Bb=b,0===v&&d(L)),Bb!==b?(cc=k(),cc!==b?(A=P,P=Za={type:"invert",amount:Ab}):(f=
P,P=b)):(f=P,P=b)):(f=P,P=b)):(f=P,P=b)):(f=P,P=b)):(f=P,P=b)):(f=P,P=b);v--;P===b&&(Za=b,0===v&&d(Ac));g=P;if(g===b){var Q,$a,Cb,ec,Db,fc,Eb,gc;v++;Q=f;$a=k();$a!==b?(a.substr(f,8)===hc?(Cb=hc,f+=8):(Cb=b,0===v&&d(Bc)),Cb!==b?(ec=k(),ec!==b?(Db=h(),Db!==b?(fc=k(),fc!==b?(41===a.charCodeAt(f)?(Eb=T,f++):(Eb=b,0===v&&d(L)),Eb!==b?(gc=k(),gc!==b?(A=Q,Q=$a={type:"opacity",amount:Db}):(f=Q,Q=b)):(f=Q,Q=b)):(f=Q,Q=b)):(f=Q,Q=b)):(f=Q,Q=b)):(f=Q,Q=b)):(f=Q,Q=b);v--;Q===b&&($a=b,0===v&&d(Cc));g=Q;if(g===
b){var R,ab,Fb,ic,Gb,jc,Hb,kc;v++;R=f;ab=k();ab!==b?(a.substr(f,9)===lc?(Fb=lc,f+=9):(Fb=b,0===v&&d(Dc)),Fb!==b?(ic=k(),ic!==b?(Gb=h(),Gb!==b?(jc=k(),jc!==b?(41===a.charCodeAt(f)?(Hb=T,f++):(Hb=b,0===v&&d(L)),Hb!==b?(kc=k(),kc!==b?(A=R,R=ab={type:"saturate",amount:Gb}):(f=R,R=b)):(f=R,R=b)):(f=R,R=b)):(f=R,R=b)):(f=R,R=b)):(f=R,R=b)):(f=R,R=b);v--;R===b&&(ab=b,0===v&&d(Ec));g=R;if(g===b){var S,bb,Ib,mc,Jb,nc,Kb,oc;v++;S=f;bb=k();bb!==b?(a.substr(f,6)===pc?(Ib=pc,f+=6):(Ib=b,0===v&&d(Fc)),Ib!==b?(mc=
k(),mc!==b?(Jb=h(),Jb!==b?(nc=k(),nc!==b?(41===a.charCodeAt(f)?(Kb=T,f++):(Kb=b,0===v&&d(L)),Kb!==b?(oc=k(),oc!==b?(A=S,S=bb={type:"sepia",amount:Jb}):(f=S,S=b)):(f=S,S=b)):(f=S,S=b)):(f=S,S=b)):(f=S,S=b)):(f=S,S=b)):(f=S,S=b);v--;S===b&&(bb=b,0===v&&d(Gc));g=S}}}}}}}}}return g}function h(){var a;v++;a=e();a===b&&(a=p());v--;a===b&&0===v&&d(cb);return a}function p(){var c,e,g;v++;c=f;e=[];ha.test(a.charAt(f))?(g=a.charAt(f),f++):(g=b,0===v&&d(ja));if(g!==b)for(;g!==b;)e.push(g),ha.test(a.charAt(f))?
(g=a.charAt(f),f++):(g=b,0===v&&d(ja));else e=b;if(e!==b)if(46===a.charCodeAt(f)?(g=Da,f++):(g=b,0===v&&d(Lb)),g!==b){e=[];ha.test(a.charAt(f))?(g=a.charAt(f),f++):(g=b,0===v&&d(ja));if(g!==b)for(;g!==b;)e.push(g),ha.test(a.charAt(f))?(g=a.charAt(f),f++):(g=b,0===v&&d(ja));else e=b;e!==b?(A=c,c=e=parseFloat(a.substring(A,f))):(f=c,c=b)}else f=c,c=b;else f=c,c=b;if(c===b){v++;c=f;e=[];ha.test(a.charAt(f))?(g=a.charAt(f),f++):(g=b,0===v&&d(ja));if(g!==b)for(;g!==b;)e.push(g),ha.test(a.charAt(f))?(g=
a.charAt(f),f++):(g=b,0===v&&d(ja));else e=b;e!==b&&(A=c,e=parseInt(a.substring(A,f),10));c=e;v--;c===b&&(e=b,0===v&&d(Ea))}v--;c===b&&(e=b,0===v&&d(Fa));return c}function e(){var c,e,g;c=f;e=p();e!==b?(37===a.charCodeAt(f)?(g=Hc,f++):(g=b,0===v&&d(Ic)),g!==b?(A=c,c=e/100):(f=c,c=b)):(f=c,c=b);return c}function E(){var c,e;v++;c=f;a.substr(f,3)===Ga?(e=Ga,f+=3):(e=b,0===v&&d(Jc));e!==b&&(A=c,e=1);c=e;c===b&&(c=f,a.substr(f,4)===Ha?(e=Ha,f+=4):(e=b,0===v&&d(Kc)),e!==b&&(A=c,e=.9),c=e,c===b&&(c=f,a.substr(f,
3)===Ia?(e=Ia,f+=3):(e=b,0===v&&d(Lc)),e!==b&&(A=c,e=180/Math.PI),c=e,c===b&&(c=f,a.substr(f,4)===Ja?(e=Ja,f+=4):(e=b,0===v&&d(Mc)),e!==b&&(A=c,e=1/360),c=e)));v--;c===b&&(e=b,0===v&&d(Nc));return c}function x(){var c,e,g;v++;c=f;e=p();e!==b?(g=w(),g!==b?(A=c,c=e*g):(f=c,c=b)):(f=c,c=b);c===b&&(c=f,48===a.charCodeAt(f)?(e=Zb,f++):(e=b,0===v&&d($b)),e!==b?(g=w(),g===b&&(g=null),g!==b?(A=c,c=0):(f=c,c=b)):(f=c,c=b));v--;c===b&&(e=b,0===v&&d(Oc));return c}function w(){var c,e;c=f;a.substr(f,2)===Ka?
(e=Ka,f+=2):(e=b,0===v&&d(Pc));e!==b&&(A=c,e=1);c=e;c===b&&(c=f,a.substr(f,2)===La?(e=La,f+=2):(e=b,0===v&&d(Qc)),e!==b&&(A=c,e=96/2.54),c=e,c===b&&(c=f,a.substr(f,2)===Ma?(e=Ma,f+=2):(e=b,0===v&&d(Rc)),e!==b&&(A=c,e=96/2.54/10),c=e,c===b&&(c=f,81===a.charCodeAt(f)?(e=Sc,f++):(e=b,0===v&&d(Tc)),e!==b&&(A=c,e=96/2.54/40),c=e,c===b&&(c=f,a.substr(f,2)===Na?(e=Na,f+=2):(e=b,0===v&&d(Uc)),e!==b&&(A=c,e=96),c=e,c===b&&(c=f,a.substr(f,2)===db?(e=db,f+=2):(e=b,0===v&&d(Vc)),e!==b&&(A=c,e=16),c=e,c===b&&
(c=f,a.substr(f,2)===eb?(e=eb,f+=2):(e=b,0===v&&d(Wc)),e!==b&&(A=c,e=96/73),c=e))))));return c}function z(){var c;Xc.test(a.charAt(f))?(c=a.charAt(f),f++):(c=b,0===v&&d(Yc));return c}function k(){var c,e;v++;c=[];Oa.test(a.charAt(f))?(e=a.charAt(f),f++):(e=b,0===v&&d(Pa));for(;e!==b;)c.push(e),Oa.test(a.charAt(f))?(e=a.charAt(f),f++):(e=b,0===v&&d(Pa));v--;c===b&&(e=b,0===v&&d(Zc));return c}u=void 0!==u?u:{};var b={},H={start:g},B=g,ua=t("none"),I="none",ga=m("none",!1),xa=t("blur()"),Qa="blur(",
fb=m("blur(",!1),T=")",L=m(")",!1),gb=t("brightness()"),Ra="brightness(",hb=m("brightness(",!1),ib=t("contrast()"),Sa="contrast(",jb=m("contrast(",!1),kb=t("drop-shadow()"),ya="drop-shadow(",lb=m("drop-shadow(",!1),mb=t("grayscale()"),la="grayscale(",sc=m("grayscale(",!1),yc=t("hue-rotate()"),wa="hue-rotate(",tc=m("hue-rotate(",!1),Ac=t("invert()"),dc="invert(",zc=m("invert(",!1),Cc=t("opacity()"),hc="opacity(",Bc=m("opacity(",!1),Ec=t("saturate()"),lc="saturate(",Dc=m("saturate(",!1),Gc=t("sepia()"),
pc="sepia(",Fc=m("sepia(",!1),cb=t("\x3cnumber-percentage\x3e"),Ea=t("\x3cinteger\x3e"),ha=/^[0-9]/,ja=r([["0","9"]],!1,!1),Fa=t("\x3cnumber\x3e"),Da=".",Lb=m(".",!1),wc=t("\x3csignedNumber\x3e"),uc=/^[+\-]/,vc=r(["+","-"],!1,!1),Hc="%",Ic=m("%",!1),xc=t("\x3cangle\x3e"),Zb="0",$b=m("0",!1),Nc=t("\x3cunit\x3e"),Ga="deg",Jc=m("deg",!1),Ha="grad",Kc=m("grad",!1),Ia="rad",Lc=m("rad",!1),Ja="turn",Mc=m("turn",!1),Oc=t("\x3clength\x3e"),Ka="px",Pc=m("px",!1),La="cm",Qc=m("cm",!1),Ma="mm",Rc=m("mm",!1),
Sc="Q",Tc=m("Q",!1),Na="in",Uc=m("in",!1),db="pc",Vc=m("pc",!1),eb="pt",Wc=m("pt",!1),Mb="#",Nb=m("#",!1),ka="rgba(",Ua=m("rgba(",!1),ba=",",ca=m(",",!1),Va="rgb(",Ob=m("rgb(",!1),Xc=/^[0-9a-fA-F]/,Yc=r([["0","9"],["a","f"],["A","F"]],!1,!1),Zc=t("whitespace"),Oa=/^[ \t\n\r]/,Pa=r([" ","\t","\n","\r"],!1,!1),rc=t("\x3cnamed-color\x3e"),Pb=/^[a-z]/,Qb=r([["a","z"]],!1,!1),f=0,A=0,oa=[{line:1,column:1}],da=0,pa=[],v=0,na;if("startRule"in u){if(!(u.startRule in H))throw Error("Can't start parsing from rule \""+
u.startRule+'".');B=H[u.startRule]}var Rb={transparent:[0,0,0,0],black:[0,0,0],silver:[192,192,192],gray:[128,128,128],white:[255,255,255],maroon:[128,0,0],red:[255,0,0],purple:[128,0,128],fuchsia:[255,0,255],green:[0,128,0],lime:[0,255,0],olive:[128,128,0],yellow:[255,255,0],navy:[0,0,128],blue:[0,0,255],teal:[0,128,128],aqua:[0,255,255],aliceblue:[240,248,255],antiquewhite:[250,235,215],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],blanchedalmond:[255,235,
205],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],
darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],greenyellow:[173,255,47],grey:[128,
128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,
206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,
225],moccasin:[255,228,181],navajowhite:[255,222,173],oldlace:[253,245,230],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],rebeccapurple:[102,51,153],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,
128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],whitesmoke:[245,245,245],yellowgreen:[154,205,50]},qc=new Set(Object.keys(Rb));na=B();if(na!==b&&f===a.length)return na;na!==
b&&f<a.length&&d({type:"end"});throw function(a,b,c){return new y(y.buildMessage(a,b),a,b,c)}(pa,da<a.length?a.charAt(da):null,da<a.length?c(da,da+1):c(da,da));}}})},"esri/views/layers/support/Transition":function(){define("require exports ../../../core/tsSupport/decorateHelper ../../../core/tsSupport/declareExtendsHelper ../../../core/Accessor ../../../core/accessorSupport/decorators ../../../core/libs/gl-matrix-2/mat4".split(" "),function(y,a,u,m,r,t,q){return function(a){function c(){var c=null!==
a&&a.apply(this,arguments)||this;c.from=null;c.to=null;c.duration=4E3;c.repeat=!0;c.done=!1;return c}m(c,a);g=c;c.prototype.getColorMatrix=function(){this.done=!1;if(null==this._lastTime)this._currentStep=0,this._lastTime=Date.now();else{var a=this._lastTime,c=Date.now();this._currentStep+=c-a;2147483647<=this._currentStep&&(this._currentStep=0);this._lastTime=c}var a=this._currentStep%this.duration/(this.duration/2),a=1>=a?a:2-a,c=this.from.getColorMatrix(),d=this.to.getColorMatrix();q.mat4.multiplyScalar(c,
c,1-a);q.mat4.multiplyScalar(d,d,a);!this.repeat&&this._currentStep>=this.duration&&(this.done=!0);return q.mat4.add(c,c,d)};c.prototype.getOpacity=function(){throw Error("No getOpacity definition for Transition");};c.prototype.clone=function(){var a=new g({from:this.from.clone(),to:this.to.clone(),duration:this.duration});a._lastTime=this._lastTime;a._currentStep=this._currentStep;return a};var g;u([t.property()],c.prototype,"from",void 0);u([t.property()],c.prototype,"to",void 0);u([t.property({type:Number})],
c.prototype,"duration",void 0);u([t.property({type:Boolean})],c.prototype,"repeat",void 0);return c=g=u([t.subclass("esri.views.layers.support.Transition")],c)}(t.declared(r))})},"esri/views/layers/support/popupUtils":function(){define("require exports ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper @dojo/framework/shim/array ../../../core/maybe ../../../layers/support/fieldUtils".split(" "),function(y,a,u,m,r,t,q){Object.defineProperty(a,"__esModule",{value:!0});a.getRequiredFields=
function(a,d){void 0===d&&(d=a.popupTemplate);return m(this,void 0,void 0,function(){var c,l,h,m,e,y,x,w,z,k,b;return u(this,function(g){switch(g.label){case 0:return t.isSome(d)?[4,d.getRequiredFields(a.fields)]:[2,[]];case 1:c=g.sent();l=d.lastEditInfoEnabled;h=a.objectIdField;m=a.typeIdField;e=a.globalIdField;if(r.includes(c,"*"))return[2,["*"]];x=q.fixFields;w=[a.fields];k=(z=c).concat;return(b=l)?[4,q.getFeatureEditFields(a)]:[3,3];case 2:b=g.sent(),g.label=3;case 3:return y=x.apply(void 0,w.concat([k.apply(z,
[b||null])])),m&&y.push(m),y&&h&&q.hasField(a.fields,h)&&-1===y.indexOf(h)&&y.push(h),y&&e&&q.hasField(a.fields,e)&&-1===y.indexOf(e)&&y.push(e),[2,y]}})})};a.getFetchPopupTemplate=function(a,d){return a.popupTemplate?a.popupTemplate:t.isSome(d)&&d.defaultPopupTemplateEnabled&&t.isSome(a.defaultPopupTemplate)?a.defaultPopupTemplate:null}})},"*noref":1}});
define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/tsSupport/paramHelper ../../../core/tsSupport/assignHelper ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../AggregateGraphic ../../../geometry ../../../Graphic ../../../core/arrayUtils ../../../core/Collection ../../../core/Error ../../../core/has ../../../core/iteratorUtils ../../../core/Logger ../../../core/maybe ../../../core/promiseUtils ../../../core/watchUtils ../../../core/accessorSupport/decorators ../../../layers/graphics/data/projectionSupport ../../../renderers/support/clickToleranceUtils ../../../tasks/support/FeatureSet ../../../tasks/support/Query ../engine ./LayerView2D ./features/tileRenderers ./features/support/rendererUtils ./support/clusterUtils ./support/FeatureLayerProxy ./support/popupUtils2D ./support/util ../tiling/TileStrategy ../../layers/FeatureLayerView ../../layers/LayerView ../../layers/RefreshableLayerView ../../../views/layers/support/FeatureFilter ../../layers/support/FeatureEffect".split(" "),function(y,
a,u,m,r,t,q,c,d,g,l,h,p,e,E,x,w,z,k,b,H,B,ua,I,ga,xa,Qa,fb,T,L,gb,Ra,hb,ib,Sa,jb,kb,ya,lb){function mb(a){return a&&"openPorts"in a}var la=w.getLogger("esri.views.2d.layers.FeatureLayerView2D");return function(a){function r(){var b=null!==a&&a.apply(this,arguments)||this;b._pipelineIsUpdating=!0;b._updatingPipelineConfig=!1;b._viewStateId=-1;b._visibilityOverrides=new Set;b._effect=null;b._highlightIds=new Map;b._onGoingEdits=0;b.container=new xa.Container;b.filter=null;b.doRefresh=k.debounce(function(){b._onGoingEdits=
0;return b._proxy.refresh().catch(function(a){k.isAbortError(a)||la.error(a)})});b._onRenderingConfigChange=k.debounce(function(){return c(b,void 0,void 0,function(){var a,b,c,d,e,g,k,h,l,m,p,r,t,wa,u,w,y;return q(this,function(q){switch(q.label){case 0:if(!this._hasRequiredSupport(this.layer))return[2];this._set("_updatingPipelineConfig",!0);return[4,this._effectiveRendererPromise];case 1:return a=q.sent(),b=a.renderer,c=a.aggregateFields,d=a.featureReduction,[4,this._updateRequiredFields()];case 2:return q.sent(),
e=this.availableFields.join("."),g=this._createLayerFilterHash(),k=this._createTileRendererHash(b),h=this._createFeatureDataHash(b),l=this._createMeshHash(b),m=e!==this._clientDataHash,p=g!==this._layerFilterHash,t=(r=h!==this._featureDataHash||m)&&!!this.layer.featureReduction,wa=l!==this._meshHash||t,u={invalidateFeatureData:r,invalidateMesh:wa,layerFilterChanged:p},w=this._createConfiguration(b,c,d),k===this._tileRendererHash?[3,9]:[4,this._initTileRenderer(b)];case 3:return q.sent(),[4,this._createServiceOptions()];
case 4:return y=q.sent(),this.effects.forEach(function(a){return z.isSome(a)&&z.isSome(a.filter)&&a.filter.enable()}),this.tileRenderer.onConfigUpdate(b),[4,this._proxy.startup(this.view.featuresTilingScheme,w,y,u)];case 5:return q.sent(),this.hasHighlight()?[4,this._proxy.setHighlight(x.keysOfMap(this._highlightIds))]:[3,7];case 6:q.sent(),q.label=7;case 7:return[4,this._onceTilesUpdated()];case 8:return q.sent(),this.tileRenderer.onConfigUpdate(b),[3,14];case 9:return this._lockAttributeTextureUpload(),
m||p||r||wa?[4,this._proxy.update(w,u)]:[3,11];case 10:q.sent(),q.label=11;case 11:return p?[4,this._onceTilesUpdated()]:[3,13];case 12:q.sent(),q.label=13;case 13:this._unlockAttributeTextureUpload(),this.effects.forEach(function(a){return z.isSome(a)&&z.isSome(a.filter)&&a.filter.enable()}),this.tileRenderer.onConfigUpdate(b),this._forceAttributeTextureUpload(),q.label=14;case 14:return this._clientDataHash=e,this._layerFilterHash=g,this._tileRendererHash=k,this._meshHash=l,this._featureDataHash=
h,this.tileRenderer.invalidateLabels(),this.requestUpdate(),[2]}})})});b._updateHighlight=k.debounce(function(){return c(b,void 0,void 0,function(){return q(this,function(a){return[2,this._proxy.setHighlight(x.keysOfMap(this._highlightIds))]})})});return b}u(r,a);r.prototype.destroy=function(){this._proxy.destroy();z.andThen(this._updateClusterSizeTask,function(a){return a.remove()})};r.prototype.initialize=function(){var a=this;this.addResolvingPromise(this._initProxy());this.handles.add([this.clips.on("change",
function(){return a.tileRenderer&&a.tileRenderer.onConfigUpdate(a._effectiveRenderer)}),this.on("valueRangesChanged",function(b){a._set("_aggregateValueRanges",b.valueRanges)})])};r.prototype._initProxy=function(){return c(this,void 0,void 0,function(){var a,b,c;return q(this,function(d){if(this.layer.isTable)throw new e("featurelayerview:table-not-supported","table feature layer can't be displayed",{layer:this.layer});a=this.layer.spatialReference;b=g.SpatialReference.WGS84;if(this.layer.featureReduction&&
!B.doesBrowserSupportProjection(a,b))throw new e("featurelayerview:featureReduction-not-supported","cannot project feature layer to WGS84",{inSpatialReference:a,outSpatialReference:b});this._proxy&&this._proxy.destroy();c=this._createClientOptions();this._set("_proxy",new gb.default({client:c}));return[2,this._proxy.when()]})})};Object.defineProperty(r.prototype,"_effectiveRendererPromise",{get:function(){var a=this,b=this._getEffectiveRenderer();b.then(function(b){return a._set("_effectiveRenderer",
b.renderer)});return b},enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,"labelsVisible",{get:function(){return!this.suspended&&this.layer.labelingInfo&&this.layer.labelsVisible},enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,"effect",{get:function(){return z.unwrapOr(this._effect,null)},set:function(a){var b=this._effect;z.isSome(b)&&z.isSome(b.filter)&&b.filter.enabled&&z.isSome(a)&&z.isSome(a.filter)&&a.filter.enable();this._effect=a;this.notifyChange("effect")},
enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,"effects",{get:function(){return this.effect&&[this.effect]||[]},enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,"numFeatures",{get:function(){var a=0;this.attached&&this._tileStrategy.tiles.forEach(function(b){a+=b.iconDisplayRecords?b.iconDisplayRecords.length:0});return a},enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,"renderingConfigHash",{get:function(){if(!this.layer)return null;var a=this.availableFields,
b=this.layer,c=b.definitionExpression,d=b.renderer,b=b.labelingInfo,e="feature"===this.layer.type?this.layer.gdbVersion:void 0,g="feature"===this.layer.type&&this.layer.historicMoment?this.layer.historicMoment.getTime():void 0,k=this.timeExtent,h="filter"in this.layer&&this.layer.filter&&""+JSON.stringify(this.layer.filter.geometry)+this.layer.filter.where,l=JSON.stringify(this.clips),m=this.layer.featureReduction&&this.layer.featureReduction.toJSON();return JSON.stringify({filterHash:z.isSome(this.filter)&&
this.filter.toJSON(),effectHash:z.isSome(this.effect)&&this.effect.toJSON(),streamFilter:h,gdbVersion:e,definitionExpression:c,historicMoment:g,availableFields:a,renderer:d,labelingInfo:b,timeExtent:k,clipsHash:l,featureReduction:m})},enumerable:!0,configurable:!0});r.prototype.highlight=function(a){var b=this,c;a instanceof l?c=[a.getObjectId()]:"number"===typeof a?c=[a]:p.isCollection(a)?c=a.map(function(a){return a&&a.getAttribute(b.layer.objectIdField)}).toArray():Array.isArray(a)&&0<a.length&&
(c="number"===typeof a[0]?a:a.map(function(a){return a&&a.getAttribute(b.layer.objectIdField)}));if(!c||!c.length)return{remove:function(){},pause:function(){},resume:function(){}};c=c.filter(function(a){return null!=a});this._addHighlight(c);return{remove:function(){return b._removeHighlight(c)},pause:function(){return b._removeHighlight(c)},resume:function(){return b._addHighlight(c)}}};r.prototype.hasHighlight=function(){return!!this._highlightIds.size};r.prototype.hitTest=function(a,b){return this._hitTest(a,
b)};r.prototype.queryStatistics=function(){return this._proxy.queryStatistics()};r.prototype.queryFeatures=function(a,b){var c=this;return this.queryFeaturesJSON(a,b).then(function(a){a=I.fromJSON(a);a.features.forEach(function(a){a.layer=c.layer;a.sourceLayer=c.layer});return a})};r.prototype.queryFeaturesJSON=function(a,b){return this._proxy.queryFeatures(this._cleanUpQuery(a),b)};r.prototype.queryObjectIds=function(a,b){return this._proxy.queryObjectIds(this._cleanUpQuery(a),b)};r.prototype.queryFeatureCount=
function(a,b){return this._proxy.queryFeatureCount(this._cleanUpQuery(a),b)};r.prototype.queryExtent=function(a,b){return this._proxy.queryExtent(this._cleanUpQuery(a),b).then(function(a){return{count:a.count,extent:g.Extent.fromJSON(a.extent)}})};r.prototype.setVisibility=function(a,b){b?this._visibilityOverrides.delete(a):this._visibilityOverrides.add(a);this._renderingConfigHashChanged()};r.prototype.update=function(a){this.attached&&this._tileStrategy&&this.tileRenderer&&(this._tileStrategy.update(a)||
this.requestUpdate(),a=a.state,this._viewStateId!==a.id&&(this._proxy.setViewState(a),this._viewStateId=a.id),this.notifyChange("numFeatures"),this.notifyChange("updating"))};r.prototype.attach=function(){var a=this;this.view.timeline.record(this.layer.title+" (FeatureLayer) Attach");this._tileStrategy=new ib({cachePolicy:"purge",acquireTile:function(b){return a._acquireTile(b)},releaseTile:function(b){return a._releaseTile(b)},tileInfoView:this.view.featuresTilingScheme,buffer:0});this.handles.add([this.layer.on("edits",
function(b){return c(a,void 0,void 0,function(){return q(this,function(a){switch(a.label){case 0:return this._onGoingEdits++,[4,this._proxy.onEdits(b)];case 1:return a.sent(),this._onGoingEdits=Math.max(0,this._onGoingEdits-1),[2]}})})}),b.init(this,"renderingConfigHash",function(){return a._renderingConfigHashChanged()},!0)],"attach")};r.prototype.detach=function(){this.container.removeAllChildren();this.handles.remove("attach");this._updatingPipelineConfig=!1;this.tileRenderer&&(this.tileRenderer.uninstall(this.container),
this.tileRenderer=null);this._tileStrategy&&(this._tileStrategy.destroy(),this._tileStrategy=null)};r.prototype.moveStart=function(){this.requestUpdate()};r.prototype.viewChange=function(){this.requestUpdate()};r.prototype.moveEnd=function(){this.requestUpdate()};r.prototype.fetchPopupFeatures=function(a,b){return c(this,void 0,void 0,function(){var c,e,g,l;return q(this,function(m){if(z.isSome(b)&&b.clientGraphics.length&&(c=b.clientGraphics[0],c instanceof d))return[2,[c]];if(e=this.validateFetchPopupFeatures(b))return[2,
k.reject(e)];if(z.isSome(b)&&0===b.clientGraphics.length)return[2,k.resolve([])];g=this.fetchClientPopupFeatures(b);if(!a)return[2,g];l=this._fetchServicePopupFeatures(a,b);return[2,k.eachAlwaysValues([g,l]).then(h.flatten)]})})};r.prototype._fetchServicePopupFeatures=function(a,b){return c(this,void 0,void 0,function(){var c,d,e,g,k,h,l,m,p,r;return q(this,function(q){switch(q.label){case 0:return[4,this.createPopupQuery(b)];case 1:c=q.sent();d=this.layer;e=d.renderer;g=ua.calculateTolerance(e);
c.geometry=this.createFetchPopupFeaturesQueryGeometry(a,g);k=new Set;h=d.objectIdField;if(l=z.isSome(b)?b.clientGraphics:null)for(m=0,p=l;m<p.length;m++)r=p[m],k.add(r.attributes[h]);return[2,d.queryFeatures(c).then(function(a){return a.features.filter(function(a){return!k.has(a.attributes[h])})})]}})})};r.prototype.createFetchPopupFeaturesQueryGeometry=function(a,b){return Ra.createQueryGeometry(a,b,this.view)};r.prototype.isUpdating=function(){return null!=this.layer.renderer&&(null!=this._updatingRequiredFieldsPromise||
null==this.tileRenderer||!this._proxy||!this._proxy.isReady||this._pipelineIsUpdating||this._updatingPipelineConfig||this.tileRenderer.updating||0<this._onGoingEdits)};r.prototype._createClientOptions=function(){var a=this;return{setUpdating:function(b){a._set("_pipelineIsUpdating",b)},emitEvent:function(b){a.emit(b.name,b.event)}}};r.prototype._createServiceOptions=function(){return c(this,void 0,void 0,function(){var a,b,c,d,e,g,k,h,l;return q(this,function(m){switch(m.label){case 0:return a=this.layer,
b=a.capabilities,c=a.objectIdField,d=a.fields.map(function(a){return a.toJSON()}),e=a.fullExtent&&a.fullExtent.toJSON(),g=hb.toJSONGeometryType(a.geometryType),k=a.timeInfo&&a.timeInfo.toJSON()||null,mb(a.source)?[4,a.source.openPorts()]:[3,2];case 1:return l=m.sent(),[3,3];case 2:l="dynamicDataSource"in a?a.dynamicDataSource?a.parsedUrl:a.url+"/"+a.layerId:a.parsedUrl,m.label=3;case 3:return h=l,[2,{type:"on-demand",maxRecordCount:b.query.maxRecordCount,tileMaxRecordCount:b.query.tileMaxRecordCount,
capabilities:b,fields:d,fullExtent:e,geometryType:g,objectIdField:c,source:h,timeInfo:k}]}})})};r.prototype._createMemoryServiceOptions=function(a){return c(this,void 0,void 0,function(){var b;return q(this,function(c){switch(c.label){case 0:return[4,a.openPorts()];case 1:return b=c.sent(),[2,t({},this._createServiceOptions(),{type:"memory",source:b})]}})})};r.prototype._cleanUpQuery=function(a){a=ga.from(a)||this.createQuery();a.outSpatialReference||(a.outSpatialReference=this.view.spatialReference);
return a};r.prototype._createUpdateClusterSizeTask=function(a,b){var d=this;return this.watch("_aggregateValueRanges",function(e){return c(d,void 0,void 0,function(){return q(this,function(c){this._updateClusterEffectiveRendererSizeVariable(a,b,e);if(!this._updatingPipelineConfig)this.tileRenderer.onConfigUpdate(this._effectiveRenderer);return[2]})})})};r.prototype._updateClusterEffectiveRendererSizeVariable=function(a,b,d){return c(this,void 0,void 0,function(){var c,e;return q(this,function(g){"visualVariables"in
a&&a.visualVariables&&(c=L.findSizeVV(a.visualVariables),z.isSome(c)&&"cluster_count"===c.field&&(e=a.visualVariables.indexOf(c),a.visualVariables[e]=L.createClusterCountSizeVariable(b,d),this._set("_effectiveRenderer",a.clone())));return[2]})})};r.prototype._getEffectiveRenderer=function(){return c(this,void 0,void 0,function(){var a,b,c,d,e;return q(this,function(g){switch(g.label){case 0:a=this.layer.renderer;b=this.layer.featureReduction;z.isSome(this._updateClusterSizeTask)&&(this._updateClusterSizeTask.remove(),
this._updateClusterSizeTask=null);if(!b||"cluster"!==b.type||!L.isClusterCompatibleRenderer(a))return[3,2];c=b;d=[];return[4,L.createClusterRenderer(d,this.layer.fields,a,c,this._aggregateValueRanges)];case 1:return e=g.sent(),z.andThen(this._updateClusterSizeTask,function(a){return a.remove()}),this._updateClusterSizeTask=this._createUpdateClusterSizeTask(e,c),[2,{renderer:e,aggregateFields:d,featureReduction:b}];case 2:return[2,{renderer:a,aggregateFields:[],featureReduction:null}]}})})};r.prototype._acquireTile=
function(a){var b=this;a=this.tileRenderer.acquireTile(a);a.once("attach",function(){b.requestUpdate()});return a};r.prototype._releaseTile=function(a){this.tileRenderer.releaseTile(a)};r.prototype._initTileRenderer=function(a){return c(this,void 0,void 0,function(){var b;return q(this,function(c){switch(c.label){case 0:return[4,fb.createOrReuseTileRenderer(a,{layerView:this,tileInfoView:this.view.featuresTilingScheme,layer:this.layer})];case 1:return b=c.sent(),this.tileRenderer&&(this._tileStrategy.clear(),
this.tileRenderer.uninstall(this.container),this.tileRenderer.destroy(),this.tileRenderer=null),this._proxy.tileRenderer=b,this._set("tileRenderer",b),this.tileRenderer.install(this.container),this.tileRenderer.onConfigUpdate(a),this.requestUpdate(),[2,this.tileRenderer]}})})};r.prototype._createLayerFilterHash=function(){var a=this.layer.definitionExpression,b="feature"===this.layer.type&&this.layer.historicMoment?this.layer.historicMoment.getTime():void 0;return a+"."+b+"."+("feature"===this.layer.type?
this.layer.gdbVersion:void 0)};r.prototype._createTileRendererHash=function(a){return("heatmap"===a.type?"heatmap":"symbol")+"."+("dot-density"===a.type)};r.prototype._createFeatureDataHash=function(a){a=a.getAttributeHash();var b=JSON.stringify(this.filter),c=z.isSome(this.effect)&&JSON.stringify(this.effect.filter),d=JSON.stringify(this.timeExtent),e="";this._visibilityOverrides.forEach(function(a){return e+=a});return a+"."+b+"."+c+"."+d+"."+e};r.prototype._createMeshHash=function(a){var b=xa.getVVFlags("visualVariables"in
a&&a.visualVariables||[]),c=this.layer.labelingInfo&&this.layer.labelingInfo.map(function(a){return JSON.stringify(a)}).join("/"),d=JSON.stringify(this.layer.featureReduction);return a.getMeshHash()+"."+b+"."+c+"."+d};r.prototype._injectOverrides=function(a){var b=this.filter&&this.filter.timeExtent,b=this.timeExtent&&b?this.timeExtent.intersection(b):this.timeExtent||b;if(!this._visibilityOverrides.size&&!b)return a;a=z.isSome(this.filter)&&this.filter.clone()||new ya;a.hiddenIds=this._visibilityOverrides;
a.timeExtent=b;return a};r.prototype._createConfiguration=function(a,b,c){a=T.simplifyVVRenderer(a);var d=this.layer.labelingInfo,e="feature"===this.layer.type&&this.layer.historicMoment?this.layer.historicMoment.getTime():void 0,g="feature"===this.layer.type?this.layer.gdbVersion:void 0,k=Array(xa.definitions.MAX_FILTERS),h=this._injectOverrides(this.filter);k[0]=z.isSome(h)&&h.toJSON()||null;k[1]=z.isSome(this.effect)&&this.effect.filter&&this.effect.filter.toJSON()||null;return{featureReduction:z.andThen(c,
function(a){return a.toJSON()}),definitionExpression:this.layer.definitionExpression,availableFields:this.availableFields,labelingInfo:d&&d.map(function(a){return a.toJSON()}),renderer:a.toJSON(),gdbVersion:g,historicMoment:e,devicePixelRatio:window.devicePixelRatio||1,filters:k,aggregateFields:b}};r.prototype._hasRequiredSupport=function(a){return"dot-density"!==a.renderer.type||E("esri-webgl-texture-float")?!0:(la.error(new e("webgl-missing-extension","Missing WebGL extension OES_Texture_Float which is required for DotDensity")),
!1)};r.prototype._onceTilesUpdated=function(){this.requestUpdate();return b.whenFalseOnce(this,"_pipelineIsUpdating",!0)};r.prototype._lockAttributeTextureUpload=function(){this.tileRenderer&&this.tileRenderer.lockAttributeTextureUpload()};r.prototype._unlockAttributeTextureUpload=function(){this.tileRenderer&&this.tileRenderer.unlockAttributeTextureUpload()};r.prototype._forceAttributeTextureUpload=function(){this.tileRenderer&&this.tileRenderer.forceAttributeTextureUpload()};r.prototype._renderingConfigHashChanged=
function(){var a=this;this.view.timeline.begin(this.layer.title+" (FeatureLayer) Initial Pipeline Config");var b=this._onRenderingConfigChange();this._updatingPromise=b;var c=function(){b===a._updatingPromise&&a._set("_updatingPipelineConfig",!1);a.view.timeline.end(a.layer.title+" (FeatureLayer) Initial Pipeline Config")};b.then(c).catch(function(a){k.isAbortError(a)||la.error(a);c()})};r.prototype._addHighlight=function(a){for(var b=0;b<a.length;b++){var c=a[b];if(this._highlightIds.has(c)){var d=
this._highlightIds.get(c);this._highlightIds.set(c,d+1)}else this._highlightIds.set(c,1)}this._updateHighlight().catch(function(a){k.isAbortError(a)||la.error(a)})};r.prototype._removeHighlight=function(a){for(var b=0;b<a.length;b++){var c=a[b];if(this._highlightIds.has(c)){var d=this._highlightIds.get(c)-1;0===d?this._highlightIds.delete(c):this._highlightIds.set(c,d)}}this._updateHighlight().catch(function(a){k.isAbortError(a)||la.error(a)})};r.prototype._createHittestResult=function(a){a.layer=
this.layer;a.sourceLayer=this.layer;z.isSome(a.geometry)&&(a.geometry.spatialReference=this.view.spatialReference);return a};r.prototype._queryFeature=function(a){return c(this,void 0,void 0,function(){var b,c,d;return q(this,function(e){switch(e.label){case 0:return[4,this._proxy.getObjectId(a)];case 1:return b=e.sent(),[4,this._proxy.queryFeatures(new ga({objectIds:[b],outSpatialReference:this.view.spatialReference,returnGeometry:!0}))];case 2:return c=e.sent(),(d=c.features[0])?[2,d]:[2,null]}})})};
r.prototype._hitTest=function(a,b){return c(this,void 0,void 0,function(){var c,e,g,h,m=this;return q(this,function(p){switch(p.label){case 0:return this.suspended||!this.tileRenderer?[2,null]:[4,this.tileRenderer.hitTest(a,b)];case 1:return c=p.sent(),0!==c.length?[3,3]:[4,k.after(1)];case 2:return p.sent(),[2,null];case 3:return e=c[0],1===(e&2147483648)>>>31?[3,5]:[4,this._queryFeature(e)];case 4:return g=p.sent(),[2,z.andThen(g,function(a){return m._createHittestResult(l.fromJSON(a))})];case 5:return[4,
this._proxy.getAggregate(e)];case 6:return h=p.sent(),z.isNone(h)?[2,null]:z.isSome(h.referenceId)?[4,this._queryFeature(h.referenceId)]:[3,8];case 7:return g=p.sent(),[2,z.andThen(g,function(a){return m._createHittestResult(l.fromJSON(a))})];case 8:return[2,this._createHittestResult(d.fromJSON(h))]}})})};m([H.property()],r.prototype,"_proxy",void 0);m([H.property()],r.prototype,"_pipelineIsUpdating",void 0);m([H.property()],r.prototype,"_updatingPipelineConfig",void 0);m([H.property()],r.prototype,
"_effectiveRenderer",void 0);m([H.property()],r.prototype,"_aggregateValueRanges",void 0);m([H.property()],r.prototype,"_onGoingEdits",void 0);m([H.property({dependsOn:["layer.renderer","layer.featureReduction"]})],r.prototype,"_effectiveRendererPromise",null);m([H.property({dependsOn:["suspended","layer.labelingInfo","layer.labelsVisible"]})],r.prototype,"labelsVisible",null);m([H.property({type:ya})],r.prototype,"filter",void 0);m([H.property({type:lb})],r.prototype,"effect",null);m([H.property({readOnly:!0,
dependsOn:["effect"]})],r.prototype,"effects",null);m([H.property()],r.prototype,"numFeatures",null);m([H.property({dependsOn:"layer.renderer availableFields layer.definitionExpression layer.gdbVersion? layer.filter? layer.historicMoment? layer.labelingInfo layer.featureReduction filter effect timeExtent clips".split(" ")})],r.prototype,"renderingConfigHash",null);m([H.property()],r.prototype,"tileRenderer",void 0);m([H.property({dependsOn:"layer.renderer tileRenderer.updating _updatingPipelineConfig _pipelineIsUpdating _updatingRequiredFieldsPromise _proxy _proxy.isReady? _onGoingEdits".split(" ")})],
r.prototype,"updating",void 0);return r=m([H.subclass("esri.views.2d.layers.FeatureLayerView2D")],r)}(H.declared(Sa.FeatureLayerView(kb.RefreshableLayerView(Qa.LayerView2D(jb)))))});